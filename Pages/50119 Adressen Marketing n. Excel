OBJECT Page 50119 Adressen Marketing n. Excel
{
  OBJECT-PROPERTIES
  {
    Date=03.11.22;
    Time=14:22:28;
    Modified=Yes;
    Version List=TOPAS;
  }
  PROPERTIES
  {
    InsertAllowed=No;
    DeleteAllowed=No;
    ModifyAllowed=No;
    ShowFilter=No;
    ActionList=ACTIONS
    {
      { 1000000115;  ;ActionContainer;
                      CaptionML=DEU=Funktionen;
                      ActionContainerType=ActionItems }
      { 1000000116;1 ;ActionGroup;
                      CaptionML=DEU=Ausfhren }
      { 1000000117;2 ;Action    ;
                      Name=Ausfhren;
                      Promoted=Yes;
                      OnAction=BEGIN

                                 // Neu 1.4.14 UB  in Entwicklung

                                 // Plausibilit„tskontrollen

                                 v_anz_h„kchen:=0;
                                 v_z„hler := 0;

                                 IF v_ohne_firm_verlassen=TRUE THEN v_anz_h„kchen:=v_anz_h„kchen+1;
                                 IF v_mit_firm_verlassen=TRUE THEN v_anz_h„kchen:=v_anz_h„kchen+1;
                                 IF v_nur_firm_verlassen=TRUE THEN v_anz_h„kchen:=v_anz_h„kchen+1;
                                 IF v_anz_h„kchen>1 THEN ERROR('Es wurden bei "Firma verlassen" zu viele H„kchen gesetzt!');

                                 IF ((v_landkz_de=TRUE) AND (v_landkz_de_at_ch=TRUE)) THEN ERROR('DE und DE,AT,CH k”nnen nur alternativ abgefragt werden!');

                                 IF ((v_person_adr=TRUE) AND (v_mandant_adr=TRUE)) THEN ERROR('Person und Mandant k”nnen nur alternativ abgefragt werden!');

                                 IF ((v_reiter2=TRUE) AND (v_reiter3=TRUE)) THEN ERROR('Branche und Branche_Systeme k”nnen nur alternativ abgefragt werden!');

                                 IF ((v_reiter1=FALSE) AND (v_reiter2=TRUE)) THEN ERROR('Ohne Reiter "1 Funktion" ist keine Branchenabfrage m”glich!');
                                 IF ((v_reiter1=FALSE) AND (v_reiter3=TRUE)) THEN ERROR('Ohne Reiter "1 Funktion" ist keine Branche Systeme-Abfrage m”glich!');

                                 IF ((v_reiter1=FALSE) AND (v_reiter2=FALSE) AND (v_reiter3=FALSE) AND (v_reiter4=FALSE) AND (v_reiter5=FALSE) AND (v_reiter6=FALSE)
                                  AND (v_reiter7=FALSE) AND (v_Test_Marge=FALSE)) THEN ERROR('Kein Reiter-H„kchen gesetzt!');

                                 v_anz_h„kchen:=0;
                                 IF v_adr_email=TRUE THEN v_anz_h„kchen:=v_anz_h„kchen+1;
                                 IF v_bericht_adr1=TRUE THEN v_anz_h„kchen:=v_anz_h„kchen+1;
                                 IF v_bericht_adr2=TRUE THEN v_anz_h„kchen:=v_anz_h„kchen+1;
                                 IF v_anz_h„kchen>1 THEN ERROR('Es wurde bei den Ausgabevarianten mehr als ein H„kchen gesetzt!');

                                 v_anz_h„kchen:=0;
                                 IF v_adr_email=TRUE THEN v_anz_h„kchen:=v_anz_h„kchen+1;
                                 IF v_bericht_adr1=TRUE THEN v_anz_h„kchen:=v_anz_h„kchen+1;
                                 IF v_bericht_adr2=TRUE THEN v_anz_h„kchen:=v_anz_h„kchen+1;


                                 IF v_anz_h„kchen>1 THEN ERROR('Es wurde bei der Berichtsausgabe mehr als ein H„kchen gesetzt!');

                                 v_anz_h„kchen:=0;
                                 //IF v_ohne_firm_verlassen=TRUE THEN v_anz_h„kchen:=v_anz_h„kchen+1;
                                 //IF v_mit_firm_verlassen=TRUE THEN v_anz_h„kchen:=v_anz_h„kchen+1;
                                 //IF v_nur_firm_verlassen=TRUE THEN v_anz_h„kchen:=v_anz_h„kchen+1;
                                 IF v_branche_prfen=TRUE THEN v_anz_h„kchen:=v_anz_h„kchen+1;
                                 IF v_sus_no=TRUE THEN v_anz_h„kchen:=v_anz_h„kchen+1;
                                 IF v_sus_endkunde=TRUE THEN v_anz_h„kchen:=v_anz_h„kchen+1;
                                 IF v_branche_such=TRUE THEN v_anz_h„kchen:=v_anz_h„kchen+1;
                                 //IF v_ml_kontakte=TRUE THEN v_anz_h„kchen:=v_anz_h„kchen+1;
                                 IF v_mailvormerk=TRUE THEN v_anz_h„kchen:=v_anz_h„kchen+1;
                                 IF v_son_list=TRUE THEN v_anz_h„kchen:=v_anz_h„kchen+1;
                                 IF v_Training=TRUE THEN v_anz_h„kchen:=v_anz_h„kchen+1;
                                 IF v_Training2=TRUE THEN v_anz_h„kchen:=v_anz_h„kchen+1;
                                 IF v_no_branche=TRUE THEN v_anz_h„kchen:=v_anz_h„kchen+1;
                                 IF v_deb_listen=TRUE THEN v_anz_h„kchen:=v_anz_h„kchen+1;
                                 IF v_Training_absolviert=TRUE THEN v_anz_h„kchen:=v_anz_h„kchen+1;
                                 IF v_Test_Marge=TRUE THEN v_anz_h„kchen:=v_anz_h„kchen+1;
                                 IF v_unsub_abgleich =TRUE THEN v_anz_h„kchen:=v_anz_h„kchen+1;

                                 IF v_anz_h„kchen>1 THEN ERROR('Es wurde bei den Ausgabevarianten mehr als ein H„kchen gesetzt!');





                                 {
                                 // Verteilung der Gesperrt-Kennung aus Mandant auf alle Ansprechpartner des Mandanten
                                 // zur Zeit deaktiviert                         *************************************
                                 // **********************************************************************************
                                 // Mobiligence_key benutzt zur Kennzeichnung der Personen deren Mandant gesperrt ist und nicht nach Nav2016 bertragen werden sollen
                                 kontakt.RESET;
                                 kontakt.SETFILTER(kontakt.Gesperrt,'%1',TRUE);
                                 kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Company);
                                 IF kontakt.FIND('-') THEN BEGIN
                                 REPEAT
                                 kontakt1.RESET;
                                  kontakt1.SETFILTER(kontakt1."Company No.",'%1',kontakt."No.");
                                  kontakt1.SETFILTER(kontakt1.Type,'%1',kontakt1.Type::Person);
                                   IF kontakt1.FIND('-') THEN BEGIN
                                   REPEAT
                                 //  kontakt1.Gesperrt:=TRUE;
                                   kontakt1.Mobiligence_key:='GS2016';
                                   kontakt1.MODIFY;
                                   UNTIL kontakt1.NEXT=0;
                                   END;
                                 UNTIL kontakt.NEXT=0;
                                 END;
                                 COMMIT;
                                 }


                                 IF v_reiter1=TRUE THEN Funktion_Neu;   //aus Funktion wird Branche_Neu oder Branche_System_Neu aufgerufen (Reiter2 oder Reiter3)
                                 //IF v_reiter1=TRUE THEN Funktion;   //aus Funktion wird Branche_ oder Branche_Systeme aufgerufen (Reiter2 oder Reiter3)
                                 IF v_reiter4=TRUE THEN Belege_Neu;   // Auf neuen Aufruf umgesteltt  (alt= Belege_)
                                 IF v_reiter5=TRUE THEN Memos_Neu;     // Auf neuen Aufruf umgestellt (alt =Memos_ )
                                 IF v_reiter6=TRUE THEN "alle Kontakte listen";
                                 IF v_nur_firm_verlassen=TRUE THEN Firma_verlassen_Neu;
                                 IF v_branche_prfen=TRUE THEN "Branche prfen";
                                 IF v_sus_no=TRUE THEN "Liste SUS-NO";
                                 IF v_sus_endkunde=TRUE THEN "Liste SUS-ENDKUNDE";
                                 IF v_branche_such=TRUE THEN "Branche suchen";
                                 IF v_ml_kontakte=TRUE THEN ML_Kontakte;
                                 IF v_gesperrt_nicht=TRUE THEN  Ansprech_gesperrt_Mandant_nich;
                                 IF v_doppel_Ansprech=TRUE THEN doppelte_Ansprechpartner_Neu;
                                 IF v_UN_verlassen=TRUE THEN Firma_verlassen_ohne_Eintrag;
                                 IF v_mailvormerk=TRUE THEN Mailingvormerkung;
                                 IF v_son_list=TRUE THEN sonstige_Listen_Neu;
                                 IF v_Training=TRUE THEN Trainingsinfos;
                                 IF v_Training2=TRUE THEN Trainingsinfos2;
                                 //IF v_no_branche=TRUE THEN no_branche;
                                 IF v_no_branche=TRUE THEN no_branche_1;
                                 IF v_deb_listen=TRUE THEN Debitor_listen;
                                 IF v_Training_absolviert=TRUE THEN Training_absolviert;
                                 IF v_Test_Marge=TRUE THEN Test_Marge_bei_RE;
                                 IF v_unsub_abgleich=TRUE THEN unsub_Abgleich;
                               END;
                                }
      { 1000000169;1 ;ActionGroup;
                      CaptionML=DEU=Defaults }
      { 1000000170;2 ;Action    ;
                      Name=System Mailings Default;
                      Promoted=Yes;
                      Image=Template;
                      OnAction=BEGIN
                                 //#Reiter 1 Funktion
                                 v_reiter1 := TRUE;
                                 //#Reiter 3 Branche System
                                 v_reiter3 := TRUE;

                                 v_email_adr := TRUE;
                                 v_person_adr := TRUE;
                                 v_ohne_firm_verlassen := TRUE;
                                 //v_adr_email := TRUE;
                                 v_adr_sus := TRUE;
                                 //v_adr_sus_un := TRUE;

                                 //#Funktionen
                                 //#Entwicklung
                                 v_entwl := TRUE;
                                 v_entwh := TRUE;
                                 v_entws := TRUE;

                                 v_vert := TRUE;
                                 v_supl := TRUE;
                                 v_sup := TRUE;
                                 v_tech := TRUE;

                                 v_so := TRUE;
                                 v_sop := TRUE;
                                 v_sol := TRUE;

                                 v_SUS_P1 := TRUE;

                                 //v_Training := TRUE;
                               END;
                                }
      { 1000000171;2 ;Action    ;
                      Name=Chip Mailings Default;
                      Promoted=Yes;
                      Image=Evaluate;
                      OnAction=BEGIN
                                 //#Reiter 1 Funktion
                                 v_reiter1 := TRUE;
                                 //#Reiter 2 Branche
                                 v_reiter2 := TRUE;

                                 v_email_adr := TRUE;
                                 v_person_adr := TRUE;
                                 v_ohne_firm_verlassen := TRUE;
                                 v_adr_email := TRUE;

                                 //#Funktionen
                                 //#Einkauf
                                 v_ekl := TRUE;
                                 v_ek := TRUE;

                                 //#Entwickling
                                 v_entwl := TRUE;
                                 v_entwh := TRUE;
                                 v_entws := TRUE;

                                 //#Geschftsleitung
                                 v_GL := TRUE;

                                 //#Sonstige
                                 v_sop := TRUE;
                                 v_sol := TRUE;

                                 //#Branchen
                                 v_telecom1 := TRUE;
                                 v_telecom2 := TRUE;
                                 v_telecom3 := TRUE;
                                 v_telecom4 := TRUE;
                                 v_telecom5 := TRUE;

                                 v_mm1 := TRUE;
                                 v_mm2 := TRUE;
                                 v_mm3 := TRUE;
                                 v_mm4 := TRUE;
                                 v_mm5 := TRUE;

                                 v_security1 := TRUE;
                                 v_security2 := TRUE;
                                 v_security3 := TRUE;
                                 v_security4 := TRUE;

                                 v_data1 := TRUE;
                                 v_data2 := TRUE;
                                 v_data3 := TRUE;
                                 v_data4 := TRUE;
                                 v_data5 := TRUE;
                                 v_data6 := TRUE;

                                 v_indu1 := TRUE;
                                 v_indu2 := TRUE;
                                 v_indu3 := TRUE;
                                 v_indu4 := TRUE;
                                 v_indu5 := TRUE;
                                 v_indu6 := TRUE;
                                 v_indu7 := TRUE;

                                 v_fahr1 := TRUE;
                                 v_fahr2 := TRUE;
                                 v_fahr3 := TRUE;
                                 v_fahr4 := TRUE;
                                 v_fahr5 := TRUE;

                                 v_con1 := TRUE;
                                 v_con2 := TRUE;
                                 v_con3 := TRUE;
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1000000000;;Container;
                ContainerType=ContentArea }

    { 1000000001;1;Group  ;
                CaptionML=DEU=Start;
                GroupType=Group }

    { 1000000009;2;Group  ;
                CaptionML=DEU=Adressaufbereitung (alle Reiter checken);
                GroupType=Group }

    { 1000000010;3;Group  ;
                CaptionML=DEU=Aufruf der Reiter;
                GroupType=Group }

    { 1000000011;4;Field  ;
                CaptionML=DEU=Reiter 1 Funktion;
                SourceExpr=v_reiter1 }

    { 1000000012;4;Field  ;
                CaptionML=DEU=Reiter 2 Branche;
                SourceExpr=v_reiter2 }

    { 1000000013;4;Field  ;
                CaptionML=DEU=Reiter 3 Branche System;
                SourceExpr=v_reiter3 }

    { 1000000014;4;Field  ;
                CaptionML=DEU=Reiter 4 Belege;
                SourceExpr=v_reiter4 }

    { 1000000015;4;Field  ;
                CaptionML=DEU=Reiter 5 Memos;
                SourceExpr=v_reiter5 }

    { 1000000016;4;Field  ;
                CaptionML=DEU=Reiter 6 Alle Kontakte oder 1 Kontakt;
                SourceExpr=v_reiter6 }

    { 1000000017;4;Field  ;
                CaptionML=DEU=Reiter 7 Sonderfunktion;
                SourceExpr=v_reiter7 }

    { 1000000026;3;Group  ;
                CaptionML=DEU=Weitere Filtereinstellungen;
                GroupType=Group }

    { 1000000027;4;Field  ;
                CaptionML=DEU=L„nderkz nur DE;
                SourceExpr=v_landkz_de }

    { 1000000028;4;Field  ;
                CaptionML=DEU=L„nderkz DE, AT und CH;
                SourceExpr=v_landkz_de_at_ch }

    { 1000000029;4;Field  ;
                CaptionML=DEU=nur mit Email-Adr.;
                SourceExpr=v_email_adr }

    { 1000000030;4;Field  ;
                CaptionML=DEU=nur Personen;
                SourceExpr=v_person_adr }

    { 1000000031;4;Field  ;
                CaptionML=DEU=nur Mandanten;
                SourceExpr=v_mandant_adr }

    { 1000000032;4;Field  ;
                CaptionML=DEU=ohne Firma verlassen;
                SourceExpr=v_ohne_firm_verlassen }

    { 1000000033;4;Field  ;
                CaptionML=DEU=nur Firma verlassen;
                SourceExpr=v_nur_firm_verlassen }

    { 1000000034;4;Field  ;
                CaptionML=DEU=mit Firma verlassen;
                SourceExpr=v_mit_firm_verlassen }

    { 1000000035;3;Group  ;
                CaptionML=DEU=Ausgabevarianten;
                GroupType=Group }

    { 1000000036;4;Field  ;
                CaptionML=DEU=Excel-File fr Serien-E-Mail;
                SourceExpr=v_adr_email }

    { 1000000037;4;Field  ;
                CaptionML=DEU=Bericht Adresse 1;
                SourceExpr=v_bericht_adr1 }

    { 1000000038;4;Field  ;
                CaptionML=DEU=Excel-File fr Serien-E-Mail (Belege + Memos);
                SourceExpr=v_adr_email1 }

    { 1000000039;4;Field  ;
                CaptionML=DEU=Bericht adresse 2;
                SourceExpr=v_bericht_adr2 }

    { 1000000040;4;Field  ;
                CaptionML=DEU=Excel-File fr Serien-E-Mail fr Systeme;
                SourceExpr=v_adr_sus }

    { 1000000041;4;Field  ;
                CaptionML=DEU=Excel-File fr Serien-E-Mail fr Systeme ohne UNSUB;
                SourceExpr=v_adr_sus_un }

    { 1000000002;1;Group  ;
                CaptionML=DEU=" 1 Funktion";
                GroupType=Group }

    { 1000000042;2;Group  ;
                CaptionML=DEU=Auswahl Funktionen;
                GroupType=Group }

    { 1000000043;3;Field  ;
                CaptionML=DEU=Alle;
                SourceExpr=v_alle }

    { 1000000044;3;Field  ;
                CaptionML=DEU=Einkaufsleitung;
                SourceExpr=v_ekl }

    { 1000000045;3;Field  ;
                CaptionML=DEU=Einkauf;
                SourceExpr=v_ek }

    { 1000000046;3;Field  ;
                CaptionML=DEU=Entwicklungsleitung;
                SourceExpr=v_entwl }

    { 1000000047;3;Field  ;
                CaptionML=DEU=Entwicklung Hardware;
                SourceExpr=v_entwh }

    { 1000000048;3;Field  ;
                CaptionML=DEU=Entwicklung Software;
                SourceExpr=v_entws }

    { 1000000049;3;Field  ;
                CaptionML=DEU=Finanzen;
                SourceExpr=v_fin }

    { 1000000050;3;Field  ;
                CaptionML=DEU=Gesch„ftsleitung;
                SourceExpr=v_GL }

    { 1000000051;3;Field  ;
                CaptionML=DEU=Produktion;
                SourceExpr=v_prod }

    { 1000000052;3;Field  ;
                CaptionML=DEU=Qualit„tswesen;
                SourceExpr=v_qual }

    { 1000000053;3;Field  ;
                CaptionML=DEU=Vertriebsleitung;
                SourceExpr=v_vertl }

    { 1000000054;3;Field  ;
                CaptionML=DEU=Vertrieb;
                SourceExpr=v_vert }

    { 1000000055;3;Field  ;
                CaptionML=DEU=Supportleitung;
                SourceExpr=v_supl }

    { 1000000056;3;Field  ;
                CaptionML=DEU=Support;
                SourceExpr=v_sup }

    { 1000000057;3;Field  ;
                CaptionML=DEU=Techniker;
                SourceExpr=v_tech }

    { 1000000058;3;Field  ;
                CaptionML=DEU=Marketingleiter;
                SourceExpr=v_ml }

    { 1000000059;3;Field  ;
                CaptionML=DEU=Marketingmitarbeiter;
                SourceExpr=v_ma }

    { 1000000060;3;Field  ;
                CaptionML=DEU=Sonstige;
                SourceExpr=v_so }

    { 1000000061;3;Field  ;
                CaptionML=DEU=sonstige Projektfunktion;
                SourceExpr=v_sop }

    { 1000000062;3;Field  ;
                CaptionML=DEU=sonstige Leitungsfunktion;
                SourceExpr=v_sol }

    { 1000000003;1;Group  ;
                CaptionML=DEU=2 Branche;
                GroupType=Group }

    { 1000000063;2;Group  ;
                CaptionML=DEU=Kundenklassifizierung;
                GroupType=Group }

    { 1000000064;3;Field  ;
                CaptionML=DEU=(TELECOM1) Telecom;
                SourceExpr=v_telecom1 }

    { 1000000065;3;Field  ;
                CaptionML=DEU=(TELECOM2) Netze;
                SourceExpr=v_telecom2 }

    { 1000000066;3;Field  ;
                CaptionML=DEU=(TELECOM3) Endger„te;
                SourceExpr=v_telecom3 }

    { 1000000067;3;Field  ;
                CaptionML=DEU=(TELECOM4) Messtechnik;
                SourceExpr=v_telecom4 }

    { 1000000068;3;Field  ;
                CaptionML=DEU=(TELECOM5) Funktechnik;
                SourceExpr=v_telecom5 }

    { 1000000069;3;Field  ;
                CaptionML=DEU=(MM1) Audio;
                SourceExpr=v_mm1 }

    { 1000000070;3;Field  ;
                CaptionML=DEU=(MM2) Home A/V;
                SourceExpr=v_mm2 }

    { 1000000071;3;Field  ;
                CaptionML=DEU=(MM3) Mobile A/V;
                SourceExpr=v_mm3 }

    { 1000000072;3;Field  ;
                CaptionML=DEU=(MM4) Automotive;
                SourceExpr=v_mm4 }

    { 1000000073;3;Field  ;
                CaptionML=DEU=(MM5) Professional;
                SourceExpr=v_mm5 }

    { 1000000074;3;Field  ;
                CaptionML=DEU=(SECURITY1) Security;
                SourceExpr=v_security1 }

    { 1000000075;3;Field  ;
                CaptionML=DEU=(SECURITY2) Consumer;
                SourceExpr=v_security2 }

    { 1000000076;3;Field  ;
                CaptionML=DEU=(SECURITY3) Professional;
                SourceExpr=v_security3 }

    { 1000000077;3;Field  ;
                CaptionML=DEU=(SECURITY4) Zugangskontrolle;
                SourceExpr=v_security4 }

    { 1000000078;3;Field  ;
                CaptionML=DEU=(IT-SYSTEM1) IT Systeme;
                SourceExpr=v_it1 }

    { 1000000079;3;Field  ;
                CaptionML=DEU=(IT-SYSTEM2) Projektierung;
                SourceExpr=v_it2 }

    { 1000000080;3;Field  ;
                CaptionML=DEU=(IT-SYSTEM3) Integration;
                SourceExpr=v_it3 }

    { 1000000081;3;Field  ;
                CaptionML=DEU=(IT-SYSTEM4) SW-Entwicklung;
                SourceExpr=v_it4 }

    { 1000000082;3;Field  ;
                CaptionML=DEU=(WARENWIRT1) Warenwirtschaftssyteme;
                SourceExpr=v_ww1 }

    { 1000000083;3;Field  ;
                CaptionML=DEU=(WARENWIRT2) Warenkennzeichnungssysteme;
                SourceExpr=v_ww2 }

    { 1000000084;3;Field  ;
                CaptionML=DEU=(WARENWIRT3) POS;
                SourceExpr=v_ww3 }

    { 1000000085;3;Field  ;
                CaptionML=DEU=(WARENWIRT4) Automaten;
                SourceExpr=v_ww4 }

    { 1000000086;3;Field  ;
                CaptionML=DEU=(AUFTR-ENTW) Auftragsentwicklung;
                SourceExpr=v_aufentw }

    { 1000000087;3;Field  ;
                CaptionML=DEU=(BESTšCKER) Bestcker;
                SourceExpr=v_bestcker }

    { 1000000088;3;Field  ;
                CaptionML=DEU=(HŽNDLER) H„ndler;
                SourceExpr=v_h„ndler }

    { 1000000089;3;Field  ;
                CaptionML=DEU=(DIENSTLEI) Dienstleister Beschaffung;
                SourceExpr=v_dienstlei }

    { 1000000090;3;Field  ;
                CaptionML=DEU=(UNI/TH/FH2) Uni/TH/FH Bildung-Forschung...;
                SourceExpr=v_uni }

    { 1000000091;3;Field  ;
                CaptionML=DEU=(DATACOM1) Datacom;
                SourceExpr=v_data1 }

    { 1000000092;3;Field  ;
                CaptionML=DEU=(DATACOM2) PC Add-On;
                SourceExpr=v_data2 }

    { 1000000093;3;Field  ;
                CaptionML=DEU=(DATACOM3) Netzwerktechnik;
                SourceExpr=v_data3 }

    { 1000000094;3;Field  ;
                CaptionML=DEU=(DATACOM4) Messtechnik;
                SourceExpr=v_data4 }

    { 1000000095;3;Field  ;
                CaptionML=DEU=(DATACOM5) Funktechnik;
                SourceExpr=v_data5 }

    { 1000000096;3;Field  ;
                CaptionML=DEU=(DATACOM6) Storage;
                SourceExpr=v_data6 }

    { 1000000097;3;Field  ;
                CaptionML=DEU=(INDUSTRIE1) Industrie;
                SourceExpr=v_indu1 }

    { 1000000098;3;Field  ;
                CaptionML=DEU=(INDUSTRIE2) Steuerungstechnik;
                SourceExpr=v_indu2 }

    { 1000000099;3;Field  ;
                CaptionML=DEU=(INDUSTRIE3) Antriebstechnik;
                SourceExpr=v_indu3 }

    { 1000000100;3;Field  ;
                CaptionML=DEU=(INDUSTRIE4) Lichttechnik;
                SourceExpr=v_indu4 }

    { 1000000101;3;Field  ;
                CaptionML=DEU=(INDUSTRIE5) Automatisierungstechnik;
                SourceExpr=v_indu5 }

    { 1000000102;3;Field  ;
                CaptionML=DEU=(INDUSTRIE6) Messtechnik;
                SourceExpr=v_indu6 }

    { 1000000103;3;Field  ;
                CaptionML=DEU=(INDUSTRIE7) Bildverarbeitung;
                SourceExpr=v_indu7 }

    { 1000000104;3;Field  ;
                CaptionML=DEU=(FAHRZEUG1) Fahrzeugtechnik;
                SourceExpr=v_fahr1 }

    { 1000000105;3;Field  ;
                CaptionML=DEU=(FAHRZEUG2) Automotive;
                SourceExpr=v_fahr2 }

    { 1000000106;3;Field  ;
                CaptionML=DEU=(FAHRZEUG3) Nutzfahrzeuge;
                SourceExpr=v_fahr3 }

    { 1000000107;3;Field  ;
                CaptionML=DEU=(FAHRZEUG4) Verkehrssysteme;
                SourceExpr=v_fahr4 }

    { 1000000108;3;Field  ;
                CaptionML=DEU=(FAHRZEUG5) Milit„r / Aerospace;
                SourceExpr=v_fahr5 }

    { 1000000109;3;Field  ;
                CaptionML=DEU=(CONSUMER1) Consumer;
                SourceExpr=v_con1 }

    { 1000000110;3;Field  ;
                CaptionML=DEU=(CONSUMER2) Haushaltsger„te;
                SourceExpr=v_con2 }

    { 1000000111;3;Field  ;
                CaptionML=DEU=(CONSUMER3) Spielzeugindustrie;
                SourceExpr=v_con3 }

    { 1000000112;3;Field  ;
                CaptionML=DEU=(GEBŽUDE/IN) Geb„ude-/Installationstechnik;
                SourceExpr=v_geb„ude }

    { 1000000113;3;Field  ;
                CaptionML=DEU=(MEDIZIN) Medizintechnik;
                SourceExpr=v_medizin }

    { 1000000114;3;Field  ;
                CaptionML=DEU=(PRESSE) Prese;
                SourceExpr=v_presse }

    { 1000000004;1;Group  ;
                CaptionML=DEU=3 Branche Systeme;
                GroupType=Group }

    { 1000000118;2;Group  ;
                CaptionML=DEU=Kundenklassifizierung;
                GroupType=Group }

    { 1000000119;3;Field  ;
                Name=<v_alle_acs>;
                CaptionML=DEU=Alle mit Brancheneintrag;
                SourceExpr=v_alle_acs }

    { 1000000120;3;Group  ;
                CaptionML=DEU=Partner;
                GroupType=Group }

    { 1000000121;4;Field  ;
                Name=<v_SUS_P1>;
                CaptionML=DEU=(SuS-P1) AudioCodes;
                SourceExpr=v_SUS_P1 }

    { 1000000122;4;Field  ;
                Name=<v_SuS-P2>;
                CaptionML=DEU=(SuS-P2) Ferrari;
                SourceExpr=v_SUS_P2 }

    { 1000000123;4;Field  ;
                Name=<v_SuS-P3>;
                CaptionML=DEU=(SuS-P3) Splicecom;
                SourceExpr=v_SUS_P3 }

    { 1000000124;4;Field  ;
                Name=<v_SuS-P4>;
                CaptionML=DEU=(SuS-P4) Wildix;
                SourceExpr=v_SUS_P4 }

    { 1000000025;4;Field  ;
                Name=<v_SuS-P5>;
                CaptionML=DEU=(SuS-P5) Docuware;
                SourceExpr=v_SUS_P5 }

    { 1000000125;3;Group  ;
                CaptionML=DEU=Typ;
                GroupType=Group }

    { 1000000126;4;Field  ;
                Name=<v_SuS-T1>;
                CaptionML=DEU=(SuS-T1) Dienstleister;
                SourceExpr=v_SUS_T1 }

    { 1000000127;4;Field  ;
                Name=<v_SuS-T2>;
                CaptionML=DEU=(SuS-T2) IT-Abteilung;
                SourceExpr=v_SUS_T2 }

    { 1000000128;4;Field  ;
                Name=<v_SuS-T3>;
                CaptionML=DEU=(SuS-T3) L”sungsanbieter;
                SourceExpr=v_SUS_T3 }

    { 1000000129;4;Field  ;
                Name=<v_SuS-T4>;
                CaptionML=DEU=(SuS-T4) Provider regional;
                SourceExpr=v_SUS_T4 }

    { 1000000130;4;Field  ;
                Name=<v_SuS-T5>;
                CaptionML=DEU=(SuS-T5) Provider berregional;
                SourceExpr=v_SUS_T5 }

    { 1000000131;4;Field  ;
                Name=<v_SuS-T6>;
                CaptionML=DEU=(SuS-T6) Reseller;
                SourceExpr=v_SUS_T6 }

    { 1000000132;4;Field  ;
                Name=<v_SuS-T7>;
                CaptionML=DEU=(SuS-T7) Systemhaus;
                SourceExpr=v_SUS_T7 }

    { 1000000133;3;Group  ;
                CaptionML=DEU=L”sung;
                GroupType=Group }

    { 1000000134;4;Field  ;
                Name=<v_SuS_L1>;
                CaptionML=DEU=(SuS-L1) Conferencing/Call Center;
                SourceExpr=v_SUS_L1 }

    { 1000000135;4;Field  ;
                Name=<v_SuS_L2>;
                CaptionML=DEU=(SuS-L2) FAX;
                SourceExpr=v_SUS_L2 }

    { 1000000136;4;Field  ;
                Name=<v_SuS_L3>;
                CaptionML=DEU=(SuS-L3) IP-Telefone;
                SourceExpr=v_SUS_L3 }

    { 1000000137;4;Field  ;
                Name=<v_SuS_L4>;
                CaptionML=DEU=(SuS-L4) Lync;
                SourceExpr=v_SUS_L4 }

    { 1000000138;4;Field  ;
                Name=<v_SuS_L5>;
                CaptionML=DEU=(SuS-L5) Voice;
                SourceExpr=v_SUS_L5 }

    { 1000000139;3;Group  ;
                CaptionML=DEU=Sonstige;
                GroupType=Group }

    { 1000000140;4;Field  ;
                Name=<v_SuS_TP>;
                CaptionML=DEU=(SuS-TP) Presse;
                SourceExpr=v_SUS_TP }

    { 1000000141;4;Field  ;
                Name=<v_SuS_ENDK>;
                CaptionML=DEU=(SuS-ENDK) System-Enckunde;
                SourceExpr=v_SUS_ENDK }

    { 1000000142;4;Field  ;
                Name=<v_SuS_NO-ACS>;
                CaptionML=DEU=(SuS-NO-ACS) keine ACS-Infos;
                SourceExpr=v_SUS_NO_ACS }

    { 1000000143;4;Field  ;
                Name=<v_SuS_NO-FER>;
                CaptionML=DEU=(SuS-NO-FER) keine FER-Infos;
                SourceExpr=v_SUS_NO_FER }

    { 1000000144;4;Field  ;
                Name=<v_SuS_NO-SPL>;
                CaptionML=DEU=(SuS-NO-SPL) keine SPL-Infos;
                SourceExpr=v_SUS_NO_SPL }

    { 1000000022;4;Field  ;
                Name=<v_SuS_NO-WIL>;
                CaptionML=DEU=(SuS-NO-WIL) keine WIL-Infos;
                SourceExpr=v_SUS_NO_WIL }

    { 1000000145;4;Field  ;
                Name=<v_NO-MAILING>;
                CaptionML=DEU=(NO-MAILING) Kein Mailing;
                SourceExpr=v_NO_MAILING }

    { 1000000005;1;Group  ;
                CaptionML=DEU=4 Belege/Memos/Kontakte;
                GroupType=Group }

    { 1000000164;2;Group  ;
                CaptionML=DEU=Auswahl Belege eingrenzen. Jeweiligen Reiter aktivieren;
                GroupType=Group }

    { 1000000163;3;Field  ;
                Name=<v_datum_von>;
                CaptionML=DEU=Datum von:;
                SourceExpr=v_datum_von }

    { 1000000162;3;Field  ;
                Name=<v_datum_bis>;
                CaptionML=DEU=Datum bis:;
                SourceExpr=v_datum_bis }

    { 1000000161;3;Field  ;
                Name=<v_hersteller1>;
                CaptionML=DEU=Hersteller 1;
                SourceExpr=v_hersteller1 }

    { 1000000160;3;Field  ;
                Name=<v_hersteller2>;
                CaptionML=DEU=Hersteller 2;
                SourceExpr=v_hersteller2 }

    { 1000000159;3;Field  ;
                Name=<v_hersteller3>;
                CaptionML=DEU=Hersteller 3;
                SourceExpr=v_hersteller3 }

    { 1000000158;3;Field  ;
                Name=<v_hersteller4>;
                CaptionML=DEU=Hersteller 4;
                SourceExpr=v_hersteller4 }

    { 1000000157;3;Field  ;
                Name=<v_hersteller5>;
                CaptionML=DEU=Hersteller 5;
                SourceExpr=v_hersteller5 }

    { 1000000006;1;Group  ;
                CaptionML=DEU=5 Memos  siehe Punkt 4;
                GroupType=Group }

    { 1000000007;1;Group  ;
                CaptionML=DEU=6 Kontakte siehe Punkt 4;
                GroupType=Group }

    { 1000000008;1;Group  ;
                CaptionML=DEU=7 Sonderfunktion;
                GroupType=Group }

    { 1000000146;2;Field  ;
                Name=<v_branche_prfen>;
                CaptionML=DEU=Prfen, ob P1, P2 oder P3 Branchenkenner fr Systemkunde angelegt ist;
                SourceExpr=v_branche_prfen }

    { 1000000147;2;Field  ;
                Name=<v_sus_no>;
                CaptionML=DEU=Liste erstellen fr 'SuS-NOxxxx';
                SourceExpr=v_sus_no }

    { 1000000148;2;Field  ;
                Name=<v_sus_endkunde>;
                CaptionML=DEU=Liste erstellen fr 'SuS-ENDKUNDE';
                SourceExpr=v_sus_endkunde }

    { 1000000149;2;Field  ;
                Name=<v_ml_kontakte>;
                CaptionML=DEU=Liste erstellen fr 'ML' Verk„ufer oder Innen;
                SourceExpr=v_ml_kontakte }

    { 1000000150;2;Field  ;
                Name=<v_gesperrt_nicht>;
                CaptionML=DEU=Liste erstellen fr gesperrte Mandanten mit gesperrten Ansprechpartner;
                SourceExpr=v_gesperrt_nicht }

    { 1000000151;2;Field  ;
                Name=<v_doppel_Ansprech>;
                CaptionML=DEU=Liste erstellen fr doppelte Ansprechpartner;
                SourceExpr=v_doppel_Ansprech }

    { 1000000152;2;Field  ;
                Name=<v_UN_verlassen>;
                CaptionML=DEU=Liste erstellen fr UN verlassen ohne Eintrag in Projekt etc.;
                SourceExpr=v_UN_verlassen }

    { 1000000153;2;Field  ;
                Name=<v_mailvormerk>;
                CaptionML=DEU=Liste erstellen Adressen mit Mailingvormerkung;
                SourceExpr=v_mailvormerk }

    { 1000000154;2;Field  ;
                Name=<v_Training>;
                CaptionML=DEU=Liste erstellen ber Trainings informieren;
                SourceExpr=v_Training }

    { 1000000155;2;Field  ;
                Name=<v_no_branche>;
                CaptionML=DEU=Liste erstellen Kontakte ohne Branche (Adrliste w„hlen);
                SourceExpr=v_no_branche }

    { 1000000156;2;Field  ;
                Name=<v_son_list>;
                CaptionML=DEU=Sonderliste PLZ 6xxxx suchen;
                SourceExpr=v_son_list }

    { 1000000018;2;Field  ;
                Name=<v_Training2>;
                CaptionML=DEU=Liste erstellen ber Traininginfos2 Liste Systeme;
                SourceExpr=v_Training2 }

    { 1000000021;2;Field  ;
                Name=<v_Training_absolviert>;
                CaptionML=DEU=Liste erstellen ber absolvierte Trainings;
                SourceExpr=v_Training_absolviert }

    { 1000000023;2;Field  ;
                Name=<v_branche_such>;
                CaptionML=DEU=Liste erstellen Branche suchen (Branchenkenner eingeben);
                SourceExpr=v_branche_such }

    { 1000000024;2;Field  ;
                Name=<v_branche_suche>;
                CaptionML=DEU=Branchenkenner eingeben (z.B. SUS-P1):;
                SourceExpr=v_branche_suche }

    { 1000000020;1;Group  ;
                Name=Group;
                GroupType=Group }

    { 1000000019;2;Field  ;
                Name=Debitor listen;
                CaptionML=DEU=Debitor listen;
                SourceExpr=v_deb_listen }

    { 1000000165;1;Group  ;
                CaptionML=DEU=Testbereich;
                GroupType=Group }

    { 1000000166;2;Field  ;
                CaptionML=DEU=Margentest starten;
                SourceExpr=v_Test_Marge }

    { 1000000167;1;Group  ;
                CaptionML=DEU=Unsub Abgleich;
                GroupType=Group }

    { 1000000168;2;Field  ;
                Name=v_unsub_abgleich;
                CaptionML=DEU=Abgleich starten;
                SourceExpr=v_unsub_abgleich }

  }
  CODE
  {
    VAR
      Excel@1000000252 : Automation "{00020813-0000-0000-C000-000000000046} 1.2:{00024500-0000-0000-C000-000000000046}:Unknown Automation Server.Application";
      Book@1000000251 : Automation "{00020813-0000-0000-C000-000000000046} 1.2:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";
      Range@1000000250 : Automation "{00020813-0000-0000-C000-000000000046} 1.2:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";
      Sheet@1000000249 : Automation "{00020813-0000-0000-C000-000000000046} 1.2:{00020820-0000-0000-C000-000000000046}:Unknown Automation Server.Worksheet";
      k@1000000248 : Text[30];
      j@1000000247 : Text[30];
      memok@1000000246 : Record 50003;
      memoz@1000000245 : Record 50004;
      vkrk@1000000244 : Record 112;
      vkrz@1000000243 : Record 113;
      vkk@1000000242 : Record 36;
      vkz@1000000241 : Record 37;
      artikel@1000000240 : Record 27;
      kontakt@1000000239 : Record 5050;
      kontakt1@1000000238 : Record 5050;
      position@1000000237 : Record 5067;
      branche@1000000236 : Record 5058;
      branche1@1000000235 : Record 5058;
      belege@1000000234 : Record 50010;
      kon_deb@1000000233 : Record 5054;
      debitor@1000000232 : Record 18;
      linie@1000000231 : Record 50002;
      verteiler@1000000230 : Record 5056;
      verteiler1@1000000229 : Record 5056;
      RMA@1000000228 : Record 50022;
      Aufgabe@1000000227 : Record 5080;
      "AP Auswahl"@1000000226 : Record 50005;
      v_reiter1@1000000225 : Boolean;
      v_reiter2@1000000224 : Boolean;
      v_reiter3@1000000223 : Boolean;
      v_reiter4@1000000222 : Boolean;
      v_reiter5@1000000221 : Boolean;
      v_reiter6@1000000220 : Boolean;
      v_reiter7@1000000219 : Boolean;
      v_nur_firm_verlassen@1000000218 : Boolean;
      v_mit_firm_verlassen@1000000217 : Boolean;
      v_ohne_firm_verlassen@1000000216 : Boolean;
      v_anz_h„kchen@1000000215 : Integer;
      v_ek@1000000214 : Boolean;
      v_ekl@1000000213 : Boolean;
      v_entwl@1000000212 : Boolean;
      v_entwh@1000000211 : Boolean;
      v_entws@1000000210 : Boolean;
      v_fin@1000000209 : Boolean;
      v_GL@1000000208 : Boolean;
      v_prod@1000000207 : Boolean;
      v_qual@1000000206 : Boolean;
      v_vertl@1000000205 : Boolean;
      v_vert@1000000204 : Boolean;
      v_supl@1000000203 : Boolean;
      v_sup@1000000202 : Boolean;
      v_tech@1000000201 : Boolean;
      v_ml@1000000200 : Boolean;
      v_ma@1000000199 : Boolean;
      v_so@1000000198 : Boolean;
      v_sop@1000000197 : Boolean;
      v_sol@1000000196 : Boolean;
      v_pcn@1000000195 : Boolean;
      v_email_adr@1000000194 : Boolean;
      v_person_adr@1000000193 : Boolean;
      v_mandant_adr@1000000192 : Boolean;
      anzahl@1000000191 : Integer;
      v_telecom1@1000000190 : Boolean;
      v_telecom2@1000000189 : Boolean;
      v_telecom3@1000000188 : Boolean;
      v_telecom4@1000000187 : Boolean;
      v_telecom5@1000000186 : Boolean;
      v_mm1@1000000185 : Boolean;
      v_mm2@1000000184 : Boolean;
      v_mm3@1000000183 : Boolean;
      v_mm4@1000000182 : Boolean;
      v_mm5@1000000181 : Boolean;
      v_security1@1000000180 : Boolean;
      v_security2@1000000179 : Boolean;
      v_security3@1000000178 : Boolean;
      v_security4@1000000177 : Boolean;
      v_it1@1000000176 : Boolean;
      v_it2@1000000175 : Boolean;
      v_it3@1000000174 : Boolean;
      v_it4@1000000173 : Boolean;
      v_ww1@1000000172 : Boolean;
      v_ww2@1000000171 : Boolean;
      v_ww3@1000000170 : Boolean;
      v_ww4@1000000169 : Boolean;
      v_aufentw@1000000168 : Boolean;
      v_bestcker@1000000167 : Boolean;
      v_h„ndler@1000000166 : Boolean;
      v_dienstlei@1000000165 : Boolean;
      v_uni@1000000164 : Boolean;
      v_presse@1000000163 : Boolean;
      v_data1@1000000162 : Boolean;
      v_data2@1000000161 : Boolean;
      v_data3@1000000160 : Boolean;
      v_data4@1000000159 : Boolean;
      v_data5@1000000158 : Boolean;
      v_data6@1000000157 : Boolean;
      v_indu1@1000000156 : Boolean;
      v_indu2@1000000155 : Boolean;
      v_indu3@1000000154 : Boolean;
      v_indu4@1000000153 : Boolean;
      v_indu5@1000000152 : Boolean;
      v_indu6@1000000151 : Boolean;
      v_indu7@1000000150 : Boolean;
      v_fahr1@1000000149 : Boolean;
      v_fahr2@1000000148 : Boolean;
      v_fahr3@1000000147 : Boolean;
      v_fahr4@1000000146 : Boolean;
      v_fahr5@1000000145 : Boolean;
      v_con1@1000000144 : Boolean;
      v_con2@1000000143 : Boolean;
      v_con3@1000000142 : Boolean;
      v_geb„ude@1000000141 : Boolean;
      v_medizin@1000000140 : Boolean;
      v_alle@1000000139 : Boolean;
      v_alle_bran@1000000138 : Boolean;
      v_datum_von@1000000137 : Date;
      v_datum_bis@1000000136 : Date;
      v_hersteller1@1000000135 : Code[10];
      v_hersteller2@1000000134 : Code[10];
      v_hersteller3@1000000133 : Code[10];
      v_hersteller4@1000000132 : Code[10];
      v_hersteller5@1000000131 : Code[10];
      v_landkz_de_at_ch@1000000130 : Boolean;
      v_landkz_de@1000000129 : Boolean;
      v_aes1@1000000128 : Boolean;
      v_aes2@1000000127 : Boolean;
      v_aes3@1000000126 : Boolean;
      v_aes4@1000000125 : Boolean;
      v_aes5@1000000124 : Boolean;
      v_aes6@1000000123 : Boolean;
      v_aes7@1000000122 : Boolean;
      v_aes8@1000000121 : Boolean;
      v_h„ndl@1000000120 : Boolean;
      v_sh1@1000000119 : Boolean;
      v_sh2@1000000118 : Boolean;
      v_sh3@1000000117 : Boolean;
      v_sh4@1000000116 : Boolean;
      v_sh5@1000000115 : Boolean;
      v_sh6@1000000114 : Boolean;
      v_sh7@1000000113 : Boolean;
      v_sh8@1000000112 : Boolean;
      v_sh9@1000000111 : Boolean;
      v_sn1@1000000110 : Boolean;
      v_sn2@1000000109 : Boolean;
      v_sn3@1000000108 : Boolean;
      v_sn4@1000000107 : Boolean;
      v_sn5@1000000106 : Boolean;
      v_sn6@1000000105 : Boolean;
      v_sn7@1000000104 : Boolean;
      v_sn8@1000000103 : Boolean;
      v_sn9@1000000102 : Boolean;
      v_sn10@1000000101 : Boolean;
      v_st1@1000000100 : Boolean;
      v_st2@1000000099 : Boolean;
      v_st3@1000000098 : Boolean;
      v_st4@1000000097 : Boolean;
      v_st5@1000000096 : Boolean;
      v_st6@1000000095 : Boolean;
      v_st7@1000000094 : Boolean;
      v_st8@1000000093 : Boolean;
      v_alle_acs@1000000092 : Boolean;
      v_au@1000000091 : Text[20];
      v_re@1000000090 : Text[20];
      v_an@1000000089 : Text[20];
      v_gu@1000000088 : Text[20];
      v_art@1000000087 : Text[15];
      v_branche@1000000086 : Integer;
      v_branche1@1000000085 : Code[10];
      v_branche2@1000000084 : Code[10];
      v_branche3@1000000083 : Code[10];
      v_branche4@1000000082 : Code[10];
      v_branche5@1000000081 : Code[10];
      v_branche6@1000000080 : Code[10];
      v_branche7@1000000079 : Code[10];
      v_branche8@1000000078 : Code[10];
      v_branche9@1000000077 : Code[10];
      v_branche10@1000000076 : Code[10];
      v_branche11@1000000075 : Code[10];
      v_branche12@1000000074 : Code[10];
      v_branche13@1000000073 : Code[10];
      v_branche14@1000000072 : Code[10];
      v_branche15@1000000071 : Code[10];
      v_verteiler1@1000000070 : Code[20];
      v_verteiler2@1000000069 : Code[10];
      v_verteiler3@1000000068 : Code[10];
      v_verteiler4@1000000067 : Code[10];
      v_verteiler5@1000000066 : Code[10];
      v_verteiler6@1000000065 : Code[20];
      v_bran_filter@1000000064 : Text[250];
      v_kontaktnr@1000000063 : Code[10];
      v_SUS_P1@1000000062 : Boolean;
      v_SUS_P2@1000000061 : Boolean;
      v_SUS_P3@1000000060 : Boolean;
      v_SUS_P4@1000000059 : Boolean;
      v_SUS_P5@1000000276 : Boolean;
      v_SUS_T1@1000000058 : Boolean;
      v_SUS_T2@1000000057 : Boolean;
      v_SUS_T3@1000000056 : Boolean;
      v_SUS_T4@1000000055 : Boolean;
      v_SUS_T5@1000000054 : Boolean;
      v_SUS_T6@1000000053 : Boolean;
      v_SUS_T7@1000000052 : Boolean;
      v_SUS_TP@1000000051 : Boolean;
      v_SUS_L1@1000000050 : Boolean;
      v_SUS_L2@1000000049 : Boolean;
      v_SUS_L3@1000000048 : Boolean;
      v_SUS_L4@1000000047 : Boolean;
      v_SUS_L5@1000000046 : Boolean;
      v_SUS_ENDK@1000000045 : Boolean;
      v_SUS_NO_ACS@1000000044 : Boolean;
      v_SUS_NO_FER@1000000043 : Boolean;
      v_SUS_NO_SPL@1000000042 : Boolean;
      v_SUS_NO_WIL@1000000271 : Boolean;
      v_NO_MAILING@1000000041 : Boolean;
      v_adr_email@1000000040 : Boolean;
      v_z„hler@1000000039 : Integer;
      v_bericht_adr1@1000000038 : Boolean;
      v_bericht_adr2@1000000037 : Boolean;
      v_anz_branche@1000000036 : Integer;
      v_branche_prfen@1000000035 : Boolean;
      v_branche_ok@1000000034 : Integer;
      v_sus_no@1000000033 : Boolean;
      v_sus_endkunde@1000000032 : Boolean;
      v_branche_suche@1000000031 : Code[10];
      v_branche_such@1000000030 : Boolean;
      v_ml_kontakte@1000000029 : Boolean;
      v_adr_sus@1000000028 : Boolean;
      v_gesperrt_nicht@1000000027 : Boolean;
      v_adr_email1@1000000026 : Boolean;
      v_memo_kurztext@1000000025 : Text[50];
      v_memo_datum@1000000024 : Date;
      v_doppel_Ansprech@1000000023 : Boolean;
      v_UN_verlassen@1000000022 : Boolean;
      v_mailvormerk@1000000021 : Boolean;
      v_son_list@1000000020 : Boolean;
      v_betrag@1000000019 : Decimal;
      v_Training@1000000018 : Boolean;
      Tab5065@1000000017 : Record 5065;
      Tab5085@1000000016 : Record 5085;
      Tab5086@1000000015 : Record 5086;
      Tab5107@1000000014 : Record 5107;
      Tab5108@1000000013 : Record 5108;
      Tab5109@1000000012 : Record 5109;
      Tab5199@1000000011 : Record 5199;
      Tab50007@1000000010 : Record 50007;
      Tab50009@1000000009 : Record 50009;
      Tab50032@1000000006 : Record 50032;
      TOPAS_API@1000000005 : Codeunit 50001;
      v_hypernr@1000000004 : Text[30];
      v_hyperlink@1000000003 : Text[250];
      v_no_branche@1000000002 : Boolean;
      v_no_unsub@1000000001 : Boolean;
      v_adr_sus_un@1000000000 : Boolean;
      v_Training2@1000000007 : Boolean;
      TempExcelBuffer@1000000262 : TEMPORARY Record 370;
      FileMgt@1000000261 : Codeunit 419;
      ServerFileName@1000000260 : Text;
      SheetName@1000000259 : Text[250];
      DoUpdateExistingWorksheet@1000000258 : Boolean;
      Testmode@1000000257 : Boolean;
      Window@1000000256 : Dialog;
      RecNo@1000000255 : Integer;
      TotalRecNo@1000000254 : Integer;
      RowNo@1000000253 : Integer;
      ColumnNo@1000000008 : Integer;
      Text000@1000000268 : TextConst 'DEU=Daten werden analysiert ...\\;ENU=Analyzing Data...\\';
      Text001@1000000267 : TextConst 'DEU=Hersteller;ENU=Manufacturer';
      Text002@1000000266 : TextConst 'DEU=Arbeitsmappe aktualisieren;ENU=Update Workbook';
      ExcelFileExtensionTok@1000000265 : TextConst '@@@={Locked};DEU=.xlsx;ENU=.xlsx';
      NewFileDirectory@1000000264 : TextConst 'DEU=F:\Daten Neu\User\Joachim\email_versand\POS Linien lfd\NAV2016\';
      Text003@1000000263 : TextConst 'DEU=Excel Export erfolgreich abgeschlossen.';
      v_deb_listen@1000000269 : Boolean;
      v_Training_absolviert@1000000270 : Boolean;
      Text066@1000000272 : TextConst 'DEU=Schritt 1';
      Text067@1000000273 : TextConst 'DEU=Schritt 2';
      Text068@1000000274 : TextConst 'DEU=Schritt 3 Adr_Emailversand_SuS_Neu';
      Text069@1000000275 : TextConst 'DEU=Schritt 4  END ELSE BEGIN';
      v_Test_Marge@1000000277 : Boolean;
      v_EK_Gesamt@1000000278 : Decimal;
      v_VK_Gesamt@1000000279 : Decimal;
      v_Marge_Gesamt@1000000280 : Decimal;
      "v_Marge_Gesamt_%"@1000000281 : Decimal;
      v_unsub_abgleich@1000000282 : Boolean;

    PROCEDURE "Ansprech suchen"@1140004();
    BEGIN
    END;

    PROCEDURE "firma verlassen"@1140000();
    BEGIN
      MESSAGE('Firma verlassen');

      CREATE (Excel,FALSE,TRUE);                                             //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Excel.Visible(TRUE);
      Sheet.Range('A1').Value := 'Kontakt-Nr.';
      Sheet.Range('B1').Value := 'Name/Vorname';
      Sheet.Range('C1').Value := 'Firma';
      Sheet.Range('D1').Value := 'Funktion';
      Sheet.Range('E1').Value := '';
      Sheet.Range('F1').Value := '';
      Sheet.Range('G1').Value := '';
      Sheet.Range('H1').Value := 'Firma Kt-Nr.';
      Sheet.Range('I1').Value := 'Anrede';
      Sheet.Range('J1').Value := 'Vorname';
      Sheet.Range('K1').Value := 'Nachname';
      Sheet.Range('L1').Value := 'Abteilung';
      Sheet.Range('M1').Value := 'Email';
      Sheet.Range('N1').Value := 'Telefon';
      Sheet.Range('O1').Value := 'Land';
      Sheet.Range('P1').Value := 'PLZ';
      Sheet.Range('Q1').Value := 'Ort';
      Sheet.Range('R1').Value := 'Verk„ufer';
      Sheet.Range('S1').Value := 'Bearbeiter';
      Sheet.Range('T1').Value := 'Gebiet';
      Sheet.Range('U1').Value := 'Team';
      Sheet.Range('V1').Value := 'UN verlassen';
      Sheet.Range('W1').Value := 'am';
      Sheet.Range('X1').Value := 'Gesperrt';
      Sheet.Range('Y1').Value := '';

      j := '2';


      kontakt.RESET;
      kontakt.SETFILTER(kontakt."Unternehmen verlassen",'%1',TRUE);
      kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Person);
      IF kontakt.FIND('-') THEN BEGIN
        REPEAT
          Sheet.Range('A'+j).Value :=kontakt."No.";
          Sheet.Range('B'+j).Value :=kontakt.Name;
          Sheet.Range('C'+j).Value :=kontakt."Company Name";
          Sheet.Range('D'+j).Value :=kontakt."Organizational Level Code";

          Sheet.Range('H'+j).Value :=kontakt."Company No.";
          IF kontakt."Salutation Code" = 'HERR' THEN Sheet.Range('I'+j).Value :='Herr';
          IF kontakt."Salutation Code" = 'FRAU' THEN Sheet.Range('I'+j).Value :='Frau';
          Sheet.Range('J'+j).Value :=kontakt."First Name";
          Sheet.Range('K'+j).Value :=kontakt.Surname;
          Sheet.Range('L'+j).Value :=kontakt.Abteilung;
          Sheet.Range('M'+j).Value :=kontakt."E-Mail";
          Sheet.Range('N'+j).Value :=kontakt."Phone No.";
          Sheet.Range('O'+j).Value :=kontakt."Country/Region Code";
          Sheet.Range('P'+j).Value :=kontakt."Post Code";
          Sheet.Range('P'+j).NumberFormat := '00000';
          Sheet.Range('Q'+j).Value :=kontakt.City;
          Sheet.Range('R'+j).Value :=kontakt."Salesperson Code";
          Sheet.Range('S'+j).Value :=kontakt."Betreuer Innendienst";
          Sheet.Range('T'+j).Value :=kontakt."Territory Code";
          Sheet.Range('U'+j).Value :=kontakt.Teams;
          Sheet.Range('V'+j).Value :=kontakt."Unternehmen verlassen";
          Sheet.Range('W'+j).Value :=kontakt."UN verlassen am";
          Sheet.Range('X'+j).Value :=kontakt.Gesperrt;
          j:=INCSTR(j);
        UNTIL kontakt.NEXT=0;
      END;
    END;

    PROCEDURE "Bericht Adresse1"@1140005();
    BEGIN
      //  Žnderungen in beiden END ELSE Bereichen vornehmen

      IF v_z„hler=1 THEN BEGIN
        CREATE (Excel,FALSE,TRUE);                                            //erzeugt excel
        Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
        Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
        Excel.Visible(TRUE);
        Sheet.Range('A1').Value := 'Kontakt-Nr.';
        Sheet.Range('B1').Value := 'Name/Vorname';
        Sheet.Range('C1').Value := 'Firma';
        Sheet.Range('D1').Value := 'Funktion';
        Sheet.Range('E1').Value := 'Branche';
        Sheet.Range('F1').Value := 'Innovator';
        Sheet.Range('G1').Value := 'AU-Entw.';
        Sheet.Range('H1').Value := 'Firma Kt-Nr.';
        Sheet.Range('I1').Value := 'Anrede';
        Sheet.Range('J1').Value := 'Vorname';
        Sheet.Range('K1').Value := 'Nachname';
        Sheet.Range('L1').Value := 'Abteilung';
        Sheet.Range('M1').Value := 'Email';
        Sheet.Range('N1').Value := 'Telefon';
        Sheet.Range('O1').Value := 'Land';
        Sheet.Range('P1').Value := 'PLZ';
        Sheet.Range('Q1').Value := 'Ort';
        Sheet.Range('R1').Value := 'Verk„ufer';
        Sheet.Range('S1').Value := 'Bearbeiter';
        Sheet.Range('T1').Value := 'Gebiet';
        Sheet.Range('U1').Value := 'Team';
        Sheet.Range('V1').Value := 'Adr.-Herkunft';
        Sheet.Range('W1').Value := 'Angebote';
        Sheet.Range('X1').Value := 'Auftr„ge';
        Sheet.Range('Y1').Value := 'Rechnungen';
        Sheet.Range('AA1').Value := 'Verteiler1';
        Sheet.Range('AB1').Value := 'Verteiler2';
        Sheet.Range('AC1').Value := 'Verteiler3';
        Sheet.Range('AD1').Value := 'Verteiler4';
        Sheet.Range('AE1').Value := 'Verteiler5';
        Sheet.Range('AF1').Value := 'Verteiler6';
        j := '2';
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('A'+j).Value :=kontakt."No.";
          Sheet.Range('B'+j).Value :=kontakt.Name;
          Sheet.Range('C'+j).Value :=kontakt."Company Name";
          Sheet.Range('D'+j).Value :=kontakt."Organizational Level Code";
          Sheet.Range('E'+j).Value :=branche."Industry Group Code";
          // zweite Branchen-Tabelle  auf Innovators filtern
          branche1.RESET;
          branche1.SETFILTER(branche1."Contact No.",'%1',kontakt."Company No.");
          branche1.SETFILTER(branche1."Industry Group Code",'%1|%2|%3|%4|%5','1-INNOVATO','2-EARL ADO','3-EARL MAJ','4-LATE MAJ','5-LAGGARDS');
          IF branche1.FINDFIRST THEN BEGIN
            Sheet.Range('F'+j).Value :=branche1."Industry Group Code";
          END;
          branche1.RESET;
          branche1.SETFILTER(branche1."Contact No.",'%1',kontakt."Company No.");
          branche1.SETFILTER(branche1."Industry Group Code",'%1','AUFTR-ENTW');
          IF branche1.FINDFIRST THEN BEGIN
            Sheet.Range('G'+j).Value :=branche1."Industry Group Code";
          END;
          Sheet.Range('H'+j).Value :=kontakt."Company No.";
          IF kontakt."Salutation Code" = 'HERR' THEN Sheet.Range('I'+j).Value :='Herr';
          IF kontakt."Salutation Code" = 'FRAU' THEN Sheet.Range('I'+j).Value :='Frau';
          Sheet.Range('J'+j).Value :=kontakt."First Name";
          Sheet.Range('K'+j).Value :=kontakt.Surname;
          Sheet.Range('L'+j).Value :=kontakt.Abteilung;
          Sheet.Range('M'+j).Value :=kontakt."E-Mail";
          Sheet.Range('N'+j).Value :=kontakt."Phone No.";
          Sheet.Range('O'+j).Value :=kontakt."Country/Region Code";
          Sheet.Range('P'+j).Value :=kontakt."Post Code";
          Sheet.Range('P'+j).NumberFormat := '00000';

          verteiler.RESET;
          verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
          IF verteiler.FINDFIRST THEN BEGIN
            Sheet.Range('AA'+j).Value :=verteiler."Mailing Group Code";
            v_verteiler1:=verteiler."Mailing Group Code";
          END;

          verteiler.RESET;
          verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
          verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1',v_verteiler1);
          IF verteiler.FINDFIRST THEN BEGIN
            Sheet.Range('AB'+j).Value :=verteiler."Mailing Group Code";
            v_verteiler2:=verteiler."Mailing Group Code"
          END;

          verteiler.RESET;
          verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
          verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2',v_verteiler1,v_verteiler2);
          IF verteiler.FINDFIRST THEN BEGIN
            Sheet.Range('AC'+j).Value :=verteiler."Mailing Group Code";
            v_verteiler3:=verteiler."Mailing Group Code"
          END;

          verteiler.RESET;
          verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
          verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3',v_verteiler1,v_verteiler2,v_verteiler3);
          IF verteiler.FINDFIRST THEN BEGIN
            Sheet.Range('AD'+j).Value :=verteiler."Mailing Group Code";
            v_verteiler4:=verteiler."Mailing Group Code"
          END;

          verteiler.RESET;
          verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
          verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4);
          IF verteiler.FINDFIRST THEN BEGIN
            Sheet.Range('AE'+j).Value :=verteiler."Mailing Group Code";
            v_verteiler5:=verteiler."Mailing Group Code"
          END;

          verteiler.RESET;
          verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
          verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4,v_verteiler5);
          IF verteiler.FINDFIRST THEN BEGIN
            Sheet.Range('AF'+j).Value :=verteiler."Mailing Group Code";
            v_verteiler6:=verteiler."Mailing Group Code"
          END;
          Sheet.Range('Q'+j).Value :=kontakt.City;
          Sheet.Range('R'+j).Value :=kontakt."Salesperson Code";
          Sheet.Range('S'+j).Value :=kontakt."Betreuer Innendienst";
          Sheet.Range('T'+j).Value :=kontakt."Territory Code";
          Sheet.Range('U'+j).Value :=kontakt.Teams;
          Sheet.Range('V'+j).Value :='Funktion/Klass';
          j:=INCSTR(j);
        END;
      END ELSE BEGIN
        //   branche.RESET;
        //   branche.SETFILTER(branche."Industry Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5','1-INNOVATO','2-EARL ADO','3-EARL MAJ','4-LATE MAJ','5-LAGGARDS');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('A'+j).Value :=kontakt."No.";
          Sheet.Range('B'+j).Value :=kontakt.Name;
          Sheet.Range('C'+j).Value :=kontakt."Company Name";
          Sheet.Range('D'+j).Value :=kontakt."Organizational Level Code";
          Sheet.Range('E'+j).Value :=branche."Industry Group Code";
          // zweite Branchen-Tabelle  auf Innovators filtern
          branche1.RESET;
          branche1.SETFILTER(branche1."Contact No.",'%1',kontakt."Company No.");
          branche1.SETFILTER(branche1."Industry Group Code",'%1|%2|%3|%4|%5','1-INNOVATO','2-EARL ADO','3-EARL MAJ','4-LATE MAJ','5-LAGGARDS');
          IF branche1.FINDFIRST THEN BEGIN
            Sheet.Range('F'+j).Value :=branche1."Industry Group Code";
          END;
          branche1.RESET;
          branche1.SETFILTER(branche1."Contact No.",'%1',kontakt."Company No.");
          branche1.SETFILTER(branche1."Industry Group Code",'%1','AUFTR-ENTW');
          IF branche1.FINDFIRST THEN BEGIN
            Sheet.Range('G'+j).Value :=branche1."Industry Group Code";
          END;
          Sheet.Range('H'+j).Value :=kontakt."Company No.";
          IF kontakt."Salutation Code" = 'HERR' THEN Sheet.Range('I'+j).Value :='Herr';
          IF kontakt."Salutation Code" = 'FRAU' THEN Sheet.Range('I'+j).Value :='Frau';
          Sheet.Range('J'+j).Value :=kontakt."First Name";
          Sheet.Range('K'+j).Value :=kontakt.Surname;
          Sheet.Range('L'+j).Value :=kontakt.Abteilung;
          Sheet.Range('M'+j).Value :=kontakt."E-Mail";
          Sheet.Range('N'+j).Value :=kontakt."Phone No.";
          Sheet.Range('O'+j).Value :=kontakt."Country/Region Code";
          Sheet.Range('P'+j).Value :=kontakt."Post Code";
          Sheet.Range('P'+j).NumberFormat := '00000';
          verteiler.RESET;
          verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
          IF verteiler.FINDFIRST THEN BEGIN
            Sheet.Range('AA'+j).Value :=verteiler."Mailing Group Code";
            v_verteiler1:=verteiler."Mailing Group Code";
          END;

          verteiler.RESET;
          verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
          verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1',v_verteiler1);
          IF verteiler.FINDFIRST THEN BEGIN
            Sheet.Range('AB'+j).Value :=verteiler."Mailing Group Code";
            v_verteiler2:=verteiler."Mailing Group Code"
          END;

          verteiler.RESET;
          verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
          verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2',v_verteiler1,v_verteiler2);
          IF verteiler.FINDFIRST THEN BEGIN
            Sheet.Range('AC'+j).Value :=verteiler."Mailing Group Code";
            v_verteiler3:=verteiler."Mailing Group Code"
          END;

          verteiler.RESET;
          verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
          verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3',v_verteiler1,v_verteiler2,v_verteiler3);
          IF verteiler.FINDFIRST THEN BEGIN
            Sheet.Range('AD'+j).Value :=verteiler."Mailing Group Code";
            v_verteiler4:=verteiler."Mailing Group Code"
          END;

          verteiler.RESET;
          verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
          verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4);
          IF verteiler.FINDFIRST THEN BEGIN
            Sheet.Range('AE'+j).Value :=verteiler."Mailing Group Code";
            v_verteiler5:=verteiler."Mailing Group Code"
          END;

          verteiler.RESET;
          verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
          verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4,v_verteiler5);
          IF verteiler.FINDFIRST THEN BEGIN
            Sheet.Range('AF'+j).Value :=verteiler."Mailing Group Code";
            v_verteiler6:=verteiler."Mailing Group Code"
          END;
          Sheet.Range('Q'+j).Value :=kontakt.City;
          Sheet.Range('R'+j).Value :=kontakt."Salesperson Code";
          Sheet.Range('S'+j).Value :=kontakt."Betreuer Innendienst";
          Sheet.Range('T'+j).Value :=kontakt."Territory Code";
          Sheet.Range('U'+j).Value :=kontakt.Teams;
          Sheet.Range('V'+j).Value :='Funktion/Klass';
          j:=INCSTR(j);
        END;
      END;
    END;

    PROCEDURE "Bericht Adresse2"@1140003();
    BEGIN
      //  Žnderungen in beiden END ELSE Bereichen vornehmen
      IF v_z„hler=1 THEN BEGIN
        CREATE (Excel,FALSE,TRUE);                                            //erzeugt excel
        Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
        Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
        Excel.Visible(TRUE);
        Sheet.Range('A1').Value := 'Kontakt-Nr.';
        Sheet.Range('B1').Value := 'Name/Vorname';
        Sheet.Range('C1').Value := 'Firma';
        Sheet.Range('D1').Value := 'Funktion';
        Sheet.Range('E1').Value := 'Branche';
        Sheet.Range('F1').Value := 'Innovator';
        Sheet.Range('G1').Value := 'AU-Entw.';
        Sheet.Range('H1').Value := 'Firma Kt-Nr.';
        Sheet.Range('I1').Value := 'Anrede';
        Sheet.Range('J1').Value := 'Vorname';
        Sheet.Range('K1').Value := 'Nachname';
        Sheet.Range('L1').Value := 'Abteilung';
        Sheet.Range('M1').Value := 'Email';
        Sheet.Range('N1').Value := 'Telefon';
        Sheet.Range('O1').Value := 'Land';
        Sheet.Range('P1').Value := 'PLZ';
        Sheet.Range('Q1').Value := 'Ort';
        Sheet.Range('R1').Value := 'Verk„ufer';
        Sheet.Range('S1').Value := 'Bearbeiter';
        Sheet.Range('T1').Value := 'Gebiet';
        Sheet.Range('U1').Value := 'Team';
        Sheet.Range('V1').Value := 'Adr.-Herkunft';
        Sheet.Range('W1').Value := 'Angebote';
        Sheet.Range('X1').Value := 'Auftr„ge';
        Sheet.Range('Y1').Value := 'Rechnungen';
        Sheet.Range('AA1').Value := 'Verteiler1';
        Sheet.Range('AB1').Value := 'Verteiler2';
        Sheet.Range('AC1').Value := 'Verteiler3';
        Sheet.Range('AD1').Value := 'Verteiler4';
        Sheet.Range('AE1').Value := 'Verteiler5';
        Sheet.Range('AF1').Value := 'Verteiler6';

        j := '2';
        IF kontakt.FIND('-') THEN BEGIN
          v_verteiler1:='';
          v_verteiler2:='';
          v_verteiler3:='';
          v_verteiler4:='';
          v_verteiler5:='';
          v_verteiler6:='';
          REPEAT
            Sheet.Range('A'+j).Value :=kontakt."No.";
            Sheet.Range('B'+j).Value :=kontakt.Name;
            Sheet.Range('C'+j).Value :=kontakt."Company Name";
            Sheet.Range('D'+j).Value :=kontakt."Organizational Level Code";

            branche.RESET;
            branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
            branche.SETFILTER(branche."Industry Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5','1-INNOVATO','2-EARL ADO','3-EARL MAJ','4-LATE MAJ','5-LAGGARDS');
            IF branche.FINDFIRST THEN BEGIN
              Sheet.Range('E'+j).Value :=branche."Industry Group Code";
            END;
            // zweite Branchen-Tabelle  auf Innovators filtern
            branche1.RESET;
            branche1.SETFILTER(branche1."Contact No.",'%1',kontakt."Company No.");
            branche1.SETFILTER(branche1."Industry Group Code",'%1|%2|%3|%4|%5','1-INNOVATO','2-EARL ADO','3-EARL MAJ','4-LATE MAJ','5-LAGGARDS');
            IF branche1.FINDFIRST THEN BEGIN
              Sheet.Range('F'+j).Value :=branche1."Industry Group Code";
            END;
            branche1.RESET;
            branche1.SETFILTER(branche1."Contact No.",'%1',kontakt."Company No.");
            branche1.SETFILTER(branche1."Industry Group Code",'%1','AUFTR-ENTW');
            IF branche1.FINDFIRST THEN BEGIN
              Sheet.Range('G'+j).Value :=branche1."Industry Group Code";
            END;
            Sheet.Range('H'+j).Value :=kontakt."Company No.";
            IF kontakt."Salutation Code" = 'HERR' THEN Sheet.Range('I'+j).Value :='Herr';
            IF kontakt."Salutation Code" = 'FRAU' THEN Sheet.Range('I'+j).Value :='Frau';
            Sheet.Range('J'+j).Value :=kontakt."First Name";
            Sheet.Range('K'+j).Value :=kontakt.Surname;
            Sheet.Range('L'+j).Value :=kontakt.Abteilung;
            Sheet.Range('M'+j).Value :=kontakt."E-Mail";
            Sheet.Range('N'+j).Value :=kontakt."Phone No.";
            Sheet.Range('O'+j).Value :=kontakt."Country/Region Code";
            Sheet.Range('P'+j).Value :=kontakt."Post Code";
            Sheet.Range('P'+j).NumberFormat := '00000';
            Sheet.Range('Q'+j).Value :=kontakt.City;
            Sheet.Range('R'+j).Value :=kontakt."Salesperson Code";
            Sheet.Range('S'+j).Value :=kontakt."Betreuer Innendienst";
            Sheet.Range('T'+j).Value :=kontakt."Territory Code";
            Sheet.Range('U'+j).Value :=kontakt.Teams;
            Sheet.Range('V'+j).Value :=v_art+v_hersteller1+v_hersteller2+v_hersteller3+v_hersteller4+v_hersteller5;
            Sheet.Range('W'+j).Value :=v_an;
            Sheet.Range('X'+j).Value :=v_au;
            Sheet.Range('Y'+j).Value :=v_re;
            Sheet.Range('Z'+j).Value :=v_gu;

            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            IF verteiler.FINDFIRST THEN BEGIN
              Sheet.Range('AA'+j).Value :=verteiler."Mailing Group Code";
              v_verteiler1:=verteiler."Mailing Group Code";
            END;

            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1',v_verteiler1);
            IF verteiler.FINDFIRST THEN BEGIN
              Sheet.Range('AB'+j).Value :=verteiler."Mailing Group Code";
              v_verteiler2:=verteiler."Mailing Group Code"
            END;


            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2',v_verteiler1,v_verteiler2);
            IF verteiler.FINDFIRST THEN BEGIN
              Sheet.Range('AC'+j).Value :=verteiler."Mailing Group Code";
              v_verteiler3:=verteiler."Mailing Group Code"
            END;

            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3',v_verteiler1,v_verteiler2,v_verteiler3);
            IF verteiler.FINDFIRST THEN BEGIN
              Sheet.Range('AD'+j).Value :=verteiler."Mailing Group Code";
              v_verteiler4:=verteiler."Mailing Group Code"
            END;

            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4);
            IF verteiler.FINDFIRST THEN BEGIN
              Sheet.Range('AE'+j).Value :=verteiler."Mailing Group Code";
              v_verteiler5:=verteiler."Mailing Group Code"
            END;

            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4,v_verteiler5);
            IF verteiler.FINDFIRST THEN BEGIN
              Sheet.Range('AF'+j).Value :=verteiler."Mailing Group Code";
              v_verteiler6:=verteiler."Mailing Group Code"
            END;
            j:=INCSTR(j);

          UNTIL kontakt.NEXT=0;
        END;
      END ELSE BEGIN
        IF kontakt.FIND('-') THEN BEGIN
          v_verteiler1:='';
          v_verteiler2:='';
          v_verteiler3:='';
          v_verteiler4:='';
          v_verteiler5:='';
          v_verteiler6:='';

          REPEAT
            Sheet.Range('A'+j).Value :=kontakt."No.";
            Sheet.Range('B'+j).Value :=kontakt.Name;
            Sheet.Range('C'+j).Value :=kontakt."Company Name";
            Sheet.Range('D'+j).Value :=kontakt."Organizational Level Code";

            branche.RESET;
            branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
            branche.SETFILTER(branche."Industry Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5','1-INNOVATO','2-EARL ADO','3-EARL MAJ','4-LATE MAJ','5-LAGGARDS');
            IF branche.FINDFIRST THEN BEGIN
              Sheet.Range('E'+j).Value :=branche."Industry Group Code";
            END;
            // zweite Branchen-Tabelle  auf Innovators filtern
            branche1.RESET;
            branche1.SETFILTER(branche1."Contact No.",'%1',kontakt."Company No.");
            branche1.SETFILTER(branche1."Industry Group Code",'%1|%2|%3|%4|%5','1-INNOVATO','2-EARL ADO','3-EARL MAJ','4-LATE MAJ','5-LAGGARDS');
            IF branche1.FINDFIRST THEN BEGIN
              Sheet.Range('F'+j).Value :=branche1."Industry Group Code";
            END;
            branche1.RESET;
            branche1.SETFILTER(branche1."Contact No.",'%1',kontakt."Company No.");
            branche1.SETFILTER(branche1."Industry Group Code",'%1','AUFTR-ENTW');
            IF branche1.FINDFIRST THEN BEGIN
              Sheet.Range('G'+j).Value :=branche1."Industry Group Code";
            END;

            Sheet.Range('H'+j).Value :=kontakt."Company No.";
            IF kontakt."Salutation Code" = 'HERR' THEN Sheet.Range('I'+j).Value :='Herr';
            IF kontakt."Salutation Code" = 'FRAU' THEN Sheet.Range('I'+j).Value :='Frau';
            Sheet.Range('J'+j).Value :=kontakt."First Name";
            Sheet.Range('K'+j).Value :=kontakt.Surname;
            Sheet.Range('L'+j).Value :=kontakt.Abteilung;
            Sheet.Range('M'+j).Value :=kontakt."E-Mail";
            Sheet.Range('N'+j).Value :=kontakt."Phone No.";
            Sheet.Range('O'+j).Value :=kontakt."Country/Region Code";
            Sheet.Range('P'+j).Value :=kontakt."Post Code";
            Sheet.Range('P'+j).NumberFormat := '00000';
            Sheet.Range('Q'+j).Value :=kontakt.City;
            Sheet.Range('R'+j).Value :=kontakt."Salesperson Code";
            Sheet.Range('S'+j).Value :=kontakt."Betreuer Innendienst";
            Sheet.Range('T'+j).Value :=kontakt."Territory Code";
            Sheet.Range('U'+j).Value :=kontakt.Teams;
            Sheet.Range('V'+j).Value :=v_art+v_hersteller1+v_hersteller2+v_hersteller3+v_hersteller4+v_hersteller5;
            Sheet.Range('W'+j).Value :=v_an;
            Sheet.Range('X'+j).Value :=v_au;
            Sheet.Range('Y'+j).Value :=v_re;
            Sheet.Range('Z'+j).Value :=v_gu;

            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            IF verteiler.FINDFIRST THEN BEGIN
              Sheet.Range('AA'+j).Value :=verteiler."Mailing Group Code";
              v_verteiler1:=verteiler."Mailing Group Code";
            END;

            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1',v_verteiler1);
            IF verteiler.FINDFIRST THEN BEGIN
              Sheet.Range('AB'+j).Value :=verteiler."Mailing Group Code";
              v_verteiler2:=verteiler."Mailing Group Code"
            END;


            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2',v_verteiler1,v_verteiler2);
            IF verteiler.FINDFIRST THEN BEGIN
              Sheet.Range('AC'+j).Value :=verteiler."Mailing Group Code";
              v_verteiler3:=verteiler."Mailing Group Code"
            END;

            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3',v_verteiler1,v_verteiler2,v_verteiler3);
            IF verteiler.FINDFIRST THEN BEGIN
              Sheet.Range('AD'+j).Value :=verteiler."Mailing Group Code";
              v_verteiler4:=verteiler."Mailing Group Code"
            END;

            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4);
            IF verteiler.FINDFIRST THEN BEGIN
              Sheet.Range('AE'+j).Value :=verteiler."Mailing Group Code";
              v_verteiler5:=verteiler."Mailing Group Code"
            END;

            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4,v_verteiler5);
            IF verteiler.FINDFIRST THEN BEGIN
              Sheet.Range('AF'+j).Value :=verteiler."Mailing Group Code";
              v_verteiler6:=verteiler."Mailing Group Code"
            END;
            j:=INCSTR(j);
          UNTIL kontakt.NEXT=0;
        END;
      END;
    END;

    PROCEDURE "Branchen eingrenzen"@1140035();
    BEGIN
    END;

    PROCEDURE "Belege suchen"@1140008();
    BEGIN
    END;

    PROCEDURE "Branchen ACS eingrenzen"@1140001();
    BEGIN
    END;

    PROCEDURE "Memo suchen"@1140010();
    BEGIN
    END;

    PROCEDURE "alle Kontakte listen"@1140002();
    BEGIN
      kontakt.RESET;
      kontakt.SETFILTER(kontakt.Gesperrt,'%1',FALSE);

      // Einschr„kung ohne Firma verlassen
      IF v_ohne_firm_verlassen=TRUE THEN BEGIN
        kontakt.SETFILTER(kontakt."Unternehmen verlassen",'%1',FALSE);
      END;

      // Einschr„nkung  Adressen nur mit Personen suchen
      IF v_person_adr=TRUE THEN BEGIN
        kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Person);
      END;

      // Einschr„nkung  Adressen nur mit Mandant suchen
      IF v_mandant_adr=TRUE THEN BEGIN
        kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Company);
      END;

      // Einschr„nkung  Adressen nur mit Emailadresse suchen
      IF v_email_adr=TRUE THEN BEGIN
        kontakt.SETFILTER(kontakt."E-Mail",'<>%1','');
      END;

      // Einschr„nkung  Adressen L„nderkennzeichen DE
      IF v_landkz_de=TRUE THEN BEGIN
        kontakt.SETFILTER(kontakt."Country/Region Code",'%1','DE');
      END;

      // Einschr„nkung  Adressen L„nderkennzeichen DE, AT und CH
      IF v_landkz_de_at_ch=TRUE THEN BEGIN
        kontakt.SETFILTER(kontakt."Country/Region Code",'%1|%2|%3','DE','AT','CH');
      END;

      // Einschr„nkung  Nur eine Kontaktnr
      IF v_kontaktnr<>'' THEN BEGIN
        kontakt.SETFILTER(kontakt."Company No.",'%1',v_kontaktnr);
      END;


      IF kontakt.FIND('-') THEN BEGIN
        REPEAT
          Adressverwaltung;
        UNTIL kontakt.NEXT=0;
      END;
    END;

    PROCEDURE "verteiler fllen"@1140022();
    BEGIN
       IF kontakt.FIND('-') THEN BEGIN
       REPEAT
         verteiler.RESET;
         verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
         IF verteiler.FINDFIRST THEN BEGIN
           //     Sheet.Range('AB'+j).Value :=verteiler."Mailing Group Code";
           v_verteiler1:=verteiler."Mailing Group Code";
         END;
         verteiler.RESET;
         verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
         verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1',v_verteiler1);
         IF verteiler.FINDFIRST THEN BEGIN
           //     Sheet.Range('AC'+j).Value :=verteiler."Mailing Group Code";
           v_verteiler2:=verteiler."Mailing Group Code"
         END;
         verteiler.RESET;
         verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
         verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2',v_verteiler1,v_verteiler2);
         IF verteiler.FINDFIRST THEN BEGIN
           //     Sheet.Range('AD'+j).Value :=verteiler."Mailing Group Code";
           v_verteiler3:=verteiler."Mailing Group Code"
         END;
         verteiler.RESET;
         verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
         verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3',v_verteiler1,v_verteiler2,v_verteiler3);
         IF verteiler.FINDFIRST THEN BEGIN
           //     Sheet.Range('AE'+j).Value :=verteiler."Mailing Group Code";
           v_verteiler4:=verteiler."Mailing Group Code"
         END;
         verteiler.RESET;
         verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
         verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4);
         IF verteiler.FINDFIRST THEN BEGIN
           //     Sheet.Range('AF'+j).Value :=verteiler."Mailing Group Code";
           v_verteiler5:=verteiler."Mailing Group Code"
         END;
         verteiler.RESET;
         verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
         verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4,v_verteiler5);
         IF verteiler.FINDFIRST THEN BEGIN
           //     Sheet.Range('AG'+j).Value :=verteiler."Mailing Group Code";
           v_verteiler6:=verteiler."Mailing Group Code"
         END;
         //  Verteilereintrag des Mandanten abfragen
         verteiler.RESET;
         verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."Company No.");
         //   verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5',v_verteiler1,v_verteiler2,v_verteiler3
         //   ,v_verteiler4,v_verteiler5);
         IF verteiler.FINDFIRST THEN BEGIN
           //     Sheet.Range('AG'+j).Value :=verteiler."Mailing Group Code";
           v_verteiler3:=(verteiler."Mailing Group Code"+' Mandant');
         END;
        UNTIL kontakt.NEXT=0;
      END;
    END;

    PROCEDURE Kontakte_listen_steffen@1140006();
    BEGIN
    END;

    PROCEDURE Funktion@1140007();
    BEGIN

      // wenn "nur_firma_verlassen" dann Funktion "Firma verlassen"
      IF v_nur_firm_verlassen=TRUE THEN BEGIN
        "firma verlassen";
      END ELSE BEGIN
        kontakt.RESET;
        // Einschr„kung gesperrte Kontakte ***********************************************************************
        kontakt.SETFILTER(kontakt.Gesperrt,'%1',FALSE);
        // Einschr„kung ohne Firma verlassen
        IF v_ohne_firm_verlassen=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Unternehmen verlassen",'%1',FALSE);
        END;
        // Einschr„nkung  Adressen nur mit Personen suchen
        IF v_person_adr=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Person);
        END;
        // Einschr„nkung  Adressen nur mit Mandant suchen
        IF v_mandant_adr=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Company);
        END;
        // Einschr„nkung  Adressen nur mit Emailadresse suchen
        IF v_email_adr=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."E-Mail",'<>%1','');
        END;
        // Einschr„nkung  Adressen L„nderkennzeichen DE
        IF v_landkz_de=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Country/Region Code",'%1','DE');
        END;
        // Einschr„nkung  Adressen L„nderkennzeichen DE, AT und CH
        IF v_landkz_de_at_ch=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Country/Region Code",'%1|%2|%3','DE','AT','CH');
        END;

        IF ((v_reiter4=TRUE) AND (v_alle_acs=TRUE)) THEN BEGIN
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_Systeme_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END ELSE BEGIN
          IF v_reiter2=TRUE THEN BEGIN
            //  Einschr„nkung Positionscode (Funktion)
            IF v_ek=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','EINKAUF');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_ekl=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','EINKAUF-L');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_entwl=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','ENTW.-LEIT');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_entwh=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','ENTW.-HW');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_entws=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','ENTW.-SW');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_fin=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','FINANZEN');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_GL=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','GSCH.-LEIT');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_prod=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','PRODUKTION');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_qual=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','QUALITŽT');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_vertl=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','VERTRIEB-L');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_vert=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','VERTRIEB');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_supl=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SUPPORT-L');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_sup=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SUPPORT');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_tech=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','TECHNIKER');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_ml=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','MARKET-LEI');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_ma=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','MARKETING');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_so=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SONSTIGE');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_sop=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SONSTIGE-P');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_sol=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SONSTIGE-L');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_alle=TRUE THEN BEGIN
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_;
                UNTIL kontakt.NEXT=0;
              END;
            END;
          END;
        END;
      END;

      IF v_reiter3=TRUE THEN BEGIN
        //  Einschr„nkung Positionscode
        IF v_ek=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','EINKAUF');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_Systeme;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_ekl=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','EINKAUF-L');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_Systeme;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_entwl=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','ENTW.-LEIT');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_Systeme;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_entwh=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','ENTW.-HW');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_Systeme;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_entws=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','ENTW.-SW');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_Systeme;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_fin=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','FINANZEN');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_Systeme;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_GL=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','GSCH.-LEIT');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_Systeme;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_prod=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','PRODUKTION');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_Systeme;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_qual=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','QUALITŽT');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_Systeme;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_vertl=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','VERTRIEB-L');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_Systeme;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_vert=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','VERTRIEB');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_Systeme;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_supl=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SUPPORT-L');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_Systeme;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_sup=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SUPPORT');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_Systeme;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_tech=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','TECHNIKER');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_Systeme;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_ml=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','MARKET-LEI');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_Systeme;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_ma=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','MARKETING');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_Systeme;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_so=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SONSTIGE');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_Systeme;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_sop=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SONSTIGE-P');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_Systeme;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_sol=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SONSTIGE-L');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_Systeme;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_alle=TRUE THEN BEGIN
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_Systeme;
            UNTIL kontakt.NEXT=0;
          END;
        END;
      END ELSE BEGIN
      END;

      IF ((v_reiter2=FALSE) AND (v_reiter3=FALSE)) THEN ERROR('Kein H„kchen bei Reiter 2 Branchen oder 3 Branchen Systeme gesetzt.');
    END;

    PROCEDURE Branche_@1140009();
    BEGIN

      //IF v_adr_email=TRUE THEN BEGIN
      //Adressverwaltung;
      //END ELSE BEGIN
      // IF kontakt.FIND('-') THEN BEGIN
      // REPEAT
      v_anz_branche:=0;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");

      IF ((v_telecom1=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','TELECOM1');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_telecom2=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','TELECOM2');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_telecom3=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','TELECOM3');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_telecom4=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','TELECOM4');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_telecom5=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','TELECOM5');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_mm1=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','MM1');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_mm2=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','MM2');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_mm3=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','MM3');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_mm4=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','MM4');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_mm5=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','MM5');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_security1=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SECURITY1');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_security2=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SECURITY2');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_security3=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SECURITY3');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_security4=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SECURITY4');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_it1=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','IT-SYSTEM1');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_it2=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','IT-SYSTEM2');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_it3=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','IT-SYSTEM3');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_it4=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','IT-SYSTEM4');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_ww1=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','WARENWIRT1');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_ww2=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','WARENWIRT2');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_ww3=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','WARENWIRT3');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_ww4=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','WARENWIRT4');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_aufentw=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','AUFTR-ENTW');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_bestcker=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','BESTšCKER');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_h„ndler=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','HŽNDLER');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_dienstlei=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','DIENSTLEI');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_uni=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','UNI/TH/FH2');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_data1=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','DATACOM1');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_data2=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','DATACOM2');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_data3=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','DATACOM3');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_data4=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','DATACOM4');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_data5=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','DATACOM5');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_data6=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','DATACOM6');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_indu1=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','INDUSTRIE1');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_indu2=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','INDUSTRIE2');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_indu3=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','INDUSTRIE3');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_indu4=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','INDUSTRIE4');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_indu5=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','INDUSTRIE5');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_indu6=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','INDUSTRIE6');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_indu7=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','INDUSTRIE7');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_fahr1=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','FAHRZEUG1');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_fahr2=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','FAHRZEUG2');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_fahr3=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','FAHRZEUG3');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_fahr4=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','FAHRZEUG4');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_fahr5=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','FAHRZEUG5');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_con1=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','CONSUMER1');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_con2=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','CONSUMER2');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_con3=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','CONSUMER3');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_geb„ude=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','GEBŽUDE/IN');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_medizin=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','MEDIZIN');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;
      IF ((v_presse=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','PRESSE');
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;

      IF ((v_alle_bran=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        IF branche.FINDFIRST THEN BEGIN
        v_anz_branche:=1;
        Adressverwaltung;
        END;
      END;

      //UNTIL kontakt.NEXT=0;
      //END;
      //END;
    END;

    PROCEDURE Branche_Systeme@1140011();
    BEGIN

      //  IF kontakt.FIND('-') THEN BEGIN
      // REPEAT
         v_anz_branche:=0;
         branche.RESET;
         branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");

      //    verteiler.RESET;
      //    verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."Company No.");

      //   IF verteiler.FIND('-') THEN BEGIN
      //   REPEAT
      //   IF ((verteiler."Mailing Group Code"='UNSUB') OR (verteiler."Mailing Group Code"='NO EMAIL')) THEN BEGIN
      //   END ELSE BEGIN

      //   v_anz_branche:=0;
      //   branche.RESET;
      //   branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      //    branche.SETFILTER(branche."Contact No.",'%1',verteiler."Contact No.");


      IF ((v_SUS_P1=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P1');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Adressverwaltung;
        END;
      END;
      IF ((v_SUS_P2=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P2');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Adressverwaltung;
        END;
      END;
      IF ((v_SUS_P3=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P3');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Adressverwaltung;
        END;
      END;
      IF ((v_SUS_P4=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P4');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Adressverwaltung;
        END;
      END;

      IF ((v_SUS_T1=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T1');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Adressverwaltung;
        END;
      END;
      IF ((v_SUS_T2=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T2');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Adressverwaltung;
        END;
      END;
      IF ((v_SUS_T3=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T3');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Adressverwaltung;
        END;
      END;
      IF ((v_SUS_T4=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T4');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Adressverwaltung;
        END;
      END;
      IF ((v_SUS_T5=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T5');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Adressverwaltung;
        END;
      END;
      IF ((v_SUS_T6=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T6');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Adressverwaltung;
        END;
      END;
      IF ((v_SUS_T7=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T7');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Adressverwaltung;
        END;
      END;

      IF ((v_SUS_TP=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-TP');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Adressverwaltung;
        END;
      END;
      IF ((v_SUS_L1=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L1');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Adressverwaltung;
        END;
      END;
      IF ((v_SUS_L2=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L2');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Adressverwaltung;
        END;
      END;
      IF ((v_SUS_L3=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L3');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Adressverwaltung;
        END;
      END;
      IF ((v_SUS_L4=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L4');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Adressverwaltung;
        END;
      END;
      IF ((v_SUS_L5=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L5');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Adressverwaltung;
        END;
      END;
      IF ((v_SUS_ENDK=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-ENDK');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Adressverwaltung;
        END;
      END;

      IF ((v_SUS_NO_ACS=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-ACS');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Adressverwaltung;
        END;
      END;
      IF ((v_SUS_NO_FER=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-FER');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Adressverwaltung;
        END;
      END;
      IF ((v_SUS_NO_SPL=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-SPL');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Adressverwaltung;
        END;
      END;
      IF ((v_NO_MAILING=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','NO-MAILING');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Adressverwaltung;
        END;
      END;

      IF ((v_alle_acs=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1..%2','SUS-A','SUS-Z');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Adressverwaltung;
        END;
      END;

      //   END;
      //   UNTIL verteiler.NEXT=0;
      //   END;


      //UNTIL kontakt.NEXT=0;
      //END;
    END;

    PROCEDURE Belege_@1140012();
    BEGIN
      IF ((v_datum_von=0D) AND (v_hersteller1='') AND (v_hersteller2='') AND (v_hersteller3='') AND (v_hersteller4='') AND (v_hersteller5='')) THEN BEGIN
        IF CONFIRM ('Wollen Sie eine Einschr„nkung bei den Belegen vornehmen?', TRUE) THEN BEGIN
          ERROR('Abruch des Aufrufs!');
        END;
      END;

      debitor.RESET;
      debitor.SETFILTER(debitor."No.",'>%1','1');
      IF debitor.FIND('-') THEN BEGIN
        REPEAT
          v_au:='';
          v_re:='';
          v_an:='';
          v_gu:='';
          belege.RESET;
          belege.SETFILTER(belege."Debitornr.",'%1',debitor."No.");
          IF v_datum_von=0D THEN BEGIN
          END ELSE BEGIN
            belege.SETFILTER(belege.Belegdatum,'%1..%2',v_datum_von,v_datum_bis);
          END;
          IF ((v_hersteller1='') AND (v_hersteller2='') AND (v_hersteller3='') AND (v_hersteller4='') AND (v_hersteller5='')) THEN BEGIN
          END ELSE BEGIN
            belege.SETFILTER(belege.Herstellercode,'%1|%2|%3|%4|%5',v_hersteller1,v_hersteller2,v_hersteller3,v_hersteller4,v_hersteller5);
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
          IF belege.FINDFIRST THEN BEGIN
            v_an:='AN';
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
          IF belege.FINDFIRST THEN BEGIN
            v_au:='AU';
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
          IF belege.FINDFIRST THEN BEGIN
            v_re:='RE';
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
          IF belege.FINDFIRST THEN BEGIN
            v_gu:='GU';
          END;

          IF ((v_an='AN') OR (v_au='AU') OR (v_re='RE') OR (v_gu='GU')) THEN BEGIN
            kon_deb.RESET;
            kon_deb.SETFILTER(kon_deb."No.",'%1',belege."Debitornr.");
            kon_deb.SETFILTER(kon_deb."Business Relation Code",'%1','DEB');
            IF kon_deb.FINDFIRST THEN BEGIN
              v_art:='Belege ';
              kontakt.RESET;
              kontakt.SETFILTER(kontakt."Company No.",'%1',kon_deb."Contact No.");
              kontakt.SETFILTER(kontakt.Gesperrt,'%1',FALSE);

              // Einschr„kung nur wenn Firma verlassen
              IF v_nur_firm_verlassen=TRUE THEN BEGIN
                kontakt.SETFILTER(kontakt."Unternehmen verlassen",'%1',TRUE);
              END;

              // Einschr„kung ohne Firma verlassen
              IF v_ohne_firm_verlassen=TRUE THEN BEGIN
                kontakt.SETFILTER(kontakt."Unternehmen verlassen",'%1',FALSE);
              END;

              // Einschr„nkung  Adressen nur mit Personen suchen
              IF v_person_adr=TRUE THEN BEGIN
                kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Person);
              END;

              // Einschr„nkung  Adressen nur mit Mandant suchen
              IF v_mandant_adr=TRUE THEN BEGIN
                kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Company);
              END;
              // Einschr„nkung  Adressen nur mit Emailadresse suchen
              IF v_email_adr=TRUE THEN BEGIN
                kontakt.SETFILTER(kontakt."E-Mail",'<>%1','');
              END;

              // Einschr„nkung  Adressen L„nderkennzeichen DE
              IF v_landkz_de=TRUE THEN BEGIN
                kontakt.SETFILTER(kontakt."Country/Region Code",'%1','DE');
              END;

              // Einschr„nkung  Adressen L„nderkennzeichen DE, AT und CH
              IF v_landkz_de_at_ch=TRUE THEN BEGIN
                kontakt.SETFILTER(kontakt."Country/Region Code",'%1|%2|%3','DE','AT','CH');
              END;

              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Adressverwaltung;
                UNTIL kontakt.NEXT=0;
              END;
            END;
          END;
      //     END;
        UNTIL debitor.NEXT=0;
      END;
    END;

    PROCEDURE Memos_@1140013();
    BEGIN
        // alle Ansprechpartner eines Kontaktes bei pos. Memo anzeigen
      kontakt1.RESET;
      kontakt1.SETFILTER(kontakt1.Type,'%1',kontakt1.Type::Company);
      kontakt1.SETFILTER(kontakt1.Gesperrt,'%1',FALSE);
      IF kontakt1.FIND('-') THEN BEGIN
        REPEAT
          memok.RESET;
          memok.SETFILTER(memok."Mandantennr.",'%1',kontakt1."No.");
          IF v_datum_von=0D THEN BEGIN
          END ELSE BEGIN
            memok.SETFILTER(memok.Anlagedatum,'%1..%2',v_datum_von,v_datum_bis);
          END;
          IF memok.FIND('-') THEN BEGIN
            v_memo_datum:=0D;
            v_memo_kurztext:='';
            REPEAT
              linie.RESET;
              linie.SETFILTER(linie."Memonr.",'%1',memok."Memonr.");
              IF ((v_hersteller1='') AND (v_hersteller2='') AND (v_hersteller3='') AND (v_hersteller4='') AND (v_hersteller5='')) THEN BEGIN
      //       IF v_hersteller='' THEN BEGIN
              END ELSE BEGIN
                linie.SETFILTER(linie.Linienkrzel,'%1|%2|%3|%4|%5',v_hersteller1,v_hersteller2,v_hersteller3,v_hersteller4,v_hersteller5);
      //      linie.SETFILTER(linie.Linienkrzel,'%1',v_hersteller);
              END;
              IF linie.FINDFIRST THEN BEGIN
                kontakt.RESET;
                kontakt.SETFILTER(kontakt."Company No.",'%1',memok."Mandantennr.");
                IF kontakt.FINDFIRST THEN BEGIN
                  v_art:='Memos ';

                 // Einschr„kung nur wenn Firma verlassen
                  IF v_nur_firm_verlassen=TRUE THEN BEGIN
                    kontakt.SETFILTER(kontakt."Unternehmen verlassen",'%1',TRUE);
                  END;

                 // Einschr„kung ohne Firma verlassen
                  IF v_ohne_firm_verlassen=TRUE THEN BEGIN
                    kontakt.SETFILTER(kontakt."Unternehmen verlassen",'%1',FALSE);
                  END;
                 // Einschr„nkung  Adressen nur mit Personen suchen
                  IF v_person_adr=TRUE THEN BEGIN
                    kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Person);
                  END;
                 // Einschr„nkung  Adressen nur mit Mandant suchen
                  IF v_mandant_adr=TRUE THEN BEGIN
                    kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Company);
                  END;
                 // Einschr„nkung  Adressen nur mit Emailadresse suchen
                  IF v_email_adr=TRUE THEN BEGIN
                    kontakt.SETFILTER(kontakt."E-Mail",'<>%1','');
                  END;
                 // Einschr„nkung  Adressen L„nderkennzeichen DE
                  IF v_landkz_de=TRUE THEN BEGIN
                    kontakt.SETFILTER(kontakt."Country/Region Code",'%1','DE');
                  END;
                 // Einschr„nkung  Adressen L„nderkennzeichen DE, AT und CH
                  IF v_landkz_de_at_ch=TRUE THEN BEGIN
                    kontakt.SETFILTER(kontakt."Country/Region Code",'%1|%2|%3','DE','AT','CH');
                  END;

                  IF kontakt.FIND('-') THEN BEGIN
                    REPEAT
                      v_memo_datum:=memok.Memodatum;
                      v_memo_kurztext:=memok.Memokurztext;
                      Adressverwaltung;
                    UNTIL kontakt.NEXT=0;
                  END;
                END;
              END;
            UNTIL memok.NEXT=0;
          END;
        UNTIL kontakt1.NEXT=0;
      END;
    END;

    PROCEDURE alle_Kontakte@1140014();
    BEGIN
    END;

    PROCEDURE Adressverwaltung@1140015();
    BEGIN
      {
        v_z„hler:=v_z„hler+1;
        IF v_adr_email=TRUE THEN Adr_Emailversand;
        IF v_bericht_adr1=TRUE THEN "Bericht Adresse1";
        IF v_bericht_adr2=TRUE THEN "Bericht Adresse2";
        IF v_adr_sus=TRUE THEN Adr_Emailversand_SUS;
        IF v_adr_email1=TRUE THEN Adr_Emailversand1;
        IF v_adr_sus_un=TRUE THEN Adr_SUS_ohne_UNSUB;
      }
      MESSAGE(Text066);
      CreateExcel;
      RowNo := 1;
      EnterCell(RowNo,1,'USER1','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);

      CloseExcel('Liste Ansprech gesperrt Mandant nicht','Liste Ansprech gesperrt Mandant nicht','F:\Daten Neu\User\Uwe\Mailing');
      MESSAGE(Text003);
    END;

    PROCEDURE Adr_Emailversand@1140016();
    BEGIN

      IF v_z„hler=1 THEN BEGIN
        CREATE (Excel,FALSE,TRUE);                                             //erzeugt excel
        Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
        Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
        Excel.Visible(TRUE);


      {
      Sheet.Range('A1').Value := 'USER1';
      Sheet.Range('B1').Value := 'Vorname';
      Sheet.Range('C1').Value := 'Name';
      Sheet.Range('D1').Value := 'Firma';
      Sheet.Range('E1').Value := 'Funktion';
      Sheet.Range('F1').Value := 'Email';
      Sheet.Range('G1').Value := 'Anrede';
      Sheet.Range('H1').Value := 'USER2';
      Sheet.Range('I1').Value := 'Nation';
      Sheet.Range('J1').Value := 'PLZ';
      Sheet.Range('K1').Value := 'Ort';
      Sheet.Range('L1').Value := 'Abteilung';
      Sheet.Range('M1').Value := 'Verk„ufer';
      Sheet.Range('N1').Value := 'Betreuer';
      Sheet.Range('O1').Value := 'Gebiet';
      Sheet.Range('P1').Value := 'Branche';
      Sheet.Range('Q1').Value := 'Telefon';




      Sheet.Range('R1').Value := 'AC Solutionpartner';
      Sheet.Range('S1').Value := 'Innovator';
      Sheet.Range('T1').Value := 'Auftragsentwickl.';
      Sheet.Range('U1').Value := 'Branche1';
      Sheet.Range('V1').Value := 'Branche2';
      Sheet.Range('W1').Value := 'Branche3';
      Sheet.Range('X1').Value := 'Branche4';
      Sheet.Range('Y1').Value := 'Branche5';
      Sheet.Range('Z1').Value := 'Branche6';
      Sheet.Range('AA1').Value := 'Branche7';
      Sheet.Range('AB1').Value := 'Branche8';
      Sheet.Range('AC1').Value := 'Branche9';
      Sheet.Range('AD1').Value := 'Branche10';
      Sheet.Range('AE1').Value := 'Branche11';
      Sheet.Range('AF1').Value := 'Branche12';
      Sheet.Range('AG1').Value := 'Branche13';
      Sheet.Range('AH1').Value := 'Branche14';
      Sheet.Range('AI1').Value := 'Branche15';
      Sheet.Range('AJ1').Value := 'Verteiler1';
      Sheet.Range('AK1').Value := 'Verteiler2';
      Sheet.Range('AL1').Value := 'Verteiler3';
      Sheet.Range('AM1').Value := 'Verteiler4';
      Sheet.Range('AN1').Value := 'Verteiler5';
      Sheet.Range('AO1').Value := 'Verteiler6';
      Sheet.Range('AP1').Value := 'Adr.-Herkunft';
      Sheet.Range('AQ1').Value := 'Angebote';
      Sheet.Range('AR1').Value := 'Auftr„ge';
      Sheet.Range('AS1').Value := 'Rechnungen';
      Sheet.Range('AT1').Value := 'Gutschriften';
      Sheet.Range('AU1').Value := 'Gesperrt';
      Sheet.Range('AV1').Value := 'Firma verlassen';
      }
        Sheet.Range('A1').Value := 'USER1';
        Sheet.Range('B1').Value := 'Art';
        Sheet.Range('C1').Value := 'Firma';
        Sheet.Range('D1').Value := 'Firma2';
        Sheet.Range('E1').Value := 'Anrede';
        Sheet.Range('F1').Value := 'Titel';
        Sheet.Range('G1').Value := 'Vorname';
        Sheet.Range('H1').Value := 'Name';
        Sheet.Range('I1').Value := 'Abteilung';
        Sheet.Range('J1').Value := 'Straáe';
        Sheet.Range('K1').Value := 'Straáe';
        Sheet.Range('L1').Value := 'Nation';
        Sheet.Range('M1').Value := 'PLZ';
        Sheet.Range('N1').Value := 'Ort';
        Sheet.Range('O1').Value := 'Verk„ufer';
        Sheet.Range('P1').Value := 'Betreuer';
        Sheet.Range('Q1').Value := 'Gebiet';
        Sheet.Range('R1').Value := 'Branche';
        Sheet.Range('S1').Value := 'Funktion';
        Sheet.Range('T1').Value := 'Email';
        Sheet.Range('U1').Value := 'Telefon';
        Sheet.Range('V1').Value := 'USER2';
        Sheet.Range('W1').Value := 'Mandant Gesperrt';
        Sheet.Range('X1').Value := 'Person Gesperrt';
        Sheet.Range('Y1').Value := 'Firma verlassen';
        Sheet.Range('Z1').Value := 'Bemerkung';
        Sheet.Range('AA1').Value := 'AC Solutionpartner';
        Sheet.Range('AB1').Value := 'Innovator';
        Sheet.Range('AC1').Value := 'Auftragsentwickl.';
        Sheet.Range('AD1').Value := 'Branche1';
        Sheet.Range('AE1').Value := 'Branche2';
        Sheet.Range('AF1').Value := 'Branche3';
        Sheet.Range('AG1').Value := 'Branche4';
        Sheet.Range('AH1').Value := 'Branche5';
        Sheet.Range('AI1').Value := 'Branche6';
        Sheet.Range('AJ1').Value := 'Branche7';
        Sheet.Range('AK1').Value := 'Branche8';
        Sheet.Range('AL1').Value := 'Branche9';
        Sheet.Range('AM1').Value := 'Branche10';
        Sheet.Range('AN1').Value := 'Branche11';
        Sheet.Range('AO1').Value := 'Branche12';
        Sheet.Range('AP1').Value := 'Branche13';
        Sheet.Range('AQ1').Value := 'Branche14';
        Sheet.Range('AR1').Value := 'Branche15';
        Sheet.Range('AS1').Value := 'Verteiler1';
        Sheet.Range('AT1').Value := 'Verteiler2';
        Sheet.Range('AU1').Value := 'Verteiler3';
        Sheet.Range('AV1').Value := 'Verteiler4';
        Sheet.Range('AW1').Value := 'Verteiler5';
        Sheet.Range('AX1').Value := 'Verteiler6';
        Sheet.Range('AY1').Value := 'Adr.-Herkunft';
        Sheet.Range('AZ1').Value := 'Angebote';
        Sheet.Range('BA1').Value := 'Auftr„ge';
        Sheet.Range('BB1').Value := 'Rechnungen';
        Sheet.Range('BC1').Value := 'Gutschriften';
        Sheet.Range('BD1').Value := 'Gesperrt';
        Sheet.Range('BE1').Value := 'Firma verlassen';

        j := '2';

        v_branche1:='';
        v_branche2:='';
        v_branche3:='';
        v_branche4:='';
        v_branche5:='';
        v_branche6:='';
      {
         Sheet.Range('A'+j).Value :=kontakt."No.";
         Sheet.Range('B'+j).Value :=kontakt."First Name";
         Sheet.Range('C'+j).Value :=kontakt.Surname;
         Sheet.Range('D'+j).Value :=kontakt."Company Name";
         Sheet.Range('E'+j).Value :=kontakt."Organizational Level Code";
         Sheet.Range('F'+j).Value :=kontakt."E-Mail";
         IF kontakt."Salutation Code" = 'HERR' THEN
         Sheet.Range('G'+j).Value :='Herr';
         IF kontakt."Salutation Code" = 'FRAU' THEN
         Sheet.Range('G'+j).Value :='Frau';
         Sheet.Range('H'+j).Value :=kontakt."Company No.";
         Sheet.Range('I'+j).Value :=kontakt."Country/Region Code";
         Sheet.Range('J'+j).Value :=kontakt."Post Code";
         Sheet.Range('J'+j).NumberFormat := '00000';
         Sheet.Range('K'+j).Value :=kontakt.City;
         Sheet.Range('L'+j).Value :=kontakt.Abteilung;
         Sheet.Range('M'+j).Value :=kontakt."Salesperson Code";
         Sheet.Range('N'+j).Value :=kontakt."Betreuer Innendienst";
         Sheet.Range('O'+j).Value :=kontakt."Territory Code";

         Sheet.Range('Q'+j).Value :=kontakt."Phone No.";
         Sheet.Range('Q'+j).NumberFormat := '00000000000000000';

      }
        Sheet.Range('A'+j).Value :=kontakt."No.";
        Sheet.Range('B'+j).Value :=kontakt.Type;
        IF kontakt.Type=kontakt.Type::Company THEN BEGIN
          Sheet.Range('C'+j).Value :=kontakt.Name;
          Sheet.Range('D'+j).Value :=kontakt."Name 2";
        END ELSE BEGIN
          kontakt1.RESET;
          kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
          IF kontakt1.FINDFIRST THEN BEGIN
            Sheet.Range('C'+j).Value :=kontakt1.Name;
            Sheet.Range('D'+j).Value :=kontakt1."Name 2";
          END;
        END;
        IF kontakt."Salutation Code" = 'HERR' THEN Sheet.Range('E'+j).Value :='Herr';
        IF kontakt."Salutation Code" = 'FRAU' THEN Sheet.Range('E'+j).Value :='Frau';
        Sheet.Range('F'+j).Value :=kontakt."Job Title";
        Sheet.Range('G'+j).Value :=kontakt."First Name";
        Sheet.Range('H'+j).Value :=kontakt.Surname;
        Sheet.Range('I'+j).Value :=kontakt.Abteilung;
        Sheet.Range('J'+j).Value :=kontakt.Address;
        Sheet.Range('K'+j).Value :=kontakt."Address 2";
        Sheet.Range('L'+j).Value :=kontakt."Country/Region Code";
        Sheet.Range('M'+j).Value :=kontakt."Post Code";
        Sheet.Range('M'+j).NumberFormat := '00000';
        Sheet.Range('N'+j).Value :=kontakt.City;
        Sheet.Range('O'+j).Value :=kontakt."Salesperson Code";
        Sheet.Range('P'+j).Value :=kontakt."Betreuer Innendienst";
        Sheet.Range('Q'+j).Value :=kontakt."Territory Code";
        Sheet.Range('R'+j).Value :=kontakt."No. of Industry Groups";
        Sheet.Range('S'+j).Value :=kontakt."Organizational Level Code";
        Sheet.Range('T'+j).Value :=kontakt."E-Mail";
        Sheet.Range('U'+j).Value :=kontakt."Phone No.";
        Sheet.Range('U'+j).NumberFormat := '00000000000000000';
        Sheet.Range('V'+j).Value :=kontakt."Company No.";
        Sheet.Range('X'+j).Value :=kontakt.Gesperrt;
        kontakt1.RESET;
        kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
        IF kontakt1.FINDFIRST THEN BEGIN
          Sheet.Range('W'+j).Value :=kontakt1.Gesperrt;
        END;
        Sheet.Range('Y'+j).Value :=kontakt."Unternehmen verlassen";
        Sheet.Range('AA'+j).Value :=kontakt.AC_Solutionpartner;
        Sheet.Range('BD'+j).Value :=kontakt.Gesperrt;
        Sheet.Range('BE'+j).Value :=kontakt."Unternehmen verlassen";

      // Branchenauswertung
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1|%2|%3|%4|%5','1-INNOVATO','2-EARL ADO','3-EARL MAJ','4-LATE MAJ','5-LAGGARDS');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AB'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','AUFTR-ENTW');
        IF branche."Industry Group Code"='AUFTR-ENTW' THEN BEGIN
          Sheet.Range('AC'+j).Value :=branche."Industry Group Code";
        END;

      //  Branche Neu Start   ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        branche.RESET;
        v_branche:=0;
        v_branche1:='';
        v_branche2:='';
        v_branche3:='';
        v_branche4:='';
        v_branche5:='';
        v_branche6:='';
        v_branche7:='';
        v_branche8:='';
        v_branche9:='';
        v_branche10:='';
        v_branche11:='';
        v_branche12:='';
        v_branche13:='';
        v_branche14:='';
        v_branche15:='';
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5&<>%6','1-INNOVATO','2-EARL ADO','3-EARL MAJ','4-LATE MAJ','5-LAGGARDS','AUFTR-ENTW');
        IF branche.FIND('-') THEN BEGIN
          REPEAT
            v_branche:=v_branche+1;
            IF v_branche = 1 THEN  v_branche1:=branche."Industry Group Code";
            IF v_branche = 2 THEN  v_branche2:=branche."Industry Group Code";
            IF v_branche = 3 THEN  v_branche3:=branche."Industry Group Code";
            IF v_branche = 4 THEN  v_branche4:=branche."Industry Group Code";
            IF v_branche = 5 THEN  v_branche5:=branche."Industry Group Code";
            IF v_branche = 6 THEN  v_branche6:=branche."Industry Group Code";
            IF v_branche = 7 THEN  v_branche7:=branche."Industry Group Code";
            IF v_branche = 8 THEN  v_branche8:=branche."Industry Group Code";
            IF v_branche = 9 THEN  v_branche9:=branche."Industry Group Code";
            IF v_branche =10 THEN  v_branche10:=branche."Industry Group Code";
            IF v_branche =11 THEN  v_branche11:=branche."Industry Group Code";
            IF v_branche =12 THEN  v_branche12:=branche."Industry Group Code";
            IF v_branche =13 THEN  v_branche13:=branche."Industry Group Code";
            IF v_branche =14 THEN  v_branche14:=branche."Industry Group Code";
            IF v_branche =15 THEN  v_branche15:=branche."Industry Group Code";
          UNTIL branche.NEXT=0;
        END;
        Sheet.Range('AD'+j).Value :=v_branche1;
        Sheet.Range('AC'+j).Value :=v_branche2;
        Sheet.Range('AD'+j).Value :=v_branche3;
        Sheet.Range('AE'+j).Value :=v_branche4;
        Sheet.Range('AF'+j).Value :=v_branche5;
        Sheet.Range('AG'+j).Value :=v_branche6;
        Sheet.Range('AH'+j).Value :=v_branche7;
        Sheet.Range('AI'+j).Value :=v_branche8;
        Sheet.Range('AJ'+j).Value :=v_branche9;
        Sheet.Range('AK'+j).Value :=v_branche10;
        Sheet.Range('AL'+j).Value :=v_branche11;
        Sheet.Range('AM'+j).Value :=v_branche12;
        Sheet.Range('AN'+j).Value :=v_branche13;
        Sheet.Range('AO'+j).Value :=v_branche14;
        Sheet.Range('AP'+j).Value :=v_branche15;
        IF v_branche>15 THEN  Sheet.Range('AI'+j).Value :='Fehler';

      //  Branche Neu Ende  ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('AQ'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler1:=verteiler."Mailing Group Code";
        END;
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1',v_verteiler1);
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('AR'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler2:=verteiler."Mailing Group Code"
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2',v_verteiler1,v_verteiler2);
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('AS'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler3:=verteiler."Mailing Group Code"
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3',v_verteiler1,v_verteiler2,v_verteiler3);
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('AT'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler4:=verteiler."Mailing Group Code"
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4);
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('AU'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler5:=verteiler."Mailing Group Code"
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4,v_verteiler5);
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('AV'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler6:=verteiler."Mailing Group Code"
        END;


      //  Verteilereintrag des Mandanten abfragen
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."Company No.");
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('AV'+j).Value :=verteiler."Mailing Group Code"+' Mandant';
          v_verteiler6:=(verteiler."Mailing Group Code"+' Mandant');
        END;

        kon_deb.RESET;
        kon_deb.SETFILTER(kon_deb."Contact No.",'%1',kontakt."Company No.");
        kon_deb.SETFILTER(kon_deb."Business Relation Code",'%1','DEB');
        IF kon_deb.FINDFIRST THEN BEGIN
          v_au:='';
          v_re:='';
          v_an:='';
          v_gu:='';
          v_art:='';
          belege.RESET;
          belege.SETFILTER(belege."Debitornr.",'%1',kon_deb."No.");
          IF ((v_datum_von=0D) AND (v_datum_bis=0D)) THEN BEGIN
          END ELSE BEGIN
            belege.SETFILTER(belege.Belegdatum,'%1..%2',v_datum_von,v_datum_bis);
          END;
          IF ((v_hersteller1='') AND (v_hersteller2='') AND (v_hersteller3='') AND (v_hersteller4='') AND (v_hersteller5='')) THEN BEGIN
          END ELSE BEGIN
            belege.SETFILTER(belege.Herstellercode,'%1|%2|%3|%4|%5',v_hersteller1,v_hersteller2,v_hersteller3,v_hersteller4,v_hersteller5);
          END;

          IF belege.Herstellercode=v_hersteller1 THEN BEGIN
            v_art:='Belege ';
            v_art:=v_art+v_hersteller1;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
            IF belege.FINDFIRST THEN BEGIN
              v_an:='AN ';
              v_an:=v_an+v_hersteller1;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
            IF belege.FINDFIRST THEN BEGIN
              v_au:='AU ';
              v_au:=v_au+v_hersteller1;
            END;
              belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
            IF belege.FINDFIRST THEN BEGIN
              v_re:='RE ';
              v_re:=v_re+v_hersteller1;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
            IF belege.FINDFIRST THEN BEGIN
              v_gu:='GU ';
              v_gu:=v_gu+v_hersteller1;
            END;
          END;

          IF belege.Herstellercode=v_hersteller2 THEN BEGIN
            IF v_art='' THEN BEGIN
              v_art:='Belege';
            END;
            v_art:=v_art+' '+v_hersteller2;

            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
            IF belege.FINDFIRST THEN BEGIN
              IF v_an='' THEN BEGIN
                v_an:='AN';
              END;
              v_an:=v_an+' '+v_hersteller2;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
            IF belege.FINDFIRST THEN BEGIN
              IF v_au='' THEN BEGIN
                v_au:='AU';
              END;
              v_au:=v_au+' '+v_hersteller2;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
            IF belege.FINDFIRST THEN BEGIN
              IF v_re='' THEN BEGIN
                v_re:='RE';
              END;
              v_re:=v_re+' '+v_hersteller2;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
            IF belege.FINDFIRST THEN BEGIN
              IF v_gu='' THEN BEGIN
                v_gu:='GU';
              END;
              v_gu:=v_gu+' '+v_hersteller2;
            END;
          END;

          IF belege.Herstellercode=v_hersteller3 THEN BEGIN
            IF v_art='' THEN BEGIN
              v_art:='Belege';
            END;
            v_art:=v_art+' '+v_hersteller3;

            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
            IF belege.FINDFIRST THEN BEGIN
              IF v_an='' THEN BEGIN
                v_an:='AN';
              END;
              v_an:=v_an+' '+v_hersteller3;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
            IF belege.FINDFIRST THEN BEGIN
              IF v_au='' THEN BEGIN
                v_au:='AU';
              END;
              v_au:=v_au+' '+v_hersteller3;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
            IF belege.FINDFIRST THEN BEGIN
              IF v_re='' THEN BEGIN
                v_re:='RE';
              END;
              v_re:=v_re+' '+v_hersteller3;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
            IF belege.FINDFIRST THEN BEGIN
              IF v_gu='' THEN BEGIN
                v_gu:='GU';
              END;
              v_gu:=v_gu+' '+v_hersteller3;
            END;
          END;

          IF belege.Herstellercode=v_hersteller4 THEN BEGIN
            IF v_art='' THEN BEGIN
              v_art:='Belege';
            END;
            v_art:=v_art+' '+v_hersteller4;

            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
            IF belege.FINDFIRST THEN BEGIN
              IF v_an='' THEN BEGIN
                v_an:='AN';
              END;
              v_an:=v_an+' '+v_hersteller4;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
            IF belege.FINDFIRST THEN BEGIN
              IF v_au='' THEN BEGIN
                v_au:='AU';
              END;
              v_au:=v_au+' '+v_hersteller4;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
            IF belege.FINDFIRST THEN BEGIN
              IF v_re='' THEN BEGIN
                v_re:='RE';
              END;
              v_re:=v_re+' '+v_hersteller4;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
            IF belege.FINDFIRST THEN BEGIN
              IF v_gu='' THEN BEGIN
                v_gu:='GU';
              END;
              v_gu:=v_gu+' '+v_hersteller4;
            END;
          END;

          IF belege.Herstellercode=v_hersteller5 THEN BEGIN
            IF v_art='' THEN BEGIN
              v_art:='Belege';
            END;
            v_art:=v_art+' '+v_hersteller5;

            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
            IF belege.FINDFIRST THEN BEGIN
              IF v_an='' THEN BEGIN
                v_an:='AN';
              END;
              v_an:=v_an+' '+v_hersteller5;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
            IF belege.FINDFIRST THEN BEGIN
              IF v_au='' THEN BEGIN
                v_au:='AU';
              END;
              v_au:=v_au+' '+v_hersteller5;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
            IF belege.FINDFIRST THEN BEGIN
              IF v_re='' THEN BEGIN
                v_re:='RE';
              END;
              v_re:=v_re+' '+v_hersteller5;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
            IF belege.FINDFIRST THEN BEGIN
              IF v_gu='' THEN BEGIN
                v_gu:='GU';
              END;
              v_gu:=v_gu+' '+v_hersteller5;
            END;
          END;

          Sheet.Range('AY'+j).Value :=v_art;
          Sheet.Range('AZ'+j).Value :=v_an;
          Sheet.Range('BA'+j).Value :=v_au;
          Sheet.Range('BB'+j).Value :=v_re;
          Sheet.Range('BC'+j).Value :=v_gu;
        END;
        j:=INCSTR(j);
      END ELSE BEGIN
      //kontakt.RESET;
      //IF v_kontaktnr='' THEN BEGIN
      //kontakt.SETFILTER(kontakt."Company No.",'<>%1','');
      ////kontakt.SETFILTER(kontakt."Company No.",'>%1','KT031000');
      //END ELSE BEGIN
      //kontakt.SETFILTER(kontakt."Company No.",'%1',v_kontaktnr);
      //END;
      //kontakt.SETFILTER(kontakt.Gesperrt,'%1',FALSE);
      //kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Person);
      //IF kontakt.FIND('-') THEN BEGIN
      //REPEAT
        v_branche1:='';
        v_branche2:='';
        v_branche3:='';
        v_branche4:='';
        v_branche5:='';
        v_branche6:='';
      {
         Sheet.Range('A'+j).Value :=kontakt."No.";
         Sheet.Range('B'+j).Value :=kontakt."First Name";
         Sheet.Range('C'+j).Value :=kontakt.Surname;
         Sheet.Range('D'+j).Value :=kontakt."Company Name";
         Sheet.Range('E'+j).Value :=kontakt."Organizational Level Code";
         Sheet.Range('F'+j).Value :=kontakt."E-Mail";
         IF kontakt."Salutation Code" = 'HERR' THEN
         Sheet.Range('G'+j).Value :='Herr';
         IF kontakt."Salutation Code" = 'FRAU' THEN
         Sheet.Range('G'+j).Value :='Frau';
         Sheet.Range('H'+j).Value :=kontakt."Company No.";
         Sheet.Range('I'+j).Value :=kontakt."Country/Region Code";
         Sheet.Range('J'+j).Value :=kontakt."Post Code";
         Sheet.Range('J'+j).NumberFormat := '00000';
         Sheet.Range('K'+j).Value :=kontakt.City;
         Sheet.Range('L'+j).Value :=kontakt.Abteilung;
         Sheet.Range('M'+j).Value :=kontakt."Salesperson Code";
         Sheet.Range('N'+j).Value :=kontakt."Betreuer Innendienst";
         Sheet.Range('O'+j).Value :=kontakt."Territory Code";

         Sheet.Range('Q'+j).Value :=kontakt."Phone No.";
         Sheet.Range('Q'+j).NumberFormat := '00000000000000000';
       }

        Sheet.Range('A'+j).Value :=kontakt."No.";
        Sheet.Range('B'+j).Value :=kontakt.Type;
        IF kontakt.Type=kontakt.Type::Company THEN BEGIN
          Sheet.Range('C'+j).Value :=kontakt.Name;
          Sheet.Range('D'+j).Value :=kontakt."Name 2";
        END ELSE BEGIN
          kontakt1.RESET;
          kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
          IF kontakt1.FINDFIRST THEN BEGIN
            Sheet.Range('C'+j).Value :=kontakt1.Name;
            Sheet.Range('D'+j).Value :=kontakt1."Name 2";
          END;
        END;
        IF kontakt."Salutation Code" = 'HERR' THEN Sheet.Range('E'+j).Value :='Herr';
        IF kontakt."Salutation Code" = 'FRAU' THEN Sheet.Range('E'+j).Value :='Frau';
        Sheet.Range('F'+j).Value :=kontakt."Job Title";
        Sheet.Range('G'+j).Value :=kontakt."First Name";
        Sheet.Range('H'+j).Value :=kontakt.Surname;
        Sheet.Range('I'+j).Value :=kontakt.Abteilung;
        Sheet.Range('J'+j).Value :=kontakt.Address;
        Sheet.Range('K'+j).Value :=kontakt."Address 2";
        Sheet.Range('L'+j).Value :=kontakt."Country/Region Code";
        Sheet.Range('M'+j).Value :=kontakt."Post Code";
        Sheet.Range('M'+j).NumberFormat := '00000';
        Sheet.Range('N'+j).Value :=kontakt.City;
        Sheet.Range('O'+j).Value :=kontakt."Salesperson Code";
        Sheet.Range('P'+j).Value :=kontakt."Betreuer Innendienst";
        Sheet.Range('Q'+j).Value :=kontakt."Territory Code";
        Sheet.Range('R'+j).Value :=kontakt."No. of Industry Groups";
        Sheet.Range('S'+j).Value :=kontakt."Organizational Level Code";
        Sheet.Range('T'+j).Value :=kontakt."E-Mail";
        Sheet.Range('U'+j).Value :=kontakt."Phone No.";
        Sheet.Range('U'+j).NumberFormat := '00000000000000000';
        Sheet.Range('V'+j).Value :=kontakt."Company No.";
        Sheet.Range('X'+j).Value :=kontakt.Gesperrt;
        kontakt1.RESET;
        kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
        IF kontakt1.FINDFIRST THEN BEGIN
          Sheet.Range('W'+j).Value :=kontakt1.Gesperrt;
        END;
        Sheet.Range('Y'+j).Value :=kontakt."Unternehmen verlassen";
        Sheet.Range('AA'+j).Value :=kontakt.AC_Solutionpartner;
        Sheet.Range('BD'+j).Value :=kontakt.Gesperrt;
        Sheet.Range('BE'+j).Value :=kontakt."Unternehmen verlassen";

      // Branchenauswertung
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1|%2|%3|%4|%5','1-INNOVATO','2-EARL ADO','3-EARL MAJ','4-LATE MAJ','5-LAGGARDS');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AB'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','AUFTR-ENTW');
        IF branche."Industry Group Code"='AUFTR-ENTW' THEN BEGIN
          Sheet.Range('AC'+j).Value :=branche."Industry Group Code";
        END;
      //  Branche Neu Start   ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        branche.RESET;
        v_branche:=0;
        v_branche1:='';
        v_branche2:='';
        v_branche3:='';
        v_branche4:='';
        v_branche5:='';
        v_branche6:='';
        v_branche7:='';
        v_branche8:='';
        v_branche9:='';
        v_branche10:='';
        v_branche11:='';
        v_branche12:='';
        v_branche13:='';
        v_branche14:='';
        v_branche15:='';
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5&<>%6','1-INNOVATO','2-EARL ADO','3-EARL MAJ','4-LATE MAJ','5-LAGGARDS','AUFTR-ENTW');
        IF branche.FIND('-') THEN BEGIN
          REPEAT
            v_branche:=v_branche+1;
            IF v_branche = 1 THEN  v_branche1:=branche."Industry Group Code";
            IF v_branche = 2 THEN  v_branche2:=branche."Industry Group Code";
            IF v_branche = 3 THEN  v_branche3:=branche."Industry Group Code";
            IF v_branche = 4 THEN  v_branche4:=branche."Industry Group Code";
            IF v_branche = 5 THEN  v_branche5:=branche."Industry Group Code";
            IF v_branche = 6 THEN  v_branche6:=branche."Industry Group Code";
            IF v_branche = 7 THEN  v_branche7:=branche."Industry Group Code";
            IF v_branche = 8 THEN  v_branche8:=branche."Industry Group Code";
            IF v_branche = 9 THEN  v_branche9:=branche."Industry Group Code";
            IF v_branche =10 THEN  v_branche10:=branche."Industry Group Code";
            IF v_branche =11 THEN  v_branche11:=branche."Industry Group Code";
            IF v_branche =12 THEN  v_branche12:=branche."Industry Group Code";
            IF v_branche =13 THEN  v_branche13:=branche."Industry Group Code";
            IF v_branche =14 THEN  v_branche14:=branche."Industry Group Code";
            IF v_branche =15 THEN  v_branche15:=branche."Industry Group Code";
          UNTIL branche.NEXT=0;
        END;
        Sheet.Range('AD'+j).Value :=v_branche1;
        Sheet.Range('AE'+j).Value :=v_branche2;
        Sheet.Range('AF'+j).Value :=v_branche3;
        Sheet.Range('AG'+j).Value :=v_branche4;
        Sheet.Range('AH'+j).Value :=v_branche5;
        Sheet.Range('AI'+j).Value :=v_branche6;
        Sheet.Range('AJ'+j).Value :=v_branche7;
        Sheet.Range('AK'+j).Value :=v_branche8;
        Sheet.Range('AL'+j).Value :=v_branche9;
        Sheet.Range('AM'+j).Value :=v_branche10;
        Sheet.Range('AN'+j).Value :=v_branche11;
        Sheet.Range('AO'+j).Value :=v_branche12;
        Sheet.Range('AP'+j).Value :=v_branche13;
        Sheet.Range('AQ'+j).Value :=v_branche14;
        Sheet.Range('AR'+j).Value :=v_branche15;
        IF v_branche>15 THEN  Sheet.Range('AI'+j).Value :='Fehler';

      //  Branche Neu Ende  ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('AS'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler1:=verteiler."Mailing Group Code";
        END;
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1',v_verteiler1);
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('AT'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler2:=verteiler."Mailing Group Code"
        END;
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2',v_verteiler1,v_verteiler2);
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('AU'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler3:=verteiler."Mailing Group Code"
        END;
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3',v_verteiler1,v_verteiler2,v_verteiler3);
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('AV'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler4:=verteiler."Mailing Group Code"
        END;
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4);
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('AW'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler5:=verteiler."Mailing Group Code"
        END;
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4,v_verteiler5);
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('AX'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler6:=verteiler."Mailing Group Code"
        END;
      //  Verteilereintrag des Mandanten abfragen
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."Company No.");
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('AX'+j).Value :=verteiler."Mailing Group Code"+' Mandant';
      //      v_verteiler6:=(verteiler."Mailing Group Code"+' Mandant');
        END;
      {        kon_deb.RESET;
              kon_deb.SETFILTER(kon_deb."Contact No.",'%1',kontakt."Company No.");
      //        Kon_deb.CALCFIELDS("Business Relation Code");
              kon_deb.SETFILTER(kon_deb."Business Relation Code",'%1','DEB');
              IF kon_deb.FINDFIRST THEN BEGIN

                  v_au:='';
                  v_re:='';
                  v_an:='';
                  v_gu:='';
                  v_art:='';
                  belege.RESET;
                  belege.SETFILTER(belege."Debitornr.",'%1',kon_deb."No.");
                    IF ((v_datum_von=0D) AND (v_datum_bis=0D)) THEN BEGIN
                    END ELSE BEGIN
                    belege.SETFILTER(belege.Belegdatum,'%1..%2',v_datum_von,v_datum_bis);
                    END;
           IF ((v_hersteller1='') AND (v_hersteller2='') AND (v_hersteller3='') AND (v_hersteller4='')
           AND (v_hersteller5='')) THEN BEGIN


       //           IF v_hersteller='' THEN BEGIN
                  END ELSE BEGIN
         belege.SETFILTER(belege.Herstellercode,'%1|%2|%3|%4|%5',v_hersteller1,v_hersteller2,v_hersteller3,v_hersteller4,v_hersteller5);
      //            belege.SETFILTER(belege.Herstellercode,'%1',v_hersteller);
                  END;
      //             belege.SETFILTER(belege.Herstellercode,'%1|%2','82','85');

                  belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
                  IF belege.FINDFIRST THEN BEGIN
                  v_an:='AN';
                  v_art:='Belege '+v_hersteller1+v_hersteller2+v_hersteller3+v_hersteller4+v_hersteller5;
                  END;
                  belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
                  IF belege.FINDFIRST THEN BEGIN
                  v_au:='AU';
                  v_art:='Belege '+v_hersteller1+v_hersteller2+v_hersteller3+v_hersteller4+v_hersteller5;
                  END;
                  belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
                  IF belege.FINDFIRST THEN BEGIN
                  v_re:='RE';
                  v_art:='Belege '+v_hersteller1+v_hersteller2+v_hersteller3+v_hersteller4+v_hersteller5;
                  END;
                  belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
                  IF belege.FINDFIRST THEN BEGIN
                  v_gu:='GU';
                  v_art:='Belege '+v_hersteller1+v_hersteller2+v_hersteller3+v_hersteller4+v_hersteller5;
                  END;

                  Sheet.Range('AY'+j).Value :=v_art;
                  Sheet.Range('AZ'+j).Value :=v_an;
                  Sheet.Range('BA'+j).Value :=v_au;
                  Sheet.Range('BB'+j).Value :=v_re;
                  Sheet.Range('BC'+j).Value :=v_gu;
      }
      {    kon_deb.RESET;
          kon_deb.SETFILTER(kon_deb."Contact No.",'%1',kontakt."Company No.");
          kon_deb.SETFILTER(kon_deb."Business Relation Code",'%1','DEB');
          IF kon_deb.FINDFIRST THEN BEGIN

      //      v_au:='';
      //      v_re:='';
      //      v_an:='';
      //      v_gu:='';
      //      v_art:='';
           belege.RESET;
           belege.SETFILTER(belege."Debitornr.",'%1',kon_deb."No.");
              IF ((v_datum_von=0D) AND (v_datum_bis=0D)) THEN BEGIN
              END ELSE BEGIN
               belege.SETFILTER(belege.Belegdatum,'%1..%2',v_datum_von,v_datum_bis);
              END;
           IF ((v_hersteller1='') AND (v_hersteller2='') AND (v_hersteller3='') AND (v_hersteller4='')
           AND (v_hersteller5='')) THEN BEGIN
           END ELSE BEGIN
           belege.SETFILTER(belege.Herstellercode,'%1|%2|%3|%4|%5',v_hersteller1,v_hersteller2,v_hersteller3,v_hersteller4,v_hersteller5);
           END;

            IF belege.Herstellercode=v_hersteller1 THEN BEGIN
             v_art:='Belege ';
             v_art:=v_art+v_hersteller1;
             belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
             IF belege.FINDFIRST THEN BEGIN
             v_an:='AN ';
             v_an:=v_an+v_hersteller1;
             END;
             belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
             IF belege.FINDFIRST THEN BEGIN
             v_au:='AU ';
             v_au:=v_au+v_hersteller1;
             END;
             belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
             IF belege.FINDFIRST THEN BEGIN
             v_re:='RE ';
             v_re:=v_re+v_hersteller1;
             END;
             belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
             IF belege.FINDFIRST THEN BEGIN
             v_gu:='GU ';
             v_gu:=v_gu+v_hersteller1;
             END;
            END;

            IF belege.Herstellercode=v_hersteller2 THEN BEGIN
             IF v_art='' THEN BEGIN
              v_art:='Belege';
             END;
              v_art:=v_art+' '+v_hersteller2;

             belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
             IF belege.FINDFIRST THEN BEGIN
             IF v_an='' THEN BEGIN
              v_an:='AN';
             END;
              v_an:=v_an+' '+v_hersteller2;
             END;
             belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
             IF belege.FINDFIRST THEN BEGIN
             IF v_au='' THEN BEGIN
              v_au:='AU';
             END;
              v_au:=v_au+' '+v_hersteller2;
             END;
             belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
             IF belege.FINDFIRST THEN BEGIN
             IF v_re='' THEN BEGIN
              v_re:='RE';
             END;
              v_re:=v_re+' '+v_hersteller2;
             END;
             belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
             IF belege.FINDFIRST THEN BEGIN
             IF v_gu='' THEN BEGIN
              v_gu:='GU';
             END;
              v_gu:=v_gu+' '+v_hersteller2;
             END;
            END;

            IF belege.Herstellercode=v_hersteller3 THEN BEGIN
             IF v_art='' THEN BEGIN
              v_art:='Belege';
             END;
              v_art:=v_art+' '+v_hersteller3;

             belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
             IF belege.FINDFIRST THEN BEGIN
             IF v_an='' THEN BEGIN
              v_an:='AN';
             END;
              v_an:=v_an+' '+v_hersteller3;
             END;
             belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
             IF belege.FINDFIRST THEN BEGIN
             IF v_au='' THEN BEGIN
              v_au:='AU';
             END;
              v_au:=v_au+' '+v_hersteller3;
             END;
             belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
             IF belege.FINDFIRST THEN BEGIN
             IF v_re='' THEN BEGIN
              v_re:='RE';
             END;
              v_re:=v_re+' '+v_hersteller3;
             END;
             belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
             IF belege.FINDFIRST THEN BEGIN
             IF v_gu='' THEN BEGIN
              v_gu:='GU';
             END;
              v_gu:=v_gu+' '+v_hersteller3;
             END;
            END;

            IF belege.Herstellercode=v_hersteller4 THEN BEGIN
             IF v_art='' THEN BEGIN
              v_art:='Belege';
             END;
              v_art:=v_art+' '+v_hersteller4;

             belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
             IF belege.FINDFIRST THEN BEGIN
             IF v_an='' THEN BEGIN
              v_an:='AN';
             END;
              v_an:=v_an+' '+v_hersteller4;
             END;
             belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
             IF belege.FINDFIRST THEN BEGIN
             IF v_au='' THEN BEGIN
              v_au:='AU';
             END;
              v_au:=v_au+' '+v_hersteller4;
             END;
             belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
             IF belege.FINDFIRST THEN BEGIN
             IF v_re='' THEN BEGIN
              v_re:='RE';
             END;
              v_re:=v_re+' '+v_hersteller4;
             END;
             belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
             IF belege.FINDFIRST THEN BEGIN
             IF v_gu='' THEN BEGIN
              v_gu:='GU';
             END;
              v_gu:=v_gu+' '+v_hersteller4;
             END;
            END;

            IF belege.Herstellercode=v_hersteller5 THEN BEGIN
             IF v_art='' THEN BEGIN
              v_art:='Belege';
             END;
              v_art:=v_art+' '+v_hersteller5;

             belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
             IF belege.FINDFIRST THEN BEGIN
             IF v_an='' THEN BEGIN
              v_an:='AN';
             END;
              v_an:=v_an+' '+v_hersteller5;
             END;
             belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
             IF belege.FINDFIRST THEN BEGIN
             IF v_au='' THEN BEGIN
              v_au:='AU';
             END;
              v_au:=v_au+' '+v_hersteller5;
             END;
             belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
             IF belege.FINDFIRST THEN BEGIN
             IF v_re='' THEN BEGIN
              v_re:='RE';
             END;
              v_re:=v_re+' '+v_hersteller5;
             END;
             belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
             IF belege.FINDFIRST THEN BEGIN
             IF v_gu='' THEN BEGIN
              v_gu:='GU';
             END;
              v_gu:=v_gu+' '+v_hersteller5;
             END;
            END;
       }
        Sheet.Range('AY'+j).Value :=v_art;
        Sheet.Range('AZ'+j).Value :=v_an;
        Sheet.Range('BA'+j).Value :=v_au;
        Sheet.Range('BB'+j).Value :=v_re;
        Sheet.Range('BC'+j).Value :=v_gu;

       //     END;
        j:=INCSTR(j);
      //UNTIL branche.NEXT=0;
      //END;
      END;
    END;

    PROCEDURE Branche_Systeme_Neu@1140017();
    BEGIN
      //
      //  IF kontakt.FIND('-') THEN BEGIN
      // REPEAT
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      IF v_alle_acs=TRUE THEN BEGIN
      //  branche.SETFILTER(branche."Industry Group Code",'%1','SUS*');
        branche.SETFILTER(branche."Industry Group Code",'%1|%2','ACS*','SUS*');
        IF branche.FINDFIRST THEN BEGIN
          Adressverwaltung;
        END;
      END ELSE BEGIN
        IF v_aes1=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-AES1');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_aes2=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-AES2');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_aes3=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-AES3');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_aes4=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-AES4');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_aes5=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-AES5');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_aes6=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-AES6');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_aes7=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-AES7');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_aes8=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-AES8');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_h„ndl=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-HŽNDL');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_sh1=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-SH1');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_sh2=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-SH2');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_sh3=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-SH3');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_sh4=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-SH4');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_sh5=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-SH5');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_sh6=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-SH6');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_sh7=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-SH7');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_sh8=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-SH8');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_sh9=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-SH9');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_sn1=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-SN1');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_sn2=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-SN2');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_sn3=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-SN3');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_sn4=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-SN4');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_sn5=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-SN5');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_sn6=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-SN6');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_sn7=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-SN7');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_sn8=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-SN8');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_sn9=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-SN9');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_sn10=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-SN10');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_st1=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-ST1');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_st2=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-ST2');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_st3=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-ST3');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_st4=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-ST4');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_st5=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-ST5');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_st6=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-ST6');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_st7=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-ST7');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_st8=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','ACS-ST8');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_SUS_P1=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P1');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_SUS_P2=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P2');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_SUS_P3=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P3');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_SUS_P4=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P4');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_SUS_T1=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T1');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_SUS_T2=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T2');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_SUS_T3=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T3');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_SUS_T4=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T4');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_SUS_T5=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T5');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_SUS_T6=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T6');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_SUS_T7=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T7');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_SUS_L1=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L1');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_SUS_L2=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L2');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_SUS_L3=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L3');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_SUS_L4=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L4');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_SUS_L5=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L5');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;
        IF v_SUS_ENDK=TRUE THEN BEGIN
          branche.SETFILTER(branche."Industry Group Code",'%1','SUS-ENDK');
          IF branche.FINDFIRST THEN BEGIN
            Adressverwaltung;
          END;
        END;

      //   IF v_alle_acs=TRUE THEN BEGIN
      //      IF branche.FINDFIRST THEN BEGIN
      //      Adressverwaltung;
      //      END;
      END;

      //UNTIL kontakt.NEXT=0;
      //END;
    END;

    PROCEDURE "Branche prfen"@1140019();
    BEGIN

      kontakt.RESET;
      kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Company);
      kontakt.SETFILTER(kontakt.Gesperrt,'%1',FALSE);
      kontakt.SETFILTER(kontakt."Territory Code",'<>%1','SYSTEM');
      IF kontakt.FIND('-') THEN BEGIN
        REPEAT
          v_branche_ok:=0;
          branche.RESET;
          branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
          branche.SETFILTER(branche."Industry Group Code",'SUS*');
          IF branche.FIND('-') THEN BEGIN
            REPEAT
              IF ((branche."Industry Group Code"='SUS-P1') OR (branche."Industry Group Code"='SUS-P2') OR (branche."Industry Group Code"='SUS-P3') OR (branche."Industry Group Code"='SUS-P4')) THEN v_branche_ok:=v_branche_ok+1;
            UNTIL branche.NEXT=0;
            IF v_branche_ok=0 THEN Andruckverwaltung;
          END;
        UNTIL kontakt.NEXT=0;
      END;


      kontakt.RESET;
      kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Company);
      kontakt.SETFILTER(kontakt.Gesperrt,'%1',FALSE);
      kontakt.SETFILTER(kontakt."Territory Code",'%1','SYSTEM');
      IF kontakt.FIND('-') THEN BEGIN
        REPEAT
          v_branche_ok:=0;
          branche.RESET;
          branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      //   branche.SETFILTER(branche."Industry Group Code",'SUS*');
          IF branche.FIND('-') THEN BEGIN
            REPEAT
              IF ((branche."Industry Group Code"='SUS-P1') OR (branche."Industry Group Code"='SUS-P2') OR (branche."Industry Group Code"='SUS-P3') OR (branche."Industry Group Code"='SUS-P4')) THEN v_branche_ok:=v_branche_ok+1;
            UNTIL branche.NEXT=0;
            IF v_branche_ok=0 THEN Andruckverwaltung;
          END;
        UNTIL kontakt.NEXT=0;
      END;

      {
      MESSAGE(Text066);
      //Andruckverwaltung;

      kontakt.RESET;
      kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Company);
      kontakt.SETFILTER(kontakt.Gesperrt,'%1',FALSE);
      kontakt.SETFILTER(kontakt."Territory Code",'%1','SYSTEM');
      //kontakt.SETFILTER(kontakt."Company No.",'%1','KT003277');
      IF kontakt.FIND('-') THEN BEGIN
      REPEAT
        Andruckverwaltung;
      UNTIL kontakt.NEXT=0;
      END;
      }
      CloseExcel('Systemkunden ohne Brancheneintrag','Systemkunden ohne Brancheneintrag','F:\Daten Neu\User\Uwe\Mailing');
    END;

    PROCEDURE "Liste SUS-NO"@1140020();
    BEGIN
      kontakt.RESET;
      kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Company);
      IF kontakt.FIND('-') THEN BEGIN
        REPEAT
          v_branche_ok:=0;
          branche.RESET;
          branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
          branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO*');
          IF branche.FINDFIRST THEN BEGIN
      //      Adressverwaltung;
             Andruckverwaltung;
          END;
        UNTIL kontakt.NEXT=0;
      END;
      CloseExcel('Liste SUS-NO','Liste SUS-NO','F:\Daten Neu\User\Uwe\Mailing');
      MESSAGE(Text003);
    END;

    PROCEDURE "Liste SUS-ENDKUNDE"@1140018();
    BEGIN
      kontakt.RESET;
      kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Company);
      IF kontakt.FIND('-') THEN BEGIN
        REPEAT
          v_branche_ok:=0;
          branche.RESET;
          branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
          branche.SETFILTER(branche."Industry Group Code",'%1','SUS-ENDK*');
          IF branche.FINDFIRST THEN BEGIN
      //      Adressverwaltung;
            Andruckverwaltung;
          END;
        UNTIL kontakt.NEXT=0;
      END;
      CloseExcel('Liste SUS-Endkunde','Liste SUS-Endkunde','F:\Daten Neu\User\Uwe\Mailing');
      MESSAGE(Text003);
    END;

    PROCEDURE "Branche suchen"@1140021();
    BEGIN
      kontakt.RESET;
      kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Company);
      IF kontakt.FIND('-') THEN BEGIN
        REPEAT
          v_branche_ok:=0;
          branche.RESET;
          branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
          branche.SETFILTER(branche."Industry Group Code",'%1',v_branche_suche);
          IF branche.FINDFIRST THEN BEGIN
      //      Adressverwaltung;
            Andruckverwaltung;
          END;
       UNTIL kontakt.NEXT=0;
      END;
      CloseExcel('Liste Branche suchen','Liste Branche suchen','F:\Daten Neu\User\Uwe\Mailing');
      MESSAGE(Text003);
    END;

    PROCEDURE ML_Kontakte@1140023();
    BEGIN
      kontakt.RESET;
      kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Company);
      kontakt.SETFILTER(kontakt.Gesperrt,'%1',FALSE);
      kontakt.SETFILTER(kontakt."Salesperson Code",'%1','ML');
      IF kontakt.FIND('-') THEN BEGIN
        REPEAT
      //   Adressverwaltung;
          Andruckverwaltung;
        UNTIL kontakt.NEXT=0;
      END;
      kontakt.RESET;
      kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Company);
      kontakt.SETFILTER(kontakt.Gesperrt,'%1',FALSE);
      kontakt.SETFILTER(kontakt."Betreuer Innendienst",'%1','ML');
      IF kontakt.FIND('-') THEN BEGIN
        REPEAT
      //   Adressverwaltung;
          Andruckverwaltung;
        UNTIL kontakt.NEXT=0;
      END;

      CloseExcel('Liste ML-Kontakte','Liste ML-Kontakte','F:\Daten Neu\User\Uwe\Mailing');
      MESSAGE(Text003);
    END;

    PROCEDURE Adr_Emailversand_SUS@1140024();
    BEGIN

      IF v_z„hler=1 THEN BEGIN
        CREATE (Excel,FALSE,TRUE);                                             //erzeugt excel
        Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
        Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
        Excel.Visible(TRUE);


       {
      Sheet.Range('A1').Value := 'USER1';
      Sheet.Range('B1').Value := 'Vorname';
      Sheet.Range('C1').Value := 'Name';
      Sheet.Range('D1').Value := 'Firma';
      Sheet.Range('E1').Value := 'Funktion';
      Sheet.Range('F1').Value := 'Email';
      Sheet.Range('G1').Value := 'Anrede';
      Sheet.Range('H1').Value := 'USER2';
      Sheet.Range('I1').Value := 'Nation';
      Sheet.Range('J1').Value := 'PLZ';
      Sheet.Range('K1').Value := 'Ort';
      Sheet.Range('L1').Value := 'Abteilung';
      Sheet.Range('M1').Value := 'Verk„ufer';
      Sheet.Range('N1').Value := 'Betreuer';
      Sheet.Range('O1').Value := 'Gebiet';
      Sheet.Range('P1').Value := 'Branche';
      Sheet.Range('Q1').Value := 'Telefon';
      }

        Sheet.Range('A1').Value := 'USER1';
        Sheet.Range('B1').Value := 'Art';
        Sheet.Range('C1').Value := 'Firma';
        Sheet.Range('D1').Value := 'Firma2';
        Sheet.Range('E1').Value := 'Anrede';
        Sheet.Range('F1').Value := 'Titel';
        Sheet.Range('G1').Value := 'Vorname';
        Sheet.Range('H1').Value := 'Name';
        Sheet.Range('I1').Value := 'Abteilung';
        Sheet.Range('J1').Value := 'Straáe';
        Sheet.Range('K1').Value := 'Straáe';
        Sheet.Range('L1').Value := 'Nation';
        Sheet.Range('M1').Value := 'PLZ';
        Sheet.Range('N1').Value := 'Ort';
        Sheet.Range('O1').Value := 'Verk„ufer';
        Sheet.Range('P1').Value := 'Betreuer';
        Sheet.Range('Q1').Value := 'Gebiet';
        Sheet.Range('R1').Value := 'Branche';
        Sheet.Range('S1').Value := 'Funktion';
        Sheet.Range('T1').Value := 'Email';
        Sheet.Range('U1').Value := 'Telefon';
        Sheet.Range('V1').Value := 'USER2';
        Sheet.Range('W1').Value := 'Mandant Gesperrt';
        Sheet.Range('X1').Value := 'Person Gesperrt';
        Sheet.Range('Y1').Value := 'Firma verlassen';

        Sheet.Range('AA1').Value := 'AC Solutionpartner';
        Sheet.Range('AB1').Value := 'NO Mailing';
        Sheet.Range('AC1').Value := 'NO ACS';
        Sheet.Range('AD1').Value := 'NO FER';
        Sheet.Range('AE1').Value := 'NO SPL';
        Sheet.Range('AF1').Value := 'NO WIL';
        Sheet.Range('AG1').Value := 'P1 ACS';
        Sheet.Range('AH1').Value := 'P2 FER';
        Sheet.Range('AI1').Value := 'P3 SPL';
        Sheet.Range('AJ1').Value := 'P4 WIL';

        Sheet.Range('AK1').Value := 'SuS Endkunde';
        Sheet.Range('AL1').Value := 'T1 Dienstleist';
        Sheet.Range('AM1').Value := 'T2 IT-Abtl.';
        Sheet.Range('AN1').Value := 'T3 L”sungsanbiet';
        Sheet.Range('AO1').Value := 'T4 Provider reg.';
        Sheet.Range('AP1').Value := 'T5 Provider berreg.';
        Sheet.Range('AQ1').Value := 'T6 Reseller';
        Sheet.Range('AR1').Value := 'T7 Systemhaus';
        Sheet.Range('AS1').Value := 'TP Presse';
        Sheet.Range('AT1').Value := 'L1 Conf/Call Center';
        Sheet.Range('AU1').Value := 'L2 Fax';
        Sheet.Range('AV1').Value := 'L3 IP Telefon';
        Sheet.Range('AW1').Value := 'L4 Lync';
        Sheet.Range('AX1').Value := 'L5 Voice';
        Sheet.Range('AY1').Value := 'Weitere';
        Sheet.Range('AZ1').Value := 'Verteiler1';
        Sheet.Range('BA1').Value := 'Verteiler2';
        Sheet.Range('BB1').Value := 'Verteiler3';
        Sheet.Range('BC1').Value := 'Verteiler4';
        Sheet.Range('BD1').Value := 'Verteiler5';
        Sheet.Range('BE1').Value := 'Verteiler6';
        Sheet.Range('BF1').Value := 'Adr.-Herkunft';
        Sheet.Range('BG1').Value := 'Angebote';
        Sheet.Range('BH1').Value := 'Auftr„ge';
        Sheet.Range('BI1').Value := 'Rechnungen';
        Sheet.Range('BJ1').Value := 'Gutschriften';
        Sheet.Range('BK1').Value := 'Gesperrt';
        Sheet.Range('BL1').Value := 'UN verlassen';
      {
      Sheet.Range('R1').Value := 'AC Solutionpartner';
      Sheet.Range('S1').Value := 'NO Mailing';
      Sheet.Range('T1').Value := 'NO ACS';
      Sheet.Range('U1').Value := 'NO FER';
      Sheet.Range('V1').Value := 'NO SPL';
      Sheet.Range('W1').Value := 'P1 ACS';
      Sheet.Range('X1').Value := 'P2 FER';
      Sheet.Range('Y1').Value := 'P3 SPL';
      Sheet.Range('Z1').Value := 'SuS Endkunde';
      Sheet.Range('AA1').Value := 'T1 Dienstleist';
      Sheet.Range('AB1').Value := 'T2 IT-Abtl.';
      Sheet.Range('AC1').Value := 'T3 L”sungsanbiet';
      Sheet.Range('AD1').Value := 'T4 Provider reg.';
      Sheet.Range('AE1').Value := 'T5 Provider berreg.';
      Sheet.Range('AF1').Value := 'T6 Reseller';
      Sheet.Range('AG1').Value := 'T7 Systemhaus';
      Sheet.Range('AH1').Value := 'TP Presse';
      Sheet.Range('AI1').Value := 'L1 Conf/Call Center';
      Sheet.Range('AJ1').Value := 'L2 Fax';
      Sheet.Range('AK1').Value := 'L3 IP Telefon';
      Sheet.Range('AL1').Value := 'L4 Lync';
      Sheet.Range('AM1').Value := 'L5 Voice';
      Sheet.Range('AN1').Value := 'Weitere';
      Sheet.Range('AO1').Value := 'Verteiler1';
      Sheet.Range('AP1').Value := 'Verteiler2';
      Sheet.Range('AQ1').Value := 'Verteiler3';
      Sheet.Range('AR1').Value := 'Verteiler4';
      Sheet.Range('AS1').Value := 'Verteiler5';
      Sheet.Range('AT1').Value := 'Verteiler6';
      Sheet.Range('AU1').Value := 'Adr.-Herkunft';
      Sheet.Range('AV1').Value := 'Angebote';
      Sheet.Range('AW1').Value := 'Auftr„ge';
      Sheet.Range('AX1').Value := 'Rechnungen';
      Sheet.Range('AY1').Value := 'Gutschriften';
      Sheet.Range('AZ1').Value := 'Gesperrt';
      Sheet.Range('BA1').Value := 'UN verlassen';
      }
        j := '2';

        v_branche1:='';
        v_branche2:='';
        v_branche3:='';
        v_branche4:='';
        v_branche5:='';
        v_branche6:='';
      {
         Sheet.Range('A'+j).Value :=kontakt."No.";
         Sheet.Range('B'+j).Value :=kontakt."First Name";
         Sheet.Range('C'+j).Value :=kontakt.Surname;
         Sheet.Range('D'+j).Value :=kontakt."Company Name";
         Sheet.Range('E'+j).Value :=kontakt."Organizational Level Code";
         Sheet.Range('F'+j).Value :=kontakt."E-Mail";
         IF kontakt."Salutation Code" = 'HERR' THEN
         Sheet.Range('G'+j).Value :='Herr';
         IF kontakt."Salutation Code" = 'FRAU' THEN
         Sheet.Range('G'+j).Value :='Frau';
         Sheet.Range('H'+j).Value :=kontakt."Company No.";
         Sheet.Range('I'+j).Value :=kontakt."Country/Region Code";
         Sheet.Range('J'+j).Value :=kontakt."Post Code";
         Sheet.Range('J'+j).NumberFormat := '00000';
         Sheet.Range('K'+j).Value :=kontakt.City;
         Sheet.Range('L'+j).Value :=kontakt.Abteilung;
         Sheet.Range('M'+j).Value :=kontakt."Salesperson Code";
         Sheet.Range('N'+j).Value :=kontakt."Betreuer Innendienst";
         Sheet.Range('O'+j).Value :=kontakt."Territory Code";

         Sheet.Range('Q'+j).Value :=kontakt."Phone No.";
         Sheet.Range('Q'+j).NumberFormat := '00000000000000000';
      }

      //                Sheet.Range('A'+j).Value := TOPAS_API.CreateExcelHyperlinkToNav(kontakt.TABLENAME,1,5050,kontakt."No.");

        Sheet.Range('A'+j).Value := kontakt."No.";
        Sheet.Range('B'+j).Value :=kontakt.Type;
        IF kontakt.Type=kontakt.Type::Company THEN BEGIN
          Sheet.Range('C'+j).Value :=kontakt.Name;
          Sheet.Range('D'+j).Value :=kontakt."Name 2";
        END ELSE BEGIN
          kontakt1.RESET;
          kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
          IF kontakt1.FINDFIRST THEN BEGIN
            Sheet.Range('C'+j).Value :=kontakt1.Name;
            Sheet.Range('D'+j).Value :=kontakt1."Name 2";
          END;
        END;
        IF kontakt."Salutation Code" = 'HERR' THEN Sheet.Range('E'+j).Value :='Herr';
        IF kontakt."Salutation Code" = 'FRAU' THEN Sheet.Range('E'+j).Value :='Frau';
        Sheet.Range('F'+j).Value :=kontakt."Job Title";
        Sheet.Range('G'+j).Value :=kontakt."First Name";
        Sheet.Range('H'+j).Value :=kontakt.Surname;
        Sheet.Range('I'+j).Value :=kontakt.Abteilung;
        Sheet.Range('J'+j).Value :=kontakt.Address;
        Sheet.Range('K'+j).Value :=kontakt."Address 2";
        Sheet.Range('L'+j).Value :=kontakt."Country/Region Code";
        Sheet.Range('M'+j).Value :=kontakt."Post Code";
        Sheet.Range('M'+j).NumberFormat := '00000';
        Sheet.Range('N'+j).Value :=kontakt.City;
        Sheet.Range('O'+j).Value :=kontakt."Salesperson Code";
        Sheet.Range('P'+j).Value :=kontakt."Betreuer Innendienst";
        Sheet.Range('Q'+j).Value :=kontakt."Territory Code";
        Sheet.Range('R'+j).Value :=kontakt."No. of Industry Groups";
        Sheet.Range('S'+j).Value :=kontakt."Organizational Level Code";
        Sheet.Range('T'+j).Value :=kontakt."E-Mail";
        Sheet.Range('U'+j).Value :=kontakt."Phone No.";
        Sheet.Range('U'+j).NumberFormat := '00000000000000000';
        Sheet.Range('V'+j).Value :=kontakt."Company No.";
        Sheet.Range('X'+j).Value :=kontakt.Gesperrt;
        kontakt1.RESET;
        kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
        IF kontakt1.FINDFIRST THEN BEGIN
          Sheet.Range('W'+j).Value :=kontakt1.Gesperrt;
        END;
        Sheet.Range('Y'+j).Value :=kontakt."Unternehmen verlassen";
        Sheet.Range('AA'+j).Value :=kontakt.AC_Solutionpartner;
        Sheet.Range('BK'+j).Value :=kontakt.Gesperrt;
        Sheet.Range('BL'+j).Value :=kontakt."Unternehmen verlassen";

      // Branchenauswertung
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','NO-MAILING');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AB'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-ACS');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AC'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-FER');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AD'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-SPL');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AE'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-WIL');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AF'+j).Value :=branche."Industry Group Code";
        END;

        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P1');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AG'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P2');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AH'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P3');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AI'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P4');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AI'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-ENDK');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AK'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T1');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AL'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T2');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AM'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T3');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AN'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T4');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AO'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T5');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AP'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T6');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AQ'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T7');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AR'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-TP');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AS'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L1');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AT'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L2');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AU'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L3');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AV'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L4');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AW'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L5');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AX'+j).Value :=branche."Industry Group Code";
        END;
      {
         branche.RESET;
         branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
         branche.SETFILTER(branche."Industry Group Code",'%1..%2','SUS-Z','Z');
         IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AY'+j).Value :=branche."Industry Group Code";
         END;
      }
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('AZ'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler1:=verteiler."Mailing Group Code";
        END;
      //  Verteilereintrag des Mandanten abfragen
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."Company No.");
      //   verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5',v_verteiler1,v_verteiler2,v_verteiler3
      //   ,v_verteiler4,v_verteiler5);
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('AZ'+j).Value :='Mandant';
          v_verteiler1:='Mandant';
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1',v_verteiler1);
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('BA'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler2:=verteiler."Mailing Group Code"
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2',v_verteiler1,v_verteiler2);
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('BB'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler3:=verteiler."Mailing Group Code"
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3',v_verteiler1,v_verteiler2,v_verteiler3);
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('BC'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler4:=verteiler."Mailing Group Code"
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4);
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('BD'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler5:=verteiler."Mailing Group Code"
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4,v_verteiler5);
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('BE'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler6:=verteiler."Mailing Group Code"
        END;

      //  Verteilereintrag des Mandanten abfragen
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."Company No.");
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('AY'+j).Value :=verteiler."Mailing Group Code"+' Mandant';
      //      v_verteiler6:=(verteiler."Mailing Group Code"+' Mandant');
        END;
        kon_deb.RESET;
        kon_deb.SETFILTER(kon_deb."Contact No.",'%1',kontakt."Company No.");
      //        Kon_deb.CALCFIELDS("Business Relation Code");
        kon_deb.SETFILTER(kon_deb."Business Relation Code",'%1','DEB');
        IF kon_deb.FINDFIRST THEN BEGIN
          v_au:='';
          v_re:='';
          v_an:='';
          v_gu:='';
          v_art:='';
          belege.RESET;
          belege.SETFILTER(belege."Debitornr.",'%1',kon_deb."No.");
          IF ((v_datum_von=0D) AND (v_datum_bis=0D)) THEN BEGIN
          END ELSE BEGIN
            belege.SETFILTER(belege.Belegdatum,'%1..%2',v_datum_von,v_datum_bis);
          END;
          IF ((v_hersteller1='') AND (v_hersteller2='') AND (v_hersteller3='') AND (v_hersteller4='') AND (v_hersteller5='')) THEN BEGIN
          END ELSE BEGIN
            belege.SETFILTER(belege.Herstellercode,'%1|%2|%3|%4|%5',v_hersteller1,v_hersteller2,v_hersteller3,v_hersteller4,v_hersteller5);
          END;
      //            IF v_hersteller='' THEN BEGIN
      //            END ELSE BEGIN
      //            belege.SETFILTER(belege.Herstellercode,'%1',v_hersteller);
      //            END;
      //             belege.SETFILTER(belege.Herstellercode,'%1|%2','82','85');

          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
          IF belege.FINDFIRST THEN BEGIN
            v_an:='AN';
            v_art:='Belege '+v_hersteller1+v_hersteller2+v_hersteller3+v_hersteller4+v_hersteller5;;
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
          IF belege.FINDFIRST THEN BEGIN
            v_au:='AU';
            v_art:='Belege '+v_hersteller1+v_hersteller2+v_hersteller3+v_hersteller4+v_hersteller5;;
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
          IF belege.FINDFIRST THEN BEGIN
            v_re:='RE';
            v_art:='Belege '+v_hersteller1+v_hersteller2+v_hersteller3+v_hersteller4+v_hersteller5;;
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
          IF belege.FINDFIRST THEN BEGIN
            v_gu:='GU';
            v_art:='Belege '+v_hersteller1+v_hersteller2+v_hersteller3+v_hersteller4+v_hersteller5;;
          END;
          Sheet.Range('BF'+j).Value :=v_art;
          Sheet.Range('BG'+j).Value :=v_an;
          Sheet.Range('BH'+j).Value :=v_au;
          Sheet.Range('BI'+j).Value :=v_re;
          Sheet.Range('BJ'+j).Value :=v_gu;
          Sheet.Range('BK'+j).Value :=kontakt.Gesperrt;
          Sheet.Range('BL'+j).Value :=kontakt."Unternehmen verlassen";
        END;
        j:=INCSTR(j);
      END ELSE BEGIN
      //kontakt.RESET;
      //IF v_kontaktnr='' THEN BEGIN
      //kontakt.SETFILTER(kontakt."Company No.",'<>%1','');
      ////kontakt.SETFILTER(kontakt."Company No.",'>%1','KT031000');
      //END ELSE BEGIN
      //kontakt.SETFILTER(kontakt."Company No.",'%1',v_kontaktnr);
      //END;
      //kontakt.SETFILTER(kontakt.Gesperrt,'%1',FALSE);
      //kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Person);
      //IF kontakt.FIND('-') THEN BEGIN
      //REPEAT
        v_branche1:='';
        v_branche2:='';
        v_branche3:='';
        v_branche4:='';
        v_branche5:='';
        v_branche6:='';
      {
         Sheet.Range('A'+j).Value :=kontakt."No.";
         Sheet.Range('B'+j).Value :=kontakt."First Name";
         Sheet.Range('C'+j).Value :=kontakt.Surname;
         Sheet.Range('D'+j).Value :=kontakt."Company Name";
         Sheet.Range('E'+j).Value :=kontakt."Organizational Level Code";
         Sheet.Range('F'+j).Value :=kontakt."E-Mail";
         IF kontakt."Salutation Code" = 'HERR' THEN
         Sheet.Range('G'+j).Value :='Herr';
         IF kontakt."Salutation Code" = 'FRAU' THEN
         Sheet.Range('G'+j).Value :='Frau';
         Sheet.Range('H'+j).Value :=kontakt."Company No.";
         Sheet.Range('I'+j).Value :=kontakt."Country/Region Code";
         Sheet.Range('J'+j).Value :=kontakt."Post Code";
         Sheet.Range('J'+j).NumberFormat := '00000';
         Sheet.Range('K'+j).Value :=kontakt.City;
         Sheet.Range('L'+j).Value :=kontakt.Abteilung;
         Sheet.Range('M'+j).Value :=kontakt."Salesperson Code";
         Sheet.Range('N'+j).Value :=kontakt."Betreuer Innendienst";
         Sheet.Range('O'+j).Value :=kontakt."Territory Code";

         Sheet.Range('Q'+j).Value :=kontakt."Phone No.";
         Sheet.Range('Q'+j).NumberFormat := '00000000000000000';
       }
      //  Sheet.Range('A'+j).Value := TOPAS_API.CreateExcelHyperlinkToNav(kontakt.TABLENAME,1,5050,kontakt."No.");
        Sheet.Range('A'+j).Value :=kontakt."No.";
        Sheet.Range('B'+j).Value :=kontakt.Type;
        IF kontakt.Type=kontakt.Type::Company THEN BEGIN
          Sheet.Range('C'+j).Value :=kontakt.Name;
          Sheet.Range('D'+j).Value :=kontakt."Name 2";
        END ELSE BEGIN
          kontakt1.RESET;
          kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
          IF kontakt1.FINDFIRST THEN BEGIN
            Sheet.Range('C'+j).Value :=kontakt1.Name;
            Sheet.Range('D'+j).Value :=kontakt1."Name 2";
          END;
        END;
        IF kontakt."Salutation Code" = 'HERR' THEN Sheet.Range('E'+j).Value :='Herr';
        IF kontakt."Salutation Code" = 'FRAU' THEN Sheet.Range('E'+j).Value :='Frau';
        Sheet.Range('F'+j).Value :=kontakt."Job Title";
        Sheet.Range('G'+j).Value :=kontakt."First Name";
        Sheet.Range('H'+j).Value :=kontakt.Surname;
        Sheet.Range('I'+j).Value :=kontakt.Abteilung;
        Sheet.Range('J'+j).Value :=kontakt.Address;
        Sheet.Range('K'+j).Value :=kontakt."Address 2";
        Sheet.Range('L'+j).Value :=kontakt."Country/Region Code";
        Sheet.Range('M'+j).Value :=kontakt."Post Code";
        Sheet.Range('M'+j).NumberFormat := '00000';
        Sheet.Range('N'+j).Value :=kontakt.City;
        Sheet.Range('O'+j).Value :=kontakt."Salesperson Code";
        Sheet.Range('P'+j).Value :=kontakt."Betreuer Innendienst";
        Sheet.Range('Q'+j).Value :=kontakt."Territory Code";
        Sheet.Range('R'+j).Value :=kontakt."No. of Industry Groups";
        Sheet.Range('S'+j).Value :=kontakt."Organizational Level Code";
        Sheet.Range('T'+j).Value :=kontakt."E-Mail";
        Sheet.Range('U'+j).Value :=kontakt."Phone No.";
        Sheet.Range('U'+j).NumberFormat := '00000000000000000';
        Sheet.Range('V'+j).Value :=kontakt."Company No.";
        Sheet.Range('X'+j).Value :=kontakt.Gesperrt;
        kontakt1.RESET;
        kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
        IF kontakt1.FINDFIRST THEN BEGIN
          Sheet.Range('W'+j).Value :=kontakt1.Gesperrt;
        END;
        Sheet.Range('Y'+j).Value :=kontakt."Unternehmen verlassen";
        Sheet.Range('AA'+j).Value :=kontakt.AC_Solutionpartner;
        Sheet.Range('BK'+j).Value :=kontakt.Gesperrt;
        Sheet.Range('BL'+j).Value :=kontakt."Unternehmen verlassen";

      // Branchenauswertung
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','NO-MAILING');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AB'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-ACS');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AC'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-FER');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AD'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-SPL');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AE'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-WIL');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AF'+j).Value :=branche."Industry Group Code";
        END;

        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P1');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AG'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P2');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AH'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P3');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AI'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P4');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AJ'+j).Value :=branche."Industry Group Code";
        END;

        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-ENDK');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AK'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T1');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AL'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T2');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AM'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T3');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AN'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T4');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AO'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T5');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AP'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T6');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AQ'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T7');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AR'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-TP');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AS'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L1');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AT'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L2');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AU'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L3');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AV'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L4');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AW'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L5');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AX'+j).Value :=branche."Industry Group Code";
        END;
      {
         branche.RESET;
         branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
         branche.SETFILTER(branche."Industry Group Code",'%1..%2','SUS-Z','Z');
         IF branche.FINDFIRST THEN BEGIN
      //    Sheet.Range('AN'+j).Value :='weitere';
           Sheet.Range('AY'+j).Value :=branche."Industry Group Code";
         END;
      }
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('AZ'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler1:=verteiler."Mailing Group Code";
        END;
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1',v_verteiler1);
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('BA'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler2:=verteiler."Mailing Group Code"
        END;
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2',v_verteiler1,v_verteiler2);
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('BB'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler3:=verteiler."Mailing Group Code"
        END;
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3',v_verteiler1,v_verteiler2,v_verteiler3);
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('BC'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler4:=verteiler."Mailing Group Code"
        END;
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4);
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('BD'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler5:=verteiler."Mailing Group Code"
        END;
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4,v_verteiler5);
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('BE'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler6:=verteiler."Mailing Group Code"
        END;
      //  Verteilereintrag des Mandanten abfragen
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."Company No.");
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('AZ'+j).Value :=verteiler."Mailing Group Code"+' Mandant';
      //      v_verteiler6:=(verteiler."Mailing Group Code"+' Mandant');
        END;
        kon_deb.RESET;
        kon_deb.SETFILTER(kon_deb."Contact No.",'%1',kontakt."Company No.");
      //        Kon_deb.CALCFIELDS("Business Relation Code");
        kon_deb.SETFILTER(kon_deb."Business Relation Code",'%1','DEB');
        IF kon_deb.FINDFIRST THEN BEGIN
          v_au:='';
          v_re:='';
          v_an:='';
          v_gu:='';
          v_art:='';
          belege.RESET;
          belege.SETFILTER(belege."Debitornr.",'%1',kon_deb."No.");
          IF ((v_datum_von=0D) AND (v_datum_bis=0D)) THEN BEGIN
          END ELSE BEGIN
            belege.SETFILTER(belege.Belegdatum,'%1..%2',v_datum_von,v_datum_bis);
          END;
          IF ((v_hersteller1='') AND (v_hersteller2='') AND (v_hersteller3='') AND (v_hersteller4='') AND (v_hersteller5='')) THEN BEGIN
          END ELSE BEGIN
            belege.SETFILTER(belege.Herstellercode,'%1|%2|%3|%4|%5',v_hersteller1,v_hersteller2,v_hersteller3,v_hersteller4,v_hersteller5);
          END;
      //            IF v_hersteller='' THEN BEGIN
      //            END ELSE BEGIN
      //            belege.SETFILTER(belege.Herstellercode,'%1',v_hersteller);
      //            END;
      //             belege.SETFILTER(belege.Herstellercode,'%1|%2','82','85');

          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
          IF belege.FINDFIRST THEN BEGIN
            v_an:='AN';
            v_art:='Belege '+v_hersteller1+v_hersteller2+v_hersteller3+v_hersteller4+v_hersteller5;;
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
          IF belege.FINDFIRST THEN BEGIN
            v_au:='AU';
            v_art:='Belege '+v_hersteller1+v_hersteller2+v_hersteller3+v_hersteller4+v_hersteller5;;
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
          IF belege.FINDFIRST THEN BEGIN
            v_re:='RE';
            v_art:='Belege '+v_hersteller1+v_hersteller2+v_hersteller3+v_hersteller4+v_hersteller5;;
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
          IF belege.FINDFIRST THEN BEGIN
            v_gu:='GU';
            v_art:='Belege '+v_hersteller1+v_hersteller2+v_hersteller3+v_hersteller4+v_hersteller5;;
          END;
          Sheet.Range('BF'+j).Value :=v_art;
          Sheet.Range('BG'+j).Value :=v_an;
          Sheet.Range('BH'+j).Value :=v_au;
          Sheet.Range('BI'+j).Value :=v_re;
          Sheet.Range('BJ'+j).Value :=v_gu;
          Sheet.Range('BK'+j).Value :=kontakt.Gesperrt;
          Sheet.Range('BL'+j).Value :=kontakt."Unternehmen verlassen";
        END;
        j:=INCSTR(j);
      //UNTIL branche.NEXT=0;
      //END;
      END;
    END;

    PROCEDURE Ansprech_gesperrt_Mandant_nich@1140027();
    BEGIN
      kontakt.RESET;
      kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Person);
      //kontakt.SETFILTER(kontakt.Gesperrt,'%1',kontakt.Gesperrt::YES);
      //kontakt.SETFILTER(Gesperrt,'TRUE');
      kontakt.SETFILTER(kontakt."Salesperson Code",'%1','ML');
      IF kontakt.FIND('-') THEN BEGIN
        REPEAT
          IF kontakt."Unternehmen verlassen"=TRUE THEN BEGIN
      //    IF kontakt.Gesperrt=TRUE THEN BEGIN
            Andruckverwaltung;
          END ELSE BEGIN
          END;
      //   kontakt.RESET;
      //   kontakt.SETFILTER(kontakt."No.",'%1',kontakt1."Company No.");
      //   kontakt.SETFILTER(kontakt.Gesperrt,'%1',FALSE);
      //     IF kontakt.FIND('-') THEN BEGIN
      //      REPEAT
      //        Andruckverwaltung;
      ////        Adressverwaltung;
      //      UNTIL kontakt.NEXT=0;
      //     END;
        UNTIL kontakt.NEXT=0;
      END;

      //     Andruckverwaltung;
      CloseExcel('Liste','Liste','F:\Daten Neu\User\Uwe\Mailing');
      MESSAGE(Text003);
    END;

    PROCEDURE Adr_Emailversand1@1140032();
    BEGIN
      //   error('Adr Emailversand1');
      IF v_z„hler=1 THEN BEGIN
        CREATE (Excel,FALSE,TRUE);                                           //erzeugt excel
        Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
        Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
        Excel.Visible(TRUE);
      {
      Sheet.Range('A1').Value := 'USER1';
      Sheet.Range('B1').Value := 'Vorname';
      Sheet.Range('C1').Value := 'Name';
      Sheet.Range('D1').Value := 'Firma';
      Sheet.Range('E1').Value := 'Funktion';
      Sheet.Range('F1').Value := 'Email';
      Sheet.Range('G1').Value := 'Anrede';
      Sheet.Range('H1').Value := 'USER2';
      Sheet.Range('I1').Value := 'Nation';
      Sheet.Range('J1').Value := 'PLZ';
      Sheet.Range('K1').Value := 'Ort';
      Sheet.Range('L1').Value := 'Abteilung';
      Sheet.Range('M1').Value := 'Verk„ufer';
      Sheet.Range('N1').Value := 'Betreuer';
      Sheet.Range('O1').Value := 'Gebiet';
      Sheet.Range('P1').Value := 'Branche';
      Sheet.Range('Q1').Value := 'Telefon';
      }
        Sheet.Range('A1').Value := 'USER1';
        Sheet.Range('B1').Value := 'Art';
        Sheet.Range('C1').Value := 'Firma';
        Sheet.Range('D1').Value := 'Firma2';
        Sheet.Range('E1').Value := 'Anrede';
        Sheet.Range('F1').Value := 'Titel';
        Sheet.Range('G1').Value := 'Vorname';
        Sheet.Range('H1').Value := 'Name';
        Sheet.Range('I1').Value := 'Abteilung';
        Sheet.Range('J1').Value := 'Straáe';
        Sheet.Range('K1').Value := 'Straáe';
        Sheet.Range('L1').Value := 'Nation';
        Sheet.Range('M1').Value := 'PLZ';
        Sheet.Range('N1').Value := 'Ort';
        Sheet.Range('O1').Value := 'Verk„ufer';
        Sheet.Range('P1').Value := 'Betreuer';
        Sheet.Range('Q1').Value := 'Gebiet';
        Sheet.Range('R1').Value := 'Branche';
        Sheet.Range('S1').Value := 'Funktion';
        Sheet.Range('T1').Value := 'Email';
        Sheet.Range('U1').Value := 'Telefon';
        Sheet.Range('V1').Value := 'USER2';
        Sheet.Range('W1').Value := 'Mandant Gesperrt';
        Sheet.Range('X1').Value := 'Person Gesperrt';
        Sheet.Range('Y1').Value := 'Firma verlassen';
        Sheet.Range('AA1').Value := 'AC Solutionpartner';
        Sheet.Range('AB1').Value := 'Innovator';
        Sheet.Range('AC1').Value := 'Auftragsentwickl.';
        Sheet.Range('AD1').Value := 'Branche1';
        Sheet.Range('AE1').Value := 'Branche2';
        Sheet.Range('AF1').Value := 'Branche3';
        Sheet.Range('AG1').Value := 'Branche4';
        Sheet.Range('AH1').Value := 'Branche5';
        Sheet.Range('AI1').Value := 'Branche6';
        Sheet.Range('AJ1').Value := 'Branche7';
        Sheet.Range('AK1').Value := 'Branche8';
        Sheet.Range('AL1').Value := 'Branche9';
        Sheet.Range('AM1').Value := 'Branche10';
        Sheet.Range('AN1').Value := 'Branche11';
        Sheet.Range('AO1').Value := 'Branche12';
        Sheet.Range('AP1').Value := 'Branche13';
        Sheet.Range('AQ1').Value := 'Branche14';
        Sheet.Range('AR1').Value := 'Branche15';
        Sheet.Range('AS1').Value := 'Verteiler1';
        Sheet.Range('AT1').Value := 'Verteiler2';
        Sheet.Range('AU1').Value := 'Verteiler3';
        Sheet.Range('AV1').Value := 'Verteiler4';
        Sheet.Range('AW1').Value := 'Verteiler5';
        Sheet.Range('AX1').Value := 'Verteiler6';
        Sheet.Range('AY1').Value := 'Adr.-Herkunft';
        Sheet.Range('AZ1').Value := 'Angebote';
        Sheet.Range('BA1').Value := 'Auftr„ge';
        Sheet.Range('BB1').Value := 'Rechnungen';
        Sheet.Range('BC1').Value := 'Gutschriften';
        Sheet.Range('BD1').Value := 'Gesperrt';
        Sheet.Range('BE1').Value := 'Firma verlassen';
        Sheet.Range('BF1').Value := 'Memo_Datum';
        Sheet.Range('BG1').Value := 'Memo Kurztext';
        j := '2';
      END ELSE BEGIN
        v_branche1:='';
        v_branche2:='';
        v_branche3:='';
        v_branche4:='';
        v_branche5:='';
        v_branche6:='';
      {
        Sheet.Range('A'+j).Value :=kontakt."No.";
        Sheet.Range('B'+j).Value :=kontakt."First Name";
        Sheet.Range('C'+j).Value :=kontakt.Surname;
        Sheet.Range('D'+j).Value :=kontakt."Company Name";
        Sheet.Range('E'+j).Value :=kontakt."Organizational Level Code";
        Sheet.Range('F'+j).Value :=kontakt."E-Mail";
        IF kontakt."Salutation Code" = 'HERR' THEN Sheet.Range('G'+j).Value :='Herr';
        IF kontakt."Salutation Code" = 'FRAU' THEN Sheet.Range('G'+j).Value :='Frau';
        Sheet.Range('H'+j).Value :=kontakt."Company No.";
        Sheet.Range('I'+j).Value :=kontakt."Country/Region Code";
        Sheet.Range('J'+j).Value :=kontakt."Post Code";
        Sheet.Range('J'+j).NumberFormat := '00000';
        Sheet.Range('K'+j).Value :=kontakt.City;
        Sheet.Range('L'+j).Value :=kontakt.Abteilung;
        Sheet.Range('M'+j).Value :=kontakt."Salesperson Code";
        Sheet.Range('N'+j).Value :=kontakt."Betreuer Innendienst";
        Sheet.Range('O'+j).Value :=kontakt."Territory Code";
        Sheet.Range('Q'+j).Value :=kontakt."Phone No.";
        Sheet.Range('Q'+j).NumberFormat := '00000000000000000';
      }
        Sheet.Range('A'+j).Value :=kontakt."No.";
        Sheet.Range('B'+j).Value :=kontakt.Type;
        IF kontakt.Type=kontakt.Type::Company THEN BEGIN
          Sheet.Range('C'+j).Value :=kontakt.Name;
          Sheet.Range('D'+j).Value :=kontakt."Name 2";
        END ELSE BEGIN
          kontakt1.RESET;
          kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
          IF kontakt1.FINDFIRST THEN BEGIN
            Sheet.Range('C'+j).Value :=kontakt1.Name;
            Sheet.Range('D'+j).Value :=kontakt1."Name 2";
          END;
        END;
        IF kontakt."Salutation Code" = 'HERR' THEN Sheet.Range('E'+j).Value :='Herr';
        IF kontakt."Salutation Code" = 'FRAU' THEN Sheet.Range('E'+j).Value :='Frau';
        Sheet.Range('F'+j).Value :=kontakt."Job Title";
        Sheet.Range('G'+j).Value :=kontakt."First Name";
        Sheet.Range('H'+j).Value :=kontakt.Surname;
        Sheet.Range('I'+j).Value :=kontakt.Abteilung;
        Sheet.Range('J'+j).Value :=kontakt.Address;
        Sheet.Range('K'+j).Value :=kontakt."Address 2";
        Sheet.Range('L'+j).Value :=kontakt."Country/Region Code";
        Sheet.Range('M'+j).Value :=kontakt."Post Code";
        Sheet.Range('M'+j).NumberFormat := '00000';
        Sheet.Range('N'+j).Value :=kontakt.City;
        Sheet.Range('O'+j).Value :=kontakt."Salesperson Code";
        Sheet.Range('P'+j).Value :=kontakt."Betreuer Innendienst";
        Sheet.Range('Q'+j).Value :=kontakt."Territory Code";
        Sheet.Range('R'+j).Value :=kontakt."No. of Industry Groups";
        Sheet.Range('S'+j).Value :=kontakt."Organizational Level Code";
        Sheet.Range('T'+j).Value :=kontakt."E-Mail";
        Sheet.Range('U'+j).Value :=kontakt."Phone No.";
        Sheet.Range('U'+j).NumberFormat := '00000000000000000';
        Sheet.Range('V'+j).Value :=kontakt."Company No.";
        Sheet.Range('X'+j).Value :=kontakt.Gesperrt;
        kontakt1.RESET;
        kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
        IF kontakt1.FINDFIRST THEN BEGIN
          Sheet.Range('W'+j).Value :=kontakt1.Gesperrt;
        END;
        Sheet.Range('Y'+j).Value :=kontakt."Unternehmen verlassen";
        Sheet.Range('AA'+j).Value :=kontakt.AC_Solutionpartner;
        Sheet.Range('BD'+j).Value :=kontakt.Gesperrt;
        Sheet.Range('BE'+j).Value :=kontakt."Unternehmen verlassen";
      // Branchenauswertung
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1|%2|%3|%4|%5','1-INNOVATO','2-EARL ADO','3-EARL MAJ','4-LATE MAJ','5-LAGGARDS');
        IF branche.FINDFIRST THEN BEGIN
          Sheet.Range('AB'+j).Value :=branche."Industry Group Code";
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','AUFTR-ENTW');
        IF branche."Industry Group Code"='AUFTR-ENTW' THEN BEGIN
          Sheet.Range('AC'+j).Value :=branche."Industry Group Code";
        END;
      //  Branche Neu Start   ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        branche.RESET;
        v_branche:=0;
        v_branche1:='';
        v_branche2:='';
        v_branche3:='';
        v_branche4:='';
        v_branche5:='';
        v_branche6:='';
        v_branche7:='';
        v_branche8:='';
        v_branche9:='';
        v_branche10:='';
        v_branche11:='';
        v_branche12:='';
        v_branche13:='';
        v_branche14:='';
        v_branche15:='';
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5&<>%6','1-INNOVATO','2-EARL ADO','3-EARL MAJ','4-LATE MAJ','5-LAGGARDS','AUFTR-ENTW');
        IF branche.FIND('-') THEN BEGIN
          REPEAT
            v_branche:=v_branche+1;
            IF v_branche = 1 THEN  v_branche1:=branche."Industry Group Code";
            IF v_branche = 2 THEN  v_branche2:=branche."Industry Group Code";
            IF v_branche = 3 THEN  v_branche3:=branche."Industry Group Code";
            IF v_branche = 4 THEN  v_branche4:=branche."Industry Group Code";
            IF v_branche = 5 THEN  v_branche5:=branche."Industry Group Code";
            IF v_branche = 6 THEN  v_branche6:=branche."Industry Group Code";
            IF v_branche = 7 THEN  v_branche7:=branche."Industry Group Code";
            IF v_branche = 8 THEN  v_branche8:=branche."Industry Group Code";
            IF v_branche = 9 THEN  v_branche9:=branche."Industry Group Code";
            IF v_branche =10 THEN  v_branche10:=branche."Industry Group Code";
            IF v_branche =11 THEN  v_branche11:=branche."Industry Group Code";
            IF v_branche =12 THEN  v_branche12:=branche."Industry Group Code";
            IF v_branche =13 THEN  v_branche13:=branche."Industry Group Code";
            IF v_branche =14 THEN  v_branche14:=branche."Industry Group Code";
            IF v_branche =15 THEN  v_branche15:=branche."Industry Group Code";
          UNTIL branche.NEXT=0;
        END;
        Sheet.Range('AD'+j).Value :=v_branche1;
        Sheet.Range('AE'+j).Value :=v_branche2;
        Sheet.Range('AF'+j).Value :=v_branche3;
        Sheet.Range('AG'+j).Value :=v_branche4;
        Sheet.Range('AH'+j).Value :=v_branche5;
        Sheet.Range('AI'+j).Value :=v_branche6;
        Sheet.Range('AJ'+j).Value :=v_branche7;
        Sheet.Range('AK'+j).Value :=v_branche8;
        Sheet.Range('AL'+j).Value :=v_branche9;
        Sheet.Range('AM'+j).Value :=v_branche10;
        Sheet.Range('AN'+j).Value :=v_branche11;
        Sheet.Range('AO'+j).Value :=v_branche12;
        Sheet.Range('AP'+j).Value :=v_branche13;
        Sheet.Range('AQ'+j).Value :=v_branche14;
        Sheet.Range('AR'+j).Value :=v_branche15;
        IF v_branche>15 THEN  Sheet.Range('AI'+j).Value :='Fehler';
      //  Branche Neu Ende  ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('AS'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler1:=verteiler."Mailing Group Code";
        END;
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1',v_verteiler1);
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('AT'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler2:=verteiler."Mailing Group Code"
        END;
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2',v_verteiler1,v_verteiler2);
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('AU'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler3:=verteiler."Mailing Group Code"
        END;
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3',v_verteiler1,v_verteiler2,v_verteiler3);
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('AV'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler4:=verteiler."Mailing Group Code"
        END;
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4);
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('AW'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler5:=verteiler."Mailing Group Code"
        END;
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4,v_verteiler5);
        IF verteiler.FINDFIRST THEN BEGIN
          Sheet.Range('AX'+j).Value :=verteiler."Mailing Group Code";
          v_verteiler6:=verteiler."Mailing Group Code"
        END;
      //  Verteilereintrag des Mandanten abfragen
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."Company No.");
        IF verteiler.FINDFIRST THEN BEGIN
          v_verteiler6:=(verteiler."Mailing Group Code"+' Mandant');
        END;
        v_an:='';
        v_au:='';
        v_re:='';
        v_gu:='';
        v_art:='';
        belege.RESET;
        belege.SETFILTER(belege."Debitornr.",'%1',debitor."No.");
        IF ((v_datum_von=0D) AND (v_datum_bis=0D)) THEN BEGIN
        END ELSE BEGIN
          belege.SETFILTER(belege.Belegdatum,'%1..%2',v_datum_von,v_datum_bis);
        END;
        belege.SETFILTER(belege.Herstellercode,'%1',v_hersteller1);
        IF belege.FINDFIRST THEN BEGIN
          v_art:='Belege '+v_hersteller1;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
          IF belege.FINDFIRST THEN BEGIN
            v_an:='AN ';
            v_an:=v_an+v_hersteller1;
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
          IF belege.FINDFIRST THEN BEGIN
            v_au:='AU ';
            v_au:=v_au+v_hersteller1;
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
          IF belege.FINDFIRST THEN BEGIN
            v_re:='RE ';
            v_re:=v_re+v_hersteller1;
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
          IF belege.FINDFIRST THEN BEGIN
            v_gu:='GU ';
            v_gu:=v_gu+v_hersteller1;
          END;
        END;
        belege.RESET;
        belege.SETFILTER(belege."Debitornr.",'%1',debitor."No.");
        IF ((v_datum_von=0D) AND (v_datum_bis=0D)) THEN BEGIN
        END ELSE BEGIN
          belege.SETFILTER(belege.Belegdatum,'%1..%2',v_datum_von,v_datum_bis);
        END;
        belege.SETFILTER(belege.Herstellercode,'%1',v_hersteller2);
        IF belege.FINDFIRST THEN BEGIN
          IF v_art='' THEN BEGIN
            v_art:='Belege '+v_hersteller2;
          END ELSE BEGIN
            v_art:=v_art+' '+v_hersteller2;
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
          IF belege.FINDFIRST THEN BEGIN
            IF v_an='' THEN v_an:='AN';
            v_an:=v_an+' '+v_hersteller2;
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
          IF belege.FINDFIRST THEN BEGIN
            IF v_au='' THEN v_au:='AU';
            v_au:=v_au+' '+v_hersteller2;
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
          IF belege.FINDFIRST THEN BEGIN
            IF v_re='' THEN v_re:='RE';
            v_re:=v_re+' '+v_hersteller2;
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
          IF belege.FINDFIRST THEN BEGIN
            IF v_gu='' THEN v_gu:='GU';
            v_gu:=v_gu+' '+v_hersteller2;
          END;
        END;
        belege.RESET;
        belege.SETFILTER(belege."Debitornr.",'%1',debitor."No.");
        IF ((v_datum_von=0D) AND (v_datum_bis=0D)) THEN BEGIN
        END ELSE BEGIN
          belege.SETFILTER(belege.Belegdatum,'%1..%2',v_datum_von,v_datum_bis);
        END;
        belege.SETFILTER(belege.Herstellercode,'%1',v_hersteller3);
        IF belege.FINDFIRST THEN BEGIN
          IF v_art='' THEN BEGIN
            v_art:='Belege '+v_hersteller3;
          END ELSE BEGIN
            v_art:=v_art+' '+v_hersteller3;
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
          IF belege.FINDFIRST THEN BEGIN
            IF v_an='' THEN v_an:='AN';
            v_an:=v_an+' '+v_hersteller3;
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
          IF belege.FINDFIRST THEN BEGIN
            IF v_au='' THEN v_au:='AU';
            v_au:=v_au+' '+v_hersteller3;
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
          IF belege.FINDFIRST THEN BEGIN
            IF v_re='' THEN v_re:='RE';
            v_re:=v_re+' '+v_hersteller3;
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
          IF belege.FINDFIRST THEN BEGIN
            IF v_gu='' THEN v_gu:='GU';
            v_gu:=v_gu+' '+v_hersteller3;
          END;
        END;
        belege.RESET;
        belege.SETFILTER(belege."Debitornr.",'%1',debitor."No.");
        IF ((v_datum_von=0D) AND (v_datum_bis=0D)) THEN BEGIN
        END ELSE BEGIN
          belege.SETFILTER(belege.Belegdatum,'%1..%2',v_datum_von,v_datum_bis);
        END;
        belege.SETFILTER(belege.Herstellercode,'%1',v_hersteller4);
        IF belege.FINDFIRST THEN BEGIN
          IF v_art='' THEN BEGIN
            v_art:='Belege '+v_hersteller4;
          END ELSE BEGIN
            v_art:=v_art+' '+v_hersteller4;
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
          IF belege.FINDFIRST THEN BEGIN
            IF v_an='' THEN v_an:='AN';
            v_an:=v_an+' '+v_hersteller4;
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
          IF belege.FINDFIRST THEN BEGIN
            IF v_au='' THEN v_au:='AU';
            v_au:=v_au+' '+v_hersteller4;
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
          IF belege.FINDFIRST THEN BEGIN
            IF v_re='' THEN v_re:='RE';
            v_re:=v_re+' '+v_hersteller4;
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
          IF belege.FINDFIRST THEN BEGIN
            IF v_gu='' THEN v_gu:='GU';
            v_gu:=v_gu+' '+v_hersteller4;
          END;
        END;
        belege.RESET;
        belege.SETFILTER(belege."Debitornr.",'%1',debitor."No.");
        IF ((v_datum_von=0D) AND (v_datum_bis=0D)) THEN BEGIN
        END ELSE BEGIN
          belege.SETFILTER(belege.Belegdatum,'%1..%2',v_datum_von,v_datum_bis);
        END;
        belege.SETFILTER(belege.Herstellercode,'%1',v_hersteller5);
        IF belege.FINDFIRST THEN BEGIN
          IF v_art='' THEN BEGIN
            v_art:='Belege '+v_hersteller5;
          END ELSE BEGIN
            v_art:=v_art+' '+v_hersteller5;
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
          IF belege.FINDFIRST THEN BEGIN
            IF v_an='' THEN v_an:='AN';
            v_an:=v_an+' '+v_hersteller5;
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
          IF belege.FINDFIRST THEN BEGIN
            IF v_au='' THEN v_au:='AU';
            v_au:=v_au+' '+v_hersteller5;
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
          IF belege.FINDFIRST THEN BEGIN
            IF v_re='' THEN v_re:='RE';
            v_re:=v_re+' '+v_hersteller5;
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
          IF belege.FINDFIRST THEN BEGIN
            IF v_gu='' THEN v_gu:='GU';
            v_gu:=v_gu+' '+v_hersteller5;
          END;
        END;
        Sheet.Range('AY'+j).Value :=v_art;
        Sheet.Range('AZ'+j).Value :=v_an;
        Sheet.Range('BA'+j).Value :=v_au;
        Sheet.Range('BB'+j).Value :=v_re;
        Sheet.Range('BC'+j).Value :=v_gu;
        IF v_memo_datum=0D THEN BEGIN
        END ELSE BEGIN
          Sheet.Range('BF'+j).Value :=v_memo_datum;
        END;
        Sheet.Range('BG'+j).Value :=v_memo_kurztext;
        j:=INCSTR(j);
      END;
      //END;
    END;

    PROCEDURE doppelte_Ansprechpartner@1140025();
    BEGIN
      CREATE (Excel,FALSE,TRUE);                                           //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Excel.Visible(TRUE);
      Sheet.Range('A1').Value := 'USER1';
      Sheet.Range('B1').Value := 'Vorname';
      Sheet.Range('C1').Value := 'Name';
      Sheet.Range('D1').Value := 'Firma';
      Sheet.Range('E1').Value := 'Funktion';
      Sheet.Range('F1').Value := 'Email';
      Sheet.Range('G1').Value := 'Anrede';
      Sheet.Range('H1').Value := 'USER2';
      Sheet.Range('I1').Value := 'Nation';
      Sheet.Range('J1').Value := 'PLZ';
      Sheet.Range('K1').Value := 'Ort';
      Sheet.Range('L1').Value := 'Abteilung';
      Sheet.Range('M1').Value := 'Verk„ufer';
      Sheet.Range('N1').Value := 'Betreuer';
      Sheet.Range('O1').Value := 'Gebiet';
      Sheet.Range('P1').Value := 'Branche';
      Sheet.Range('Q1').Value := 'Telefon';
      Sheet.Range('R1').Value := 'AC Solutionpartner';
      Sheet.Range('S1').Value := 'Gesperrt';
      Sheet.Range('T1').Value := 'Firma verlassen';
      j := '2';
      kontakt.RESET;
      kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Person);
      kontakt.SETFILTER(kontakt.Gesperrt,'%1',FALSE);
      kontakt.SETFILTER(kontakt."Unternehmen verlassen",'%1',FALSE);
      IF kontakt.FIND('-') THEN BEGIN
        REPEAT
          kontakt1.RESET;
          kontakt1.SETFILTER(kontakt1.Name,'%1',kontakt.Name);
          kontakt1.SETFILTER(kontakt1."Company Name",'%1',kontakt."Company Name");
          kontakt1.SETFILTER(kontakt1."First Name",'<>%1','Auftragsbest„tigung');
          kontakt1.SETFILTER(kontakt1.Surname,'<>%1','Auftragsbest„tigung');
          kontakt1.SETFILTER(kontakt1."First Name",'<>%1','Qualit„tssicherung');
          kontakt1.SETFILTER(kontakt1.Surname,'<>%1','Qualit„tssicherung');
          kontakt1.SETFILTER(kontakt1."Unternehmen verlassen",'%1',FALSE);
          IF kontakt1.FIND('-') THEN BEGIN
            REPEAT
              IF kontakt1."No." = kontakt."No." THEN BEGIN
              END ELSE BEGIN
      //            Adressverwaltung;
                Sheet.Range('A'+j).Value :=kontakt1."No.";
                Sheet.Range('B'+j).Value :=kontakt1."First Name";
                Sheet.Range('C'+j).Value :=kontakt1.Surname;
                Sheet.Range('D'+j).Value :=kontakt1."Company Name";
                Sheet.Range('E'+j).Value :=kontakt1."Organizational Level Code";
                Sheet.Range('F'+j).Value :=kontakt1."E-Mail";
                IF kontakt1."Salutation Code" = 'HERR' THEN Sheet.Range('G'+j).Value :='Herr';
                IF kontakt1."Salutation Code" = 'FRAU' THEN Sheet.Range('G'+j).Value :='Frau';
                Sheet.Range('H'+j).Value :=kontakt1."Company No.";
                Sheet.Range('I'+j).Value :=kontakt1."Country/Region Code";
                Sheet.Range('J'+j).Value :=kontakt1."Post Code";
                Sheet.Range('J'+j).NumberFormat := '00000';
                Sheet.Range('K'+j).Value :=kontakt1.City;
                Sheet.Range('L'+j).Value :=kontakt1.Abteilung;
                Sheet.Range('M'+j).Value :=kontakt1."Salesperson Code";
                Sheet.Range('N'+j).Value :=kontakt1."Betreuer Innendienst";
                Sheet.Range('O'+j).Value :=kontakt1."Territory Code";
                Sheet.Range('Q'+j).Value :=kontakt1."Phone No.";
                Sheet.Range('Q'+j).NumberFormat := '00000000000000000';
                Sheet.Range('R'+j).Value :=kontakt1.AC_Solutionpartner;
                Sheet.Range('S'+j).Value :=kontakt1.Gesperrt;
                Sheet.Range('T'+j).Value :=kontakt1."Unternehmen verlassen";
      //  Branche Neu Start   ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                branche.RESET;
                v_branche:=0;
                v_branche1:='';
                v_branche2:='';
                v_branche3:='';
                v_branche4:='';
                v_branche5:='';
                v_branche6:='';
                v_branche7:='';
                v_branche8:='';
                v_branche9:='';
                v_branche10:='';
                v_branche11:='';
                v_branche12:='';
                v_branche13:='';
                v_branche14:='';
                v_branche15:='';
                branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
                branche.SETFILTER(branche."Industry Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5&<>%6','1-INNOVATO','2-EARL ADO','3-EARL MAJ','4-LATE MAJ','5-LAGGARDS','AUFTR-ENTW');
                IF branche.FIND('-') THEN BEGIN
                  REPEAT
                    v_branche:=v_branche+1;
                    IF v_branche = 1 THEN  v_branche1:=branche."Industry Group Code";
                    IF v_branche = 2 THEN  v_branche2:=branche."Industry Group Code";
                    IF v_branche = 3 THEN  v_branche3:=branche."Industry Group Code";
                    IF v_branche = 4 THEN  v_branche4:=branche."Industry Group Code";
                    IF v_branche = 5 THEN  v_branche5:=branche."Industry Group Code";
                    IF v_branche = 6 THEN  v_branche6:=branche."Industry Group Code";
                    IF v_branche = 7 THEN  v_branche7:=branche."Industry Group Code";
                    IF v_branche = 8 THEN  v_branche8:=branche."Industry Group Code";
                    IF v_branche = 9 THEN  v_branche9:=branche."Industry Group Code";
                    IF v_branche =10 THEN  v_branche10:=branche."Industry Group Code";
                    IF v_branche =11 THEN  v_branche11:=branche."Industry Group Code";
                    IF v_branche =12 THEN  v_branche12:=branche."Industry Group Code";
                    IF v_branche =13 THEN  v_branche13:=branche."Industry Group Code";
                    IF v_branche =14 THEN  v_branche14:=branche."Industry Group Code";
                    IF v_branche =15 THEN  v_branche15:=branche."Industry Group Code";
                  UNTIL branche.NEXT=0;
                END;
                Sheet.Range('U'+j).Value :=v_branche1;
                Sheet.Range('V'+j).Value :=v_branche2;
                Sheet.Range('W'+j).Value :=v_branche3;
                Sheet.Range('X'+j).Value :=v_branche4;
                Sheet.Range('Y'+j).Value :=v_branche5;
                Sheet.Range('Z'+j).Value :=v_branche6;
                Sheet.Range('AA'+j).Value :=v_branche7;
                Sheet.Range('AB'+j).Value :=v_branche8;
                Sheet.Range('AC'+j).Value :=v_branche9;
                Sheet.Range('AD'+j).Value :=v_branche10;
                Sheet.Range('AE'+j).Value :=v_branche11;
                Sheet.Range('AF'+j).Value :=v_branche12;
                Sheet.Range('AG'+j).Value :=v_branche13;
                Sheet.Range('AH'+j).Value :=v_branche14;
                Sheet.Range('AI'+j).Value :=v_branche15;
                IF v_branche>15 THEN  Sheet.Range('AI'+j).Value :='Fehler';
      //  Branche Neu Ende  ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                verteiler.RESET;
                verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
                IF verteiler.FINDFIRST THEN BEGIN
                  Sheet.Range('AJ'+j).Value :=verteiler."Mailing Group Code";
                  v_verteiler1:=verteiler."Mailing Group Code";
                END;
                verteiler.RESET;
                verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
                verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1',v_verteiler1);
                IF verteiler.FINDFIRST THEN BEGIN
                  Sheet.Range('AK'+j).Value :=verteiler."Mailing Group Code";
                  v_verteiler2:=verteiler."Mailing Group Code"
                END;
                verteiler.RESET;
                verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
                verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2',v_verteiler1,v_verteiler2);
                IF verteiler.FINDFIRST THEN BEGIN
                  Sheet.Range('AL'+j).Value :=verteiler."Mailing Group Code";
                  v_verteiler3:=verteiler."Mailing Group Code"
                END;
                verteiler.RESET;
                verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
                verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3',v_verteiler1,v_verteiler2,v_verteiler3);
                IF verteiler.FINDFIRST THEN BEGIN
                  Sheet.Range('AM'+j).Value :=verteiler."Mailing Group Code";
                  v_verteiler4:=verteiler."Mailing Group Code"
                END;
                verteiler.RESET;
                verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
                verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4);
                IF verteiler.FINDFIRST THEN BEGIN
                  Sheet.Range('AN'+j).Value :=verteiler."Mailing Group Code";
                  v_verteiler5:=verteiler."Mailing Group Code"
                END;
                verteiler.RESET;
                verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
                verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4,v_verteiler5);
                IF verteiler.FINDFIRST THEN BEGIN
                  Sheet.Range('AO'+j).Value :=verteiler."Mailing Group Code";
                  v_verteiler6:=verteiler."Mailing Group Code"
                END;
      //  Verteilereintrag des Mandanten abfragen
                verteiler.RESET;
                verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."Company No.");
                IF verteiler.FINDFIRST THEN BEGIN
                  v_verteiler6:=(verteiler."Mailing Group Code"+' Mandant');
                END;
                j:=INCSTR(j);
              END;
            UNTIL kontakt1.NEXT=0;
          END;
        UNTIL kontakt.NEXT=0;
      END;
    END;

    PROCEDURE Firma_verlassen_ohne_Eintrag@1140026();
    BEGIN
      CREATE (Excel,FALSE,TRUE);                                             //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Excel.Visible(TRUE);
      Sheet.Range('A1').Value := 'USER1';
      Sheet.Range('B1').Value := 'Vorname';
      Sheet.Range('C1').Value := 'Name';
      Sheet.Range('D1').Value := 'Firma';
      Sheet.Range('E1').Value := 'Funktion';
      Sheet.Range('F1').Value := 'Email';
      Sheet.Range('G1').Value := 'Anrede';
      Sheet.Range('H1').Value := 'USER2';
      Sheet.Range('I1').Value := 'Nation';
      Sheet.Range('J1').Value := 'PLZ';
      Sheet.Range('K1').Value := 'Ort';
      Sheet.Range('L1').Value := 'Abteilung';
      Sheet.Range('M1').Value := 'Verk„ufer';
      Sheet.Range('N1').Value := 'Betreuer';
      Sheet.Range('O1').Value := 'Gebiet';
      Sheet.Range('P1').Value := 'Branche';
      Sheet.Range('Q1').Value := 'Telefon';
      Sheet.Range('R1').Value := 'Mandant Gesperrt';
      Sheet.Range('S1').Value := 'Person Gesperrt';
      Sheet.Range('T1').Value := 'Firma verlassen';
      Sheet.Range('U1').Value := 'RMA Beteiligter';
      Sheet.Range('V1').Value := 'Aufgabe Nr.';
      Sheet.Range('W1').Value := 'Aufgabe Name';
      Sheet.Range('X1').Value := 'AN Auswahl';
      Sheet.Range('Y1').Value := 'Projektname';
      Sheet.Range('Z1').Value := 'PJ Memo Nr.';
      Sheet.Range('AA1').Value := 'KT Memo Nr.';
      Sheet.Range('AB1').Value := 'KT Memo Name';
      Sheet.Range('AC1').Value := 'KT_Deb_Kred';
      Sheet.Range('AD1').Value := 'Verteiler';
      Sheet.Range('AE1').Value := 'Branche';
      Sheet.Range('AF1').Value := 'Aktiv.Prot';
      Sheet.Range('AG1').Value := 'Position';
      Sheet.Range('AH1').Value := 'Duplikat';
      Sheet.Range('AI1').Value := 'Duplikat Such';
      Sheet.Range('AJ1').Value := 'VK Kopf Archiv';
      Sheet.Range('AK1').Value := 'VK Zeile Archiv';
      Sheet.Range('AL1').Value := 'EK Kopf Archiv';
      Sheet.Range('AM1').Value := 'Teilnehmer';
      Sheet.Range('AN1').Value := 'Endkunden';
      Sheet.Range('AO1').Value := 'Statistik';
      Sheet.Range('AP1').Value := 'Belege';
      Sheet.Range('AQ1').Value := 'FC-Kopf';
      Sheet.Range('AR1').Value := 'FC-Zeile';
      Sheet.Range('AS1').Value := 'Dokument';

      Sheet.Range('U2').Value := 'Tab 50022';
      Sheet.Range('V2').Value := 'Tab 5080';
      Sheet.Range('X2').Value := 'Tab 50005';
      Sheet.Range('AA2').Value := 'Tab 50003';
      Sheet.Range('AC2').Value := 'Tab 5054';
      Sheet.Range('AD2').Value := 'Tab 5056';
      Sheet.Range('AE2').Value := 'Tab 5058';
      Sheet.Range('AF2').Value := 'Tab 5065';
      Sheet.Range('AG2').Value := 'Tab 5067';
      Sheet.Range('AH2').Value := 'Tab 5085';
      Sheet.Range('AI2').Value := 'Tab 5086';
      Sheet.Range('AJ2').Value := 'Tab 5107';
      Sheet.Range('AK2').Value := 'Tab 5108';
      Sheet.Range('AL2').Value := 'Tab 5109';
      Sheet.Range('AM2').Value := 'Tab 5199';
      Sheet.Range('AN2').Value := 'Tab 50007';
      Sheet.Range('AO2').Value := 'Tab 50009';
      Sheet.Range('AP2').Value := 'Tab 50010';
      Sheet.Range('AQ2').Value := 'Tab 50025';
      Sheet.Range('AR2').Value := 'Tab 50026';
      Sheet.Range('AS2').Value := 'Tab 50032';

      j := '3';

      kontakt.RESET;
      kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Person);
      kontakt.SETFILTER(kontakt."Unternehmen verlassen",'%1',TRUE);
      //  **************************************************************  Einschr„nkung auch Gesperrt ************************************
      //kontakt.SETFILTER(kontakt.Gesperrt,'%1',TRUE);
      //  ********************************************************************************************************************************
      IF kontakt.FIND('-') THEN BEGIN
        REPEAT
      //v_hypernr:= kontakt."No.";
      //v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
      //             'target=Form%205050%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      //Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + kontakt."No." + '")';
          Sheet.Range('A'+j).Value :=kontakt."No.";
          Sheet.Range('B'+j).Value :=kontakt."First Name";
          Sheet.Range('C'+j).Value :=kontakt.Surname;
          Sheet.Range('D'+j).Value :=kontakt."Company Name";
          Sheet.Range('E'+j).Value :=kontakt."Organizational Level Code";
          Sheet.Range('F'+j).Value :=kontakt."E-Mail";
          IF kontakt."Salutation Code" = 'HERR' THEN Sheet.Range('G'+j).Value :='Herr';
          IF kontakt."Salutation Code" = 'FRAU' THEN Sheet.Range('G'+j).Value :='Frau';
          Sheet.Range('H'+j).Value :=kontakt."Company No.";
          Sheet.Range('I'+j).Value :=kontakt."Country/Region Code";
          Sheet.Range('J'+j).Value :=kontakt."Post Code";
          Sheet.Range('J'+j).NumberFormat := '00000';
          Sheet.Range('K'+j).Value :=kontakt.City;
          Sheet.Range('L'+j).Value :=kontakt.Abteilung;
          Sheet.Range('M'+j).Value :=kontakt."Salesperson Code";
          Sheet.Range('N'+j).Value :=kontakt."Betreuer Innendienst";
          Sheet.Range('O'+j).Value :=kontakt."Territory Code";
          Sheet.Range('Q'+j).Value :=kontakt."Phone No.";
          Sheet.Range('Q'+j).NumberFormat := '00000000000000000';
          kontakt1.RESET;
          kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."No.");
          IF kontakt1.FINDFIRST THEN BEGIN
            Sheet.Range('R'+j).Value :=kontakt1.Gesperrt;
          END;
            Sheet.Range('S'+j).Value :=kontakt.Gesperrt;
            Sheet.Range('T'+j).Value :=kontakt."Unternehmen verlassen";
          RMA.RESET;
          RMA.SETFILTER(RMA."Nr.",'%1',kontakt."No.");
          IF RMA.FINDFIRST THEN BEGIN
            Sheet.Range('U'+j).Value :=RMA."RMA-Nr.";
          END;
          Aufgabe.RESET;
          Aufgabe.SETFILTER(Aufgabe."Contact No.",'%1',kontakt."No.");
          IF Aufgabe.FINDFIRST THEN BEGIN
            Sheet.Range('V'+j).Value :=Aufgabe."Campaign No.";
            Sheet.Range('W'+j).Value :=Aufgabe.Description;
          END;
          "AP Auswahl".RESET;
          "AP Auswahl".SETFILTER("AP Auswahl"."Kontaktnr.",'%1',kontakt."No.");
          IF "AP Auswahl".FINDFIRST THEN BEGIN
            Sheet.Range('X'+j).Value :="AP Auswahl"."Kontaktnr.";
            Sheet.Range('Y'+j).Value :="AP Auswahl".Projektname;
            Sheet.Range('Z'+j).Value :="AP Auswahl"."Memonr.";
          END;
          memok.RESET;
          memok.SETFILTER(memok."Mandantennr.",'%1',kontakt."No.");
          IF memok.FINDFIRST THEN BEGIN
            Sheet.Range('AA'+j).Value :=memok."Memonr.";
            Sheet.Range('AB'+j).Value :=memok.Memokurztext;
          END;
          kon_deb.RESET;
          kon_deb.SETFILTER(kon_deb."Contact No.",'%1',kontakt."No.");
          IF kon_deb.FINDFIRST THEN BEGIN
            Sheet.Range('AC'+j).Value :=kon_deb."Business Relation Code";
          END;
          verteiler.RESET;
          verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
          IF verteiler.FINDFIRST THEN BEGIN
            Sheet.Range('AD'+j).Value :=verteiler."Mailing Group Code";
          END;
          branche.RESET;
          branche.SETFILTER(branche."Contact No.",'%1',kontakt."No.");
          IF branche.FINDFIRST THEN BEGIN
            Sheet.Range('AE'+j).Value :=branche."Industry Group Code";
          END;
          Tab5065.RESET;
          Tab5065.SETFILTER(Tab5065."Contact No.",'%1',kontakt."No.");
          IF Tab5065.FINDFIRST THEN BEGIN
            Sheet.Range('AF'+j).Value :=Tab5065."Contact No.";
          END;
          position.RESET;
          position.SETFILTER(position."Contact No.",'%1',kontakt."No.");
          IF position.FINDFIRST THEN BEGIN
            Sheet.Range('AG'+j).Value :=position."Job Responsibility Code";
          END;
          Tab5085.RESET;
          Tab5085.SETFILTER(Tab5085."Contact No.",'%1',kontakt."No.");
          IF Tab5085.FINDFIRST THEN BEGIN
            Sheet.Range('AH'+j).Value :=Tab5085."Contact No.";
          END;
          Tab5086.RESET;
          Tab5086.SETFILTER(Tab5086."Contact Company No.",'%1',kontakt."No.");
          IF Tab5086.FINDFIRST THEN BEGIN
            Sheet.Range('AI'+j).Value :=Tab5086."Contact Company No.";
          END;
          Tab5107.RESET;
          Tab5107.SETFILTER(Tab5107.Kontaktperson,'%1',kontakt."No.");
          IF Tab5107.FINDFIRST THEN BEGIN
            Sheet.Range('AJ'+j).Value :=Tab5107.Kontaktperson;
          END;
          Tab5108.RESET;
          Tab5108.SETFILTER(Tab5108."Endkundennr.",'%1',kontakt."No.");
          IF Tab5108.FINDFIRST THEN BEGIN
            Sheet.Range('AK'+j).Value :=Tab5108."Endkundennr.";
          END;
          Tab5109.RESET;
          Tab5109.SETFILTER(Tab5109."Pay-to Contact No.",'%1',kontakt."No.");
          IF Tab5109.FINDFIRST THEN BEGIN
            Sheet.Range('AL'+j).Value :=Tab5109."Pay-to Contact No.";
          END;
          Tab5199.RESET;
          Tab5199.SETFILTER(Tab5199."Attendee No.",'%1',kontakt."No.");
          IF Tab5199.FINDFIRST THEN BEGIN
            Sheet.Range('AM'+j).Value :=Tab5199."Attendee No.";
          END;
          Tab50007.RESET;
          Tab50007.SETFILTER(Tab50007."Endkundennr.",'%1',kontakt."No.");
          IF Tab50007.FINDFIRST THEN BEGIN
            Sheet.Range('AN'+j).Value :=Tab50007."Endkundennr.";
          END;
          Tab50009.RESET;
          Tab50009.SETFILTER(Tab50009.Kontakt,'%1',kontakt."No.");
          IF Tab50009.FINDFIRST THEN BEGIN
            Sheet.Range('AO'+j).Value :=Tab50009.Kontakt;
          END;
          belege.RESET;
          belege.SETFILTER(belege.Kontakt,'%1',kontakt."No.");
          IF belege.FINDFIRST THEN BEGIN
            Sheet.Range('AP'+j).Value :=belege.Kontakt;
          END;
          Tab50032.RESET;
          Tab50032.SETFILTER(Tab50032."Kontaktnr.",'%1',kontakt."No.");
          IF Tab50032.FINDFIRST THEN BEGIN
            Sheet.Range('AS'+j).Value :=Tab50032.Dateiname;
            Sheet.Range('AT'+j).Value :=Tab50032."Kontaktnr.";
          END;
          j:=INCSTR(j);
        UNTIL kontakt.NEXT=0;
      END;
    END;

    PROCEDURE Mailingvormerkung@1140028();
    BEGIN
      CREATE (Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Excel.Visible(TRUE);
      Sheet.Range('A1').Value := 'USER1';
      Sheet.Range('B1').Value := 'Art';
      Sheet.Range('C1').Value := 'Firma';
      Sheet.Range('D1').Value := 'Firma2';
      Sheet.Range('E1').Value := 'Anrede';
      Sheet.Range('F1').Value := 'Titel';
      Sheet.Range('G1').Value := 'Vorname';
      Sheet.Range('H1').Value := 'Name';
      Sheet.Range('I1').Value := 'Abteilung';
      Sheet.Range('J1').Value := 'Straáe';
      Sheet.Range('K1').Value := 'Straáe';
      Sheet.Range('L1').Value := 'Nation';
      Sheet.Range('M1').Value := 'PLZ';
      Sheet.Range('N1').Value := 'Ort';
      Sheet.Range('O1').Value := 'Verk„ufer';
      Sheet.Range('P1').Value := 'Betreuer';
      Sheet.Range('Q1').Value := 'Gebiet';
      Sheet.Range('R1').Value := 'Branche';
      Sheet.Range('S1').Value := 'Funktion';
      Sheet.Range('T1').Value := 'Email';
      Sheet.Range('U1').Value := 'Telefon';
      Sheet.Range('V1').Value := 'USER2';
      Sheet.Range('W1').Value := 'Mandant Gesperrt';
      Sheet.Range('X1').Value := 'Person Gesperrt';
      Sheet.Range('Y1').Value := 'Firma verlassen';
      j := '2';
      kontakt.RESET;
      //kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Person);
      //kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Company);
      kontakt.SETFILTER(kontakt.Mailingvormerkung,'%1',TRUE);
      //kontakt.CALCFIELDS(kontakt."No. of Industry Groups");
      IF kontakt.FIND('-') THEN BEGIN
        REPEAT
      //v_hypernr:= kontakt."No.";
      //v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
      //             'target=Form%205050%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      //Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + kontakt."No." + '")';
          Sheet.Range('A'+j).Value :=kontakt."No.";
          Sheet.Range('B'+j).Value :=kontakt.Type;
          IF kontakt.Type=kontakt.Type::Company THEN BEGIN
            Sheet.Range('C'+j).Value :=kontakt.Name;
            Sheet.Range('D'+j).Value :=kontakt."Name 2";
          END ELSE BEGIN
            kontakt1.RESET;
            kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
            IF kontakt1.FINDFIRST THEN BEGIN
              Sheet.Range('C'+j).Value :=kontakt1.Name;
              Sheet.Range('D'+j).Value :=kontakt1."Name 2";
            END;
          END;
          IF kontakt."Salutation Code" = 'HERR' THEN Sheet.Range('E'+j).Value :='Herr';
          IF kontakt."Salutation Code" = 'FRAU' THEN Sheet.Range('E'+j).Value :='Frau';
          Sheet.Range('F'+j).Value :=kontakt."Job Title";
          Sheet.Range('G'+j).Value :=kontakt."First Name";
          Sheet.Range('H'+j).Value :=kontakt.Surname;
          Sheet.Range('I'+j).Value :=kontakt.Abteilung;
          Sheet.Range('J'+j).Value :=kontakt.Address;
          Sheet.Range('K'+j).Value :=kontakt."Address 2";
          Sheet.Range('L'+j).Value :=kontakt."Country/Region Code";
          Sheet.Range('M'+j).Value :=kontakt."Post Code";
          Sheet.Range('M'+j).NumberFormat := '00000';
          Sheet.Range('N'+j).Value :=kontakt.City;
          Sheet.Range('O'+j).Value :=kontakt."Salesperson Code";
          Sheet.Range('P'+j).Value :=kontakt."Betreuer Innendienst";
          Sheet.Range('Q'+j).Value :=kontakt."Territory Code";
          Sheet.Range('R'+j).Value :=kontakt."No. of Industry Groups";
          Sheet.Range('S'+j).Value :=kontakt."Organizational Level Code";
          Sheet.Range('T'+j).Value :=kontakt."E-Mail";
          Sheet.Range('U'+j).Value :=kontakt."Phone No.";
          Sheet.Range('U'+j).NumberFormat := '00000000000000000';
          Sheet.Range('V'+j).Value :=kontakt."Company No.";
          Sheet.Range('X'+j).Value :=kontakt.Gesperrt;
          kontakt1.RESET;
          kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
          IF kontakt1.FINDFIRST THEN BEGIN
            Sheet.Range('W'+j).Value :=kontakt1.Gesperrt;
          END;
          Sheet.Range('Y'+j).Value :=kontakt."Unternehmen verlassen";
          j:=INCSTR(j);
        UNTIL kontakt.NEXT=0;
      END;
    END;

    PROCEDURE "sonstige Listen"@1140029();
    BEGIN
      CREATE (Excel,FALSE,TRUE);                                             //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Excel.Visible(TRUE);
      Sheet.Range('A1').Value := 'Liste aller Kontakte im PLZ-Breich 6xxxx';
      Sheet.Range('A2').Value := 'Kontakt Nr.';
      Sheet.Range('B2').Value := 'Firma';
      Sheet.Range('H2').Value := 'Umsatz ab 1.1.15';
      Sheet.Range('I2').Value := 'Anspr. vorhanden';
      Sheet.Range('J2').Value := 'Projekte vorhanden';
      Sheet.Range('K2').Value := 'Angebote vorhanden';
      j := '4';
      kontakt.RESET;
      kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Company);
      kontakt.SETFILTER("Country/Region Code",'%1','DE');
      kontakt.SETFILTER(kontakt."Post Code",'%1..%2','60000','69999');
      IF kontakt.FIND('-') THEN BEGIN
        REPEAT
          Sheet.Range('A'+j).Value :=kontakt."No.";
          Sheet.Range('B'+j).Value :=kontakt."Company Name";
          Sheet.Range('C'+j).Value :=kontakt."Post Code";
          Sheet.Range('D'+j).Value :=FORMAT(kontakt.Type);
          Sheet.Range('E'+j).Value :=kontakt."Country/Region Code";
      //v_hypernr:= kontakt."No.";
      //v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
      //             'target=Form%2050091%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      //Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + kontakt."No." + '")';
          kon_deb.RESET;
          kon_deb.SETFILTER(kon_deb."Contact No.",'%1',kontakt."No.");
          kon_deb.SETFILTER(kon_deb."Business Relation Code",'%1','DEB');
          IF kon_deb.FINDFIRST THEN BEGIN
            debitor.RESET;
            debitor.SETFILTER(debitor."No.",'%1',kon_deb."No.");
            IF debitor.FINDFIRST THEN BEGIN
              v_betrag:=0;
              Sheet.Range('F'+j).Value :=debitor."No.";
      //v_hypernr:= debitor."No.";
      //v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
      //             'target=Form%2021%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      //Sheet.Range('F'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + debitor."No." + '")';
              vkrz.RESET;
              vkrz.SETFILTER(vkrz."Sell-to Customer No.",'%1',debitor."No.");
              vkrz.SETFILTER(vkrz.Quantity,'<>%1',0);
              vkrz.SETFILTER(vkrz."Posting Date",'>%1',311214D);
              IF vkrz.FIND('-') THEN BEGIN
                REPEAT
                  v_betrag:=v_betrag+vkrz.Amount;
                UNTIL vkrz.NEXT=0;
                  Sheet.Range('H'+j).Value :=v_betrag;
              END;
            END;
          END;
          Sheet.Range('G'+j).Value :=kontakt."Territory Code";
          kontakt1.RESET;
          kontakt1.SETFILTER(kontakt1."Company No.",'%1',kontakt."No.");
          kontakt1.SETFILTER(kontakt1.Type,'%1',kontakt.Type::Person);
          IF kontakt1.FINDFIRST THEN BEGIN
            Sheet.Range('I'+j).Value :='JA';
          END;
          "AP Auswahl".RESET;
          "AP Auswahl".SETFILTER("AP Auswahl"."Kontakt Mandantennr.",'%1',kontakt."No.");
          "AP Auswahl".SETFILTER("AP Auswahl"."Kampagnennr.",'<>%1','');
          IF "AP Auswahl".FINDFIRST THEN BEGIN
            Sheet.Range('J'+j).Value :='JA';
          END;
          vkz.RESET;
          vkz.SETFILTER(vkz."Sell-to Customer No.",'%1',debitor."No.");
          vkz.SETFILTER(vkz."Document Type",'%1',vkz."Document Type"::Quote);
       //     vkz.SETFILTER(vkz."Posting Date",'>%1',311214D);
          IF vkz.FINDFIRST THEN BEGIN
            Sheet.Range('K'+j).Value :='JA';
          END;
          j:=INCSTR(j);
        UNTIL kontakt.NEXT=0;
      END;
    END;

    PROCEDURE Trainingsinfos@1140030();
    BEGIN
      CreateExcel;
      RecNo := 0;
      RowNo := 1;
      EnterCell(RowNo,1,'Aktuelle Trainingsinteressenten','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      RowNo := 2;
      EnterCell(RowNo,1,'USER1','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,2,'Art','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,3,'Firma','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,4,'Firma2','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,5,'Anrede','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,6,'Titel','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,7,'Vorname','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,8,'Name','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,9,'Abteilung','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,10,'Straáe','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,11,'Straáe','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,12,'Nation','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,13,'PLZ','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,14,'Ort','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,15,'Verk„ufer','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,16,'Betreuer','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,17,'Gebiet','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,18,'Branche','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,19,'Funktion','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,20,'Email','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,21,'Telefon','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,22,'USER2','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,23,'Mandant Gesperrt','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,24,'Person Gesperrt','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,25,'Firma verlassen','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,26,'Verteiler','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      RowNo := 3;
      verteiler.RESET;
      verteiler.SETFILTER(verteiler."Mailing Group Code",'%1','TRAINING');
      IF verteiler.FIND('-') THEN BEGIN
        REPEAT
          kontakt.RESET;
          kontakt.SETFILTER(kontakt."No.",'%1',verteiler."Contact No.");
          IF kontakt.FINDFIRST THEN BEGIN
            EnterCell(RowNo,1,kontakt."No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            IF kontakt.Type=kontakt.Type::Company THEN EnterCell(RowNo,2,'Mandant','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            IF kontakt.Type<>kontakt.Type::Company THEN EnterCell(RowNo,2,'Person','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            IF kontakt.Type=kontakt.Type::Company THEN BEGIN
              EnterCell(RowNo,3,kontakt.Name,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,4,kontakt."Name 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            END ELSE BEGIN
              kontakt1.RESET;
              kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
              IF kontakt1.FINDFIRST THEN BEGIN
                EnterCell(RowNo,3,kontakt1.Name,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,4,kontakt1."Name 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              END;
            END;
            IF kontakt."Salutation Code" = 'HERR' THEN EnterCell(RowNo,5,'Herr','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            IF kontakt."Salutation Code" = 'FRAU' THEN EnterCell(RowNo,5,'Frau','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,6,kontakt."Job Title",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,7,kontakt."First Name",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,8,kontakt.Surname,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,9,kontakt.Abteilung,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,10,kontakt.Address,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,11,kontakt."Address 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,12,kontakt."Country/Region Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,13,FORMAT(kontakt."Post Code"),'',FALSE,FALSE,FALSE,'00000',TempExcelBuffer."Cell Type"::Number);
            EnterCell(RowNo,14,kontakt.City,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,15,kontakt."Salesperson Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,16,kontakt."Betreuer Innendienst",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,17,kontakt."Territory Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,18,FORMAT(kontakt."No. of Industry Groups"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Number);
            EnterCell(RowNo,19,kontakt."Organizational Level Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,20,kontakt."E-Mail",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,21,kontakt."Phone No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,22,kontakt."Company No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,24,FORMAT(kontakt.Gesperrt),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,25,FORMAT(kontakt."Unternehmen verlassen"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,26,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            kontakt1.RESET;
            kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
            IF kontakt1.FINDFIRST THEN BEGIN
              EnterCell(RowNo,23,FORMAT(kontakt1.Gesperrt),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            END;
            RowNo := RowNo + 1;
          END;
        UNTIL verteiler.NEXT=0;
      END;

      CloseExcel('Trainingsinfo','Trainingsinfo','F:\Daten Neu\User\Uwe\Mailing');
      MESSAGE(Text003);
    END;

    PROCEDURE no_branche@1140031();
    BEGIN
      CREATE (Excel,FALSE,TRUE);                                            //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Excel.Visible(TRUE);


      Sheet.Range('A1').Value := 'Kontakte ohne Brancheneintrag  Stand:';
      Sheet.Range('E1').Value := WORKDATE;

      Sheet.Range('A2').Value := 'USER1';
      Sheet.Range('B2').Value := 'Art';
      Sheet.Range('C2').Value := 'Firma';
      Sheet.Range('D2').Value := 'Firma2';
      Sheet.Range('E2').Value := 'Anrede';
      Sheet.Range('F2').Value := 'Titel';
      Sheet.Range('G2').Value := 'Vorname';
      Sheet.Range('H2').Value := 'Name';
      Sheet.Range('I2').Value := 'Abteilung';
      Sheet.Range('J2').Value := 'Straáe';
      Sheet.Range('K2').Value := 'Straáe';
      Sheet.Range('L2').Value := 'Nation';
      Sheet.Range('M2').Value := 'PLZ';
      Sheet.Range('N2').Value := 'Ort';
      Sheet.Range('O2').Value := 'Verk„ufer';
      Sheet.Range('P2').Value := 'Betreuer';
      Sheet.Range('Q2').Value := 'Gebiet';
      Sheet.Range('R2').Value := 'Branche';
      Sheet.Range('S2').Value := 'Funktion';
      Sheet.Range('T2').Value := 'Email';
      Sheet.Range('U2').Value := 'Telefon';
      Sheet.Range('V2').Value := 'USER2';
      Sheet.Range('W2').Value := 'Verteiler';
      Sheet.Range('X2').Value := 'Mandant Gesperrt';
      Sheet.Range('Y2').Value := 'Person Gesperrt';
      Sheet.Range('Z2').Value := 'Firma verlassen';

      j := '3';

      kontakt.RESET;
      kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Company);
      kontakt.SETFILTER(kontakt.Gesperrt,'%1',FALSE);

      IF kontakt.FIND('-') THEN BEGIN
        REPEAT
      //  v_branche_ok:=0;
          branche.RESET;
          branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      //  branche.SETFILTER(branche."Industry Group Code",'%1','SUS*');
          IF NOT branche.FINDFIRST THEN BEGIN
      //      REPEAT
      //        IF ((branche."Industry Group Code"='SUS-P1') OR (branche."Industry Group Code"='SUS-P2') OR
      //         (branche."Industry Group Code"='SUS-P3')) THEN v_branche_ok:=v_branche_ok+1;
      //      UNTIL branche.NEXT=0;
      //      IF v_branche_ok=0 THEN Adressverwaltung;
      //        Adressverwaltung;
      //    v_hypernr:= kontakt."No.";
      //    v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
      //             'target=Form%205050%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      //    Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + kontakt."No." + '")';
            Sheet.Range('A'+j).Value :=kontakt."No.";
            Sheet.Range('B'+j).Value :=kontakt.Type;
      //            IF kontakt.Type=kontakt.Type::Company THEN BEGIN
            Sheet.Range('C'+j).Value :=kontakt.Name;
            Sheet.Range('D'+j).Value :=kontakt."Name 2";
      //             END ELSE BEGIN
      //                  kontakt1.RESET;
      //                  kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
      //                  IF kontakt1.FINDFIRST THEN BEGIN
      //                Sheet.Range('C'+j).Value :=kontakt1.Name;
      //                Sheet.Range('D'+j).Value :=kontakt1."Name 2";
      //                  END;
      //             END;
            IF kontakt."Salutation Code" = 'HERR' THEN Sheet.Range('E'+j).Value :='Herr';
            IF kontakt."Salutation Code" = 'FRAU' THEN Sheet.Range('E'+j).Value :='Frau';
            Sheet.Range('F'+j).Value :=kontakt."Job Title";
            Sheet.Range('G'+j).Value :=kontakt."First Name";
            Sheet.Range('H'+j).Value :=kontakt.Surname;
            Sheet.Range('I'+j).Value :=kontakt.Abteilung;
            Sheet.Range('J'+j).Value :=kontakt.Address;
            Sheet.Range('K'+j).Value :=kontakt."Address 2";
            Sheet.Range('L'+j).Value :=kontakt."Country/Region Code";
            Sheet.Range('M'+j).Value :=kontakt."Post Code";
            Sheet.Range('M'+j).NumberFormat := '00000';
            Sheet.Range('N'+j).Value :=kontakt.City;
            Sheet.Range('O'+j).Value :=kontakt."Salesperson Code";
            Sheet.Range('P'+j).Value :=kontakt."Betreuer Innendienst";
            Sheet.Range('Q'+j).Value :=kontakt."Territory Code";
            Sheet.Range('R'+j).Value :=kontakt."No. of Industry Groups";
            Sheet.Range('S'+j).Value :=kontakt."Organizational Level Code";
            Sheet.Range('T'+j).Value :=kontakt."E-Mail";
            Sheet.Range('U'+j).Value :=kontakt."Phone No.";
            Sheet.Range('U'+j).NumberFormat := '00000000000000000';
            Sheet.Range('V'+j).Value :=kontakt."Company No.";
      //                Sheet.Range('W'+j).Value :=verteiler."Mailing Group Code";
            Sheet.Range('Y'+j).Value :=kontakt.Gesperrt;

            j:=INCSTR(j);
          END;
        UNTIL kontakt.NEXT=0;
      END;
    END;

    PROCEDURE Adr_SUS_ohne_UNSUB@1140033();
    BEGIN

      IF v_z„hler=1 THEN BEGIN
        CREATE (Excel,FALSE,TRUE);                                            //erzeugt excel
        Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
        Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
        Excel.Visible(TRUE);

        Sheet.Range('A1').Value := 'USER1';
        Sheet.Range('B1').Value := 'Art';
        Sheet.Range('C1').Value := 'Firma';
        Sheet.Range('D1').Value := 'Firma2';
        Sheet.Range('E1').Value := 'Anrede';
        Sheet.Range('F1').Value := 'Titel';
        Sheet.Range('G1').Value := 'Vorname';
        Sheet.Range('H1').Value := 'Name';
        Sheet.Range('I1').Value := 'Abteilung';
        Sheet.Range('J1').Value := 'Straáe';
        Sheet.Range('K1').Value := 'Straáe';
        Sheet.Range('L1').Value := 'Nation';
        Sheet.Range('M1').Value := 'PLZ';
        Sheet.Range('N1').Value := 'Ort';
        Sheet.Range('O1').Value := 'Verk„ufer';
        Sheet.Range('P1').Value := 'Betreuer';
        Sheet.Range('Q1').Value := 'Gebiet';
        Sheet.Range('R1').Value := 'Branche';
        Sheet.Range('S1').Value := 'Funktion';
        Sheet.Range('T1').Value := 'Email';
        Sheet.Range('U1').Value := 'Telefon';
        Sheet.Range('V1').Value := 'USER2';
        Sheet.Range('W1').Value := 'Mandant Gesperrt';
        Sheet.Range('X1').Value := 'Person Gesperrt';
        Sheet.Range('Y1').Value := 'Firma verlassen';
        Sheet.Range('AA1').Value := 'AC Solutionpartner';
        Sheet.Range('AB1').Value := 'NO Mailing';
        Sheet.Range('AC1').Value := 'NO ACS';
        Sheet.Range('AD1').Value := 'NO FER';
        Sheet.Range('AE1').Value := 'NO SPL';
        Sheet.Range('AF1').Value := 'NO WIL';
        Sheet.Range('AG1').Value := 'P1 ACS';
        Sheet.Range('AH1').Value := 'P2 FER';
        Sheet.Range('AI1').Value := 'P3 SPL';
        Sheet.Range('AJ1').Value := 'P4 WIL';
        Sheet.Range('AK1').Value := 'SuS Endkunde';
        Sheet.Range('AL1').Value := 'T1 Dienstleist';
        Sheet.Range('AM1').Value := 'T2 IT-Abtl.';
        Sheet.Range('AN1').Value := 'T3 L”sungsanbiet';
        Sheet.Range('AO1').Value := 'T4 Provider reg.';
        Sheet.Range('AP1').Value := 'T5 Provider berreg.';
        Sheet.Range('AQ1').Value := 'T6 Reseller';
        Sheet.Range('AR1').Value := 'T7 Systemhaus';
        Sheet.Range('AS1').Value := 'TP Presse';
        Sheet.Range('AT1').Value := 'L1 Conf/Call Center';
        Sheet.Range('AU1').Value := 'L2 Fax';
        Sheet.Range('AV1').Value := 'L3 IP Telefon';
        Sheet.Range('AW1').Value := 'L4 Lync';
        Sheet.Range('AX1').Value := 'L5 Voice';
        Sheet.Range('AY1').Value := 'Weitere';
        Sheet.Range('AZ1').Value := 'Verteiler1';
        Sheet.Range('BA1').Value := 'Verteiler2';
        Sheet.Range('BB1').Value := 'Verteiler3';
        Sheet.Range('BC1').Value := 'Verteiler4';
        Sheet.Range('BD1').Value := 'Verteiler5';
        Sheet.Range('BE1').Value := 'Verteiler6';
        Sheet.Range('BF1').Value := 'Adr.-Herkunft';
        Sheet.Range('BG1').Value := 'Angebote';
        Sheet.Range('BH1').Value := 'Auftr„ge';
        Sheet.Range('BI1').Value := 'Rechnungen';
        Sheet.Range('BJ1').Value := 'Gutschriften';
        Sheet.Range('BK1').Value := 'Gesperrt';
        Sheet.Range('BL1').Value := 'UN verlassen';

        j := '2';

        verteiler1.RESET;
        verteiler1.SETFILTER(verteiler1."Contact No.",'%1',kontakt."No.");
        IF verteiler1.FIND('-') THEN BEGIN
          REPEAT
            IF ((verteiler1."Mailing Group Code"='UNSUB') OR (verteiler1."Mailing Group Code"='NO EMAIL')) THEN BEGIN
            END ELSE BEGIN
              funktion_adr_SUS;
            END;
          UNTIL verteiler1.NEXT=0;
        END ELSE BEGIN
          funktion_adr_SUS;
        END;
      END ELSE BEGIN
        verteiler1.RESET;
        verteiler1.SETFILTER(verteiler1."Contact No.",'%1',kontakt."No.");
        IF verteiler1.FIND('-') THEN BEGIN
          REPEAT
            IF ((verteiler1."Mailing Group Code"='UNSUB') OR (verteiler1."Mailing Group Code"='NO EMAIL')) THEN BEGIN
            END ELSE BEGIN
              funktion_adr_SUS;
            END;
          UNTIL verteiler1.NEXT=0;
        END ELSE BEGIN
          funktion_adr_SUS;
        END;
      END;
    END;

    PROCEDURE funktion_adr_SUS@1140039();
    BEGIN
      v_branche1:='';
      v_branche2:='';
      v_branche3:='';
      v_branche4:='';
      v_branche5:='';
      v_branche6:='';
      //               Sheet.Range('A'+j).Value := TOPAS_API.CreateExcelHyperlinkToNav(kontakt.TABLENAME,1,5050,kontakt."No.");
      Sheet.Range('A'+j).Value :=kontakt."No.";
      Sheet.Range('B'+j).Value :=kontakt.Type;
      IF kontakt.Type=kontakt.Type::Company THEN BEGIN
        Sheet.Range('C'+j).Value :=kontakt.Name;
        Sheet.Range('D'+j).Value :=kontakt."Name 2";
      END ELSE BEGIN
        kontakt1.RESET;
        kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
        IF kontakt1.FINDFIRST THEN BEGIN
          Sheet.Range('C'+j).Value :=kontakt1.Name;
          Sheet.Range('D'+j).Value :=kontakt1."Name 2";
        END;
      END;
      IF kontakt."Salutation Code" = 'HERR' THEN Sheet.Range('E'+j).Value :='Herr';
      IF kontakt."Salutation Code" = 'FRAU' THEN Sheet.Range('E'+j).Value :='Frau';
      Sheet.Range('F'+j).Value :=kontakt."Job Title";
      Sheet.Range('G'+j).Value :=kontakt."First Name";
      Sheet.Range('H'+j).Value :=kontakt.Surname;
      Sheet.Range('I'+j).Value :=kontakt.Abteilung;
      Sheet.Range('J'+j).Value :=kontakt.Address;
      Sheet.Range('K'+j).Value :=kontakt."Address 2";
      Sheet.Range('L'+j).Value :=kontakt."Country/Region Code";
      Sheet.Range('M'+j).Value :=kontakt."Post Code";
      Sheet.Range('M'+j).NumberFormat := '00000';
      Sheet.Range('N'+j).Value :=kontakt.City;
      Sheet.Range('O'+j).Value :=kontakt."Salesperson Code";
      Sheet.Range('P'+j).Value :=kontakt."Betreuer Innendienst";
      Sheet.Range('Q'+j).Value :=kontakt."Territory Code";
      Sheet.Range('R'+j).Value :=kontakt."No. of Industry Groups";
      Sheet.Range('S'+j).Value :=kontakt."Organizational Level Code";
      Sheet.Range('T'+j).Value :=kontakt."E-Mail";
      Sheet.Range('U'+j).Value :=kontakt."Phone No.";
      Sheet.Range('U'+j).NumberFormat := '00000000000000000';
      Sheet.Range('V'+j).Value :=kontakt."Company No.";
      Sheet.Range('X'+j).Value :=kontakt.Gesperrt;
      kontakt1.RESET;
      kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
      IF kontakt1.FINDFIRST THEN BEGIN
        Sheet.Range('W'+j).Value :=kontakt1.Gesperrt;
      END;
      Sheet.Range('Y'+j).Value :=kontakt."Unternehmen verlassen";

      Sheet.Range('AA'+j).Value :=kontakt.AC_Solutionpartner;
      Sheet.Range('BL'+j).Value :=kontakt.Gesperrt;
      Sheet.Range('BK'+j).Value :=kontakt."Unternehmen verlassen";

      // Branchenauswertung
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','NO-MAILING');
      IF branche.FINDFIRST THEN BEGIN
        Sheet.Range('AB'+j).Value :=branche."Industry Group Code";
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-ACS');
      IF branche.FINDFIRST THEN BEGIN
        Sheet.Range('AC'+j).Value :=branche."Industry Group Code";
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-FER');
      IF branche.FINDFIRST THEN BEGIN
        Sheet.Range('AD'+j).Value :=branche."Industry Group Code";
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-SPL');
      IF branche.FINDFIRST THEN BEGIN
        Sheet.Range('AE'+j).Value :=branche."Industry Group Code";
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-WIL');
      IF branche.FINDFIRST THEN BEGIN
        Sheet.Range('AF'+j).Value :=branche."Industry Group Code";
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P1');
      IF branche.FINDFIRST THEN BEGIN
        Sheet.Range('AG'+j).Value :=branche."Industry Group Code";
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P2');
      IF branche.FINDFIRST THEN BEGIN
        Sheet.Range('AH'+j).Value :=branche."Industry Group Code";
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P3');
      IF branche.FINDFIRST THEN BEGIN
        Sheet.Range('AI'+j).Value :=branche."Industry Group Code";
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P4');
      IF branche.FINDFIRST THEN BEGIN
        Sheet.Range('AJ'+j).Value :=branche."Industry Group Code";
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-ENDK');
      IF branche.FINDFIRST THEN BEGIN
        Sheet.Range('AK'+j).Value :=branche."Industry Group Code";
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T1');
      IF branche.FINDFIRST THEN BEGIN
        Sheet.Range('AL'+j).Value :=branche."Industry Group Code";
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T2');
      IF branche.FINDFIRST THEN BEGIN
        Sheet.Range('AM'+j).Value :=branche."Industry Group Code";
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T3');
      IF branche.FINDFIRST THEN BEGIN
        Sheet.Range('AN'+j).Value :=branche."Industry Group Code";
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T4');
      IF branche.FINDFIRST THEN BEGIN
        Sheet.Range('AO'+j).Value :=branche."Industry Group Code";
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T5');
      IF branche.FINDFIRST THEN BEGIN
        Sheet.Range('AP'+j).Value :=branche."Industry Group Code";
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T6');
      IF branche.FINDFIRST THEN BEGIN
        Sheet.Range('AQ'+j).Value :=branche."Industry Group Code";
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T7');
      IF branche.FINDFIRST THEN BEGIN
        Sheet.Range('AR'+j).Value :=branche."Industry Group Code";
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-TP');
      IF branche.FINDFIRST THEN BEGIN
        Sheet.Range('AS'+j).Value :=branche."Industry Group Code";
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L1');
      IF branche.FINDFIRST THEN BEGIN
        Sheet.Range('AT'+j).Value :=branche."Industry Group Code";
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L2');
      IF branche.FINDFIRST THEN BEGIN
        Sheet.Range('AU'+j).Value :=branche."Industry Group Code";
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L3');
      IF branche.FINDFIRST THEN BEGIN
        Sheet.Range('AV'+j).Value :=branche."Industry Group Code";
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L4');
      IF branche.FINDFIRST THEN BEGIN
        Sheet.Range('AW'+j).Value :=branche."Industry Group Code";
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L5');
      IF branche.FINDFIRST THEN BEGIN
        Sheet.Range('AX'+j).Value :=branche."Industry Group Code";
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1..%2','SUS-Z','Z');
      IF branche.FINDFIRST THEN BEGIN
        //    Sheet.Range('AN'+j).Value :='weitere';
        Sheet.Range('AY'+j).Value :=branche."Industry Group Code";
      END;
      verteiler.RESET;
      verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
      IF verteiler.FINDFIRST THEN BEGIN
        Sheet.Range('AZ'+j).Value :=verteiler."Mailing Group Code";
        v_verteiler1:=verteiler."Mailing Group Code";
      END;
      //  Verteilereintrag des Mandanten abfragen
      verteiler.RESET;
      verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."Company No.");
      //   verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5',v_verteiler1,v_verteiler2,v_verteiler3
      //   ,v_verteiler4,v_verteiler5);
      IF verteiler.FINDFIRST THEN BEGIN
        Sheet.Range('AZ'+j).Value :='Mandant';
        v_verteiler1:='Mandant';
      END;
      verteiler.RESET;
      verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
      verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1',v_verteiler1);
      IF verteiler.FINDFIRST THEN BEGIN
        Sheet.Range('BA'+j).Value :=verteiler."Mailing Group Code";
        v_verteiler2:=verteiler."Mailing Group Code"
      END;
      verteiler.RESET;
      verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
      verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2',v_verteiler1,v_verteiler2);
      IF verteiler.FINDFIRST THEN BEGIN
        Sheet.Range('BB'+j).Value :=verteiler."Mailing Group Code";
        v_verteiler3:=verteiler."Mailing Group Code"
      END;
      verteiler.RESET;
      verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
      verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3',v_verteiler1,v_verteiler2,v_verteiler3);
      IF verteiler.FINDFIRST THEN BEGIN
        Sheet.Range('BC'+j).Value :=verteiler."Mailing Group Code";
        v_verteiler4:=verteiler."Mailing Group Code"
      END;
      verteiler.RESET;
      verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
      verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4);
      IF verteiler.FINDFIRST THEN BEGIN
        Sheet.Range('BD'+j).Value :=verteiler."Mailing Group Code";
        v_verteiler5:=verteiler."Mailing Group Code"
      END;
      verteiler.RESET;
      verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
      verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4,v_verteiler5);
      IF verteiler.FINDFIRST THEN BEGIN
        Sheet.Range('BE'+j).Value :=verteiler."Mailing Group Code";
        v_verteiler6:=verteiler."Mailing Group Code"
      END;
      //  Verteilereintrag des Mandanten abfragen
      verteiler.RESET;
      verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."Company No.");
      IF verteiler.FINDFIRST THEN BEGIN
        Sheet.Range('AZ'+j).Value :=verteiler."Mailing Group Code"+' Mandant';
        //      v_verteiler6:=(verteiler."Mailing Group Code"+' Mandant');
      END;
      kon_deb.RESET;
      kon_deb.SETFILTER(kon_deb."Contact No.",'%1',kontakt."Company No.");
      //        Kon_deb.CALCFIELDS("Business Relation Code");
      kon_deb.SETFILTER(kon_deb."Business Relation Code",'%1','DEB');
      IF kon_deb.FINDFIRST THEN BEGIN
        v_au:='';
        v_re:='';
        v_an:='';
        v_gu:='';
        v_art:='';
        belege.RESET;
        belege.SETFILTER(belege."Debitornr.",'%1',kon_deb."No.");
        IF ((v_datum_von=0D) AND (v_datum_bis=0D)) THEN BEGIN
        END ELSE BEGIN
          belege.SETFILTER(belege.Belegdatum,'%1..%2',v_datum_von,v_datum_bis);
        END;
        IF ((v_hersteller1='') AND (v_hersteller2='') AND (v_hersteller3='') AND (v_hersteller4='') AND (v_hersteller5='')) THEN BEGIN
        END ELSE BEGIN
          belege.SETFILTER(belege.Herstellercode,'%1|%2|%3|%4|%5',v_hersteller1,v_hersteller2,v_hersteller3,v_hersteller4,v_hersteller5);
        END;
        //            IF v_hersteller='' THEN BEGIN
        //            END ELSE BEGIN
        //            belege.SETFILTER(belege.Herstellercode,'%1',v_hersteller);
        //            END;
        //             belege.SETFILTER(belege.Herstellercode,'%1|%2','82','85');
        belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
        IF belege.FINDFIRST THEN BEGIN
          v_an:='AN';
          v_art:='Belege '+v_hersteller1+v_hersteller2+v_hersteller3+v_hersteller4+v_hersteller5;;
        END;
        belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
        IF belege.FINDFIRST THEN BEGIN
          v_au:='AU';
          v_art:='Belege '+v_hersteller1+v_hersteller2+v_hersteller3+v_hersteller4+v_hersteller5;;
        END;
        belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
        IF belege.FINDFIRST THEN BEGIN
          v_re:='RE';
          v_art:='Belege '+v_hersteller1+v_hersteller2+v_hersteller3+v_hersteller4+v_hersteller5;;
        END;
        belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
        IF belege.FINDFIRST THEN BEGIN
          v_gu:='GU';
          v_art:='Belege '+v_hersteller1+v_hersteller2+v_hersteller3+v_hersteller4+v_hersteller5;;
        END;
        Sheet.Range('BF'+j).Value :=v_art;
        Sheet.Range('BG'+j).Value :=v_an;
        Sheet.Range('BH'+j).Value :=v_au;
        Sheet.Range('BI'+j).Value :=v_re;
        Sheet.Range('BJ'+j).Value :=v_gu;
        Sheet.Range('BK'+j).Value :=kontakt.Gesperrt;
        Sheet.Range('BL'+j).Value :=kontakt."Unternehmen verlassen";
      END;
      j:=INCSTR(j);
      //END;
      //UNTIL verteiler1.NEXT=0;
      //END;
    END;

    LOCAL PROCEDURE Trainingsinfos2@1000000000();
    BEGIN
      verteiler1.RESET;
      verteiler1.SETFILTER(verteiler1."Mailing Group Code",'%1','TRAINING');
      IF verteiler1.FIND('-') THEN BEGIN
        REPEAT
          kontakt.RESET;
          kontakt.SETFILTER(kontakt."No.",'%1',verteiler1."Contact No.");
          IF kontakt.FINDFIRST THEN BEGIN
            IF kontakt.Type=kontakt.Type::Person THEN BEGIN
              Andruckverwaltung;
            END ELSE BEGIN
              kontakt.RESET;
              kontakt.SETFILTER(kontakt."Company No.",'%1',verteiler1."Contact No.");
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Andruckverwaltung;
                UNTIL kontakt.NEXT=0;
              END;
            END;
          END;
        UNTIL verteiler1.NEXT=0;
      END;

      CloseExcel('Trainingsinfo2','Trainingsinfo2','F:\Daten Neu\User\Uwe\Mailing');
      MESSAGE(Text003);
    END;

    LOCAL PROCEDURE CreateExcel@1000000001();
    BEGIN
      IF DoUpdateExistingWorksheet THEN BEGIN
        IF ServerFileName = '' THEN
          ServerFileName := FileMgt.UploadFile(Text002,ExcelFileExtensionTok);
        IF ServerFileName = '' THEN
          EXIT;
        SheetName := TempExcelBuffer.SelectSheetsName(ServerFileName);
        IF SheetName = '' THEN
          EXIT;
      END;

      Window.OPEN(
        Text000 +
        '@1@@@@@@@@@@@@@@@@@@@@@\');

      TempExcelBuffer.DELETEALL;
      CLEAR(TempExcelBuffer);
    END;

    LOCAL PROCEDURE CloseExcel@1000000002(Sheetname@1000000000 : Text;FileName@1000000001 : Text;FilePath@1000000002 : Text);
    BEGIN
      Window.CLOSE;

      IF DoUpdateExistingWorksheet THEN BEGIN
        TempExcelBuffer.UpdateBook(ServerFileName,Sheetname);
        TempExcelBuffer.WriteSheet('',COMPANYNAME,USERID);
        TempExcelBuffer.CloseBook;
        IF NOT Testmode THEN
          TempExcelBuffer.DownloadAndOpenExcel;
      END ELSE BEGIN
        TempExcelBuffer.CreateBook(ServerFileName,Sheetname);
        TempExcelBuffer.WriteSheet(Sheetname,COMPANYNAME,USERID);
        //TempExcelBuffer.SetWidth(1,'A',20);
        TempExcelBuffer.CloseBook;
        IF NOT Testmode THEN BEGIN
          IF (FileName = '') OR (FilePath = '') THEN
            TempExcelBuffer.OpenExcel //hat Autofit drin der die Spaltenbreite wieder berschreibt, deshalb neue Fkt. nachfolgend
          ELSE
            TempExcelBuffer.OpenExcelWithoutAutoFit(Sheetname,FileName + ExcelFileExtensionTok,FilePath,TRUE);
        END;
      END;
      IF NOT Testmode THEN
        TempExcelBuffer.GiveUserControl;
    END;

    LOCAL PROCEDURE EnterCell@1000000026(RowNo@1000000000 : Integer;ColumnNo@1000000001 : Integer;CellValue@1000000002 : Text[250];Formular@1000000008 : Text[250];Bold@1000000003 : Boolean;Italic@1000000004 : Boolean;UnderLine@1000000005 : Boolean;NumberFormat@1000000006 : Text[30];CellType@1000000007 : Option);
    BEGIN
      TempExcelBuffer.INIT;
      TempExcelBuffer.VALIDATE("Row No.",RowNo);
      TempExcelBuffer.VALIDATE("Column No.",ColumnNo);
      TempExcelBuffer."Cell Value as Text" := CellValue;
      TempExcelBuffer.Formula := Formular;
      TempExcelBuffer.Bold := Bold;
      TempExcelBuffer.Italic := Italic;
      TempExcelBuffer.Underline := UnderLine;
      TempExcelBuffer.NumberFormat := NumberFormat;
      TempExcelBuffer."Cell Type" := CellType;
      TempExcelBuffer.INSERT;
    END;

    LOCAL PROCEDURE UpdateCell@1000000004(RowNo@1000000000 : Integer;ColumnNo@1000000001 : Integer;CellValue@1000000002 : Text);
    BEGIN
      IF TempExcelBuffer.GET(RowNo,ColumnNo)  THEN BEGIN
        TempExcelBuffer."Cell Value as Text" := CellValue;
        TempExcelBuffer.MODIFY;
      END;
    END;

    LOCAL PROCEDURE Funktion_Neu@1000000005();
    BEGIN

      // wenn "nur_firma_verlassen" dann Funktion "Firma verlassen Neu"
      IF v_nur_firm_verlassen=TRUE THEN BEGIN
        Firma_verlassen_Neu;
      END ELSE BEGIN
        kontakt.RESET;
        // Einschr„kung gesperrte Kontakte ***********************************************************************
        kontakt.SETFILTER(kontakt.Gesperrt,'%1',FALSE);
        // Einschr„kung ohne Firma verlassen
        IF v_ohne_firm_verlassen=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Unternehmen verlassen",'%1',FALSE);
        END;
        // Einschr„nkung  Adressen nur mit Personen suchen
        IF v_person_adr=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Person);
        END;
        // Einschr„nkung  Adressen nur mit Mandant suchen
        IF v_mandant_adr=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Company);
        END;
        // Einschr„nkung  Adressen nur mit Emailadresse suchen
        IF v_email_adr=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."E-Mail",'<>%1','');
        END;
        // Einschr„nkung  Adressen L„nderkennzeichen DE
        IF v_landkz_de=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Country/Region Code",'%1','DE');
        END;
        // Einschr„nkung  Adressen L„nderkennzeichen DE, AT und CH
        IF v_landkz_de_at_ch=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Country/Region Code",'%1|%2|%3','DE','AT','CH');
        END;

        IF ((v_reiter4=TRUE) AND (v_alle_acs=TRUE)) THEN BEGIN
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END ELSE BEGIN
          IF v_reiter2=TRUE THEN BEGIN
            //  Einschr„nkung Positionscode (Funktion)
            IF v_ek=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','EINKAUF');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_ekl=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','EINKAUF-L');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_entwl=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','ENTW.-LEIT');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_entwh=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','ENTW.-HW');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_entws=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','ENTW.-SW');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_fin=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','FINANZEN');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_GL=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','GSCH.-LEIT');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_prod=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','PRODUKTION');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_qual=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','QUALITŽT');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_vertl=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','VERTRIEB-L');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_vert=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','VERTRIEB');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_supl=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SUPPORT-L');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_sup=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SUPPORT');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_tech=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','TECHNIKER');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_ml=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','MARKET-LEI');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_ma=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','MARKETING');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_so=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SONSTIGE');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_sop=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SONSTIGE-P');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_sol=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SONSTIGE-L');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_alle=TRUE THEN BEGIN
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
          END;
        END;
      END;

      IF v_reiter3=TRUE THEN BEGIN
        //  Einschr„nkung Positionscode
        IF v_ek=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','EINKAUF');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_ekl=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','EINKAUF-L');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_entwl=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','ENTW.-LEIT');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_entwh=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','ENTW.-HW');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_entws=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','ENTW.-SW');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_fin=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','FINANZEN');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_GL=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','GSCH.-LEIT');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_prod=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','PRODUKTION');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_qual=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','QUALITŽT');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_vertl=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','VERTRIEB-L');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_vert=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','VERTRIEB');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_supl=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SUPPORT-L');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_sup=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SUPPORT');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_tech=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','TECHNIKER');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_ml=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','MARKET-LEI');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_ma=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','MARKETING');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_so=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SONSTIGE');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_sop=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SONSTIGE-P');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_sol=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SONSTIGE-L');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_alle=TRUE THEN BEGIN
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
      END ELSE BEGIN
      END;

      IF ((v_reiter2=FALSE) AND (v_reiter3=FALSE)) THEN ERROR('Kein H„kchen bei Reiter 2 Branche_Neu oder 3 Branche_System_Neu gesetzt.');

      CloseExcel('Mailingadressen','Mailingadressen','F:\Daten Neu\User\Uwe\Mailing');
      MESSAGE(Text003);
    END;

    LOCAL PROCEDURE Branche_Neu@1000000006();
    BEGIN
      v_anz_branche:=0;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      IF ((v_telecom1=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','TELECOM1');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_telecom2=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','TELECOM2');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_telecom3=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','TELECOM3');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_telecom4=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','TELECOM4');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_telecom5=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','TELECOM5');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_mm1=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','MM1');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_mm2=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','MM2');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_mm3=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','MM3');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_mm4=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','MM4');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_mm5=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','MM5');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_security1=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SECURITY1');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_security2=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SECURITY2');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_security3=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SECURITY3');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_security4=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SECURITY4');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_it1=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','IT-SYSTEM1');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_it2=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','IT-SYSTEM2');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_it3=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','IT-SYSTEM3');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_it4=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','IT-SYSTEM4');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_ww1=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','WARENWIRT1');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_ww2=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','WARENWIRT2');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_ww3=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','WARENWIRT3');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_ww4=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','WARENWIRT4');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_aufentw=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','AUFTR-ENTW');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_bestcker=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','BESTšCKER');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_h„ndler=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','HŽNDLER');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_dienstlei=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','DIENSTLEI');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_uni=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','UNI/TH/FH2');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_data1=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','DATACOM1');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_data2=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','DATACOM2');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_data3=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','DATACOM3');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_data4=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','DATACOM4');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_data5=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','DATACOM5');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_data6=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','DATACOM6');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_indu1=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','INDUSTRIE1');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_indu2=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','INDUSTRIE2');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_indu3=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','INDUSTRIE3');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_indu4=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','INDUSTRIE4');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_indu5=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','INDUSTRIE5');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_indu6=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','INDUSTRIE6');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_indu7=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','INDUSTRIE7');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_fahr1=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','FAHRZEUG1');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_fahr2=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','FAHRZEUG2');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_fahr3=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','FAHRZEUG3');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_fahr4=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','FAHRZEUG4');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_fahr5=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','FAHRZEUG5');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_con1=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','CONSUMER1');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_con2=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','CONSUMER2');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_con3=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','CONSUMER3');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_geb„ude=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','GEBŽUDE/IN');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_medizin=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','MEDIZIN');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_presse=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','PRESSE');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;

      IF ((v_alle_bran=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
    END;

    LOCAL PROCEDURE Branche_System_Neu@1000000007();
    BEGIN
      v_anz_branche:=0;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      IF ((v_SUS_P1=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P1');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_SUS_P2=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P2');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_SUS_P3=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P3');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_SUS_P4=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P4');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_SUS_P5=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P5');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;

      IF ((v_SUS_T1=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T1');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_SUS_T2=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T2');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_SUS_T3=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T3');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_SUS_T4=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T4');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_SUS_T5=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T5');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_SUS_T6=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T6');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_SUS_T7=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T7');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;

      IF ((v_SUS_TP=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-TP');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_SUS_L1=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L1');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_SUS_L2=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L2');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_SUS_L3=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L3');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_SUS_L4=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L4');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_SUS_L5=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L5');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_SUS_ENDK=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-ENDK');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;

      IF ((v_SUS_NO_ACS=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-ACS');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_SUS_NO_FER=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-FER');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_SUS_NO_SPL=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-SPL');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_SUS_NO_WIL=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-WIL');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
      IF ((v_NO_MAILING=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1','NO-MAILING');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;

      IF ((v_alle_acs=TRUE) AND (v_anz_branche=0)) THEN BEGIN
        branche.SETFILTER(branche."Industry Group Code",'%1..%2','SUS-A','SUS-Z');
        IF branche.FINDFIRST THEN BEGIN
          v_anz_branche:=1;
          Andruckverwaltung;
        END;
      END;
    END;

    LOCAL PROCEDURE Belege_Neu@1000000008();
    BEGIN
      IF ((v_datum_von=0D) AND (v_hersteller1='') AND (v_hersteller2='') AND (v_hersteller3='') AND (v_hersteller4='') AND (v_hersteller5='')) THEN BEGIN
        IF CONFIRM ('Wollen Sie eine Einschr„nkung bei den Belegen vornehmen?', TRUE) THEN BEGIN
          ERROR('Abruch des Aufrufs!');
        END;
      END;

      debitor.RESET;
      debitor.SETFILTER(debitor."No.",'>%1','1');
      IF debitor.FIND('-') THEN BEGIN
        REPEAT
          v_au:='';
          v_re:='';
          v_an:='';
          v_gu:='';
          belege.RESET;
          belege.SETFILTER(belege."Debitornr.",'%1',debitor."No.");
          IF v_datum_von=0D THEN BEGIN
          END ELSE BEGIN
            belege.SETFILTER(belege.Belegdatum,'%1..%2',v_datum_von,v_datum_bis);
          END;
          IF ((v_hersteller1='') AND (v_hersteller2='') AND (v_hersteller3='') AND (v_hersteller4='') AND (v_hersteller5='')) THEN BEGIN
          END ELSE BEGIN
            belege.SETFILTER(belege.Herstellercode,'%1|%2|%3|%4|%5',v_hersteller1,v_hersteller2,v_hersteller3,v_hersteller4,v_hersteller5);
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
          IF belege.FINDFIRST THEN BEGIN
            v_an:='AN';
          END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
          IF belege.FINDFIRST THEN BEGIN
            v_au:='AU';
          END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
          IF belege.FINDFIRST THEN BEGIN
            v_re:='RE';
          END;
          belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
          IF belege.FINDFIRST THEN BEGIN
            v_gu:='GU';
          END;
          IF ((v_an='AN') OR (v_au='AU') OR (v_re='RE') OR (v_gu='GU')) THEN BEGIN
            kon_deb.RESET;
            kon_deb.SETFILTER(kon_deb."No.",'%1',belege."Debitornr.");
            kon_deb.SETFILTER(kon_deb."Business Relation Code",'%1','DEB');
            IF kon_deb.FINDFIRST THEN BEGIN
              v_art:='Belege ';
              kontakt.RESET;
              kontakt.SETFILTER(kontakt."Company No.",'%1',kon_deb."Contact No.");
              kontakt.SETFILTER(kontakt.Gesperrt,'%1',FALSE);
              // Einschr„kung nur wenn Firma verlassen
              IF v_nur_firm_verlassen=TRUE THEN BEGIN
                kontakt.SETFILTER(kontakt."Unternehmen verlassen",'%1',TRUE);
              END;
              // Einschr„kung ohne Firma verlassen
              IF v_ohne_firm_verlassen=TRUE THEN BEGIN
                kontakt.SETFILTER(kontakt."Unternehmen verlassen",'%1',FALSE);
              END;
              // Einschr„nkung  Adressen nur mit Personen suchen
              IF v_person_adr=TRUE THEN BEGIN
                kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Person);
              END;
              // Einschr„nkung  Adressen nur mit Mandant suchen
              IF v_mandant_adr=TRUE THEN BEGIN
                kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Company);
              END;
              // Einschr„nkung  Adressen nur mit Emailadresse suchen
              IF v_email_adr=TRUE THEN BEGIN
                kontakt.SETFILTER(kontakt."E-Mail",'<>%1','');
              END;
              // Einschr„nkung  Adressen L„nderkennzeichen DE
              IF v_landkz_de=TRUE THEN BEGIN
                kontakt.SETFILTER(kontakt."Country/Region Code",'%1','DE');
              END;
              // Einschr„nkung  Adressen L„nderkennzeichen DE, AT und CH
              IF v_landkz_de_at_ch=TRUE THEN BEGIN
                kontakt.SETFILTER(kontakt."Country/Region Code",'%1|%2|%3','DE','AT','CH');
              END;
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Andruckverwaltung;
                UNTIL kontakt.NEXT=0;
              END;
            END;
          END;
        UNTIL debitor.NEXT=0;
      END;
    END;

    LOCAL PROCEDURE Memos_Neu@1000000009();
    BEGIN
      // alle Ansprechpartner eines Kontaktes bei pos. Memo anzeigen
      kontakt1.RESET;
      kontakt1.SETFILTER(kontakt1.Type,'%1',kontakt1.Type::Company);
      kontakt1.SETFILTER(kontakt1.Gesperrt,'%1',FALSE);
      IF kontakt1.FIND('-') THEN BEGIN
        REPEAT
          memok.RESET;
          memok.SETFILTER(memok."Mandantennr.",'%1',kontakt1."No.");
          IF v_datum_von=0D THEN BEGIN
          END ELSE BEGIN
            memok.SETFILTER(memok.Anlagedatum,'%1..%2',v_datum_von,v_datum_bis);
          END;
          IF memok.FIND('-') THEN BEGIN
            v_memo_datum:=0D;
            v_memo_kurztext:='';
            REPEAT
              linie.RESET;
              linie.SETFILTER(linie."Memonr.",'%1',memok."Memonr.");
              IF ((v_hersteller1='') AND (v_hersteller2='') AND (v_hersteller3='') AND (v_hersteller4='') AND (v_hersteller5='')) THEN BEGIN
      //        IF v_hersteller='' THEN BEGIN
              END ELSE BEGIN
                linie.SETFILTER(linie.Linienkrzel,'%1|%2|%3|%4|%5',v_hersteller1,v_hersteller2,v_hersteller3,v_hersteller4,v_hersteller5);
      //        linie.SETFILTER(linie.Linienkrzel,'%1',v_hersteller);
              END;
              IF linie.FINDFIRST THEN BEGIN
                kontakt.RESET;
                kontakt.SETFILTER(kontakt."Company No.",'%1',memok."Mandantennr.");
                IF kontakt.FINDFIRST THEN BEGIN v_art:='Memos ';
                // Einschr„kung nur wenn Firma verlassen
                  IF v_nur_firm_verlassen=TRUE THEN BEGIN
                    kontakt.SETFILTER(kontakt."Unternehmen verlassen",'%1',TRUE);
                  END;
                 // Einschr„kung ohne Firma verlassen
                  IF v_ohne_firm_verlassen=TRUE THEN BEGIN
                    kontakt.SETFILTER(kontakt."Unternehmen verlassen",'%1',FALSE);
                  END;
                 // Einschr„nkung  Adressen nur mit Personen suchen
                  IF v_person_adr=TRUE THEN BEGIN
                    kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Person);
                  END;
                 // Einschr„nkung  Adressen nur mit Mandant suchen
                  IF v_mandant_adr=TRUE THEN BEGIN
                    kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Company);
                  END;
                 // Einschr„nkung  Adressen nur mit Emailadresse suchen
                  IF v_email_adr=TRUE THEN BEGIN
                    kontakt.SETFILTER(kontakt."E-Mail",'<>%1','');
                  END;
                 // Einschr„nkung  Adressen L„nderkennzeichen DE
                  IF v_landkz_de=TRUE THEN BEGIN
                    kontakt.SETFILTER(kontakt."Country/Region Code",'%1','DE');
                  END;
                 // Einschr„nkung  Adressen L„nderkennzeichen DE, AT und CH
                  IF v_landkz_de_at_ch=TRUE THEN BEGIN
                    kontakt.SETFILTER(kontakt."Country/Region Code",'%1|%2|%3','DE','AT','CH');
                  END;
                  IF kontakt.FIND('-') THEN BEGIN
                    REPEAT
                      v_memo_datum:=memok.Memodatum;
                      v_memo_kurztext:=memok.Memokurztext;
                      Andruckverwaltung;
                    UNTIL kontakt.NEXT=0;
                  END;
                END;
              END;
            UNTIL memok.NEXT=0;
          END;
        UNTIL kontakt1.NEXT=0;
      END;
    END;

    LOCAL PROCEDURE Andruckverwaltung@1000000010();
    BEGIN
      //MESSAGE(Text067);
      v_z„hler:=v_z„hler+1;
      IF v_adr_email=TRUE THEN Adr_Emailversand_Neu;
      IF v_bericht_adr1=TRUE THEN "Bericht Adresse1_Neu";
      IF v_bericht_adr2=TRUE THEN "Bericht Adresse2_Neu";
      IF v_adr_sus=TRUE THEN Adr_Emailversand_SuS_Neu;
      //IF v_adr_email1=TRUE THEN Adr_Emailversand1;
      IF v_adr_sus_un=TRUE THEN Adr_SUS_ohne_UNSUB_Neu;
    END;

    LOCAL PROCEDURE Firma_verlassen_Neu@1000000011();
    BEGIN
      CreateExcel;
      RecNo := 0;
      RowNo := 1;
      EnterCell(RowNo,1,'Kontakt-Nr.','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,2,'Name/Vorname','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,3,'Firma','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,4,'Funktion','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,5,'','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,6,'','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,7,'','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,8,'Firma Kt-Nr.','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,9,'Anrede','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,10,'Vorname','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,11,'Nachname','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,12,'Abteilung','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,13,'Email','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,14,'Telefon','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,15,'Land','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,16,'PLZ','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,17,'Ort','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,18,'Verk„ufer','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,19,'Bearbeiter','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,20,'Gebiet','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,21,'Team','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,22,'UN verlassen','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,23,'am','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,24,'Gesperrt','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,25,'','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);

      kontakt.RESET;
      kontakt.SETFILTER(kontakt."Unternehmen verlassen",'%1',TRUE);
      kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Person);
      IF kontakt.FIND('-') THEN BEGIN
        REPEAT
          RowNo := RowNo + 1;
          EnterCell(RowNo,1,kontakt."No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,2,kontakt.Name,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,3,kontakt."Company Name",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,4,kontakt."Organizational Level Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);

          EnterCell(RowNo,8,kontakt."Company No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          IF kontakt."Salutation Code" = 'HERR' THEN
          EnterCell(RowNo,9,'Herr','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          IF kontakt."Salutation Code" = 'FRAU' THEN
          EnterCell(RowNo,9,'Frau','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,10,kontakt."First Name",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,11,kontakt.Surname,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,12,kontakt.Abteilung,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,13,kontakt."E-Mail",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,14,kontakt."Phone No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,15,kontakt."Country/Region Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,16,FORMAT(kontakt."Post Code"),'',FALSE,FALSE,FALSE,'00000',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,17,kontakt.City,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,18,kontakt."Salesperson Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,19,kontakt."Betreuer Innendienst",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,20,kontakt."Territory Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,21,kontakt.Teams,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,22,FORMAT(kontakt."Unternehmen verlassen"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,23,FORMAT(kontakt."UN verlassen am"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,24,FORMAT(kontakt.Gesperrt),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        UNTIL kontakt.NEXT=0;
      END;

      CloseExcel('Firma verlassen Neu','Firma verlassen Neu','F:\Daten Neu\User\Uwe\Mailing');
      MESSAGE('Firma verlassen Neu');
    END;

    LOCAL PROCEDURE Adr_Emailversand_Neu@1000000017();
    BEGIN
      IF v_z„hler=1 THEN BEGIN
        CreateExcel;
        RecNo := 0;
        RowNo := 1;
        EnterCell(RowNo,1,'USER1','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,2,'Art','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,3,'Firma','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,4,'Firma2','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,5,'Anrede','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,6,'Titel','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,7,'Vorname','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,8,'Name','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,9,'Abteilung','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,10,'Straáe','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,11,'Straáe2','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,12,'Nation','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,13,'PLZ','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,14,'Ort','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,15,'Verk„ufer','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,16,'Betreuer','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,17,'Gebiet','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,18,'Anzahl Branche','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,19,'Funktion','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,20,'Email','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,21,'Telefon','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,22,'USER2','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,23,'Mandant gesperrt','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,24,'Person gesperrt','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,25,'Firma verlassen','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,26,'Bemerkung','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,27,'AC Solutionpartner','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,28,'Innovator','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,29,'Auftragsentwickl.','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,30,'Branche1','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,31,'Branche2','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,32,'Branche3','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,33,'Branche4','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,34,'Branche5','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,35,'Branche6','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,36,'Branche7','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,37,'Branche8','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,38,'Branche9','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,39,'Branche10','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,40,'Branche11','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,41,'Branche12','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,42,'Branche13','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,43,'Branche14','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,44,'Branche15','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,45,'Verteiler1','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,46,'Verteiler2','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,47,'Verteiler3','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,48,'Verteiler4','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,49,'Verteiler5','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,50,'Verteiler6','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,51,'Adr.-Herkunft','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,52,'Angebote','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,53,'Auftr„ge','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,54,'Rechnungen','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,55,'Gutschriften','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,56,'Gesperrt','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,57,'Firma verlassen','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        v_branche1:='';
        v_branche2:='';
        v_branche3:='';
        v_branche4:='';
        v_branche5:='';
        v_branche6:='';
        RowNo := RowNo + 1;
        EnterCell(RowNo,1,kontakt."No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,2,FORMAT(kontakt.Type),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        IF kontakt.Type=kontakt.Type::Company THEN BEGIN
          EnterCell(RowNo,3,kontakt.Name,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,4,kontakt."Name 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END ELSE BEGIN
          kontakt1.RESET;
          kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
          IF kontakt1.FINDFIRST THEN BEGIN
            EnterCell(RowNo,3,kontakt1.Name,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,4,kontakt1."Name 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          END;
        END;
        IF kontakt."Salutation Code" = 'HERR' THEN EnterCell(RowNo,5,'Herr','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        IF kontakt."Salutation Code" = 'FRAU' THEN EnterCell(RowNo,5,'Frau','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,6,kontakt."Job Title",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,7,kontakt."First Name",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,8,kontakt.Surname,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,9,kontakt.Abteilung,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,10,kontakt.Address,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,11,kontakt."Address 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,12,kontakt."Country/Region Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,13,kontakt."Post Code",'',FALSE,FALSE,FALSE,'00000',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,14,kontakt.City,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,15,kontakt."Salesperson Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,16,kontakt."Betreuer Innendienst",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,17,kontakt."Territory Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,18,FORMAT(kontakt."No. of Industry Groups"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,19,kontakt."Organizational Level Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,20,kontakt."E-Mail",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,21,kontakt."Phone No.",'',FALSE,FALSE,FALSE,'00000000000000000',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,22,kontakt."Company No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,24,FORMAT(kontakt.Gesperrt),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        kontakt1.RESET;
        kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
        IF kontakt1.FINDFIRST THEN BEGIN
          EnterCell(RowNo,23,FORMAT(kontakt1.Gesperrt),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        EnterCell(RowNo,25,FORMAT(kontakt."Unternehmen verlassen"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,26,FORMAT(kontakt.Comment),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,27,kontakt.AC_Solutionpartner,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,56,FORMAT(kontakt.Gesperrt),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,57,FORMAT(kontakt."Unternehmen verlassen"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        // Branchenauswertung
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1|%2|%3|%4|%5','1-INNOVATO','2-EARL ADO','3-EARL MAJ','4-LATE MAJ','5-LAGGARDS');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,28,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','AUFTR-ENTW');
        IF branche."Industry Group Code"='AUFTR-ENTW' THEN BEGIN
          EnterCell(RowNo,29,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        //  Branche Neu Start   ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        branche.RESET;
        v_branche:=0;
        v_branche1:='';
        v_branche2:='';
        v_branche3:='';
        v_branche4:='';
        v_branche5:='';
        v_branche6:='';
        v_branche7:='';
        v_branche8:='';
        v_branche9:='';
        v_branche10:='';
        v_branche11:='';
        v_branche12:='';
        v_branche13:='';
        v_branche14:='';
        v_branche15:='';
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5&<>%6','1-INNOVATO','2-EARL ADO','3-EARL MAJ','4-LATE MAJ','5-LAGGARDS','AUFTR-ENTW');
        IF branche.FIND('-') THEN BEGIN
          REPEAT
            v_branche:=v_branche+1;
            IF v_branche = 1 THEN  v_branche1:=branche."Industry Group Code";
            IF v_branche = 2 THEN  v_branche2:=branche."Industry Group Code";
            IF v_branche = 3 THEN  v_branche3:=branche."Industry Group Code";
            IF v_branche = 4 THEN  v_branche4:=branche."Industry Group Code";
            IF v_branche = 5 THEN  v_branche5:=branche."Industry Group Code";
            IF v_branche = 6 THEN  v_branche6:=branche."Industry Group Code";
            IF v_branche = 7 THEN  v_branche7:=branche."Industry Group Code";
            IF v_branche = 8 THEN  v_branche8:=branche."Industry Group Code";
            IF v_branche = 9 THEN  v_branche9:=branche."Industry Group Code";
            IF v_branche =10 THEN  v_branche10:=branche."Industry Group Code";
            IF v_branche =11 THEN  v_branche11:=branche."Industry Group Code";
            IF v_branche =12 THEN  v_branche12:=branche."Industry Group Code";
            IF v_branche =13 THEN  v_branche13:=branche."Industry Group Code";
            IF v_branche =14 THEN  v_branche14:=branche."Industry Group Code";
            IF v_branche =15 THEN  v_branche15:=branche."Industry Group Code";
          UNTIL branche.NEXT=0;
        END;
        EnterCell(RowNo,30,v_branche1,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,31,v_branche2,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,32,v_branche3,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,33,v_branche4,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,34,v_branche5,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,35,v_branche6,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,36,v_branche7,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,37,v_branche8,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,38,v_branche9,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,39,v_branche10,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,40,v_branche11,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,41,v_branche12,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,42,v_branche13,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,43,v_branche14,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,44,v_branche15,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        IF v_branche>15 THEN EnterCell(RowNo,60,'Fehler Branche','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        //  Branche Neu Ende  ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,45,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler1:=verteiler."Mailing Group Code";
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1',v_verteiler1);
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,46,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler2:=verteiler."Mailing Group Code"
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2',v_verteiler1,v_verteiler2);
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,47,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler3:=verteiler."Mailing Group Code"
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3',v_verteiler1,v_verteiler2,v_verteiler3);
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,48,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler4:=verteiler."Mailing Group Code"
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4);
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,49,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler5:=verteiler."Mailing Group Code"
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4,v_verteiler5);
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,50,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler6:=verteiler."Mailing Group Code"
        END;

        //  Verteilereintrag des Mandanten abfragen
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."Company No.");
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,58,(verteiler."Mailing Group Code"+' Mandant'),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          //Sheet.Range('AV'+j).Value :=verteiler."Mailing Group Code"+' Mandant';
          v_verteiler6:=(verteiler."Mailing Group Code"+' Mandant');
        END;
        kon_deb.RESET;
        kon_deb.SETFILTER(kon_deb."Contact No.",'%1',kontakt."Company No.");
        kon_deb.SETFILTER(kon_deb."Business Relation Code",'%1','DEB');
        IF kon_deb.FINDFIRST THEN BEGIN
          v_au:='';
          v_re:='';
          v_an:='';
          v_gu:='';
          v_art:='';
          belege.RESET;
          belege.SETFILTER(belege."Debitornr.",'%1',kon_deb."No.");
          IF ((v_datum_von=0D) AND (v_datum_bis=0D)) THEN BEGIN
          END ELSE BEGIN
            belege.SETFILTER(belege.Belegdatum,'%1..%2',v_datum_von,v_datum_bis);
          END;
          IF ((v_hersteller1='') AND (v_hersteller2='') AND (v_hersteller3='') AND (v_hersteller4='') AND (v_hersteller5='')) THEN BEGIN
          END ELSE BEGIN
            belege.SETFILTER(belege.Herstellercode,'%1|%2|%3|%4|%5',v_hersteller1,v_hersteller2,v_hersteller3,v_hersteller4,v_hersteller5);
          END;
          IF belege.Herstellercode=v_hersteller1 THEN BEGIN
            v_art:='Belege ';
            v_art:=v_art+v_hersteller1;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
            IF belege.FINDFIRST THEN BEGIN
              v_an:='AN ';
              v_an:=v_an+v_hersteller1;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
            IF belege.FINDFIRST THEN BEGIN
              v_au:='AU ';
              v_au:=v_au+v_hersteller1;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
            IF belege.FINDFIRST THEN BEGIN
              v_re:='RE ';
              v_re:=v_re+v_hersteller1;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
            IF belege.FINDFIRST THEN BEGIN
              v_gu:='GU ';
              v_gu:=v_gu+v_hersteller1;
            END;
          END;

          IF belege.Herstellercode=v_hersteller2 THEN BEGIN
            IF v_art='' THEN BEGIN
              v_art:='Belege';
            END;
            v_art:=v_art+' '+v_hersteller2;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
            IF belege.FINDFIRST THEN BEGIN
              IF v_an='' THEN BEGIN
                v_an:='AN';
              END;
              v_an:=v_an+' '+v_hersteller2;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
            IF belege.FINDFIRST THEN BEGIN
              IF v_au='' THEN BEGIN
                v_au:='AU';
              END;
              v_au:=v_au+' '+v_hersteller2;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
            IF belege.FINDFIRST THEN BEGIN
              IF v_re='' THEN BEGIN
                v_re:='RE';
              END;
              v_re:=v_re+' '+v_hersteller2;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
            IF belege.FINDFIRST THEN BEGIN
              IF v_gu='' THEN BEGIN
                v_gu:='GU';
              END;
              v_gu:=v_gu+' '+v_hersteller2;
            END;
          END;

          IF belege.Herstellercode=v_hersteller3 THEN BEGIN
            IF v_art='' THEN BEGIN
              v_art:='Belege';
            END;
            v_art:=v_art+' '+v_hersteller3;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
            IF belege.FINDFIRST THEN BEGIN
              IF v_an='' THEN BEGIN
                v_an:='AN';
              END;
              v_an:=v_an+' '+v_hersteller3;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
            IF belege.FINDFIRST THEN BEGIN
              IF v_au='' THEN BEGIN
                v_au:='AU';
              END;
              v_au:=v_au+' '+v_hersteller3;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
            IF belege.FINDFIRST THEN BEGIN
              IF v_re='' THEN BEGIN
                v_re:='RE';
              END;
              v_re:=v_re+' '+v_hersteller3;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
            IF belege.FINDFIRST THEN BEGIN
              IF v_gu='' THEN BEGIN
                v_gu:='GU';
              END;
              v_gu:=v_gu+' '+v_hersteller3;
            END;
          END;

          IF belege.Herstellercode=v_hersteller4 THEN BEGIN
            IF v_art='' THEN BEGIN
              v_art:='Belege';
            END;
            v_art:=v_art+' '+v_hersteller4;

            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
            IF belege.FINDFIRST THEN BEGIN
              IF v_an='' THEN BEGIN
                v_an:='AN';
              END;
              v_an:=v_an+' '+v_hersteller4;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
            IF belege.FINDFIRST THEN BEGIN
              IF v_au='' THEN BEGIN
                v_au:='AU';
              END;
              v_au:=v_au+' '+v_hersteller4;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
            IF belege.FINDFIRST THEN BEGIN
              IF v_re='' THEN BEGIN
                v_re:='RE';
              END;
              v_re:=v_re+' '+v_hersteller4;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
            IF belege.FINDFIRST THEN BEGIN
              IF v_gu='' THEN BEGIN
                v_gu:='GU';
              END;
              v_gu:=v_gu+' '+v_hersteller4;
            END;
          END;

          IF belege.Herstellercode=v_hersteller5 THEN BEGIN
            IF v_art='' THEN BEGIN
              v_art:='Belege';
            END;
            v_art:=v_art+' '+v_hersteller5;

            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
            IF belege.FINDFIRST THEN BEGIN
              IF v_an='' THEN BEGIN
                v_an:='AN';
              END;
              v_an:=v_an+' '+v_hersteller5;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
            IF belege.FINDFIRST THEN BEGIN
              IF v_au='' THEN BEGIN
                v_au:='AU';
              END;
              v_au:=v_au+' '+v_hersteller5;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
            IF belege.FINDFIRST THEN BEGIN
              IF v_re='' THEN BEGIN
                v_re:='RE';
              END;
              v_re:=v_re+' '+v_hersteller5;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
            IF belege.FINDFIRST THEN BEGIN
              IF v_gu='' THEN BEGIN
                v_gu:='GU';
              END;
              v_gu:=v_gu+' '+v_hersteller5;
            END;
          END;
          EnterCell(RowNo,51,v_art,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,52,v_an,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,53,v_au,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,54,v_re,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,55,v_gu,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
      END ELSE BEGIN
      //  v_branche1:='';
      //  v_branche2:='';
      //  v_branche3:='';
      //  v_branche4:='';
      //  v_branche5:='';
      //  v_branche6:='';
        RowNo := RowNo + 1;
        EnterCell(RowNo,1,kontakt."No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,2,FORMAT(kontakt.Type),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        IF kontakt.Type=kontakt.Type::Company THEN BEGIN
          EnterCell(RowNo,3,kontakt.Name,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,4,kontakt."Name 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          // Sheet.Range('C'+j).Value :=kontakt.Name;
          // Sheet.Range('D'+j).Value :=kontakt."Name 2";
        END ELSE BEGIN
          kontakt1.RESET;
          kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
          IF kontakt1.FINDFIRST THEN BEGIN
            EnterCell(RowNo,3,kontakt1.Name,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,4,kontakt1."Name 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            // Sheet.Range('C'+j).Value :=kontakt1.Name;
            // Sheet.Range('D'+j).Value :=kontakt1."Name 2";
          END;
        END;
        IF kontakt."Salutation Code" = 'HERR' THEN EnterCell(RowNo,5,'Herr','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        IF kontakt."Salutation Code" = 'FRAU' THEN EnterCell(RowNo,5,'Frau','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,6,kontakt."Job Title",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,7,kontakt."First Name",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,8,kontakt.Surname,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,9,kontakt.Abteilung,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,10,kontakt.Address,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,11,kontakt."Address 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,12,kontakt."Country/Region Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,13,kontakt."Post Code",'',FALSE,FALSE,FALSE,'00000',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,14,kontakt.City,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,15,kontakt."Salesperson Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,16,kontakt."Betreuer Innendienst",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,17,kontakt."Territory Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        kontakt.CALCFIELDS("No. of Industry Groups");
        EnterCell(RowNo,18,FORMAT(kontakt."No. of Industry Groups"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,19,kontakt."Organizational Level Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,20,kontakt."E-Mail",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,21,kontakt."Phone No.",'',FALSE,FALSE,FALSE,'00000000000000000',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,22,kontakt."Company No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,24,FORMAT(kontakt.Gesperrt),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        kontakt1.RESET;
        kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
        IF kontakt1.FINDFIRST THEN BEGIN
          EnterCell(RowNo,23,FORMAT(kontakt1.Gesperrt),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        EnterCell(RowNo,25,FORMAT(kontakt."Unternehmen verlassen"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,27,kontakt.AC_Solutionpartner,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,56,FORMAT(kontakt.Gesperrt),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,57,FORMAT(kontakt."Unternehmen verlassen"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      // Branchenauswertung
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1|%2|%3|%4|%5','1-INNOVATO','2-EARL ADO','3-EARL MAJ','4-LATE MAJ','5-LAGGARDS');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,28,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','AUFTR-ENTW');
        IF branche."Industry Group Code"='AUFTR-ENTW' THEN BEGIN
          EnterCell(RowNo,29,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        //  Branche Neu Start   ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        branche.RESET;
        v_branche:=0;
        v_branche1:='';
        v_branche2:='';
        v_branche3:='';
        v_branche4:='';
        v_branche5:='';
        v_branche6:='';
        v_branche7:='';
        v_branche8:='';
        v_branche9:='';
        v_branche10:='';
        v_branche11:='';
        v_branche12:='';
        v_branche13:='';
        v_branche14:='';
        v_branche15:='';
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5&<>%6','1-INNOVATO','2-EARL ADO','3-EARL MAJ','4-LATE MAJ','5-LAGGARDS','AUFTR-ENTW');
        IF branche.FIND('-') THEN BEGIN
          REPEAT
            v_branche:=v_branche+1;
            IF v_branche = 1 THEN  v_branche1:=branche."Industry Group Code";
            IF v_branche = 2 THEN  v_branche2:=branche."Industry Group Code";
            IF v_branche = 3 THEN  v_branche3:=branche."Industry Group Code";
            IF v_branche = 4 THEN  v_branche4:=branche."Industry Group Code";
            IF v_branche = 5 THEN  v_branche5:=branche."Industry Group Code";
            IF v_branche = 6 THEN  v_branche6:=branche."Industry Group Code";
            IF v_branche = 7 THEN  v_branche7:=branche."Industry Group Code";
            IF v_branche = 8 THEN  v_branche8:=branche."Industry Group Code";
            IF v_branche = 9 THEN  v_branche9:=branche."Industry Group Code";
            IF v_branche =10 THEN  v_branche10:=branche."Industry Group Code";
            IF v_branche =11 THEN  v_branche11:=branche."Industry Group Code";
            IF v_branche =12 THEN  v_branche12:=branche."Industry Group Code";
            IF v_branche =13 THEN  v_branche13:=branche."Industry Group Code";
            IF v_branche =14 THEN  v_branche14:=branche."Industry Group Code";
            IF v_branche =15 THEN  v_branche15:=branche."Industry Group Code";
          UNTIL branche.NEXT=0;
        END;
        EnterCell(RowNo,30,v_branche1,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,31,v_branche2,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,32,v_branche3,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,33,v_branche4,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,34,v_branche5,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,35,v_branche6,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,36,v_branche7,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,37,v_branche8,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,38,v_branche9,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,39,v_branche10,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,40,v_branche11,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,41,v_branche12,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,42,v_branche13,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,43,v_branche14,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,44,v_branche15,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        IF v_branche>15 THEN EnterCell(RowNo,60,'Fehler Branche','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        //  Branche Neu Ende  ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,45,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler1:=verteiler."Mailing Group Code";
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1',v_verteiler1);
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,46,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler2:=verteiler."Mailing Group Code"
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2',v_verteiler1,v_verteiler2);
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,47,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler3:=verteiler."Mailing Group Code"
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3',v_verteiler1,v_verteiler2,v_verteiler3);
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,48,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler4:=verteiler."Mailing Group Code"
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4);
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,49,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler5:=verteiler."Mailing Group Code"
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4,v_verteiler5);
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,50,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler6:=verteiler."Mailing Group Code"
        END;
          //  Verteilereintrag des Mandanten abfragen
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."Company No.");
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,58,(verteiler."Mailing Group Code"+' Mandant'),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler6:=(verteiler."Mailing Group Code"+' Mandant');
        END;

        kon_deb.RESET;
        kon_deb.SETFILTER(kon_deb."Contact No.",'%1',kontakt."Company No.");
        kon_deb.SETFILTER(kon_deb."Business Relation Code",'%1','DEB');
        IF kon_deb.FINDFIRST THEN BEGIN
          v_au:='';
          v_re:='';
          v_an:='';
          v_gu:='';
          v_art:='';
          belege.RESET;
          belege.SETFILTER(belege."Debitornr.",'%1',kon_deb."No.");
          IF ((v_datum_von=0D) AND (v_datum_bis=0D)) THEN BEGIN
          END ELSE BEGIN
            belege.SETFILTER(belege.Belegdatum,'%1..%2',v_datum_von,v_datum_bis);
          END;
          IF ((v_hersteller1='') AND (v_hersteller2='') AND (v_hersteller3='') AND (v_hersteller4='') AND (v_hersteller5='')) THEN BEGIN
          END ELSE BEGIN
            belege.SETFILTER(belege.Herstellercode,'%1|%2|%3|%4|%5',v_hersteller1,v_hersteller2,v_hersteller3,v_hersteller4,v_hersteller5);
          END;
          IF belege.Herstellercode=v_hersteller1 THEN BEGIN
            v_art:='Belege ';
            v_art:=v_art+v_hersteller1;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
            IF belege.FINDFIRST THEN BEGIN
              v_an:='AN ';
              v_an:=v_an+v_hersteller1;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
            IF belege.FINDFIRST THEN BEGIN
              v_au:='AU ';
              v_au:=v_au+v_hersteller1;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
            IF belege.FINDFIRST THEN BEGIN
              v_re:='RE ';
              v_re:=v_re+v_hersteller1;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
            IF belege.FINDFIRST THEN BEGIN
              v_gu:='GU ';
              v_gu:=v_gu+v_hersteller1;
            END;
          END;

          IF belege.Herstellercode=v_hersteller2 THEN BEGIN
            IF v_art='' THEN BEGIN
              v_art:='Belege';
            END;
            v_art:=v_art+' '+v_hersteller2;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
            IF belege.FINDFIRST THEN BEGIN
              IF v_an='' THEN BEGIN
                v_an:='AN';
              END;
              v_an:=v_an+' '+v_hersteller2;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
            IF belege.FINDFIRST THEN BEGIN
              IF v_au='' THEN BEGIN
                v_au:='AU';
              END;
              v_au:=v_au+' '+v_hersteller2;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
            IF belege.FINDFIRST THEN BEGIN
              IF v_re='' THEN BEGIN
                v_re:='RE';
              END;
              v_re:=v_re+' '+v_hersteller2;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
            IF belege.FINDFIRST THEN BEGIN
              IF v_gu='' THEN BEGIN
                v_gu:='GU';
              END;
              v_gu:=v_gu+' '+v_hersteller2;
            END;
          END;

          IF belege.Herstellercode=v_hersteller3 THEN BEGIN
            IF v_art='' THEN BEGIN
              v_art:='Belege';
            END;
            v_art:=v_art+' '+v_hersteller3;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
            IF belege.FINDFIRST THEN BEGIN
              IF v_an='' THEN BEGIN
                v_an:='AN';
              END;
              v_an:=v_an+' '+v_hersteller3;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
            IF belege.FINDFIRST THEN BEGIN
              IF v_au='' THEN BEGIN
                v_au:='AU';
              END;
              v_au:=v_au+' '+v_hersteller3;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
            IF belege.FINDFIRST THEN BEGIN
              IF v_re='' THEN BEGIN
                v_re:='RE';
              END;
              v_re:=v_re+' '+v_hersteller3;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
            IF belege.FINDFIRST THEN BEGIN
              IF v_gu='' THEN BEGIN
                v_gu:='GU';
              END;
              v_gu:=v_gu+' '+v_hersteller3;
            END;
          END;

          IF belege.Herstellercode=v_hersteller4 THEN BEGIN
            IF v_art='' THEN BEGIN
              v_art:='Belege';
            END;
            v_art:=v_art+' '+v_hersteller4;

            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
            IF belege.FINDFIRST THEN BEGIN
              IF v_an='' THEN BEGIN
                v_an:='AN';
              END;
              v_an:=v_an+' '+v_hersteller4;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
            IF belege.FINDFIRST THEN BEGIN
              IF v_au='' THEN BEGIN
                v_au:='AU';
              END;
              v_au:=v_au+' '+v_hersteller4;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
            IF belege.FINDFIRST THEN BEGIN
              IF v_re='' THEN BEGIN
                v_re:='RE';
              END;
              v_re:=v_re+' '+v_hersteller4;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
            IF belege.FINDFIRST THEN BEGIN
              IF v_gu='' THEN BEGIN
                v_gu:='GU';
              END;
              v_gu:=v_gu+' '+v_hersteller4;
            END;
          END;

          IF belege.Herstellercode=v_hersteller5 THEN BEGIN
            IF v_art='' THEN BEGIN
              v_art:='Belege';
            END;
            v_art:=v_art+' '+v_hersteller5;

            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
            IF belege.FINDFIRST THEN BEGIN
              IF v_an='' THEN BEGIN
                v_an:='AN';
              END;
              v_an:=v_an+' '+v_hersteller5;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
            IF belege.FINDFIRST THEN BEGIN
              IF v_au='' THEN BEGIN
                v_au:='AU';
              END;
              v_au:=v_au+' '+v_hersteller5;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
            IF belege.FINDFIRST THEN BEGIN
              IF v_re='' THEN BEGIN
                v_re:='RE';
              END;
              v_re:=v_re+' '+v_hersteller5;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
            IF belege.FINDFIRST THEN BEGIN
              IF v_gu='' THEN BEGIN
                v_gu:='GU';
              END;
              v_gu:=v_gu+' '+v_hersteller5;
            END;
          END;
          EnterCell(RowNo,51,v_art,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,52,v_an,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,53,v_au,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,54,v_re,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,55,v_gu,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
      END;
    END;

    LOCAL PROCEDURE Adr_Emailversand_SuS_Neu@1000000012();
    BEGIN
      {
      IF v_z„hler=1 THEN BEGIN

      MESSAGE(Text068);
        CreateExcel;
        RowNo := 1;
        EnterCell(RowNo,1,'USER1','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        RowNo := 2;
        EnterCell(RowNo,1,kontakt."No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        CloseExcel('Test33','Test33','F:\Daten Neu\User\Uwe\Mailing');
      END ELSE BEGIN
      MESSAGE(Text069);

      END;
      }


      IF v_z„hler=1 THEN BEGIN
        CreateExcel;
        RecNo := 0;
        RowNo := 1;
        EnterCell(RowNo,1,'USER1','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,2,'Art','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,3,'Firma','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,4,'Firma2','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,5,'Anrede','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,6,'Titel','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,7,'Vorname','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,8,'Name','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,9,'Abteilung','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,10,'Straáe','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,11,'Straáe2','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,12,'Nation','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,13,'PLZ','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,14,'Ort','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,15,'Verk„ufer','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,16,'Betreuer','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,17,'Gebiet','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,18,'Anzahl Branche','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,19,'Funktion','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,20,'Email','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,21,'Telefon','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,22,'USER2','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,23,'Mandant gesperrt','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,24,'Person gesperrt','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,25,'Firma verlassen','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,26,'Bemerkung','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,27,'AC Solutionpartner','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,28,'NO Mailing','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,29,'NO ACS','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,30,'NO FER','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,31,'NO SPL','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,32,'NO WIL','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,33,'P1 ACS','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,34,'P2 FER','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,35,'P3 SPL','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,36,'P4 WIL','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,37,'P5 Docu','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,38,'SuS Endkunde','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,39,'T1 Dienstleist','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,40,'T2 IT-Abtl.','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,41,'T3 L”sungsanbiet','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,42,'T4 Provider reg.','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,43,'T5 Provider berreg.','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,44,'T6 Reseller','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,45,'T7 Systemhaus','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,46,'TP Presse','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,47,'L1 Conf/Call Center','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,48,'L2 Fax','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,49,'L3 IP Telefon','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,50,'L4 Lync','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,51,'L5 Voice','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,52,'Weitere','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,53,'Verteiler1','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,54,'Verteiler2','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,55,'Verteiler3','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,56,'Verteiler4','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,57,'Verteiler5','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,58,'Verteiler6','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,59,'Adr.-Herkunft','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,60,'Angebote','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,61,'Auftr„ge','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,62,'Rechnungen','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,63,'Gutschriften','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,64,'Gesperrt','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,65,'Firma verlassen','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,66,'Testfeld Andruck','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        v_branche1:='';
        v_branche2:='';
        v_branche3:='';
        v_branche4:='';
        v_branche5:='';
        v_branche6:='';
        RowNo := RowNo + 1;
        EnterCell(RowNo,1,kontakt."No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,2,FORMAT(kontakt.Type),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        IF kontakt.Type=kontakt.Type::Company THEN BEGIN
          EnterCell(RowNo,3,kontakt.Name,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,4,kontakt."Name 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END ELSE BEGIN
          kontakt1.RESET;
          kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
          IF kontakt1.FINDFIRST THEN BEGIN
            EnterCell(RowNo,3,kontakt1.Name,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,4,kontakt1."Name 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          END;
        END;
        IF kontakt."Salutation Code" = 'HERR' THEN EnterCell(RowNo,5,'Herr','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        IF kontakt."Salutation Code" = 'FRAU' THEN EnterCell(RowNo,5,'Frau','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,6,kontakt."Job Title",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,7,kontakt."First Name",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,8,kontakt.Surname,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,9,kontakt.Abteilung,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,10,kontakt.Address,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,11,kontakt."Address 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,12,kontakt."Country/Region Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,13,kontakt."Post Code",'',FALSE,FALSE,FALSE,'00000',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,14,kontakt.City,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,15,kontakt."Salesperson Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,16,kontakt."Betreuer Innendienst",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,17,kontakt."Territory Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,18,FORMAT(kontakt."No. of Industry Groups"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,19,kontakt."Organizational Level Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,20,kontakt."E-Mail",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,21,kontakt."Phone No.",'',FALSE,FALSE,FALSE,'00000000000000000',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,22,kontakt."Company No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,24,FORMAT(kontakt.Gesperrt),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        kontakt1.RESET;
        kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
        IF kontakt1.FINDFIRST THEN BEGIN
          EnterCell(RowNo,23,FORMAT(kontakt1.Gesperrt),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        EnterCell(RowNo,25,FORMAT(kontakt."Unternehmen verlassen"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,26,FORMAT(kontakt.Comment),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,27,kontakt.AC_Solutionpartner,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,65,FORMAT(kontakt.Gesperrt),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,66,FORMAT(kontakt."Unternehmen verlassen"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        // Branchenauswertung
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','NO-MAILING');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,28,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;

        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-ACS');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,29,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-FER');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,30,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-SPL');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,31,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-WIL');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,32,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P1');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,33,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P2');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,34,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P3');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,35,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P4');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,36,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P5');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,37,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;




        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-ENDK');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,38,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T1');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,39,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T2');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,40,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T3');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,41,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T4');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,42,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T5');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,43,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T6');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,44,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T7');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,45,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-TP');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,46,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L1');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,47,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L2');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,48,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L3');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,49,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L4');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,50,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L5');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,51,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        {
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1..%2','SUS-Z','Z');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,52,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        }

        //  Branche Neu Ende  ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,53,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler1:=verteiler."Mailing Group Code";
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1',v_verteiler1);
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,54,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler2:=verteiler."Mailing Group Code"
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2',v_verteiler1,v_verteiler2);
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,55,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler3:=verteiler."Mailing Group Code"
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3',v_verteiler1,v_verteiler2,v_verteiler3);
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,56,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler4:=verteiler."Mailing Group Code"
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4);
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,57,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler5:=verteiler."Mailing Group Code"
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4,v_verteiler5);
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,58,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler6:=verteiler."Mailing Group Code"
        END;

        //  Verteilereintrag des Mandanten abfragen
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."Company No.");
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,52,(verteiler."Mailing Group Code"+' Mandant'),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler6:=(verteiler."Mailing Group Code"+' Mandant');
        END;

        kon_deb.RESET;
        kon_deb.SETFILTER(kon_deb."Contact No.",'%1',kontakt."Company No.");
        kon_deb.SETFILTER(kon_deb."Business Relation Code",'%1','DEB');
        IF kon_deb.FINDFIRST THEN BEGIN
          v_au:='';
          v_re:='';
          v_an:='';
          v_gu:='';
          v_art:='';
          belege.RESET;
          belege.SETFILTER(belege."Debitornr.",'%1',kon_deb."No.");
          IF ((v_datum_von=0D) AND (v_datum_bis=0D)) THEN BEGIN
          END ELSE BEGIN
            belege.SETFILTER(belege.Belegdatum,'%1..%2',v_datum_von,v_datum_bis);
          END;
          IF ((v_hersteller1='') AND (v_hersteller2='') AND (v_hersteller3='') AND (v_hersteller4='') AND (v_hersteller5='')) THEN BEGIN
          END ELSE BEGIN
            belege.SETFILTER(belege.Herstellercode,'%1|%2|%3|%4|%5',v_hersteller1,v_hersteller2,v_hersteller3,v_hersteller4,v_hersteller5);
          END;
          IF belege.Herstellercode=v_hersteller1 THEN BEGIN
            v_art:='Belege ';
            v_art:=v_art+v_hersteller1;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
            IF belege.FINDFIRST THEN BEGIN
              v_an:='AN ';
              v_an:=v_an+v_hersteller1;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
            IF belege.FINDFIRST THEN BEGIN
              v_au:='AU ';
              v_au:=v_au+v_hersteller1;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
            IF belege.FINDFIRST THEN BEGIN
              v_re:='RE ';
              v_re:=v_re+v_hersteller1;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
            IF belege.FINDFIRST THEN BEGIN
              v_gu:='GU ';
              v_gu:=v_gu+v_hersteller1;
            END;
          END;

          IF belege.Herstellercode=v_hersteller2 THEN BEGIN
            IF v_art='' THEN BEGIN
              v_art:='Belege';
            END;
            v_art:=v_art+' '+v_hersteller2;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
            IF belege.FINDFIRST THEN BEGIN
              IF v_an='' THEN BEGIN
                v_an:='AN';
              END;
              v_an:=v_an+' '+v_hersteller2;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
            IF belege.FINDFIRST THEN BEGIN
              IF v_au='' THEN BEGIN
                v_au:='AU';
              END;
              v_au:=v_au+' '+v_hersteller2;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
            IF belege.FINDFIRST THEN BEGIN
              IF v_re='' THEN BEGIN
                v_re:='RE';
              END;
              v_re:=v_re+' '+v_hersteller2;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
            IF belege.FINDFIRST THEN BEGIN
              IF v_gu='' THEN BEGIN
                v_gu:='GU';
              END;
              v_gu:=v_gu+' '+v_hersteller2;
            END;
          END;

          IF belege.Herstellercode=v_hersteller3 THEN BEGIN
            IF v_art='' THEN BEGIN
              v_art:='Belege';
            END;
            v_art:=v_art+' '+v_hersteller3;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
            IF belege.FINDFIRST THEN BEGIN
              IF v_an='' THEN BEGIN
                v_an:='AN';
              END;
              v_an:=v_an+' '+v_hersteller3;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
            IF belege.FINDFIRST THEN BEGIN
              IF v_au='' THEN BEGIN
                v_au:='AU';
              END;
              v_au:=v_au+' '+v_hersteller3;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
            IF belege.FINDFIRST THEN BEGIN
              IF v_re='' THEN BEGIN
                v_re:='RE';
              END;
              v_re:=v_re+' '+v_hersteller3;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
            IF belege.FINDFIRST THEN BEGIN
              IF v_gu='' THEN BEGIN
                v_gu:='GU';
              END;
              v_gu:=v_gu+' '+v_hersteller3;
            END;
          END;

          IF belege.Herstellercode=v_hersteller4 THEN BEGIN
            IF v_art='' THEN BEGIN
              v_art:='Belege';
            END;
            v_art:=v_art+' '+v_hersteller4;

            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
            IF belege.FINDFIRST THEN BEGIN
              IF v_an='' THEN BEGIN
                v_an:='AN';
              END;
              v_an:=v_an+' '+v_hersteller4;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
            IF belege.FINDFIRST THEN BEGIN
              IF v_au='' THEN BEGIN
                v_au:='AU';
              END;
              v_au:=v_au+' '+v_hersteller4;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
            IF belege.FINDFIRST THEN BEGIN
              IF v_re='' THEN BEGIN
                v_re:='RE';
              END;
              v_re:=v_re+' '+v_hersteller4;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
            IF belege.FINDFIRST THEN BEGIN
              IF v_gu='' THEN BEGIN
                v_gu:='GU';
              END;
              v_gu:=v_gu+' '+v_hersteller4;
            END;
          END;

          IF belege.Herstellercode=v_hersteller5 THEN BEGIN
            IF v_art='' THEN BEGIN
              v_art:='Belege';
            END;
            v_art:=v_art+' '+v_hersteller5;

            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
            IF belege.FINDFIRST THEN BEGIN
              IF v_an='' THEN BEGIN
                v_an:='AN';
              END;
              v_an:=v_an+' '+v_hersteller5;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
            IF belege.FINDFIRST THEN BEGIN
              IF v_au='' THEN BEGIN
                v_au:='AU';
              END;
              v_au:=v_au+' '+v_hersteller5;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
            IF belege.FINDFIRST THEN BEGIN
              IF v_re='' THEN BEGIN
                v_re:='RE';
              END;
              v_re:=v_re+' '+v_hersteller5;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
            IF belege.FINDFIRST THEN BEGIN
              IF v_gu='' THEN BEGIN
                v_gu:='GU';
              END;
              v_gu:=v_gu+' '+v_hersteller5;
            END;
          END;
          EnterCell(RowNo,59,v_art,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,60,v_an,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,61,v_au,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,62,v_re,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,63,v_gu,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
      END ELSE BEGIN
      //  v_branche1:='';
      //  v_branche2:='';
      //  v_branche3:='';
      //  v_branche4:='';
      //  v_branche5:='';
      //  v_branche6:='';
        RowNo := RowNo + 1;
        EnterCell(RowNo,1,kontakt."No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,2,FORMAT(kontakt.Type),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        IF kontakt.Type=kontakt.Type::Company THEN BEGIN
          EnterCell(RowNo,3,kontakt.Name,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,4,kontakt."Name 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END ELSE BEGIN
          kontakt1.RESET;
          kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
          IF kontakt1.FINDFIRST THEN BEGIN
            EnterCell(RowNo,3,kontakt1.Name,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,4,kontakt1."Name 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          END;
        END;
        IF kontakt."Salutation Code" = 'HERR' THEN EnterCell(RowNo,5,'Herr','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        IF kontakt."Salutation Code" = 'FRAU' THEN EnterCell(RowNo,5,'Frau','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,6,kontakt."Job Title",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,7,kontakt."First Name",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,8,kontakt.Surname,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,9,kontakt.Abteilung,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,10,kontakt.Address,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,11,kontakt."Address 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,12,kontakt."Country/Region Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,13,kontakt."Post Code",'',FALSE,FALSE,FALSE,'00000',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,14,kontakt.City,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,15,kontakt."Salesperson Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,16,kontakt."Betreuer Innendienst",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,17,kontakt."Territory Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,18,FORMAT(kontakt."No. of Industry Groups"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,19,kontakt."Organizational Level Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,20,kontakt."E-Mail",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,21,kontakt."Phone No.",'',FALSE,FALSE,FALSE,'00000000000000000',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,22,kontakt."Company No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,24,FORMAT(kontakt.Gesperrt),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        kontakt1.RESET;
        kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
        IF kontakt1.FINDFIRST THEN BEGIN
          EnterCell(RowNo,23,FORMAT(kontakt1.Gesperrt),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        EnterCell(RowNo,25,FORMAT(kontakt."Unternehmen verlassen"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,27,kontakt.AC_Solutionpartner,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,64,FORMAT(kontakt.Gesperrt),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,65,FORMAT(kontakt."Unternehmen verlassen"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      // Branchenauswertung
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','NO-MAILING');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,28,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-ACS');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,29,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-FER');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,30,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-SPL');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,31,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-WIL');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,32,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P1');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,33,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P2');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,34,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P3');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,35,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P4');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,36,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;

        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P5');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,37,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-ENDK');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,38,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T1');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,39,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T2');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,40,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T3');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,41,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T4');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,42,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T5');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,43,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T6');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,44,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T7');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,45,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-TP');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,46,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L1');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,47,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L2');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,48,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L3');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,49,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L4');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,50,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
        branche.RESET;
        branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
        branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L5');
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,51,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;



        //  Branche Neu Start   ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

        //  Branche Neu Ende  ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,53,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler1:=verteiler."Mailing Group Code";
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1',v_verteiler1);
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,54,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler2:=verteiler."Mailing Group Code"
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2',v_verteiler1,v_verteiler2);
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,55,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler3:=verteiler."Mailing Group Code"
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3',v_verteiler1,v_verteiler2,v_verteiler3);
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,56,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler4:=verteiler."Mailing Group Code"
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4);
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,57,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler5:=verteiler."Mailing Group Code"
        END;

        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
        verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4,v_verteiler5);
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,58,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler6:=verteiler."Mailing Group Code"
        END;
          //  Verteilereintrag des Mandanten abfragen
        verteiler.RESET;
        verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."Company No.");
        IF verteiler.FINDFIRST THEN BEGIN
          EnterCell(RowNo,52,(verteiler."Mailing Group Code"+' Mandant'),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          v_verteiler6:=(verteiler."Mailing Group Code"+' Mandant');
        END;

        kon_deb.RESET;
        kon_deb.SETFILTER(kon_deb."Contact No.",'%1',kontakt."Company No.");
        kon_deb.SETFILTER(kon_deb."Business Relation Code",'%1','DEB');
        IF kon_deb.FINDFIRST THEN BEGIN
          v_au:='';
          v_re:='';
          v_an:='';
          v_gu:='';
          v_art:='';
          belege.RESET;
          belege.SETFILTER(belege."Debitornr.",'%1',kon_deb."No.");
          IF ((v_datum_von=0D) AND (v_datum_bis=0D)) THEN BEGIN
          END ELSE BEGIN
            belege.SETFILTER(belege.Belegdatum,'%1..%2',v_datum_von,v_datum_bis);
          END;
          IF ((v_hersteller1='') AND (v_hersteller2='') AND (v_hersteller3='') AND (v_hersteller4='') AND (v_hersteller5='')) THEN BEGIN
          END ELSE BEGIN
            belege.SETFILTER(belege.Herstellercode,'%1|%2|%3|%4|%5',v_hersteller1,v_hersteller2,v_hersteller3,v_hersteller4,v_hersteller5);
          END;
          IF belege.Herstellercode=v_hersteller1 THEN BEGIN
            v_art:='Belege ';
            v_art:=v_art+v_hersteller1;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
            IF belege.FINDFIRST THEN BEGIN
              v_an:='AN ';
              v_an:=v_an+v_hersteller1;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
            IF belege.FINDFIRST THEN BEGIN
              v_au:='AU ';
              v_au:=v_au+v_hersteller1;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
            IF belege.FINDFIRST THEN BEGIN
              v_re:='RE ';
              v_re:=v_re+v_hersteller1;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
            IF belege.FINDFIRST THEN BEGIN
              v_gu:='GU ';
              v_gu:=v_gu+v_hersteller1;
            END;
          END;

          IF belege.Herstellercode=v_hersteller2 THEN BEGIN
            IF v_art='' THEN BEGIN
              v_art:='Belege';
            END;
            v_art:=v_art+' '+v_hersteller2;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
            IF belege.FINDFIRST THEN BEGIN
              IF v_an='' THEN BEGIN
                v_an:='AN';
              END;
              v_an:=v_an+' '+v_hersteller2;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
            IF belege.FINDFIRST THEN BEGIN
              IF v_au='' THEN BEGIN
                v_au:='AU';
              END;
              v_au:=v_au+' '+v_hersteller2;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
            IF belege.FINDFIRST THEN BEGIN
              IF v_re='' THEN BEGIN
                v_re:='RE';
              END;
              v_re:=v_re+' '+v_hersteller2;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
            IF belege.FINDFIRST THEN BEGIN
              IF v_gu='' THEN BEGIN
                v_gu:='GU';
              END;
              v_gu:=v_gu+' '+v_hersteller2;
            END;
          END;

          IF belege.Herstellercode=v_hersteller3 THEN BEGIN
            IF v_art='' THEN BEGIN
              v_art:='Belege';
            END;
            v_art:=v_art+' '+v_hersteller3;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
            IF belege.FINDFIRST THEN BEGIN
              IF v_an='' THEN BEGIN
                v_an:='AN';
              END;
              v_an:=v_an+' '+v_hersteller3;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
            IF belege.FINDFIRST THEN BEGIN
              IF v_au='' THEN BEGIN
                v_au:='AU';
              END;
              v_au:=v_au+' '+v_hersteller3;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
            IF belege.FINDFIRST THEN BEGIN
              IF v_re='' THEN BEGIN
                v_re:='RE';
              END;
              v_re:=v_re+' '+v_hersteller3;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
            IF belege.FINDFIRST THEN BEGIN
              IF v_gu='' THEN BEGIN
                v_gu:='GU';
              END;
              v_gu:=v_gu+' '+v_hersteller3;
            END;
          END;

          IF belege.Herstellercode=v_hersteller4 THEN BEGIN
            IF v_art='' THEN BEGIN
              v_art:='Belege';
            END;
            v_art:=v_art+' '+v_hersteller4;

            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
            IF belege.FINDFIRST THEN BEGIN
              IF v_an='' THEN BEGIN
                v_an:='AN';
              END;
              v_an:=v_an+' '+v_hersteller4;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
            IF belege.FINDFIRST THEN BEGIN
              IF v_au='' THEN BEGIN
                v_au:='AU';
              END;
              v_au:=v_au+' '+v_hersteller4;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
            IF belege.FINDFIRST THEN BEGIN
              IF v_re='' THEN BEGIN
                v_re:='RE';
              END;
              v_re:=v_re+' '+v_hersteller4;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
            IF belege.FINDFIRST THEN BEGIN
              IF v_gu='' THEN BEGIN
                v_gu:='GU';
              END;
              v_gu:=v_gu+' '+v_hersteller4;
            END;
          END;

          IF belege.Herstellercode=v_hersteller5 THEN BEGIN
            IF v_art='' THEN BEGIN
              v_art:='Belege';
            END;
            v_art:=v_art+' '+v_hersteller5;

            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
            IF belege.FINDFIRST THEN BEGIN
              IF v_an='' THEN BEGIN
                v_an:='AN';
              END;
              v_an:=v_an+' '+v_hersteller5;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
            IF belege.FINDFIRST THEN BEGIN
              IF v_au='' THEN BEGIN
                v_au:='AU';
              END;
              v_au:=v_au+' '+v_hersteller5;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
            IF belege.FINDFIRST THEN BEGIN
              IF v_re='' THEN BEGIN
                v_re:='RE';
              END;
              v_re:=v_re+' '+v_hersteller5;
            END;
            belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
            IF belege.FINDFIRST THEN BEGIN
              IF v_gu='' THEN BEGIN
                v_gu:='GU';
              END;
              v_gu:=v_gu+' '+v_hersteller5;
            END;
          END;
          EnterCell(RowNo,59,v_art,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,60,v_an,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,61,v_au,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,62,v_re,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,63,v_gu,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
      END;
    END;

    LOCAL PROCEDURE "Bericht Adresse1_Neu"@1000000021();
    BEGIN
      //  Einschr„nkung auf gehakte Brancheneintr„ge und Funktionen
      IF v_z„hler=1 THEN BEGIN
        CreateExcel;
        RecNo := 0;                                         //erzeugt excel
        RowNo := 1;
        EnterCell(RowNo,1,'Kontakt-Nr.','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,2,'Name/Vorname','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,3,'Firma','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,4,'Funktion','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,5,'Branche','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,6,'Innovator','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,7,'AU-Entw.','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,8,'Firma Kt-Nr.','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,9,'Anrede','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,10,'Vorname','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,11,'Nachname','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,12,'Abteilung','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,13,'Email','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,14,'Telefon','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,15,'Land','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,16,'PLZ','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,17,'Ort','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,18,'Verk„ufer','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,19,'Bearbeiter','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,20,'Gebiet','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,21,'Team','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,22,'Adr.-Herkunft','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,23,'Angebote','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,24,'Auftr„ge','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,25,'Rechnungen','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,26,'Verteiler1','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,27,'Verteiler2','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,28,'Verteiler3','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,29,'Verteiler4','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,30,'Verteiler5','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,31,'Verteiler6','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        RowNo := 2;
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,1,kontakt."No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,2,kontakt.Name,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,3,kontakt."Company Name",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,4,kontakt."Organizational Level Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,5,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          branche1.RESET;
          branche1.SETFILTER(branche1."Contact No.",'%1',kontakt."Company No.");
          branche1.SETFILTER(branche1."Industry Group Code",'%1|%2|%3|%4|%5','1-INNOVATO','2-EARL ADO','3-EARL MAJ','4-LATE MAJ','5-LAGGARDS');
          IF branche1.FINDFIRST THEN BEGIN
            EnterCell(RowNo,6,branche1."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          END;
          branche1.RESET;
          branche1.SETFILTER(branche1."Contact No.",'%1',kontakt."Company No.");
          branche1.SETFILTER(branche1."Industry Group Code",'%1','AUFTR-ENTW');
          IF branche1.FINDFIRST THEN BEGIN
            EnterCell(RowNo,7,branche1."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          END;
          EnterCell(RowNo,8,kontakt."Company No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          IF kontakt."Salutation Code" = 'HERR' THEN EnterCell(RowNo,9,'Herr','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          IF kontakt."Salutation Code" = 'FRAU' THEN EnterCell(RowNo,9,'Frau','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,10,kontakt."First Name",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,11,kontakt.Surname,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,12,kontakt.Abteilung,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,13,kontakt."E-Mail",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,14,kontakt."Phone No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,15,kontakt."Country/Region Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,16,FORMAT(kontakt."Post Code"),'',FALSE,FALSE,FALSE,'00000',TempExcelBuffer."Cell Type"::Number);
          EnterCell(RowNo,17,kontakt.City,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,18,kontakt."Salesperson Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,19,kontakt."Betreuer Innendienst",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,20,kontakt."Territory Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,21,kontakt.Teams,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,22,'Funktion/Klass','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          verteiler.RESET;
          verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
          IF verteiler.FINDFIRST THEN BEGIN
            EnterCell(RowNo,26,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            v_verteiler1:=verteiler."Mailing Group Code";
          END;

          verteiler.RESET;
          verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
          verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1',v_verteiler1);
          IF verteiler.FINDFIRST THEN BEGIN
            EnterCell(RowNo,27,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            v_verteiler2:=verteiler."Mailing Group Code"
          END;

          verteiler.RESET;
          verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
          verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2',v_verteiler1,v_verteiler2);
          IF verteiler.FINDFIRST THEN BEGIN
            EnterCell(RowNo,28,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            v_verteiler3:=verteiler."Mailing Group Code"
          END;

          verteiler.RESET;
          verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
          verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3',v_verteiler1,v_verteiler2,v_verteiler3);
          IF verteiler.FINDFIRST THEN BEGIN
            EnterCell(RowNo,29,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            v_verteiler4:=verteiler."Mailing Group Code"
          END;

          verteiler.RESET;
          verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
          verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4);
          IF verteiler.FINDFIRST THEN BEGIN
            EnterCell(RowNo,30,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            v_verteiler5:=verteiler."Mailing Group Code"
          END;

          verteiler.RESET;
          verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
          verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4,v_verteiler5);
          IF verteiler.FINDFIRST THEN BEGIN
            EnterCell(RowNo,31,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            v_verteiler6:=verteiler."Mailing Group Code"
          END;
          RowNo := RowNo + 1;
        END;
      END ELSE BEGIN
        IF branche.FINDFIRST THEN BEGIN
          EnterCell(RowNo,1,kontakt."No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,2,kontakt.Name,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,3,kontakt."Company Name",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,4,kontakt."Organizational Level Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,5,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          branche1.RESET;
          branche1.SETFILTER(branche1."Contact No.",'%1',kontakt."Company No.");
          branche1.SETFILTER(branche1."Industry Group Code",'%1|%2|%3|%4|%5','1-INNOVATO','2-EARL ADO','3-EARL MAJ','4-LATE MAJ','5-LAGGARDS');
          IF branche1.FINDFIRST THEN BEGIN
            EnterCell(RowNo,6,branche1."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          END;
          branche1.RESET;
          branche1.SETFILTER(branche1."Contact No.",'%1',kontakt."Company No.");
          branche1.SETFILTER(branche1."Industry Group Code",'%1','AUFTR-ENTW');
          IF branche1.FINDFIRST THEN BEGIN
            EnterCell(RowNo,7,branche1."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          END;
          EnterCell(RowNo,8,kontakt."Company No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          IF kontakt."Salutation Code" = 'HERR' THEN EnterCell(RowNo,9,'Herr','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          IF kontakt."Salutation Code" = 'FRAU' THEN EnterCell(RowNo,9,'Frau','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,10,kontakt."First Name",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,11,kontakt.Surname,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,12,kontakt.Abteilung,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,13,kontakt."E-Mail",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,14,kontakt."Phone No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,15,kontakt."Country/Region Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,16,FORMAT(kontakt."Post Code"),'',FALSE,FALSE,FALSE,'00000',TempExcelBuffer."Cell Type"::Number);
          EnterCell(RowNo,17,kontakt.City,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,18,kontakt."Salesperson Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,19,kontakt."Betreuer Innendienst",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,20,kontakt."Territory Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,21,kontakt.Teams,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,22,'Funktion/Klass','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);

          verteiler.RESET;
          verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
          IF verteiler.FINDFIRST THEN BEGIN
            EnterCell(RowNo,26,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            v_verteiler1:=verteiler."Mailing Group Code";
          END;

          verteiler.RESET;
          verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
          verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1',v_verteiler1);
          IF verteiler.FINDFIRST THEN BEGIN
            EnterCell(RowNo,27,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            v_verteiler2:=verteiler."Mailing Group Code"
          END;

          verteiler.RESET;
          verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
          verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2',v_verteiler1,v_verteiler2);
          IF verteiler.FINDFIRST THEN BEGIN
            EnterCell(RowNo,28,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            v_verteiler3:=verteiler."Mailing Group Code"
          END;

          verteiler.RESET;
          verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
          verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3',v_verteiler1,v_verteiler2,v_verteiler3);
          IF verteiler.FINDFIRST THEN BEGIN
            EnterCell(RowNo,29,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            v_verteiler4:=verteiler."Mailing Group Code"
          END;

          verteiler.RESET;
          verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
          verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4);
          IF verteiler.FINDFIRST THEN BEGIN
            EnterCell(RowNo,30,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            v_verteiler5:=verteiler."Mailing Group Code"
          END;

          verteiler.RESET;
          verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
          verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4,v_verteiler5);
          IF verteiler.FINDFIRST THEN BEGIN
            EnterCell(RowNo,31,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            v_verteiler6:=verteiler."Mailing Group Code"
          END;
          RowNo := RowNo + 1;
        END;
      END;
    END;

    LOCAL PROCEDURE "Bericht Adresse2_Neu"@1000000015();
    BEGIN
      // Keine Einschr„nkung auf Branchen, trotz H„kchen im Filter, Auswertung nur ber Funktion
      IF v_z„hler=1 THEN BEGIN
        CreateExcel;
        RecNo := 0;                                           //erzeugt excel
        RowNo := 1;
        EnterCell(RowNo,1,'Kontakt-Nr.','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,2,'Name/Vorname','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,3,'Firma','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,4,'Funktion','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,5,'Branche','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,6,'Innovator','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,7,'AU-Entw.','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,8,'Firma Kt-Nr.','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,9,'Anrede','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,10,'Vorname','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,11,'Nachname','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,12,'Abteilung','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,13,'Email','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,14,'Telefon','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,15,'Land','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,16,'PLZ','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,17,'Ort','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,18,'Verk„ufer','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,19,'Bearbeiter','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,20,'Gebiet','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,21,'Team','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,22,'Verteiler1','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,23,'Verteiler2','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,24,'Verteiler3','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,25,'Verteiler4','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,26,'Verteiler5','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,27,'Verteiler6','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        RowNo := 2;
        IF kontakt.FIND('-') THEN BEGIN
          v_verteiler1:='';
          v_verteiler2:='';
          v_verteiler3:='';
          v_verteiler4:='';
          v_verteiler5:='';
          v_verteiler6:='';
          REPEAT
            EnterCell(RowNo,1,kontakt."No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            IF kontakt.Type=kontakt.Type::Company THEN BEGIN
              EnterCell(RowNo,2,kontakt.Name,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,3,kontakt."Name 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            END ELSE BEGIN
              kontakt1.RESET;
              kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
              IF kontakt1.FINDFIRST THEN BEGIN
                EnterCell(RowNo,2,kontakt1.Name,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,3,kontakt1."Name 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              END;
            END;
            EnterCell(RowNo,4,kontakt."Organizational Level Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            branche.RESET;
            branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
            branche.SETFILTER(branche."Industry Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5','1-INNOVATO','2-EARL ADO','3-EARL MAJ','4-LATE MAJ','5-LAGGARDS');
            IF branche.FINDFIRST THEN BEGIN
              EnterCell(RowNo,5,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            END;
            branche1.RESET;
            branche1.SETFILTER(branche1."Contact No.",'%1',kontakt."Company No.");
            branche1.SETFILTER(branche1."Industry Group Code",'%1|%2|%3|%4|%5','1-INNOVATO','2-EARL ADO','3-EARL MAJ','4-LATE MAJ','5-LAGGARDS');
            IF branche1.FINDFIRST THEN BEGIN
              EnterCell(RowNo,6,branche1."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            END;
            branche1.RESET;
            branche1.SETFILTER(branche1."Contact No.",'%1',kontakt."Company No.");
            branche1.SETFILTER(branche1."Industry Group Code",'%1','AUFTR-ENTW');
            IF branche1.FINDFIRST THEN BEGIN
              EnterCell(RowNo,7,branche1."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            END;
            EnterCell(RowNo,8,kontakt."Company No.",'',FALSE,FALSE,FALSE,'######',TempExcelBuffer."Cell Type"::Number);
            IF kontakt."Salutation Code" = 'HERR' THEN EnterCell(RowNo,9,'Herr','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            IF kontakt."Salutation Code" = 'FRAU' THEN EnterCell(RowNo,9,'Frau','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,10,kontakt."First Name",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,11,kontakt.Surname,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,12,kontakt.Abteilung,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,13,kontakt."E-Mail",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,14,kontakt."Phone No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,15,kontakt."Country/Region Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,16,FORMAT(kontakt."Post Code"),'',FALSE,FALSE,FALSE,'00000',TempExcelBuffer."Cell Type"::Number);
            EnterCell(RowNo,17,kontakt.City,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,18,kontakt."Salesperson Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,19,kontakt."Betreuer Innendienst",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,20,kontakt."Territory Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,21,kontakt.Teams,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            IF verteiler.FINDFIRST THEN BEGIN
              EnterCell(RowNo,22,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              v_verteiler1:=verteiler."Mailing Group Code";
            END;
            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1',v_verteiler1);
            IF verteiler.FINDFIRST THEN BEGIN
              EnterCell(RowNo,23,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              v_verteiler2:=verteiler."Mailing Group Code"
            END;
            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2',v_verteiler1,v_verteiler2);
            IF verteiler.FINDFIRST THEN BEGIN
              EnterCell(RowNo,24,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              v_verteiler3:=verteiler."Mailing Group Code"
            END;
            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3',v_verteiler1,v_verteiler2,v_verteiler3);
            IF verteiler.FINDFIRST THEN BEGIN
              EnterCell(RowNo,25,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              v_verteiler4:=verteiler."Mailing Group Code"
            END;

            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4);
            IF verteiler.FINDFIRST THEN BEGIN
              EnterCell(RowNo,26,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              v_verteiler5:=verteiler."Mailing Group Code"
            END;

            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4,v_verteiler5);
            IF verteiler.FINDFIRST THEN BEGIN
              EnterCell(RowNo,27,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              v_verteiler6:=verteiler."Mailing Group Code"
            END;
            RowNo := RowNo + 1;
          UNTIL kontakt.NEXT=0;
        END;
      END ELSE BEGIN
        IF kontakt.FIND('-') THEN BEGIN
          v_verteiler1:='';
          v_verteiler2:='';
          v_verteiler3:='';
          v_verteiler4:='';
          v_verteiler5:='';
          v_verteiler6:='';
          REPEAT
            EnterCell(RowNo,1,kontakt."No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,2,kontakt.Name,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,3,kontakt."Company Name",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,4,kontakt."Organizational Level Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            branche.RESET;
            branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
            branche.SETFILTER(branche."Industry Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5','1-INNOVATO','2-EARL ADO','3-EARL MAJ','4-LATE MAJ','5-LAGGARDS');
            IF branche.FINDFIRST THEN BEGIN
              EnterCell(RowNo,5,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            END;
            branche1.RESET;
            branche1.SETFILTER(branche1."Contact No.",'%1',kontakt."Company No.");
            branche1.SETFILTER(branche1."Industry Group Code",'%1|%2|%3|%4|%5','1-INNOVATO','2-EARL ADO','3-EARL MAJ','4-LATE MAJ','5-LAGGARDS');
            IF branche1.FINDFIRST THEN BEGIN
              EnterCell(RowNo,6,branche1."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            END;
            branche1.RESET;
            branche1.SETFILTER(branche1."Contact No.",'%1',kontakt."Company No.");
            branche1.SETFILTER(branche1."Industry Group Code",'%1','AUFTR-ENTW');
            IF branche1.FINDFIRST THEN BEGIN
              EnterCell(RowNo,7,branche1."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            END;
            EnterCell(RowNo,8,kontakt."Company No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            IF kontakt."Salutation Code" = 'HERR' THEN EnterCell(RowNo,9,'Herr','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            IF kontakt."Salutation Code" = 'FRAU' THEN EnterCell(RowNo,9,'Frau','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,10,kontakt."First Name",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,11,kontakt.Surname,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,12,kontakt.Abteilung,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,13,kontakt."E-Mail",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,14,kontakt."Phone No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,15,kontakt."Country/Region Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,16,FORMAT(kontakt."Post Code"),'',FALSE,FALSE,FALSE,'00000',TempExcelBuffer."Cell Type"::Number);
            EnterCell(RowNo,17,kontakt.City,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,18,kontakt."Salesperson Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,19,kontakt."Betreuer Innendienst",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,20,kontakt."Territory Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,21,kontakt.Teams,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            IF verteiler.FINDFIRST THEN BEGIN
              EnterCell(RowNo,22,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              v_verteiler1:=verteiler."Mailing Group Code";
            END;
            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1',v_verteiler1);
            IF verteiler.FINDFIRST THEN BEGIN
              EnterCell(RowNo,23,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              v_verteiler2:=verteiler."Mailing Group Code"
            END;
            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2',v_verteiler1,v_verteiler2);
            IF verteiler.FINDFIRST THEN BEGIN
              EnterCell(RowNo,24,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              v_verteiler3:=verteiler."Mailing Group Code"
            END;
            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3',v_verteiler1,v_verteiler2,v_verteiler3);
            IF verteiler.FINDFIRST THEN BEGIN
              EnterCell(RowNo,25,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              v_verteiler4:=verteiler."Mailing Group Code"
            END;
            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4);
            IF verteiler.FINDFIRST THEN BEGIN
              EnterCell(RowNo,26,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              v_verteiler5:=verteiler."Mailing Group Code"
            END;
            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4,v_verteiler5);
            IF verteiler.FINDFIRST THEN BEGIN
              EnterCell(RowNo,27,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              v_verteiler6:=verteiler."Mailing Group Code"
            END;
            RowNo := RowNo + 1;
          UNTIL kontakt.NEXT=0;
        END;
      END;
    END;

    LOCAL PROCEDURE Adr_SUS_ohne_UNSUB_Neu@1000000033();
    BEGIN
      IF v_z„hler=1 THEN BEGIN
        CreateExcel;
        RecNo := 0;
        RowNo := 1;
        EnterCell(RowNo,1,'USER1','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,2,'Art','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,3,'Firma','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,4,'Firma2','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,5,'Anrede','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,6,'Titel','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,7,'Vorname','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,8,'Name','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,9,'Abteilung','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,10,'Straáe','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,11,'Straáe2','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,12,'Nation','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,13,'PLZ','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,14,'Ort','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,15,'Verk„ufer','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,16,'Betreuer','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,17,'Gebiet','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,18,'Anzahl Branche','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,19,'Funktion','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,20,'Email','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,21,'Telefon','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,22,'USER2','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,23,'Mandant gesperrt','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,24,'Person gesperrt','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,25,'Firma verlassen','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,26,'Bemerkung','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,27,'AC Solutionpartner','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,28,'NO Mailing','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,29,'NO ACS','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,30,'NO FER','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,31,'NO SPL','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,32,'NO WIL','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,33,'P1 ACS','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,34,'P2 FER','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,35,'P3 SPL','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,36,'P4 WIL','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,37,'SuS Endkunde','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,38,'T1 Dienstleist','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,39,'T2 IT-Abtl.','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,40,'T3 L”sungsanbiet','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,41,'T4 Provider reg.','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,42,'T5 Provider berreg.','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,43,'T6 Reseller','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,44,'T7 Systemhaus','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,45,'TP Presse','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,46,'L1 Conf/Call Center','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,47,'L2 Fax','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,48,'L3 IP Telefon','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,49,'L4 Lync','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,50,'L5 Voice','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,51,'Weitere','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,52,'Verteiler1','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,53,'Verteiler2','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,54,'Verteiler3','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,55,'Verteiler4','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,56,'Verteiler5','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,57,'Verteiler6','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,58,'Adr.-Herkunft','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,59,'Angebote','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,60,'Auftr„ge','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,61,'Rechnungen','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,62,'Gutschriften','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,63,'Gesperrt','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,64,'Firma verlassen','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,66,'Testfeld Andruck','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        RowNo := 2;
        verteiler1.RESET;
        verteiler1.SETFILTER(verteiler1."Contact No.",'%1',kontakt."No.");
        IF verteiler1.FIND('-') THEN BEGIN
          REPEAT
            IF ((verteiler1."Mailing Group Code"='UNSUB') OR (verteiler1."Mailing Group Code"='NO EMAIL')) THEN BEGIN
            END ELSE BEGIN
              RowNo := RowNo + 1;
      //        EnterCell(RowNo,1,verteiler."Contact Company Name",'',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              Funktion_Adr_SUS_Neu;
            END;
          UNTIL verteiler1.NEXT=0;
        END ELSE BEGIN
          Funktion_Adr_SUS_Neu;
        END;
      END ELSE BEGIN
        verteiler1.RESET;
        verteiler1.SETFILTER(verteiler1."Contact No.",'%1',kontakt."No.");
        IF verteiler1.FIND('-') THEN BEGIN
          REPEAT
            IF ((verteiler1."Mailing Group Code"='UNSUB') OR (verteiler1."Mailing Group Code"='NO EMAIL')) THEN BEGIN
            END ELSE BEGIN
              Funktion_Adr_SUS_Neu;
            END;
          UNTIL verteiler1.NEXT=0;
        END ELSE BEGIN
          Funktion_Adr_SUS_Neu;
        END;
      END;
      CloseExcel('Adr_SUS_Neu','Adr_SUS_Neu','F:\Daten Neu\User\Uwe\Mailing');
      MESSAGE(Text003);
    END;

    LOCAL PROCEDURE Funktion_Adr_SUS_Neu@1000000034();
    BEGIN
      v_branche1:='';
      v_branche2:='';
      v_branche3:='';
      v_branche4:='';
      v_branche5:='';
      v_branche6:='';
      //               Sheet.Range('A'+j).Value := TOPAS_API.CreateExcelHyperlinkToNav(kontakt.TABLENAME,1,5050,kontakt."No.");
      EnterCell(RowNo,1,kontakt."No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,2,kontakt."No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      IF kontakt.Type=kontakt.Type::Company THEN BEGIN
        EnterCell(RowNo,3,kontakt.Name,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,4,kontakt."Name 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END ELSE BEGIN
        kontakt1.RESET;
        kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
        IF kontakt1.FINDFIRST THEN BEGIN
          EnterCell(RowNo,3,kontakt1.Name,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,4,kontakt1."Name 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        END;
      END;
      IF kontakt."Salutation Code" = 'HERR' THEN EnterCell(RowNo,5,'Herr','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      IF kontakt."Salutation Code" = 'FRAU' THEN EnterCell(RowNo,5,'Frau','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,6,kontakt."Job Title",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,7,kontakt."First Name",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,8,kontakt.Surname,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,9,kontakt.Abteilung,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,10,kontakt.Address,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,11,kontakt."Address 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,12,kontakt."Country/Region Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,13,FORMAT(kontakt."Post Code"),'',FALSE,FALSE,FALSE,'00000',TempExcelBuffer."Cell Type"::Number);
      EnterCell(RowNo,14,kontakt.City,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,15,kontakt."Salesperson Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,16,kontakt."Betreuer Innendienst",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,17,kontakt."Territory Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,18,FORMAT(kontakt."No. of Industry Groups"),'',FALSE,FALSE,FALSE,'0000000',TempExcelBuffer."Cell Type"::Number);
      EnterCell(RowNo,19,kontakt."Organizational Level Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,20,kontakt."E-Mail",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,21,FORMAT(kontakt."Phone No."),'',FALSE,FALSE,FALSE,'00000000000000000',TempExcelBuffer."Cell Type"::Number);
      EnterCell(RowNo,22,kontakt."Company No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      kontakt1.RESET;
      kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
      IF kontakt1.FINDFIRST THEN BEGIN
        EnterCell(RowNo,24,FORMAT(kontakt1.Gesperrt),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END;
      EnterCell(RowNo,25,FORMAT(kontakt."Unternehmen verlassen"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,27,kontakt.AC_Solutionpartner,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,63,FORMAT(kontakt.Gesperrt),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,64,FORMAT(kontakt."Unternehmen verlassen"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      // Branchenauswertung
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','NO-MAILING');
      IF branche.FINDFIRST THEN BEGIN
        EnterCell(RowNo,28,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-ACS');
      IF branche.FINDFIRST THEN BEGIN
        EnterCell(RowNo,29,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-FER');
      IF branche.FINDFIRST THEN BEGIN
        EnterCell(RowNo,30,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-SPL');
      IF branche.FINDFIRST THEN BEGIN
        EnterCell(RowNo,31,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-NO-WIL');
      IF branche.FINDFIRST THEN BEGIN
        EnterCell(RowNo,32,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P1');
      IF branche.FINDFIRST THEN BEGIN
        EnterCell(RowNo,33,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P2');
      IF branche.FINDFIRST THEN BEGIN
        EnterCell(RowNo,34,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P3');
      IF branche.FINDFIRST THEN BEGIN
        EnterCell(RowNo,35,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-P4');
      IF branche.FINDFIRST THEN BEGIN
        EnterCell(RowNo,36,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-ENDK');
      IF branche.FINDFIRST THEN BEGIN
        EnterCell(RowNo,37,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T1');
      IF branche.FINDFIRST THEN BEGIN
        EnterCell(RowNo,38,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T2');
      IF branche.FINDFIRST THEN BEGIN
        EnterCell(RowNo,39,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T3');
      IF branche.FINDFIRST THEN BEGIN
        EnterCell(RowNo,40,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T4');
      IF branche.FINDFIRST THEN BEGIN
        EnterCell(RowNo,41,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T5');
      IF branche.FINDFIRST THEN BEGIN
        EnterCell(RowNo,42,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T6');
      IF branche.FINDFIRST THEN BEGIN
        EnterCell(RowNo,43,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-T7');
      IF branche.FINDFIRST THEN BEGIN
        EnterCell(RowNo,44,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-TP');
      IF branche.FINDFIRST THEN BEGIN
        EnterCell(RowNo,45,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L1');
      IF branche.FINDFIRST THEN BEGIN
        EnterCell(RowNo,46,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L2');
      IF branche.FINDFIRST THEN BEGIN
        EnterCell(RowNo,47,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L3');
      IF branche.FINDFIRST THEN BEGIN
        EnterCell(RowNo,48,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L4');
      IF branche.FINDFIRST THEN BEGIN
        EnterCell(RowNo,49,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1','SUS-L5');
      IF branche.FINDFIRST THEN BEGIN
        EnterCell(RowNo,50,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END;
      branche.RESET;
      branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      branche.SETFILTER(branche."Industry Group Code",'%1..%2','SUS-Z','Z');
      IF branche.FINDFIRST THEN BEGIN
        EnterCell(RowNo,51,branche."Industry Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END;
      // verteiler.RESET;
      // verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
      // IF verteiler.FINDFIRST THEN BEGIN
      //   EnterCell(RowNo,52,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      // //  Sheet.Range('AZ'+j).Value :=verteiler."Mailing Group Code";
      //   v_verteiler1:=verteiler."Mailing Group Code";
      // END;
      //  Verteilereintrag des Mandanten abfragen
      // verteiler.RESET;
      // verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."Company No.");
      // verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4,v_verteiler5);
      // IF verteiler.FINDFIRST THEN BEGIN
      //   EnterCell(RowNo,52,'Mandant','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      //    //  Sheet.Range('AZ'+j).Value :='Mandant';
      //  v_verteiler1:='Mandant';
      // END;
      verteiler.RESET;
      verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
      verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1',v_verteiler1);
      IF verteiler.FINDFIRST THEN BEGIN
        EnterCell(RowNo,53,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        v_verteiler2:=verteiler."Mailing Group Code"
      END;
      verteiler.RESET;
      verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
      verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2',v_verteiler1,v_verteiler2);
      IF verteiler.FINDFIRST THEN BEGIN
        EnterCell(RowNo,54,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        v_verteiler3:=verteiler."Mailing Group Code"
      END;
      verteiler.RESET;
      verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
      verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3',v_verteiler1,v_verteiler2,v_verteiler3);
      IF verteiler.FINDFIRST THEN BEGIN
        EnterCell(RowNo,55,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        v_verteiler4:=verteiler."Mailing Group Code"
      END;
      verteiler.RESET;
      verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
      verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4);
      IF verteiler.FINDFIRST THEN BEGIN
        EnterCell(RowNo,56,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        v_verteiler5:=verteiler."Mailing Group Code"
      END;
      verteiler.RESET;
      verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
      verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4,v_verteiler5);
      IF verteiler.FINDFIRST THEN BEGIN
        EnterCell(RowNo,57,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        v_verteiler6:=verteiler."Mailing Group Code"
      END;
      //  Verteilereintrag des Mandanten abfragen
      verteiler.RESET;
      verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."Company No.");
      IF verteiler.FINDFIRST THEN BEGIN
        EnterCell(RowNo,52,verteiler."Mailing Group Code"+' Mandant','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        Sheet.Range('AZ'+j).Value :=verteiler."Mailing Group Code"+' Mandant';
      END;
      kon_deb.RESET;
      kon_deb.SETFILTER(kon_deb."Contact No.",'%1',kontakt."Company No.");
      //        Kon_deb.CALCFIELDS("Business Relation Code");
      kon_deb.SETFILTER(kon_deb."Business Relation Code",'%1','DEB');
      IF kon_deb.FINDFIRST THEN BEGIN
        v_au:='';
        v_re:='';
        v_an:='';
        v_gu:='';
        v_art:='';
        belege.RESET;
        belege.SETFILTER(belege."Debitornr.",'%1',kon_deb."No.");
        IF ((v_datum_von=0D) AND (v_datum_bis=0D)) THEN BEGIN
        END ELSE BEGIN
          belege.SETFILTER(belege.Belegdatum,'%1..%2',v_datum_von,v_datum_bis);
        END;
        IF ((v_hersteller1='') AND (v_hersteller2='') AND (v_hersteller3='') AND (v_hersteller4='') AND (v_hersteller5='')) THEN BEGIN
        END ELSE BEGIN
          belege.SETFILTER(belege.Herstellercode,'%1|%2|%3|%4|%5',v_hersteller1,v_hersteller2,v_hersteller3,v_hersteller4,v_hersteller5);
        END;
      //            IF v_hersteller='' THEN BEGIN
      //            END ELSE BEGIN
      //              belege.SETFILTER(belege.Herstellercode,'%1',v_hersteller);
      //            END;
      //            belege.SETFILTER(belege.Herstellercode,'%1|%2','82','85');
        belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Quote);
        IF belege.FINDFIRST THEN BEGIN
          v_an:='AN';
          v_art:='Belege '+v_hersteller1+v_hersteller2+v_hersteller3+v_hersteller4+v_hersteller5;;
        END;
        belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Order);
        IF belege.FINDFIRST THEN BEGIN
          v_au:='AU';
          v_art:='Belege '+v_hersteller1+v_hersteller2+v_hersteller3+v_hersteller4+v_hersteller5;;
        END;
        belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::Invoice);
        IF belege.FINDFIRST THEN BEGIN
          v_re:='RE';
          v_art:='Belege '+v_hersteller1+v_hersteller2+v_hersteller3+v_hersteller4+v_hersteller5;;
        END;
        belege.SETFILTER(belege.Belegart,'%1',belege.Belegart::"Credit Memo");
        IF belege.FINDFIRST THEN BEGIN
          v_gu:='GU';
          v_art:='Belege '+v_hersteller1+v_hersteller2+v_hersteller3+v_hersteller4+v_hersteller5;;
        END;
        EnterCell(RowNo,58,v_art,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,59,v_an,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,60,v_au,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,61,v_re,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,62,v_gu,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,65,FORMAT(kontakt.Gesperrt),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        EnterCell(RowNo,66,FORMAT(kontakt."Unternehmen verlassen"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      END;
      RowNo := RowNo + 1;
    END;

    LOCAL PROCEDURE Funktion_neu_1@1000000014();
    BEGIN
      // wenn "nur_firma_verlassen" dann Funktion "Firma verlassen Neu"
      IF v_nur_firm_verlassen=TRUE THEN BEGIN
        Firma_verlassen_Neu;
      END ELSE BEGIN
        kontakt.RESET;
        // Einschr„kung gesperrte Kontakte ***********************************************************************
        kontakt.SETFILTER(kontakt.Gesperrt,'%1',FALSE);
        // Einschr„kung ohne Firma verlassen
        IF v_ohne_firm_verlassen=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Unternehmen verlassen",'%1',FALSE);
        END;
        // Einschr„nkung  Adressen nur mit Personen suchen
        IF v_person_adr=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Person);
        END;
        // Einschr„nkung  Adressen nur mit Mandant suchen
        IF v_mandant_adr=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Company);
        END;
        // Einschr„nkung  Adressen nur mit Emailadresse suchen
        IF v_email_adr=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."E-Mail",'<>%1','');
        END;
        // Einschr„nkung  Adressen L„nderkennzeichen DE
        IF v_landkz_de=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Country/Region Code",'%1','DE');
        END;
        // Einschr„nkung  Adressen L„nderkennzeichen DE, AT und CH
        IF v_landkz_de_at_ch=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Country/Region Code",'%1|%2|%3','DE','AT','CH');
        END;

        IF ((v_reiter4=TRUE) AND (v_alle_acs=TRUE)) THEN BEGIN
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END ELSE BEGIN
          IF v_reiter2=TRUE THEN BEGIN
            //  Einschr„nkung Positionscode (Funktion)
            IF v_ek=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','EINKAUF');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_ekl=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','EINKAUF-L');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_entwl=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','ENTW.-LEIT');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_entwh=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','ENTW.-HW');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_entws=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','ENTW.-SW');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_fin=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','FINANZEN');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_GL=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','GSCH.-LEIT');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_prod=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','PRODUKTION');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_qual=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','QUALITŽT');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_vertl=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','VERTRIEB-L');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_vert=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','VERTRIEB');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_supl=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SUPPORT-L');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_sup=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SUPPORT');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_tech=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','TECHNIKER');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_ml=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','MARKET-LEI');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_ma=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','MARKETING');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_so=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SONSTIGE');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_sop=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SONSTIGE-P');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_sol=TRUE THEN BEGIN
              kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SONSTIGE-L');
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
            IF v_alle=TRUE THEN BEGIN
              IF kontakt.FIND('-') THEN BEGIN
                REPEAT
                  Branche_Neu;
                UNTIL kontakt.NEXT=0;
              END;
            END;
          END;
        END;
      END;

      IF v_reiter3=TRUE THEN BEGIN
        //  Einschr„nkung Positionscode
        IF v_ek=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','EINKAUF');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_ekl=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','EINKAUF-L');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_entwl=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','ENTW.-LEIT');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_entwh=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','ENTW.-HW');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_entws=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','ENTW.-SW');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_fin=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','FINANZEN');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_GL=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','GSCH.-LEIT');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_prod=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','PRODUKTION');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_qual=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','QUALITŽT');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_vertl=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','VERTRIEB-L');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_vert=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','VERTRIEB');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_supl=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SUPPORT-L');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_sup=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SUPPORT');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_tech=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','TECHNIKER');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_ml=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','MARKET-LEI');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_ma=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','MARKETING');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_so=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SONSTIGE');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_sop=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SONSTIGE-P');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_sol=TRUE THEN BEGIN
          kontakt.SETFILTER(kontakt."Organizational Level Code",'%1','SONSTIGE-L');
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
        IF v_alle=TRUE THEN BEGIN
          IF kontakt.FIND('-') THEN BEGIN
            REPEAT
              Branche_System_Neu;
            UNTIL kontakt.NEXT=0;
          END;
        END;
      END ELSE BEGIN
      END;

      IF ((v_reiter2=FALSE) AND (v_reiter3=FALSE)) THEN ERROR('Kein H„kchen bei Reiter 2 Branche_Neu oder 3 Branche_System_Neu gesetzt.');

      CloseExcel('Mailingadressen','Mailingadressen','F:\Daten Neu\User\Uwe\Mailing');
      MESSAGE(Text003);
    END;

    LOCAL PROCEDURE Debitor_listen@1000000013();
    BEGIN
      CreateExcel;
      RecNo := 0;
      RowNo := 1;
      EnterCell(RowNo,1,'Debitor-Nr.','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,2,'Name_1','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,3,'Name_2','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,4,'EMail','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,5,'Verk„ufer','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,6,'Bearbeiter','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,7,'Gebiet','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,8,'Anz. Angebote','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,9,'Anz. Rahmen','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,10,'Anz. Auftr„ge','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,11,'Anz. Rechnungen','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,12,'Fakt. Betrag','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,13,'Adresse','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,14,'Adresse2','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,15,'Land','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,16,'PLZ','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,17,'Ort','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);

      debitor.RESET;
      debitor.SETFILTER(debitor."No.",'<>%1','1');
      //debitor.CALCFIELDS(debitor."No. of Quotes",debitor."No. of Blanket Orders",debitor."No. of Orders",debitor."No. of Pstd. Invoices",debitor."Invoice Amounts");
      //debitor.SETFILTER(debitor."AB EMail-Adresse",'<>%1','');
      IF debitor.FIND('-') THEN BEGIN
        REPEAT
          RowNo := RowNo + 1;
          debitor.CALCFIELDS(debitor."No. of Quotes",debitor."No. of Blanket Orders",debitor."No. of Orders",debitor."No. of Pstd. Invoices",debitor."Invoice Amounts");
          EnterCell(RowNo,1,debitor."No.",TOPAS_API.replace_text(TOPAS_API.CreateExcelHyperlinkToNav(debitor.TABLENAME,1,21,debitor."No."),';',','),FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      //    EnterCell(RowNo,1,debitor."No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Number);
          EnterCell(RowNo,2,debitor.Name,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,3,debitor."Name 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,4,debitor."AB EMail-Adresse",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,5,debitor."Salesperson Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,6,debitor."Betreuer Innendienst",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,7,debitor."Territory Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,8,FORMAT(debitor."No. of Quotes"),'',FALSE,FALSE,FALSE,'###,##0',TempExcelBuffer."Cell Type"::Number);
          EnterCell(RowNo,9,FORMAT(debitor."No. of Blanket Orders"),'',FALSE,FALSE,FALSE,'###,##0',TempExcelBuffer."Cell Type"::Number);
          EnterCell(RowNo,10,FORMAT(debitor."No. of Orders"),'',FALSE,FALSE,FALSE,'###,##0',TempExcelBuffer."Cell Type"::Number);
          EnterCell(RowNo,11,FORMAT(debitor."No. of Pstd. Invoices"),'',FALSE,FALSE,FALSE,'###,##0',TempExcelBuffer."Cell Type"::Number);
          EnterCell(RowNo,12,FORMAT(debitor."Invoice Amounts"),'',FALSE,FALSE,FALSE,'###,##0.00',TempExcelBuffer."Cell Type"::Number);
          EnterCell(RowNo,13,debitor.Address,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,14,debitor."Address 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,15,debitor."Country/Region Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,16,debitor."Post Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,17,debitor.City,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        UNTIL debitor.NEXT=0;
      END;
      CloseExcel('Debitorliste','Debitorliste','F:\Daten Neu\User\Uwe\Mailing');
      MESSAGE(Text003);
    END;

    LOCAL PROCEDURE sonstige_Listen_Neu@1000000016();
    BEGIN
      CreateExcel;
      RecNo := 0;
      RowNo := 1;
      EnterCell(RowNo,1,'Liste aller Kontakte im PLZ-Breich 6xxxx','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      RowNo := 2;
      EnterCell(RowNo,1,'Kontakt Nr.','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,2,'Firma','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,8,'Umsatz ab 1.7.17','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,9,'Anspr. vorhanden','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,10,'Projekte vorhanden','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,11,'Angebote vorhanden','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      RowNo := 4;
      kontakt.RESET;
      // kontakt.SETFILTER(kontakt."No.",'%1','KT001170');  // Testkontaktzeile
      kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Company);
      kontakt.SETFILTER("Country/Region Code",'%1','DE');
      kontakt.SETFILTER(kontakt."Post Code",'%1..%2','60000','69999');
      IF kontakt.FIND('-') THEN BEGIN
        REPEAT
          EnterCell(RowNo,1,kontakt."No.",TOPAS_API.replace_text(TOPAS_API.CreateExcelHyperlinkToNav(kontakt.TABLENAME,1,5050,kontakt."No."),';',','),FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,2,kontakt."Company Name",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,3,kontakt."Post Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,4,FORMAT(kontakt.Type),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,5,kontakt."Country/Region Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          kon_deb.RESET;
          kon_deb.SETFILTER(kon_deb."Contact No.",'%1',kontakt."No.");
          kon_deb.SETFILTER(kon_deb."Business Relation Code",'%1','DEB');
          IF kon_deb.FINDFIRST THEN BEGIN
            debitor.RESET;
            debitor.SETFILTER(debitor."No.",'%1',kon_deb."No.");
            IF debitor.FINDFIRST THEN BEGIN
              v_betrag:=0;
              EnterCell(RowNo,6,debitor."No.",TOPAS_API.replace_text(TOPAS_API.CreateExcelHyperlinkToNav(debitor.TABLENAME,1,21,debitor."No."),';',','),FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              vkrz.RESET;
              vkrz.SETFILTER(vkrz."Sell-to Customer No.",'%1',debitor."No.");
              vkrz.SETFILTER(vkrz.Quantity,'<>%1',0);
              vkrz.SETFILTER(vkrz."Posting Date",'>%1',300617D);
              IF vkrz.FIND('-') THEN BEGIN
                REPEAT
                    v_betrag:=v_betrag+vkrz.Amount;
                UNTIL vkrz.NEXT=0;
                EnterCell(RowNo,8,FORMAT(v_betrag),'',FALSE,FALSE,FALSE,'###,###,###.##',TempExcelBuffer."Cell Type"::Number);
              END;
            END;
          END;
          EnterCell(RowNo,7,kontakt."Territory Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          kontakt1.RESET;
          kontakt1.SETFILTER(kontakt1."Company No.",'%1',kontakt."No.");
          kontakt1.SETFILTER(kontakt1.Type,'%1',kontakt.Type::Person);
          IF kontakt1.FINDFIRST THEN BEGIN
            EnterCell(RowNo,9,'JA','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          END;

          "AP Auswahl".RESET;
          "AP Auswahl".SETFILTER("AP Auswahl"."Kontakt Mandantennr.",'%1',kontakt."No.");
          "AP Auswahl".SETFILTER("AP Auswahl"."Kampagnennr.",'<>%1','');
          IF "AP Auswahl".FINDFIRST THEN BEGIN
            EnterCell(RowNo,10,'JA','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          END;
          vkz.RESET;
          vkz.SETFILTER(vkz."Sell-to Customer No.",'%1',debitor."No.");
          vkz.SETFILTER(vkz."Document Type",'%1',vkz."Document Type"::Quote);
          IF vkz.FINDFIRST THEN BEGIN
            EnterCell(RowNo,11,'JA','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          END;
          RowNo := RowNo + 1;
        UNTIL kontakt.NEXT=0;
      END;
      CloseExcel('Kontaktliste','Kontaktliste','F:\Daten Neu\User\Uwe\Mailing');
      MESSAGE(Text003);
    END;

    LOCAL PROCEDURE doppelte_Ansprechpartner_Neu@1000000003();
    BEGIN
      CreateExcel;
      RecNo := 0;
      RowNo := 1;
      EnterCell(RowNo,1,'USER1','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,2,'Vorname','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,3,'Name','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,4,'Firma','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,5,'Funktion','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,6,'Email','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,7,'Anrede','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,8,'USER2','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,9,'Nation','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,10,'PLZ','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,11,'Ort','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,12,'Abteilung','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,13,'Verk„ufer','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,14,'Betreuer','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,15,'Gebiet','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,16,'Branche','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,17,'Telefon','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,18,'AC Solutionpartner','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,19,'Gesperrt','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,20,'Firma verlassen','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      RowNo := 2;
      kontakt.RESET;
      kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Person);
      kontakt.SETFILTER(kontakt.Gesperrt,'%1',FALSE);
      kontakt.SETFILTER(kontakt."Unternehmen verlassen",'%1',FALSE);
      IF kontakt.FIND('-') THEN BEGIN
        REPEAT
          kontakt1.RESET;
          kontakt1.SETFILTER(kontakt1.Name,'%1',kontakt.Name);
          kontakt1.SETFILTER(kontakt1."Company Name",'%1',kontakt."Company Name");
          kontakt1.SETFILTER(kontakt1."First Name",'<>%1','Auftragsbest„tigung');
          kontakt1.SETFILTER(kontakt1.Surname,'<>%1','Auftragsbest„tigung');
          kontakt1.SETFILTER(kontakt1."First Name",'<>%1','Qualit„tssicherung');
          kontakt1.SETFILTER(kontakt1.Surname,'<>%1','Qualit„tssicherung');
          kontakt1.SETFILTER(kontakt1."Unternehmen verlassen",'%1',FALSE);
          IF kontakt1.FIND('-') THEN BEGIN
            REPEAT
              IF kontakt1."No." = kontakt."No." THEN BEGIN
              END ELSE BEGIN
      //        Adressverwaltung;
                EnterCell(RowNo,1,kontakt1."No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,2,kontakt1."First Name",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,3,kontakt1.Surname,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,4,kontakt1."Company Name",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,5,kontakt1."Organizational Level Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,6,kontakt1."E-Mail",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                IF kontakt1."Salutation Code" = 'HERR' THEN EnterCell(RowNo,7,'Herr','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                IF kontakt1."Salutation Code" = 'FRAU' THEN EnterCell(RowNo,7,'Frau','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,8,kontakt1."Company No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,9,kontakt1."Country/Region Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,10,kontakt1."Post Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,11,kontakt1.City,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,12,kontakt1.Abteilung,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,13,kontakt1."Salesperson Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,14,kontakt1."Betreuer Innendienst",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,15,kontakt1."Territory Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,17,kontakt1."Phone No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,18,kontakt1.AC_Solutionpartner,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,19,FORMAT(kontakt1.Gesperrt),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,20,FORMAT(kontakt1."Unternehmen verlassen"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);

      //  Branche Neu Start   ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                branche.RESET;
                v_branche:=0;
                v_branche1:='';
                v_branche2:='';
                v_branche3:='';
                v_branche4:='';
                v_branche5:='';
                v_branche6:='';
                v_branche7:='';
                v_branche8:='';
                v_branche9:='';
                v_branche10:='';
                v_branche11:='';
                v_branche12:='';
                v_branche13:='';
                v_branche14:='';
                v_branche15:='';
                branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
                branche.SETFILTER(branche."Industry Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5&<>%6','1-INNOVATO','2-EARL ADO','3-EARL MAJ','4-LATE MAJ','5-LAGGARDS','AUFTR-ENTW');
                IF branche.FIND('-') THEN BEGIN
                  REPEAT
                    v_branche:=v_branche+1;
                    IF v_branche = 1 THEN  v_branche1:=branche."Industry Group Code";
                    IF v_branche = 2 THEN  v_branche2:=branche."Industry Group Code";
                    IF v_branche = 3 THEN  v_branche3:=branche."Industry Group Code";
                    IF v_branche = 4 THEN  v_branche4:=branche."Industry Group Code";
                    IF v_branche = 5 THEN  v_branche5:=branche."Industry Group Code";
                    IF v_branche = 6 THEN  v_branche6:=branche."Industry Group Code";
                    IF v_branche = 7 THEN  v_branche7:=branche."Industry Group Code";
                    IF v_branche = 8 THEN  v_branche8:=branche."Industry Group Code";
                    IF v_branche = 9 THEN  v_branche9:=branche."Industry Group Code";
                    IF v_branche =10 THEN  v_branche10:=branche."Industry Group Code";
                    IF v_branche =11 THEN  v_branche11:=branche."Industry Group Code";
                    IF v_branche =12 THEN  v_branche12:=branche."Industry Group Code";
                    IF v_branche =13 THEN  v_branche13:=branche."Industry Group Code";
                    IF v_branche =14 THEN  v_branche14:=branche."Industry Group Code";
                    IF v_branche =15 THEN  v_branche15:=branche."Industry Group Code";
                  UNTIL branche.NEXT=0;
                END;
                EnterCell(RowNo,21,v_branche1,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,22,v_branche2,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,23,v_branche3,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,24,v_branche4,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,25,v_branche5,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,26,v_branche6,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,27,v_branche7,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,28,v_branche8,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,29,v_branche9,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,30,v_branche10,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,31,v_branche11,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,32,v_branche12,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,33,v_branche13,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,34,v_branche14,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                IF v_branche>15 THEN BEGIN
                  EnterCell(RowNo,35,'Fehler','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                END ELSE BEGIN
                  EnterCell(RowNo,35,v_branche15,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                END;
      //  Branche Neu Ende  ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
                verteiler.RESET;
                verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
                IF verteiler.FINDFIRST THEN BEGIN
                  EnterCell(RowNo,36,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                  v_verteiler1:=verteiler."Mailing Group Code";
                END;
                verteiler.RESET;
                verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
                verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1',v_verteiler1);
                IF verteiler.FINDFIRST THEN BEGIN
                  EnterCell(RowNo,37,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                  v_verteiler2:=verteiler."Mailing Group Code"
                END;
                verteiler.RESET;
                verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
                verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2',v_verteiler1,v_verteiler2);
                IF verteiler.FINDFIRST THEN BEGIN
                  EnterCell(RowNo,38,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                  v_verteiler3:=verteiler."Mailing Group Code"
                END;
                verteiler.RESET;
                verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
                verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3',v_verteiler1,v_verteiler2,v_verteiler3);
                IF verteiler.FINDFIRST THEN BEGIN
                  EnterCell(RowNo,39,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                  v_verteiler4:=verteiler."Mailing Group Code"
                END;
                verteiler.RESET;
                verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
                verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4);
                IF verteiler.FINDFIRST THEN BEGIN
                  EnterCell(RowNo,40,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                  v_verteiler5:=verteiler."Mailing Group Code"
                END;
                verteiler.RESET;
                verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
                verteiler.SETFILTER(verteiler."Mailing Group Code",'<>%1&<>%2&<>%3&<>%4&<>%5',v_verteiler1,v_verteiler2,v_verteiler3,v_verteiler4,v_verteiler5);
                IF verteiler.FINDFIRST THEN BEGIN
                  EnterCell(RowNo,41,verteiler."Mailing Group Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                  v_verteiler6:=verteiler."Mailing Group Code"
                END;

      //  Verteilereintrag des Mandanten abfragen
                verteiler.RESET;
                verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."Company No.");
                IF verteiler.FINDFIRST THEN BEGIN
                  v_verteiler6:=(verteiler."Mailing Group Code"+' Mandant');
                END;
                RowNo := RowNo + 1;
              END;
            UNTIL kontakt1.NEXT=0;
          END;
        UNTIL kontakt.NEXT=0;
      END;

      CloseExcel('Doppelte Ansprechparnter','Doppelte Ansprechpartner','F:\Daten Neu\User\Uwe\Mailing');
      MESSAGE(Text003);
    END;

    LOCAL PROCEDURE Training_absolviert@1000000018();
    BEGIN
      CreateExcel;
      RecNo := 0;
      RowNo := 1;
      EnterCell(RowNo,1,'Aktuelle Trainingsabsolventen','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      RowNo := 2;
      EnterCell(RowNo,1,'USER1','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,2,'Art','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,3,'Firma','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,4,'Firma2','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,5,'Anrede','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,6,'Titel','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,7,'Vorname','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,8,'Name','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,9,'Abteilung','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,10,'Straáe','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,11,'Straáe','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,12,'Nation','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,13,'PLZ','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,14,'Ort','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,15,'Verk„ufer','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,16,'Betreuer','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,17,'Gebiet','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,18,'Branche','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,19,'Funktion','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,20,'Email','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,21,'Telefon','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,22,'USER2','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,23,'Mandant Gesperrt','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,24,'Person Gesperrt','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,25,'Firma verlassen','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,26,'Betreff','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,27,'Schulung','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,28,'Schulungsdatum','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,29,'Unsubcribe','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,30,'NoEmail','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,31,'Training','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      RowNo := 3;
      Tab50032.RESET;
      Tab50032.SETFILTER(Tab50032.Aktion,'%1',Tab50032.Aktion::Schulung);
      IF Tab50032.FIND('-') THEN BEGIN
        REPEAT
          kontakt.RESET;
          kontakt.SETFILTER(kontakt."No.",'%1',Tab50032."Kontaktnr.");
          IF kontakt.FINDFIRST THEN BEGIN
            EnterCell(RowNo,1,kontakt."No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            IF kontakt.Type=kontakt.Type::Company THEN EnterCell(RowNo,2,'Mandant','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            IF kontakt.Type<>kontakt.Type::Company THEN EnterCell(RowNo,2,'Person','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            IF kontakt.Type=kontakt.Type::Company THEN BEGIN
              EnterCell(RowNo,3,kontakt.Name,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,4,kontakt."Name 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            END ELSE BEGIN
              kontakt1.RESET;
              kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
              IF kontakt1.FINDFIRST THEN BEGIN
                EnterCell(RowNo,3,kontakt1.Name,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
                EnterCell(RowNo,4,kontakt1."Name 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              END;
            END;
            IF kontakt."Salutation Code" = 'HERR' THEN EnterCell(RowNo,5,'Herr','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            IF kontakt."Salutation Code" = 'FRAU' THEN EnterCell(RowNo,5,'Frau','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,6,kontakt."Job Title",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,7,kontakt."First Name",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,8,kontakt.Surname,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,9,kontakt.Abteilung,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,10,kontakt.Address,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,11,kontakt."Address 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,12,kontakt."Country/Region Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,13,FORMAT(kontakt."Post Code"),'',FALSE,FALSE,FALSE,'00000',TempExcelBuffer."Cell Type"::Number);
            EnterCell(RowNo,14,kontakt.City,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,15,kontakt."Salesperson Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,16,kontakt."Betreuer Innendienst",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,17,kontakt."Territory Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,18,FORMAT(kontakt."No. of Industry Groups"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Number);
            EnterCell(RowNo,19,kontakt."Organizational Level Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,20,kontakt."E-Mail",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,21,kontakt."Phone No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,22,kontakt."Company No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,24,FORMAT(kontakt.Gesperrt),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,25,FORMAT(kontakt."Unternehmen verlassen"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);

            kontakt1.RESET;
            kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
            IF kontakt1.FINDFIRST THEN BEGIN
              EnterCell(RowNo,23,FORMAT(kontakt1.Gesperrt),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            END;
            EnterCell(RowNo,26,Tab50032.Betreff,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,27,FORMAT(Tab50032.Schulung),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,28,FORMAT(Tab50032.Schulungsdatum),'',FALSE,FALSE,FALSE,'dd.mm.yyyy',TempExcelBuffer."Cell Type"::Date);

            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            verteiler.SETFILTER(verteiler."Mailing Group Code",'%1','UNSUB');
            IF verteiler.FINDFIRST THEN BEGIN
              EnterCell(RowNo,29,FORMAT(verteiler."Mailing Group Code"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            END;

            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            verteiler.SETFILTER(verteiler."Mailing Group Code",'%1','NO EMAIL');
            IF verteiler.FINDFIRST THEN BEGIN
              EnterCell(RowNo,30,FORMAT(verteiler."Mailing Group Code"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            END;

            verteiler.RESET;
            verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
            verteiler.SETFILTER(verteiler."Mailing Group Code",'%1','TRAINING');
            IF verteiler.FINDFIRST THEN BEGIN
              EnterCell(RowNo,31,FORMAT(verteiler."Mailing Group Code"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            END;

            RowNo := RowNo + 1;
          END;
        UNTIL Tab50032.NEXT=0;
      END;

      CloseExcel('Trainingsabsolvent','Trainingsabsolvent','F:\Daten Neu\User\Uwe\Mailing');
      MESSAGE(Text003);
    END;

    LOCAL PROCEDURE Test_Marge_bei_RE@1000000019();
    BEGIN
      CreateExcel;
      RowNo := 1;
      //EnterCell(RowNo,1,'Margenbetrachtung fr spezielle Rechnungen','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      //RowNo := 2;
      EnterCell(RowNo,1,'Datum','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,2,'Re-Nr.','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,3,'Zeilennr.','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,4,'Debitornr','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,5,'Debitor','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,6,'Artikel','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,7,'Menge','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,8,'Restmenge','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,9,'EK','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,10,'EK-Betrag','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,11,'VK','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,12,'VK-Betrag','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,13,'Marge %','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,14,'Marge Betrag','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);

      RowNo := 3;
      vkrk.RESET;
      vkrk.SETFILTER(vkrk."Posting Date",'%1..2%"',010521D,310521D);
      v_EK_Gesamt:=0;
      v_VK_Gesamt:=0;
      v_Marge_Gesamt:=0;
      "v_Marge_Gesamt_%":=0;
      IF vkrk.FIND('-') THEN BEGIN
        REPEAT
          vkrz.RESET;
          vkrz.SETFILTER(vkrz."Document No.",'%1',vkrk."No.");
          vkrz.SETFILTER(vkrz."Manufacturer Code",'%1','57');
          vkrz.SETFILTER(vkrz.Quantity,'<>%1',0);
          vkrz.SETFILTER(vkrz."Location Code",'%1','ZENT');
          IF vkrz.FIND('-') THEN BEGIN
            EnterCell(RowNo,1,FORMAT(vkrk."Posting Date"),'',FALSE,FALSE,FALSE,'dd.mm.yyyy',TempExcelBuffer."Cell Type"::Date);
            EnterCell(RowNo,2,vkrz."Document No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,3,FORMAT(vkrz."Line No."),'',FALSE,FALSE,FALSE,'#######',TempExcelBuffer."Cell Type"::Number);
            EnterCell(RowNo,4,vkrk."Sell-to Customer No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,5,vkrk."Sell-to Customer Name",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,6,vkrz."No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,7,FORMAT(vkrz.Quantity),'',FALSE,FALSE,FALSE,'###,###',TempExcelBuffer."Cell Type"::Number);
            EnterCell(RowNo,8,'','',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
            EnterCell(RowNo,9,FORMAT(vkrz."DC-Preis (MW)"),'',FALSE,FALSE,FALSE,'###,##0.00',TempExcelBuffer."Cell Type"::Number);
            EnterCell(RowNo,10,FORMAT(vkrz."DC-Preis (MW)"*vkrz.Quantity),'',FALSE,FALSE,FALSE,'###,##0.00',TempExcelBuffer."Cell Type"::Number);
            EnterCell(RowNo,11,FORMAT(vkrz."VK-Preis (MW)"),'',FALSE,FALSE,FALSE,'###,##0.00',TempExcelBuffer."Cell Type"::Number);
            EnterCell(RowNo,12,FORMAT(vkrz."VK-Preis (MW)"*vkrz.Quantity),'',FALSE,FALSE,FALSE,'###,##0.00',TempExcelBuffer."Cell Type"::Number);
            EnterCell(RowNo,13,FORMAT(((vkrz."VK-Preis (MW)"*vkrz.Quantity)-(vkrz."DC-Preis (MW)"*vkrz.Quantity))/(vkrz."VK-Preis (MW)"*vkrz.Quantity)*100),'',FALSE,FALSE,FALSE,'###,##0.00',TempExcelBuffer."Cell Type"::Number);
            EnterCell(RowNo,14,FORMAT((vkrz."VK-Preis (MW)"*vkrz.Quantity)-(vkrz."DC-Preis (MW)"*vkrz.Quantity)),'',FALSE,FALSE,FALSE,'###,##0.00',TempExcelBuffer."Cell Type"::Number);
            v_EK_Gesamt:=v_EK_Gesamt+(vkrz."DC-Preis (MW)"*vkrz.Quantity);
            v_VK_Gesamt:=v_VK_Gesamt+(vkrz."VK-Preis (MW)"*vkrz.Quantity);
            RowNo := RowNo + 1;
          END;
        UNTIL vkrk.NEXT=0;
      END;
      v_Marge_Gesamt:=v_VK_Gesamt-v_EK_Gesamt;
      "v_Marge_Gesamt_%":=v_Marge_Gesamt/v_VK_Gesamt*100;
      RowNo := RowNo + 2;
      EnterCell(RowNo,10,FORMAT(v_EK_Gesamt),'',FALSE,FALSE,FALSE,'###,##0.00',TempExcelBuffer."Cell Type"::Number);
      EnterCell(RowNo,12,FORMAT(v_VK_Gesamt),'',FALSE,FALSE,FALSE,'###,##0.00',TempExcelBuffer."Cell Type"::Number);
      EnterCell(RowNo,14,FORMAT(v_Marge_Gesamt),'',FALSE,FALSE,FALSE,'###,##0.00',TempExcelBuffer."Cell Type"::Number);
      EnterCell(RowNo,13,FORMAT("v_Marge_Gesamt_%"),'',FALSE,FALSE,FALSE,'###,##0.00',TempExcelBuffer."Cell Type"::Number);
      CloseExcel('Margebetrachtung_Champs','Margenbetrachung_Champs','F:\Daten Neu\User\Uwe\Maria');
      MESSAGE(Text003);
    END;

    LOCAL PROCEDURE no_branche_1@1000000020();
    BEGIN
      CreateExcel;
      RowNo := 1;
      EnterCell(RowNo,1,'Kontakte ohne Brancheneintrag  Stand:','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,4,FORMAT(WORKDATE),'',TRUE,FALSE,FALSE,'dd.mm.yyyy',TempExcelBuffer."Cell Type"::Date);
      RowNo := 2;
      EnterCell(RowNo,1,'Kontakt','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,2,'Debitor','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,3,'Firma','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,4,'Firma2','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,5,'Adresse','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,6,'Adresse2','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,7,'Nation','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,8,'PLZ','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,9,'Ort','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,10,'Verk„ufer','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,11,'Betreuer','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,12,'Gebiet','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,13,'Team','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,14,'Branche','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);

      RowNo := 3;

      kontakt.RESET;
      kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Company);
      kontakt.SETFILTER(kontakt.Gesperrt,'%1',FALSE);

      IF kontakt.FIND('-') THEN BEGIN
        REPEAT
          branche.RESET;
          branche.SETFILTER(branche."Contact No.",'%1',kontakt."Company No.");
      //  branche.SETFILTER(branche."Industry Group Code",'%1','SUS*');
          IF NOT branche.FINDFIRST THEN BEGIN
      //      EnterCell(RowNo,1,FORMAT(kontakt."No."),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      //      EnterCell(RowNo,2,vkrz."Document No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      //      EnterCell(RowNo,3,FORMAT(kontakt.Name),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      //      EnterCell(RowNo,4,FORMAT('kontakt.Name 2'),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      //      EnterCell(RowNo,5,kontakt.Address,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      //      EnterCell(RowNo,6,kontakt."Address 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      //      EnterCell(RowNo,7,kontakt."Country/Region Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      //      EnterCell(RowNo,8,FORMAT(kontakt."Post Code"),'',FALSE,FALSE,FALSE,'00000',TempExcelBuffer."Cell Type"::Number);
      //      EnterCell(RowNo,9,kontakt.City,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      //      EnterCell(RowNo,10,kontakt."Salesperson Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      //      EnterCell(RowNo,11,kontakt."Betreuer Innendienst",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      //      EnterCell(RowNo,12,kontakt."Territory Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      //      EnterCell(RowNo,13,kontakt.Teams,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      //      EnterCell(RowNo,14,FORMAT(kontakt."No. of Industry Groups"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Number);
      //      RowNo := RowNo + 1;



            kon_deb.RESET;
            kon_deb.SETFILTER(kon_deb."Contact No.",'%1',kontakt."Company No.");
            kon_deb.SETFILTER(kon_deb."Business Relation Code",'%1','DEB');
            IF kon_deb.FIND('-') THEN BEGIN
              EnterCell(RowNo,1,FORMAT(kontakt."No."),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,2,kon_deb."No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,3,FORMAT(kontakt.Name),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,4,FORMAT(kontakt."Name 2"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,5,kontakt.Address,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,6,kontakt."Address 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,7,kontakt."Country/Region Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,8,FORMAT(kontakt."Post Code"),'',FALSE,FALSE,FALSE,'00000',TempExcelBuffer."Cell Type"::Number);
              EnterCell(RowNo,9,kontakt.City,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,10,kontakt."Salesperson Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,11,kontakt."Betreuer Innendienst",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,12,kontakt."Territory Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,13,kontakt.Teams,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,14,FORMAT(kontakt."No. of Industry Groups"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Number);
              RowNo := RowNo + 1;
            END ELSE BEGIN
              EnterCell(RowNo,1,FORMAT(kontakt."No."),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
        //      EnterCell(RowNo,2,kon_deb."No.",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,3,FORMAT(kontakt.Name),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,4,FORMAT(kontakt."Name 2"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,5,kontakt.Address,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,6,kontakt."Address 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,7,kontakt."Country/Region Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,8,FORMAT(kontakt."Post Code"),'',FALSE,FALSE,FALSE,'00000',TempExcelBuffer."Cell Type"::Number);
              EnterCell(RowNo,9,kontakt.City,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,10,kontakt."Salesperson Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,11,kontakt."Betreuer Innendienst",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,12,kontakt."Territory Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,13,kontakt.Teams,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,14,FORMAT(kontakt."No. of Industry Groups"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Number);
              RowNo := RowNo + 1;
            END;
          END;
        UNTIL kontakt.NEXT=0;
      END;
      CloseExcel('Kontakte ohne Branchen','Kontakte ohne Branchen','F:\Daten Neu\User\Uwe\Interne');

      MESSAGE(Text003);
    END;

    LOCAL PROCEDURE unsub_Abgleich@1000000022();
    BEGIN
      CreateExcel;
      RowNo := 1;
      EnterCell(RowNo,1,'Unsub Abgleich  Stand:','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,3,FORMAT(WORKDATE),'',TRUE,FALSE,FALSE,'dd.mm.yyyy',TempExcelBuffer."Cell Type"::Date);
      RowNo := 2;
      EnterCell(RowNo,1,'Kontakt','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,2,'Name','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,3,'Vorname','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,4,'Firma','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,5,'Adresse','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,6,'Adresse2','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,7,'Nation','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,8,'PLZ','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,9,'Ort','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,10,'Verk„ufer','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,11,'Betreuer','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,12,'Gebiet','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,13,'Team','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
      EnterCell(RowNo,14,'Verteiler','',TRUE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);

      RowNo := 3;

      {
      verteiler.RESET;
      verteiler.SETFILTER(verteiler."Mailing Group Code",'%1','UNSUB');
      IF verteiler.FIND('-') THEN BEGIN
        REPEAT
        kontakt.RESET;
        kontakt.SETFILTER(kontakt."No.",'%1',verteiler."Contact No.");
      //  kontakt.SETFILTER(kontakt.Gesperrt,'%1',FALSE);
        IF kontakt.FIND('-') THEN BEGIN

              EnterCell(RowNo,1,FORMAT(kontakt."No."),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,2,FORMAT(kontakt.Surname),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,3,FORMAT(kontakt."First Name"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,4,FORMAT(kontakt.Name),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,5,kontakt.Address,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,6,kontakt."Address 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,7,kontakt."Country/Region Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,8,FORMAT(kontakt."Post Code"),'',FALSE,FALSE,FALSE,'00000',TempExcelBuffer."Cell Type"::Number);
              EnterCell(RowNo,9,kontakt.City,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,10,kontakt."Salesperson Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,11,kontakt."Betreuer Innendienst",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,12,kontakt."Territory Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,13,kontakt.Teams,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,14,FORMAT(kontakt."No. of Mailing Groups"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Number);
              EnterCell(RowNo,15,FORMAT(kontakt."No."),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
              EnterCell(RowNo,16,FORMAT(kontakt."E-Mail"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Number);
              EnterCell(RowNo,17,FORMAT(kontakt.Gesperrt),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Number);
              RowNo := RowNo + 1;

            END;

        UNTIL verteiler.NEXT=0;

      END;
      }

      kontakt.RESET;
      kontakt.SETFILTER(kontakt."Salutation Code",'<>%1','MANDANT');
      kontakt.SETFILTER(kontakt.Gesperrt,'%1',FALSE);
      kontakt.SETFILTER(kontakt."E-Mail",'<>%1','');
      IF kontakt.FIND('-') THEN BEGIN
        REPEAT
          EnterCell(RowNo,1,FORMAT(kontakt."No."),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,2,FORMAT(kontakt.Surname),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,3,FORMAT(kontakt."First Name"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,4,FORMAT(kontakt.Name),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,5,kontakt.Address,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,6,kontakt."Address 2",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,7,kontakt."Country/Region Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,8,FORMAT(kontakt."Post Code"),'',FALSE,FALSE,FALSE,'00000',TempExcelBuffer."Cell Type"::Number);
          EnterCell(RowNo,9,kontakt.City,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,10,kontakt."Salesperson Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,11,kontakt."Betreuer Innendienst",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,12,kontakt."Territory Code",'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,13,kontakt.Teams,'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,14,FORMAT(kontakt."No. of Mailing Groups"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Number);
          EnterCell(RowNo,15,FORMAT(kontakt."No."),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Text);
          EnterCell(RowNo,16,FORMAT(kontakt."E-Mail"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Number);
          verteiler.RESET;
          verteiler.SETFILTER(verteiler."Contact No.",'%1',kontakt."No.");
          IF verteiler.FIND('-') THEN BEGIN
            EnterCell(RowNo,17,FORMAT(verteiler."Mailing Group Code"),'',FALSE,FALSE,FALSE,'',TempExcelBuffer."Cell Type"::Number);
          END;
          RowNo := RowNo + 1;
        UNTIL kontakt.NEXT=0;
      END;


      CloseExcel('Unsub_Abgleich','Unsub_Abgleich','F:\Daten Neu\User\Uwe\Interne\Steffen');

      MESSAGE(Text003);
    END;

    EVENT Sheet@1000000249::SelectionChange@1543(Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT Sheet@1000000249::BeforeDoubleClick@1537(Target@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Sheet@1000000249::BeforeRightClick@1534(Target@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Sheet@1000000249::Activate@304();
    BEGIN
    END;

    EVENT Sheet@1000000249::Deactivate@1530();
    BEGIN
    END;

    EVENT Sheet@1000000249::Calculate@279();
    BEGIN
    END;

    EVENT Sheet@1000000249::Change@1545(Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT Sheet@1000000249::FollowHyperlink@1470(Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00024431-0000-0000-C000-000000000046}:Unknown Automation Server.Hyperlink");
    BEGIN
    END;

    EVENT Sheet@1000000249::PivotTableUpdate@2156(Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT Sheet@1000000249::PivotTableAfterValueChange@2886(TargetPivotTable@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";TargetRange@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT Sheet@1000000249::PivotTableBeforeAllocateChanges@2889(TargetPivotTable@1000000003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1000000002 : Integer;ValueChangeEnd@1000000001 : Integer;VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Sheet@1000000249::PivotTableBeforeCommitChanges@2892(TargetPivotTable@1000000003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1000000002 : Integer;ValueChangeEnd@1000000001 : Integer;VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Sheet@1000000249::PivotTableBeforeDiscardChanges@2893(TargetPivotTable@1000000002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1000000001 : Integer;ValueChangeEnd@1000000000 : Integer);
    BEGIN
    END;

    EVENT Sheet@1000000249::PivotTableChangeSync@2894(Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT Book@1000000251::Open@1923();
    BEGIN
    END;

    EVENT Book@1000000251::Activate@304();
    BEGIN
    END;

    EVENT Book@1000000251::Deactivate@1530();
    BEGIN
    END;

    EVENT Book@1000000251::BeforeClose@1546(VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Book@1000000251::BeforeSave@1547(SaveAsUI@1000000001 : Boolean;VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Book@1000000251::BeforePrint@1549(VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Book@1000000251::NewSheet@1550(Sh@1000000000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Book@1000000251::AddinInstall@1552();
    BEGIN
    END;

    EVENT Book@1000000251::AddinUninstall@1553();
    BEGIN
    END;

    EVENT Book@1000000251::WindowResize@1554(Wn@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:Unknown Automation Server.Window");
    BEGIN
    END;

    EVENT Book@1000000251::WindowActivate@1556(Wn@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:Unknown Automation Server.Window");
    BEGIN
    END;

    EVENT Book@1000000251::WindowDeactivate@1557(Wn@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:Unknown Automation Server.Window");
    BEGIN
    END;

    EVENT Book@1000000251::SheetSelectionChange@1558(Sh@1000000001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT Book@1000000251::SheetBeforeDoubleClick@1559(Sh@1000000002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Book@1000000251::SheetBeforeRightClick@1560(Sh@1000000002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Book@1000000251::SheetActivate@1561(Sh@1000000000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Book@1000000251::SheetDeactivate@1562(Sh@1000000000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Book@1000000251::SheetCalculate@1563(Sh@1000000000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Book@1000000251::SheetChange@1564(Sh@1000000001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT Book@1000000251::SheetFollowHyperlink@1854(Sh@1000000001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00024431-0000-0000-C000-000000000046}:Unknown Automation Server.Hyperlink");
    BEGIN
    END;

    EVENT Book@1000000251::SheetPivotTableUpdate@2157(Sh@1000000001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT Book@1000000251::PivotTableCloseConnection@2158(Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT Book@1000000251::PivotTableOpenConnection@2159(Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT Book@1000000251::Sync@2266(SyncEventType@1000000000 : Integer);
    BEGIN
    END;

    EVENT Book@1000000251::BeforeXmlImport@2283(Map@1000000003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";Url@1000000002 : Text;IsRefresh@1000000001 : Boolean;VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Book@1000000251::AfterXmlImport@2285(Map@1000000002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";IsRefresh@1000000001 : Boolean;Result@1000000000 : Integer);
    BEGIN
    END;

    EVENT Book@1000000251::BeforeXmlExport@2287(Map@1000000002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";Url@1000000001 : Text;VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Book@1000000251::AfterXmlExport@2288(Map@1000000002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";Url@1000000001 : Text;Result@1000000000 : Integer);
    BEGIN
    END;

    EVENT Book@1000000251::RowsetComplete@2610(Description@1000000002 : Text;Sheet@1000000001 : Text;Success@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Book@1000000251::SheetPivotTableAfterValueChange@2895(Sh@1000000002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";TargetRange@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT Book@1000000251::SheetPivotTableBeforeAllocateChanges@2896(Sh@1000000004 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1000000003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1000000002 : Integer;ValueChangeEnd@1000000001 : Integer;VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Book@1000000251::SheetPivotTableBeforeCommitChanges@2897(Sh@1000000004 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1000000003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1000000002 : Integer;ValueChangeEnd@1000000001 : Integer;VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Book@1000000251::SheetPivotTableBeforeDiscardChanges@2898(Sh@1000000003 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1000000002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1000000001 : Integer;ValueChangeEnd@1000000000 : Integer);
    BEGIN
    END;

    EVENT Book@1000000251::SheetPivotTableChangeSync@2899(Sh@1000000001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT Book@1000000251::AfterSave@2900(Success@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Book@1000000251::NewChart@2901(Ch@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020821-0000-0000-C000-000000000046}:Unknown Automation Server.Chart");
    BEGIN
    END;

    EVENT Excel@1000000252::NewWorkbook@1565(Wb@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook");
    BEGIN
    END;

    EVENT Excel@1000000252::SheetSelectionChange@1558(Sh@1000000001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT Excel@1000000252::SheetBeforeDoubleClick@1559(Sh@1000000002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1000000252::SheetBeforeRightClick@1560(Sh@1000000002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1000000252::SheetActivate@1561(Sh@1000000000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Excel@1000000252::SheetDeactivate@1562(Sh@1000000000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Excel@1000000252::SheetCalculate@1563(Sh@1000000000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Excel@1000000252::SheetChange@1564(Sh@1000000001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT Excel@1000000252::WorkbookOpen@1567(Wb@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook");
    BEGIN
    END;

    EVENT Excel@1000000252::WorkbookActivate@1568(Wb@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook");
    BEGIN
    END;

    EVENT Excel@1000000252::WorkbookDeactivate@1569(Wb@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook");
    BEGIN
    END;

    EVENT Excel@1000000252::WorkbookBeforeClose@1570(Wb@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1000000252::WorkbookBeforeSave@1571(Wb@1000000002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";SaveAsUI@1000000001 : Boolean;VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1000000252::WorkbookBeforePrint@1572(Wb@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1000000252::WorkbookNewSheet@1573(Wb@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Sh@1000000000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Excel@1000000252::WorkbookAddinInstall@1574(Wb@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook");
    BEGIN
    END;

    EVENT Excel@1000000252::WorkbookAddinUninstall@1575(Wb@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook");
    BEGIN
    END;

    EVENT Excel@1000000252::WindowResize@1554(Wb@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Wn@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:Unknown Automation Server.Window");
    BEGIN
    END;

    EVENT Excel@1000000252::WindowActivate@1556(Wb@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Wn@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:Unknown Automation Server.Window");
    BEGIN
    END;

    EVENT Excel@1000000252::WindowDeactivate@1557(Wb@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Wn@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:Unknown Automation Server.Window");
    BEGIN
    END;

    EVENT Excel@1000000252::SheetFollowHyperlink@1854(Sh@1000000001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00024431-0000-0000-C000-000000000046}:Unknown Automation Server.Hyperlink");
    BEGIN
    END;

    EVENT Excel@1000000252::SheetPivotTableUpdate@2157(Sh@1000000001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT Excel@1000000252::WorkbookPivotTableCloseConnection@2160(Wb@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT Excel@1000000252::WorkbookPivotTableOpenConnection@2161(Wb@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Target@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT Excel@1000000252::WorkbookSync@2289(Wb@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";SyncEventType@1000000000 : Integer);
    BEGIN
    END;

    EVENT Excel@1000000252::WorkbookBeforeXmlImport@2290(Wb@1000000004 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Map@1000000003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";Url@1000000002 : Text;IsRefresh@1000000001 : Boolean;VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1000000252::WorkbookAfterXmlImport@2291(Wb@1000000003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Map@1000000002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";IsRefresh@1000000001 : Boolean;Result@1000000000 : Integer);
    BEGIN
    END;

    EVENT Excel@1000000252::WorkbookBeforeXmlExport@2292(Wb@1000000003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Map@1000000002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";Url@1000000001 : Text;VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1000000252::WorkbookAfterXmlExport@2293(Wb@1000000003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Map@1000000002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";Url@1000000001 : Text;Result@1000000000 : Integer);
    BEGIN
    END;

    EVENT Excel@1000000252::WorkbookRowsetComplete@2611(Wb@1000000003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Description@1000000002 : Text;Sheet@1000000001 : Text;Success@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1000000252::AfterCalculate@2612();
    BEGIN
    END;

    EVENT Excel@1000000252::SheetPivotTableAfterValueChange@2895(Sh@1000000002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";TargetRange@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT Excel@1000000252::SheetPivotTableBeforeAllocateChanges@2896(Sh@1000000004 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1000000003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1000000002 : Integer;ValueChangeEnd@1000000001 : Integer;VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1000000252::SheetPivotTableBeforeCommitChanges@2897(Sh@1000000004 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1000000003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1000000002 : Integer;ValueChangeEnd@1000000001 : Integer;VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1000000252::SheetPivotTableBeforeDiscardChanges@2898(Sh@1000000003 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1000000002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable";ValueChangeStart@1000000001 : Integer;ValueChangeEnd@1000000000 : Integer);
    BEGIN
    END;

    EVENT Excel@1000000252::ProtectedViewWindowOpen@2903(Pvw@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{000244CD-0000-0000-C000-000000000046}:Unknown Automation Server.ProtectedViewWindow");
    BEGIN
    END;

    EVENT Excel@1000000252::ProtectedViewWindowBeforeEdit@2905(Pvw@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{000244CD-0000-0000-C000-000000000046}:Unknown Automation Server.ProtectedViewWindow";VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1000000252::ProtectedViewWindowBeforeClose@2906(Pvw@1000000002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{000244CD-0000-0000-C000-000000000046}:Unknown Automation Server.ProtectedViewWindow";Reason@1000000001 : Integer;VAR Cancel@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1000000252::ProtectedViewWindowResize@2908(Pvw@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{000244CD-0000-0000-C000-000000000046}:Unknown Automation Server.ProtectedViewWindow");
    BEGIN
    END;

    EVENT Excel@1000000252::ProtectedViewWindowActivate@2909(Pvw@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{000244CD-0000-0000-C000-000000000046}:Unknown Automation Server.ProtectedViewWindow");
    BEGIN
    END;

    EVENT Excel@1000000252::ProtectedViewWindowDeactivate@2910(Pvw@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{000244CD-0000-0000-C000-000000000046}:Unknown Automation Server.ProtectedViewWindow");
    BEGIN
    END;

    EVENT Excel@1000000252::WorkbookAfterSave@2911(Wb@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Success@1000000000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1000000252::WorkbookNewChart@2912(Wb@1000000001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Ch@1000000000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020821-0000-0000-C000-000000000046}:Unknown Automation Server.Chart");
    BEGIN
    END;

    BEGIN
    END.
  }
}

