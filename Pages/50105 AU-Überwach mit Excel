OBJECT Page 50105 AU-šberwach mit Excel
{
  OBJECT-PROPERTIES
  {
    Date=01.09.17;
    Time=09:50:05;
    Modified=Yes;
    Version List=TOPAS;
  }
  PROPERTIES
  {
    PromotedActionCategoriesML=[DEU=Neu,Vorgang,Bericht,Funktion;
                                ENU=New,Process,Report,Function];
    ShowFilter=No;
    OnInit=BEGIN
             //  Wenn untere Meldung erscheint, gibt es eine neue Linie, die noch nicht umgestzt wird.
             //  Siehe kurz vor Ende der Functions 'aktuellen Ab einfgen'
             //tab_ab_bw.RESET;
             //tab_ab_bw.SETFILTER(tab_ab_bw.Linie,'%1..%2','00','99');
             //IF tab_ab_bw.FINDFIRST THEN BEGIN
             //"Linien umsetzen";
             //END;

             tab_ab_bw.RESET;
             tab_ab_bw.SETFILTER(tab_ab_bw.Linie,'%1..%2','00','99');
             IF tab_ab_bw.FINDFIRST THEN
               MESSAGE ('Es gibt Linien mit einer Zahl als Herstellerkurzname! Bitte Uwe ansprechen');

             tab_ab_bw.RESET;
             tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','SYST');
             tab_ab_bw.SETFILTER(tab_ab_bw.Datum,'%1',31122222D);
             tab_ab_bw.SETFILTER(tab_ab_bw.AU_Nr,'%1','AU999999');
             tab_ab_bw.SETFILTER(tab_ab_bw.POS_Nr,'%1',10000);
             IF tab_ab_bw.FINDFIRST THEN BEGIN
               IF tab_ab_bw.Wunschdatum = WORKDATE THEN BEGIN
                 AB_holen_Datum:=tab_ab_bw.Wunschdatum;
                 AE_holen_Datum:=tab_ab_bw.Auftragsdatum;
                 AE_holen_Datum_1:=tab_ab_bw.Auftragsdatum;
               END ELSE BEGIN
             //   tab_ab_bw.Auftragsdatum :=tab_ab_bw.Wunschdatum;
             //   tab_ab_bw.MODIFY;
                 AB_holen_Datum:=tab_ab_bw.Wunschdatum;
                 AE_holen_Datum:=tab_ab_bw.Wunschdatum;
             //   AE_holen_Datum:=tab_ab_bw.Auftragsdatum;
               END;
             END;

             kto_datum := 010199D;

             hinweis[1] := '1.  t„glichen Auftrags- und Bestellbestand sichern';
             hinweis[2] := 'vor Ausfhrung Excel beenden';
             hinweis[3] := 'Speichern ( Name des Files z.B.: AE_2017_06.XLSX)';
             hinweis[4] := 'Speichern nach ...Auftragseingang\Sylke\ xxxxxx.XLSX)';
             hinweis[5] := 'Filenamen eingeben (z.B. BE_2017_06_30.xlsx)';
             hinweis[6] := 'Filename angeben (z.B. AE_KW10_2017.xlsx)';
             hinweis[7] := 'Auftrag, der vor Auftragseingangskontrolle geliefert werden soll, sichern.';
             hinweis[8] := 'H„kchen setzen, Auftragsnummer eintragen und dann Ausfhren.';
             hinweis[9] := 'Hier nur Ausfllen, wenn AU bereits geliefert und somit archiviert ist.';
             hinweis[10] := 'H„kchen setzen, archivierte Auftragsnummer eintragen und dann Ausfhren.';
             hinweis[11] := 'Momentan gibt es noch keinen Report fr die Geschenkauswertung.';
             hinweis[12] := 'Tabelle 50032 Dokumentenversand ”ffnen. Filter setzen. Markierte nach Excel kopieren.';
           END;

    ActionList=ACTIONS
    {
      { 1900000000;0 ;ActionContainer;
                      ActionContainerType=RelatedInformation }
      { 1       ;1   ;ActionGroup;
                      CaptionML=DEU=Navigation }
      { 1140008 ;2   ;Action    ;
                      Name=AB bearbeiten;
                      CaptionML=DEU=AB bearbeiten;
                      RunObject=Page 50007;
                      RunPageView=WHERE(Belegart=FILTER(AUšW));
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=OrderList;
                      PromotedCategory=Process }
      { 1140032 ;2   ;Action    ;
                      Name=Alle AE's zeigen;
                      CaptionML=DEU=Alle AE's zeigen;
                      RunObject=Page 50006;
                      RunPageView=SORTING(AU_Nr,POS_Nr,Deb_Nr,Datum,Belegart)
                                  WHERE(Status=FILTER(AE));
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=AllLines;
                      PromotedCategory=Process }
      { 1140051 ;2   ;Action    ;
                      Name=AE bearbeiten;
                      CaptionML=DEU=AE bearbeiten;
                      RunObject=Page 50006;
                      RunPageView=SORTING(AU_Nr,POS_Nr,Deb_Nr,Datum,Belegart)
                                  WHERE(Belegart=FILTER(AETG|GUTG));
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=OrderList;
                      PromotedCategory=Process }
      { 1140052 ;2   ;Action    ;
                      Name=Diff. bearbeiten;
                      CaptionML=DEU=Diff. bearbeiten;
                      RunObject=Page 50006;
                      RunPageView=SORTING(AU_Nr,POS_Nr,Deb_Nr,Datum,Belegart)
                                  WHERE(Belegart=FILTER(AEND));
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=OrderList;
                      PromotedCategory=Process }
      { 1140053 ;2   ;Action    ;
                      Name=AE + Diff bearbeiten;
                      CaptionML=DEU=AE + Diff bearbeiten;
                      RunObject=Page 50006;
                      RunPageView=SORTING(AU_Nr,POS_Nr,Deb_Nr,Datum,Belegart)
                                  WHERE(Belegart=FILTER(AETG|AEND|GUTG));
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=DocumentEdit;
                      PromotedCategory=Process }
      { 1000000016;0 ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 1000000015;1 ;ActionGroup;
                      CaptionML=DEU=Funktionen }
      { 1140063 ;2   ;Action    ;
                      Name=AESaldoabstimmen;
                      CaptionML=DEU=AE-Saldo abstimmen;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 AE_mtl.RESET;
                                 AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AETG','GUTG','AEND');
                                 IF AE_mtl.FINDFIRST THEN BEGIN
                                   AE_Saldo_prf := 0;
                                   REPEAT
                                     AE_Saldo_prf := AE_Saldo_prf + ROUND(AE_mtl."Betrag in EUR",0.01);
                                   UNTIL AE_mtl.NEXT=0;
                                 END;

                                 MESSAGE( 'Summe des Auftrageingangs ist: %1 EUR',AE_Saldo_prf);
                               END;
                                }
      { 1140154 ;2   ;Action    ;
                      Name=Ausfhren;
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      PromotedCategory=Category4;
                      OnAction=BEGIN
                                 tab_ab_bw.RESET;
                                 tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','SYST');
                                 tab_ab_bw.SETFILTER(tab_ab_bw.Datum,'%1',31122222D);
                                 tab_ab_bw.SETFILTER(tab_ab_bw.AU_Nr,'%1','AU999999');
                                 tab_ab_bw.SETFILTER(tab_ab_bw.POS_Nr,'%1',10000);
                                 IF tab_ab_bw.FINDFIRST THEN BEGIN
                                  IF tab_ab_bw.Wunschdatum = WORKDATE THEN
                                  BEGIN
                                    AB_holen_Datum:=tab_ab_bw.Wunschdatum;
                                    AE_holen_Datum:=tab_ab_bw.Auftragsdatum;
                                  END ELSE BEGIN
                                    tab_ab_bw.Auftragsdatum :=tab_ab_bw.Wunschdatum;
                                    tab_ab_bw.MODIFY;
                                    AB_holen_Datum:=tab_ab_bw.Wunschdatum;
                                    AE_holen_Datum:=tab_ab_bw.Wunschdatum;
                                    //AE_holen_Datum:=tab_ab_bw.Auftragsdatum;
                                  END;
                                 END;




                                 tab_ab_bw.RESET;
                                 //IF ((tab_ab_bw.Linie >'(1)') AND (tab_ab_bw.Linie <'100')) THEN

                                 IF tab_ab_bw.Linie ='00' THEN
                                 MESSAGE ('Es gibt Linien mit einer Zahl als Herstellerkurzname');




                                 // ANFANG šberprfung ob mehrere H„kchen gesetzt sind '''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''''
                                 var_anzahl_h„kchen:=0;
                                 IF (AB_holen=TRUE) THEN var_anzahl_h„kchen:=var_anzahl_h„kchen + 1;
                                 IF (BE_holen=TRUE) THEN var_anzahl_h„kchen:=var_anzahl_h„kchen + 1;
                                 IF (BB_Diff=TRUE) THEN var_anzahl_h„kchen:=var_anzahl_h„kchen + 1;
                                 IF ((AB_holen=TRUE) AND (AE_holen_Datum=0D)) THEN ERROR('Datum muá eingetragen sein! Programm abgebrochen');
                                 IF (AB_holen_rcksetzen=TRUE) THEN var_anzahl_h„kchen:=var_anzahl_h„kchen + 1;
                                 IF (Diff_ermitteln=TRUE) THEN var_anzahl_h„kchen:=var_anzahl_h„kchen + 1;
                                 IF (t„gl_AE=TRUE) THEN var_anzahl_h„kchen:=var_anzahl_h„kchen + 1;
                                 IF ((t„gl_AE=TRUE) AND (AE_holen_Datum_1=0D)) THEN ERROR('Datum muá eingetragen sein! Programm abgebrochen');
                                 IF (AE_verteilen=TRUE) THEN var_anzahl_h„kchen:=var_anzahl_h„kchen + 1;
                                 IF (AE_Verteilen_mtl=TRUE) THEN var_anzahl_h„kchen:=var_anzahl_h„kchen + 1;
                                 IF (AE_Verteilen_xx=TRUE) THEN var_anzahl_h„kchen:=var_anzahl_h„kchen + 1;
                                 IF tglAE=TRUE THEN var_anzahl_h„kchen:=var_anzahl_h„kchen + 1;
                                 IF AU_sichern=TRUE THEN var_anzahl_h„kchen:=var_anzahl_h„kchen + 1;
                                 IF AU_Arch_sichern=TRUE THEN var_anzahl_h„kchen:=var_anzahl_h„kchen + 1;
                                 IF kto_salden=TRUE THEN var_anzahl_h„kchen:=var_anzahl_h„kchen + 1;
                                 IF Lager_ausf=TRUE THEN var_anzahl_h„kchen:=var_anzahl_h„kchen + 1;
                                 IF Lager_ausf2=TRUE THEN var_anzahl_h„kchen:=var_anzahl_h„kchen + 1;
                                 IF AE_t„gl=TRUE THEN var_anzahl_h„kchen:=var_anzahl_h„kchen + 1;
                                 IF v_deb_prf=TRUE THEN var_anzahl_h„kchen:=var_anzahl_h„kchen + 1;
                                 IF v_idprove=TRUE THEN var_anzahl_h„kchen:=var_anzahl_h„kchen + 1;
                                 IF t„gl_AE_Saldo=TRUE THEN var_anzahl_h„kchen:=var_anzahl_h„kchen + 1;
                                 IF v_n2=TRUE THEN var_anzahl_h„kchen:=var_anzahl_h„kchen + 1;
                                 IF v_vertrieb4=TRUE THEN var_anzahl_h„kchen:=var_anzahl_h„kchen + 1;
                                 IF v_abstimm_tab_belege=TRUE THEN var_anzahl_h„kchen:=var_anzahl_h„kchen + 1;
                                 IF v_post_geschenk_adr_liste=TRUE THEN var_anzahl_h„kchen:=var_anzahl_h„kchen + 1;
                                 IF v_geschenk_adr_liste_bersicht=TRUE THEN var_anzahl_h„kchen:=var_anzahl_h„kchen + 1;

                                 IF var_anzahl_h„kchen>1 THEN
                                 ERROR('Es wurden mehrere H„kchen gesetzt. Report abgebrochen!');
                                 // ENDE šberprfung ob mehrere H„kchen gesetzt sind             '''''''''''''''''''''''''''''''''''''''''''''''''''''''

                                 //25.08.2011-ST šberprft das AE holen Datum, darf nicht Tagesdatum sein, denn er soll ja den Vortag holen
                                 // und das Datum auch mit dem Vortag z.B. belegen, sonst kommt es sp„testens n„chsten Tag zur Fehlermeldung
                                 // wenn dann das Vortagsdatum geholt und eingetragen werden soll

                                 IF AE_holen_Datum = WORKDATE THEN
                                   ERROR('Das AE Datum darf nicht dem Tagesdatum entsprechen. Geben Sie bitte den Vortag ein');
                                 IF AE_holen_Datum = (010199D)THEN
                                   ERROR('Das AE Datum darf nicht 01.01.99 sein. Geben Sie bitte den Vortag ein');

                                 // ANFANG Aufruf der Funktionen *****************************************************************

                                 IF AB_holen=TRUE THEN "aktuellen AB einfgen";
                                 IF BE_holen=TRUE THEN "aktuellen BB einfgen";
                                 IF BB_Diff=TRUE THEN "BB Diff ermitteln";
                                 IF AB_holen_rcksetzen=TRUE THEN "AB einfgen rcksetzen";
                                 IF Diff_ermitteln=TRUE THEN "Differenzen ermitteln";
                                 IF t„gl_AE=TRUE THEN "t„glichen AE einfgen";
                                 IF AE_verteilen=TRUE THEN AE_Verteilung;
                                 IF AE_Verteilen_mtl=TRUE THEN AE_Verteilung_mtl;
                                 IF AE_Verteilen_xx=TRUE THEN AE_Verteilung_xx;
                                 IF tglAE=TRUE THEN "tgl AE in mtl AE bernehmen";
                                 IF AU_sichern=TRUE THEN Auftrag_sichern;
                                 IF AU_Arch_sichern=TRUE THEN Auftrag_Arch_sichern;
                                 IF kto_salden=TRUE THEN "Konto Salden holen";
                                 IF AE_t„gl=TRUE THEN "AE Salden t„gl gesamt";
                                 IF Lager_ausf=TRUE THEN AE_Vertrieb1;
                                 IF v_vertrieb4=TRUE THEN AE_Vertrieb4;
                                 //IF Lager_ausf2=TRUE THEN Lagerbewertung2;
                                 IF v_deb_prf=TRUE THEN Debitor_šberprfung;
                                 IF v_idprove=TRUE THEN ID_Prove;
                                 IF t„gl_AE_Saldo=TRUE THEN t„gl_AE_Saldo_abstimmen;
                                 IF v_n2=TRUE THEN N2_berprfen;
                                 IF v_abstimm_tab_belege=TRUE THEN Abstimm_tab_belege;
                                 IF v_post_geschenk_adr_liste=TRUE THEN geschenk_adr_liste;
                                 IF v_geschenk_adr_liste_bersicht=TRUE THEN geschenk_adr_liste_bersicht;

                                 //  ENDE Aufruf der Funktionen  **********************************************************************
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000;0;Container ;
                ContainerType=ContentArea }

    { 1000000003;1;Group  ;
                CaptionML=DEU=Allgemein;
                GroupType=Group }

    { 1000000004;2;Group  ;
                GroupType=Group }

    { 1000000005;3;Field  ;
                SourceExpr=hinweis[1];
                Enabled=FALSE;
                Editable=FALSE;
                Style=Unfavorable;
                StyleExpr=TRUE }

    { 1140007;3;Field     ;
                Name=AB_holen_Datum;
                CaptionML=DEU=Stand;
                SourceExpr=AB_holen_Datum;
                Editable=FALSE }

    { 1140003;3;Field     ;
                Name=AE_holen_Datum;
                CaptionML=DEU=Datum des Vortages unter dem die Daten gespeichert werden sollen;
                SourceExpr=AE_holen_Datum }

    { 1140013;3;Field     ;
                Name=AB_holen;
                CaptionML=DEU=Aktuellen Auftragsbestand holen und in Tabelle speichern;
                ToolTipML=DEU=Kann nur einmal pro Tag ausgefhrt werden, ansonsten greift eine Prfung, ob dies bereits geschehen ist.;
                SourceExpr=AB_holen }

    { 1000000001;2;Group  ;
                CaptionML=DEU=Zurcksetzen;
                GroupType=Group }

    { 1140001;3;Field     ;
                Name=AB_holen_rcksetzen;
                CaptionML=DEU=AB holen - Rcksetzen (nur nach Rcksprache mit Uwe !!!);
                SourceExpr=AB_holen_rcksetzen }

    { 1900002;1;Group     ;
                CaptionML=DEU=" Auftr„ge" }

    { 1000000006;2;Group  ;
                CaptionML=DEU=2.  t„glicher Auftragseingang zum Bearbeiten sichern;
                GroupType=Group }

    { 1140023;3;Field     ;
                Name=t„gl_AE;
                CaptionML=DEU=tgl. AE holen  (Datum des AE eintragen);
                SourceExpr=t„gl_AE }

    { 1140035;3;Field     ;
                Name=AE_holen_Datum_1;
                CaptionML=DEU=AE holen Datum;
                SourceExpr=AE_holen_Datum_1 }

    { 1000000007;2;Group  ;
                CaptionML=DEU=3.  t„gliche Auftragsbestandskontrolle;
                GroupType=Group }

    { 1140025;3;Field     ;
                Name=Diff_ermitteln;
                CaptionML=DEU=Differenzen zwischen altem und neuem AB ermitteln;
                SourceExpr=Diff_ermitteln }

    { 1000000008;2;Group  ;
                CaptionML=DEU=4.  t„glicher Auftragseingang sowie Differenzen nach Bearbeitung in Monatsdatei bernehmen;
                GroupType=Group }

    { 1140024;3;Field     ;
                Name=tglAE;
                CaptionML=DEU=T„gl. AE sowie Storno, Erh”hungen und Minderungen in mtl. Datei bernehmen;
                SourceExpr=tglAE }

    { 1000000010;2;Group  ;
                CaptionML=DEU=5.  t„gliche Verteilung nach Excel vornehmen.;
                GroupType=Group }

    { 1140033;3;Field     ;
                Name=AE_verteilen;
                CaptionML=DEU=AE verteilen;
                SourceExpr=AE_verteilen }

    { 1140038;3;Field     ;
                Name=Datum_von;
                CaptionML=DEU=Datum von;
                SourceExpr=Datum_von }

    { 1140047;3;Field     ;
                Name=Datum_bis;
                CaptionML=DEU=Datum bis;
                SourceExpr=Datum_bis }

    { 1000000012;3;Field  ;
                SourceExpr=hinweis[2];
                Enabled=FALSE;
                Editable=FALSE;
                Style=StrongAccent;
                StyleExpr=TRUE }

    { 1000000011;2;Group  ;
                CaptionML=DEU=6.  monatliche Verteilung nach Excel vornehmen.;
                GroupType=Group }

    { 1140041;3;Field     ;
                Name=AE_Verteilen_mtl;
                CaptionML=DEU=AE Verteilen mtl.;
                SourceExpr=AE_Verteilen_mtl }

    { 1140043;3;Field     ;
                Name=Datum_von_;
                CaptionML=DEU=Datum von;
                SourceExpr=Datum_von }

    { 1140048;3;Field     ;
                Name=Datum_bis_;
                CaptionML=DEU=Datum bis;
                SourceExpr=Datum_bis }

    { 1140054;3;Field     ;
                Name=Filename;
                CaptionML=DEU=Dateiname;
                SourceExpr=Filename }

    { 1000000009;3;Field  ;
                SourceExpr=hinweis[3];
                Enabled=FALSE;
                Editable=FALSE;
                Style=StrongAccent;
                StyleExpr=TRUE }

    { 1000000013;2;Group  ;
                CaptionML=DEU=7.  einmalige Verteilung nach Excel vornehmen.;
                GroupType=Group }

    { 1140055;3;Field     ;
                Name=AE_Verteilen_xx;
                CaptionML=DEU=AE Verteilen xx;
                SourceExpr=AE_Verteilen_xx }

    { 1140057;3;Field     ;
                Name=Datum_von__;
                CaptionML=DEU=Datum von;
                SourceExpr=Datum_von }

    { 1140059;3;Field     ;
                Name=Datum_bis__;
                CaptionML=DEU=Datum bis;
                SourceExpr=Datum_bis }

    { 1140060;3;Field     ;
                Name=Filename_;
                CaptionML=DEU=Dateiname;
                SourceExpr=Filename }

    { 1000000014;3;Field  ;
                SourceExpr=hinweis[4];
                Enabled=FALSE;
                Editable=FALSE;
                Style=StrongAccent;
                StyleExpr=TRUE }

    { 1900003;1;Group     ;
                CaptionML=DEU=" Bestellungen" }

    { 1140069;2;Field     ;
                Name=BE_holen;
                CaptionML=DEU=aktuellen Bestellbestand holen und in Tabelle speichern;
                SourceExpr=BE_holen }

    { 1140071;2;Field     ;
                Name=AE_holen_Datum_;
                CaptionML=DEU=Datum eingeben;
                SourceExpr=AE_holen_Datum }

    { 1140065;2;Field     ;
                Name=BB_Diff;
                CaptionML=DEU=Bestellbestandsdifferenzen ermitteln;
                SourceExpr=BB_Diff }

    { 1140067;2;Field     ;
                Name=bb_Filename;
                CaptionML=DEU=Dateiname;
                SourceExpr=bb_Filename }

    { 1000000000;2;Field  ;
                SourceExpr=hinweis[5];
                Enabled=FALSE;
                Editable=FALSE;
                Style=StrongAccent;
                StyleExpr=TRUE }

    { 1900004;1;Group     ;
                CaptionML=DEU=AE Vertrieb }

    { 1140084;2;Field     ;
                Name=v_vertrieb4;
                CaptionML=DEU=Auftragseingang System von Freitag (Vorwoche) bis Donnerstag   freitags;
                SourceExpr=v_vertrieb4 }

    { 1000000017;2;Field  ;
                SourceExpr='oder' }

    { 1140082;2;Field     ;
                Name=Lager_ausf;
                CaptionML=DEU=Auftragseingang der letzten Woche fr Vertriebsmeeting   montags;
                SourceExpr=Lager_ausf }

    { 1000000018;2;Group  ;
                CaptionML=DEU="  Ab hier immer ausfllen                          Freitag                        Montag";
                GroupType=Group }

    { 1140080;3;Field     ;
                Name=Datum_von___;
                CaptionML=DEU=Auftragseingang holen ab:                             Freitag (Vorwoche)       Montag;
                SourceExpr=Datum_von }

    { 1140073;3;Field     ;
                Name=Datum_bis___;
                CaptionML=DEU=Auftragseingang holen bis:                             Donnerstag                   Donnerstag;
                SourceExpr=Datum_bis }

    { 1140074;3;Field     ;
                Name=AE_holen_Datum__;
                CaptionML=DEU=Tag fr den der AE noch fehlt:                       automatisch                   automatisch;
                SourceExpr=AE_holen_Datum }

    { 1140077;3;Field     ;
                Name=Filename__;
                CaptionML=DEU=Dateiname;
                SourceExpr=Filename }

    { 1000000002;3;Field  ;
                SourceExpr=hinweis[6];
                Enabled=FALSE;
                Editable=FALSE;
                Style=StrongAccent;
                StyleExpr=TRUE }

    { 1900005;1;Group     ;
                CaptionML=DEU=" einzelnen AU sichern" }

    { 1000000019;2;Field  ;
                SourceExpr=hinweis[7];
                Enabled=FALSE;
                Editable=FALSE;
                Style=StrongAccent;
                StyleExpr=TRUE }

    { 1000000020;2;Field  ;
                SourceExpr=hinweis[8];
                Enabled=FALSE;
                Editable=FALSE;
                Style=StandardAccent;
                StyleExpr=TRUE }

    { 1140092;2;Field     ;
                Name=AU_sichern;
                CaptionML=DEU=Auftrag sichern;
                SourceExpr=AU_sichern }

    { 1140093;2;Field     ;
                Name=AU_Nr_sich;
                CaptionML=DEU=AU-Nr zum Sichern eintragen;
                SourceExpr=AU_Nr_sich }

    { 1000000021;2;Field  ;
                SourceExpr=hinweis[9];
                Enabled=FALSE;
                Editable=FALSE;
                Style=StrongAccent;
                StyleExpr=TRUE }

    { 1000000022;2;Field  ;
                SourceExpr=hinweis[10];
                Enabled=FALSE;
                Editable=FALSE;
                Style=StandardAccent;
                StyleExpr=TRUE }

    { 1140096;2;Field     ;
                Name=AU_Arch_sichern;
                CaptionML=DEU=Auftragsarchiv sichern;
                SourceExpr=AU_Arch_sichern }

    { 1140097;2;Field     ;
                Name=AU_Arch_Nr_sich;
                CaptionML=DEU=Arch. AU-Nr zum Sichern eintragen;
                SourceExpr=AU_Arch_Nr_sich }

    { 1900006;1;Group     ;
                CaptionML=DEU=" Kontosalden" }

    { 1000000023;2;Group  ;
                CaptionML=DEU=Kontosalden holen;
                GroupType=Group }

    { 1140100;3;Field     ;
                Name=kto_salden;
                CaptionML=DEU=Kontosalden ausfhren;
                SourceExpr=kto_salden }

    { 1140103;3;Field     ;
                Name=kto_datum;
                CaptionML=DEU=Datum fr Saldo Gesamt. (Nur ausfllen wenn nicht ab heute geholt werden soll);
                SourceExpr=kto_datum }

    { 1140101;3;Field     ;
                Name=saldo_heute_datum;
                CaptionML=DEU=Datum fr den Tagessaldo;
                SourceExpr=saldo_heute_datum }

    { 1000000024;2;Group  ;
                CaptionML=DEU=Weitere Prfungen;
                GroupType=Group }

    { 1140108;3;Field     ;
                Name=v_deb_prf;
                CaptionML=DEU=t„gliche Debitor šberprfung, div. Felder nicht gefllt;
                SourceExpr=v_deb_prf }

    { 1140105;3;Field     ;
                Name=v_n2;
                CaptionML=DEU=N2 šberprfung;
                SourceExpr=v_n2 }

    { 1140114;3;Field     ;
                Name=AE_t„gl;
                CaptionML=DEU=šbertragen der t„glichen AE-Salden nach Excel;
                SourceExpr=AE_t„gl }

    { 1140111;3;Field     ;
                Name=v_idprove;
                CaptionML=DEU=Daten fr ID_Prove bereitstellen;
                SourceExpr=v_idprove }

    { 1140118;3;Field     ;
                Name=v_abstimm_tab_belege;
                CaptionML=DEU=Abstimmung Rechnungen aus VKRZ mit Tab Belege;
                SourceExpr=v_abstimm_tab_belege }

    { 1900008;1;Group     ;
                CaptionML=DEU=" Geschenke" }

    { 1000000029;2;Group  ;
                GroupType=FixedLayout }

    { 1000000030;3;Group  ;
                GroupType=Group }

    { 1000000025;4;Field  ;
                SourceExpr=hinweis[11];
                Enabled=FALSE;
                Editable=FALSE;
                Style=StrongAccent;
                StyleExpr=TRUE }

    { 1000000026;4;Field  ;
                SourceExpr=hinweis[12];
                Enabled=FALSE;
                Editable=FALSE;
                Style=StrongAccent;
                StyleExpr=TRUE }

    { 1000000028;2;Group  ;
                CaptionML=DEU=Funktionen;
                GroupType=Group }

    { 1000000027;3;Group  ;
                GroupType=Group }

    { 1140151;4;Field     ;
                Name=v_post_geschenk_adr_liste;
                CaptionML=DEU=Adressen Geschenk Fan-Schminke;
                SourceExpr=v_post_geschenk_adr_liste }

    { 1140152;4;Field     ;
                Name=v_geschenk_adr_liste_bersicht;
                CaptionML=DEU=Geschenk-Liste in šbersicht;
                SourceExpr=v_geschenk_adr_liste_bersicht }

  }
  CODE
  {
    VAR
      Excel@1140164 : Automation "{00020813-0000-0000-C000-000000000046} 1.2:{00024500-0000-0000-C000-000000000046}:Unknown Automation Server.Application";
      Book@1140163 : Automation "{00020813-0000-0000-C000-000000000046} 1.2:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";
      Range@1140162 : Automation "{00020813-0000-0000-C000-000000000046} 1.2:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";
      Sheet@1140161 : Automation "{00020813-0000-0000-C000-000000000046} 1.2:{00020820-0000-0000-C000-000000000046}:Unknown Automation Server.Worksheet";
      wshFile@1000000001 : Automation "{F935DC20-1CF0-11D0-ADB9-00C04FD58A0B} 1.0:{0D43FE01-F093-11CF-8940-00A0C9054228}:'Windows Script Host Object Model'.FileSystemObject";
      j@1140160 : Text[30];
      AB_holen@1140159 : Boolean;
      AB_holen_Datum@1140158 : Date;
      tab_ab@1140157 : Record 37;
      tab_ab_arch@1140156 : Record 5108;
      tab_ab_bw@1140155 : Record 50016;
      prf@1140154 : Record 50016;
      rech@1140153 : Record 113;
      vkrk@1140152 : Record 112;
      best@1140151 : Record 123;
      tab_vkk@1140150 : Record 36;
      tab_vkk_arch@1140149 : Record 5107;
      tab_kurse@1140148 : Record 330;
      var_AU_Nr@1140147 : Code[20];
      AB_holen_rcksetzen@1140146 : Boolean;
      Diff_ermitteln@1140145 : Boolean;
      t„gl_AE@1140144 : Boolean;
      t„gl_AE_Saldo@1140143 : Boolean;
      var_re_menge@1140142 : Integer;
      var_be_menge@1140141 : Integer;
      AE_mtl@1140140 : Record 50017;
      AE_holen_Datum@1140139 : Date;
      tab_vkk1@1140138 : Record 36;
      tab_vkk1_arch@1140137 : Record 5107;
      var_anzahl_h„kchen@1140136 : Integer;
      aus_Excel_impotieren@1140135 : Boolean;
      "**zu importierende Datei"@1140134 : Integer;
      tglAE@1140133 : Boolean;
      AE_holen_Datum_1@1140132 : Date;
      AE_verteilen@1140131 : Boolean;
      Datum_von@1140130 : Date;
      Datum_bis@1140129 : Date;
      Book1@1140128 : Automation "{00020813-0000-0000-C000-000000000046} 1.2:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";
      Sheet1@1140127 : Automation "{00020813-0000-0000-C000-000000000046} 1.2:{00020820-0000-0000-C000-000000000046}:Unknown Automation Server.Worksheet";
      Range1@1140126 : Automation "{00020813-0000-0000-C000-000000000046} 1.2:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";
      var_datum_kz@1140125 : Date;
      var_linie_kz@1140124 : Text[10];
      var_rec@1140123 : Record 50017;
      Datei@1140122 : File;
      AE_Verteilen_mtl@1140121 : Boolean;
      AE_Verteilen_xx@1140120 : Boolean;
      Filename@1140119 : Text;
      bb_Filename@1140118 : Text;
      tab_be@1140117 : Record 39;
      BE_holen@1140116 : Boolean;
      tab_bek@1140115 : Record 38;
      BB_Diff@1140114 : Boolean;
      tab_guz@1140113 : Record 115;
      tab_guk@1140112 : Record 114;
      tab_guk1@1140111 : Record 114;
      AU_sichern@1140110 : Boolean;
      AU_Arch_sichern@1140109 : Boolean;
      AU_Nr_sich@1140108 : Code[10];
      AU_Arch_Nr_sich@1140107 : Code[10];
      kto_salden@1140106 : Boolean;
      kto_datum@1140105 : Date;
      sachposten@1140104 : Record 17;
      sum_konten@1140103 : Decimal;
      sum_konten1@1140102 : Decimal;
      sum_konten2@1140101 : Decimal;
      sum_konten3@1140100 : Decimal;
      sum_konten4@1140099 : Decimal;
      sum_konten5@1140098 : Decimal;
      sum_konten6@1140097 : Decimal;
      sum_konten7@1140096 : Decimal;
      sum_konten8@1140095 : Decimal;
      sum_konten9@1140094 : Decimal;
      sum_konten10@1140093 : Decimal;
      sum_konten11@1140092 : Decimal;
      sum_konten12@1140091 : Decimal;
      sum_konten13@1140090 : Decimal;
      sum_konten14@1140089 : Decimal;
      sum_konten15@1140088 : Decimal;
      sum_konten16@1140087 : Decimal;
      sum_konten17@1140086 : Decimal;
      sum_konten18@1140085 : Decimal;
      sum_konten19@1140084 : Decimal;
      sum_konten20@1140083 : Decimal;
      saldo_heute_datum@1140082 : Date;
      Jahr@1140075 : Integer;
      Monat@1140074 : Integer;
      MonatGJ@1140073 : Integer;
      KW@1140072 : Integer;
      Beleg@1140071 : Record 50010;
      herstell@1140070 : Record 5720;
      deb@1140069 : Record 18;
      AE_t„gl@1140068 : Boolean;
      AE_t„gl_gesamt@1140067 : Decimal;
      AE_t„gl_datum@1140066 : Date;
      JahrGJ@1140063 : Integer;
      Lager_ausf@1140062 : Boolean;
      Lager_ausf2@1140061 : Boolean;
      Lager_abgrenz_Datum@1140060 : Date;
      Kurs_JPY@1140059 : Decimal;
      Kurs_USD@1140058 : Decimal;
      Kurs_GBP@1140057 : Decimal;
      Artikel@1140056 : Record 27;
      Wertposten@1140055 : Record 5802;
      Lagerort1@1140054 : Code[10];
      Lagerort2@1140053 : Code[10];
      Lagerort3@1140052 : Code[10];
      Artikelposten@1140051 : Record 32;
      Lagerbestand@1140050 : Decimal;
      Lagerstck1@1140049 : Decimal;
      var_NEXT@1140048 : Integer;
      var_text1@1140047 : Text[30];
      var_text2@1140046 : Text[30];
      var_letzter_wert@1140045 : Decimal;
      var_sum_zugang_wert@1140044 : Decimal;
      var_sum_zugang_wert_stichkurs@1140043 : Decimal;
      W„_kurs@1140042 : Record 330;
      EK_Rech_k@1140041 : Record 122;
      zu_W„h_kurs@1140040 : Decimal;
      var_sum_bewert@1140039 : Decimal;
      v_dcwert@1140038 : Decimal;
      v_sum_bewert@1140037 : Decimal;
      v_dc@1140036 : Decimal;
      v_zuwert@1140035 : Decimal;
      v_stichwert@1140034 : Decimal;
      v_bewert@1140033 : Decimal;
      ek_preis@1140032 : Record 7012;
      v_dcw„@1140031 : Text[30];
      v_ab_bestand@1140030 : Decimal;
      v_bb_bestand@1140029 : Decimal;
      v_sonderlager@1140028 : Boolean;
      v_ab_menge@1140027 : Decimal;
      v_deb_prf@1140026 : Boolean;
      kontakt@1140025 : Record 5050;
      kontakt1@1140024 : Record 5050;
      v_idprove@1140023 : Boolean;
      v_del@1140022 : Text[5];
      v_del1@1140021 : Text[5];
      v_kontaktnr@1140020 : Text[10];
      Dateiname@1140019 : Text;
      AE_Saldo_prf@1140018 : Decimal;
      Pfad@1140017 : Text;
      Pfaddatum@1140016 : Text;
      Pfad_tag@1140015 : Text[10];
      Pfad_monat@1140014 : Text[10];
      Pfad_jahr@1140013 : Text[10];
      v_n2@1140012 : Boolean;
      v_vertrieb4@1140011 : Boolean;
      OK@1140010 : Boolean;
      anz_zent@1140009 : Decimal;
      anz_must@1140008 : Decimal;
      anz_gutschr@1140007 : Decimal;
      v_abstimm_tab_belege@1140006 : Boolean;
      Lief_adr@1140005 : Record 222;
      v_hyperlink@1140004 : Text;
      v_hypernr@1140003 : Text;
      v_post_geschenk_adr_liste@1140002 : Boolean;
      tab_geschenk@1140001 : Record 50032;
      v_geschenk_adr_liste_bersicht@1140000 : Boolean;
      hinweis@1000000000 : ARRAY [30] OF Text;

    PROCEDURE "aktuellen AB einfgen"@1140000();
    BEGIN
      // ANFANG Als erstes Datum einfgen -> Sicherstellung Ausfhrung nur 1 x pro Tag
      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','SYST');
      tab_ab_bw.SETFILTER(tab_ab_bw.Datum,'%1',31122222D);
      tab_ab_bw.SETFILTER(tab_ab_bw.AU_Nr,'%1','AU999999');
      tab_ab_bw.SETFILTER(tab_ab_bw.POS_Nr,'%1',10000);
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      IF tab_ab_bw.Wunschdatum=WORKDATE THEN BEGIN
      ERROR('Der Job wurde heute bereits ausgefhrt');
      END ELSE BEGIN
      MESSAGE('Am Ende kommt ein Best„tigungsfenster. Wird dieses nicht angezeigt ist der Job fehlerhaft beendet. IT informieren!');
       tab_ab_bw.Wunschdatum:=WORKDATE;
       tab_ab_bw.MODIFY;
      END;
      // ENDE Als erstes Datum einfgen

      //  ANFANG  L”schen und umbenennen von alten S„tzen
      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','AL2');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
        tab_ab_bw.DELETE;
      UNTIL tab_ab_bw.NEXT=0;
      END;

      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','AL1');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
        tab_ab_bw.Art:='AL2';
        tab_ab_bw.MODIFY;
      UNTIL tab_ab_bw.NEXT=0;
      END;

      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','ALT');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
        tab_ab_bw.Art:='AL1';
        tab_ab_bw.MODIFY;
      UNTIL tab_ab_bw.NEXT=0;
      END;

      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','NEU');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
        tab_ab_bw.Art:='ALT';
        tab_ab_bw.MODIFY;
      UNTIL tab_ab_bw.NEXT=0;
      END;

      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','ALT');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
        tab_ab_bw.Status:='NN';
        tab_ab_bw.Stat_Artikel:='NN';
        tab_ab_bw.Stat_Menge:='NN';
        tab_ab_bw.Stat_EK:='NN';
        tab_ab_bw.Stat_VK:='NN';
        tab_ab_bw.MODIFY;
      UNTIL tab_ab_bw.NEXT=0;
      END;
      //  ENDE  L”schen und umbenennen von alten S„tzen


      // ANFANG Einfgen von neuem AB
      tab_ab.RESET;
      tab_ab.SETFILTER(tab_ab."Document Type",'%1', tab_ab."Document Type"::Order);
      tab_ab.SETFILTER(tab_ab.Type,'%1',tab_ab.Type::Item);
      tab_ab.SETFILTER(tab_ab."Location Code",'%1|%2|%3|%4','ZENT','KONSI','ERSATZ','IDT');
      //tab_ab.SETFILTER(tab_ab."Outstanding Quantity",'>%1',0);
       IF tab_ab.FIND('-')  THEN
       REPEAT
          tab_ab_bw.INIT;
                 tab_ab_bw.Belegart:='AUšW';
                 tab_ab_bw.Datum:=AE_holen_Datum;
                 tab_ab_bw.AU_Nr:=tab_ab."Document No.";
                 tab_ab_bw.POS_Nr:=tab_ab."Line No.";
                 tab_ab_bw.Deb_Nr:=tab_ab."Sell-to Customer No.";
                 tab_ab_bw.Artikel:=tab_ab."No.";
                 tab_ab_bw.Menge:=tab_ab.Quantity;
                 tab_ab_bw.Restmenge:=tab_ab."Outstanding Quantity";
                 tab_ab_bw.EK:=tab_ab."Unit Cost (LCY)";
                 tab_ab_bw.VK:=tab_ab."Unit Price";
                 tab_ab_bw."Best„tigt LD":=tab_ab."Promised Delivery Date";
                 tab_ab_bw.Wunschdatum:=tab_ab."Requested Delivery Date";
                 tab_ab_bw.Status:='NN';
                 tab_ab_bw.Art:='NEU';
                 tab_ab_bw."EK Gesamt":=ROUND(((tab_ab.Quantity)*(tab_ab."Unit Cost (LCY)")),0.01);
                 tab_ab_bw."VK Gesamt":=ROUND(((tab_ab.Quantity)*(tab_ab."Unit Price")),0.01);
                 tab_ab_bw.Lager:=tab_ab."Location Code";
                 tab_ab_bw."DB %":=tab_ab."Profit %";
                 tab_ab_bw.Linie:=tab_ab."Manufacturer Code";
                 tab_ab_bw.Endkunde:=tab_ab.Endkunde;
                 IF tab_ab."Blanket Order No."='' THEN BEGIN
                 END ELSE BEGIN
                 tab_ab_bw."AU aus Rahmen":=TRUE;
                 END;

                  tab_vkk.RESET;
                  tab_vkk.SETFILTER(tab_vkk."No.",'%1',tab_ab_bw.AU_Nr);
                   IF tab_vkk.FINDFIRST THEN
                    BEGIN
                    tab_ab_bw.Debitor:=tab_vkk."Sell-to Customer Name";
                    tab_ab_bw.W„hrungscode:=tab_vkk."Currency Code";
                    tab_ab_bw.Auftragsdatum:=tab_vkk."Order Date";
                    tab_ab_bw.Betreuer:=tab_vkk."Betreuer Innendienst";
                    tab_ab_bw.Vertreter:=tab_vkk."Salesperson Code";
                    tab_ab_bw.Teams:=tab_vkk.Teams;
                    tab_ab_bw.Plz:=tab_vkk."Sell-to Post Code";
                    tab_ab_bw.Gebietscode:=tab_vkk."Territory Code";
                   END;
          tab_ab_bw.INSERT;
       UNTIL tab_ab.NEXT=0;
      END;
      //  ENDE Einfgen von neuem AB

      // ANFANG Kurse des AU holen
      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','NEU');
      tab_ab_bw.SETFILTER(tab_ab_bw.W„hrungscode,'<>%1','');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
       REPEAT
           tab_kurse.RESET;
           tab_kurse.SETFILTER(tab_kurse."Starting Date",'%1',tab_ab_bw.Auftragsdatum);
           tab_kurse.SETFILTER(tab_kurse."Currency Code",'%1',tab_ab_bw.W„hrungscode);
             IF tab_kurse.FINDFIRST THEN BEGIN
              tab_ab_bw.w„_faktor:=tab_kurse."Exchange Rate Amount";
              tab_ab_bw."VK Gesamt":=ROUND((((tab_ab.Quantity)*(tab_ab."Unit Price"))/(tab_kurse."Exchange Rate Amount")),2);
              tab_ab_bw.MODIFY;
             END;
       UNTIL tab_ab_bw.NEXT=0;
       END;
      // ENDE Kurse des AU holen


      "Linien umsetzen";


      // ANFANG Als letztes wird dieses Datum berprft -> Sicherstellung Ausfhrung nur 1 x pro Tag
      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','SYST');
      tab_ab_bw.SETFILTER(tab_ab_bw.Datum,'%1',31122222D);
      tab_ab_bw.SETFILTER(tab_ab_bw.AU_Nr,'%1','AU999999');
      tab_ab_bw.SETFILTER(tab_ab_bw.POS_Nr,'%1',10000);
      IF tab_ab_bw.FINDFIRST THEN BEGIN
       IF tab_ab_bw.Wunschdatum=WORKDATE THEN BEGIN
       MESSAGE(' JOB wurde ordnungsgem„á erledigt. ');
       END;

      END;
      //  Als letztes wird dieses Datum berprft und eine Meldung erzeugt. Kommt keine Meldung ist der Job nicht durchgelaufen!!!
      // ENDE Als letztes Datum berprfen

      //Rechnungsdaten des lfd GJ t„glich nach F:\Daten Neu\user\Sylke\intern\auswertungen\umsatz\umsatz_GJ12.XLSX bertragen
    END;

    PROCEDURE "Differenzen ermitteln"@1140002();
    BEGIN
      // ANFANG zurcksetzen Status auf NN zwecks Programmtests
      //        kann bei Echtbetrieb unterbleiben!!!
      MESSAGE(' JOB wurde ordnungsgem„á gestartet. ');
      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','ALT');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
        tab_ab_bw.Status:='NN';
        tab_ab_bw.Stat_Artikel:='NN';
        tab_ab_bw.Stat_Menge:='NN';
        tab_ab_bw.Stat_EK:='NN';
        tab_ab_bw.Stat_VK:='NN';
        tab_ab_bw.MODIFY;
      UNTIL tab_ab_bw.NEXT=0;
      END;
      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','NEU');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
        tab_ab_bw.Status:='NN';
        tab_ab_bw.Stat_Artikel:='NN';
        tab_ab_bw.Stat_Menge:='NN';
        tab_ab_bw.Stat_EK:='NN';
        tab_ab_bw.Stat_VK:='NN';
        tab_ab_bw.MODIFY;
      UNTIL tab_ab_bw.NEXT=0;
      END;
      // ENDE zurcksetzen Status auf NN zwecks Programmtests


      //  ANFANG Vergleich zwischen NEU und ALT (tab_ab_bw=NEU  und prf=ALT)
      //  ANFANG Diff. feststellen Artikel, Menge, EK, VK
      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','NEU');
      IF tab_ab_bw.FIND('-') THEN BEGIN
      REPEAT
      prf.RESET;
      prf.SETFILTER(prf.Belegart,'%1','AUšW');
      prf.SETFILTER(prf.AU_Nr,'%1',tab_ab_bw.AU_Nr);
      prf.SETFILTER(prf.POS_Nr,'%1',tab_ab_bw.POS_Nr);
      prf.SETFILTER(prf.Art,'%1','ALT');
      IF prf.FIND('-') THEN BEGIN
        IF prf.Artikel=tab_ab_bw.Artikel THEN BEGIN
          tab_ab_bw.Stat_Artikel:='OK';
          prf.Stat_Artikel:='OK';
        END ELSE BEGIN
          tab_ab_bw.Stat_Artikel:='AF';
          tab_ab_bw.Status:='ŽN';
          prf.Stat_Artikel:='AF';
          prf.Status:='ŽN';
        END;

        IF prf.Menge=tab_ab_bw.Menge THEN BEGIN
         tab_ab_bw.Stat_Menge:='OK';
         prf.Stat_Menge:='OK';
      // ANFANG  Rechnungsmengenprfung bei Menge OK
            IF prf.Restmenge=tab_ab_bw.Restmenge THEN BEGIN
            END ELSE BEGIN
             tab_ab_bw.Stat_Menge:='MR';
             tab_ab_bw.Status:='ŽN';
             prf.Stat_Menge:='MR';
             prf.Status:='ŽN';
            END;
      // ENDE  Rechnungsmengenprfung bei Menge OK
        END ELSE BEGIN
         tab_ab_bw.Stat_Menge:='MF';
         tab_ab_bw.Status:='ŽN';
         prf.Stat_Menge:='MF';
         prf.Status:='ŽN';
        END;

        IF prf.Restmenge=tab_ab_bw.Restmenge THEN BEGIN
        END ELSE BEGIN
         tab_ab_bw.Stat_Menge:='MR';
         tab_ab_bw.Status:='ŽN';
         prf.Stat_Menge:='MR';
         prf.Status:='ŽN';
        END;


        IF prf.EK=tab_ab_bw.EK THEN BEGIN
         tab_ab_bw.Stat_EK:='OK';
         prf.Stat_EK:='OK';
        END ELSE BEGIN
         tab_ab_bw.Stat_EK:='EF';
         tab_ab_bw.Status:='ŽN';
         prf.Stat_EK:='EF';
         prf.Status:='ŽN';
        END;

        IF prf.VK=tab_ab_bw.VK THEN BEGIN
         tab_ab_bw.Stat_VK:='OK';
         prf.Stat_VK:='OK';
        END ELSE BEGIN
         tab_ab_bw.Stat_VK:='VF';
         tab_ab_bw.Status:='ŽN';
         prf.Stat_VK:='VF';
         prf.Status:='ŽN';
        END;

        IF prf.W„hrungscode=tab_ab_bw.W„hrungscode THEN BEGIN
        END ELSE BEGIN
         tab_ab_bw.Stat_VK:='WŽ';
         tab_ab_bw.Status:='ŽN';
         prf.Status:='ŽN';
         prf.Stat_VK:='WŽ';
        END;

        tab_ab_bw.MODIFY;
        prf.MODIFY;
      END;
      UNTIL tab_ab_bw.NEXT=0;
      END;
      //  ENDE Diff. feststellen Artikel, Menge, EK, VK
      //  ANFANG Status auf OK setzen, wenn keine Abweichnung vorliegt
      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','NEU');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_Artikel,'%1','OK');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_Menge,'%1','OK');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_EK,'%1','OK');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_VK,'%1','OK');
      IF tab_ab_bw.FIND('-') THEN BEGIN
      REPEAT
       tab_ab_bw.Status:='OK';
       tab_ab_bw.MODIFY;
      UNTIL tab_ab_bw.NEXT=0;
      END;

      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','ALT');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_Artikel,'%1','OK');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_Menge,'%1','OK');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_EK,'%1','OK');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_VK,'%1','OK');
      IF tab_ab_bw.FIND('-') THEN BEGIN
      REPEAT
       tab_ab_bw.Status:='OK';
       tab_ab_bw.MODIFY;
      UNTIL tab_ab_bw.NEXT=0;
      END;
      //  ENDE   Status auf OK setzen, wenn keine Abweichnung vorliegt

      //  ANFANG Feststellen, ob neuer Auftrag/Pos vorliegt
      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','NEU');
      tab_ab_bw.SETFILTER(tab_ab_bw.Status,'%1','NN');
      IF tab_ab_bw.FIND('-') THEN BEGIN
      REPEAT

       prf.RESET;
       tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
       prf.SETFILTER(prf.Art,'%1','ALT');
       prf.SETFILTER(prf.AU_Nr,'%1',tab_ab_bw.AU_Nr);
        IF prf.FINDFIRST THEN BEGIN
      //  Neue Position zu altem Auftrag
              tab_ab_bw.Status:='NP';
              tab_ab_bw.MODIFY;
        END ELSE BEGIN
      //  Neuer Auftrag
           tab_ab_bw.Status:='NA';
           tab_ab_bw.MODIFY;

        END;
      UNTIL tab_ab_bw.NEXT=0;
      END;
      //  ENDE   Feststellen, ob neuer Auftrag/Pos vorliegt

      // ANFANG  Feststellen, ob ein Auftrag/Pos storniert wurde
      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','ALT');
      tab_ab_bw.SETFILTER(tab_ab_bw.Status,'%1','NN');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
        var_re_menge:=0;
       rech.RESET;
       rech.SETFILTER(rech."Order No.",'%1',tab_ab_bw.AU_Nr);
       // Rechnungsmenge ohne laufender Tag *********************************
       rech.SETFILTER(rech."Posting Date",'<%1',WORKDATE);
       rech.SETFILTER(rech."Order Line No.",'%1',tab_ab_bw.POS_Nr);
       IF rech.FINDFIRST THEN BEGIN
         REPEAT
           tab_ab_bw.Status:='ST';
           tab_ab_bw.MODIFY;

           var_re_menge:=var_re_menge+rech.Quantity;
         UNTIL rech.NEXT=0;
         IF var_re_menge>0 THEN
         BEGIN
         tab_ab_bw.Status:='RE';
         END;
         tab_ab_bw.re_menge:=var_re_menge;
         tab_ab_bw.MODIFY;
        var_re_menge:=0;
       END
        ELSE BEGIN
      //  Storno der Zeile
           tab_ab_bw.Status:='ST';
           tab_ab_bw.MODIFY;
        END;
      UNTIL tab_ab_bw.NEXT=0;
      END;


      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','ALT');
      tab_ab_bw.SETFILTER(tab_ab_bw.Status,'%1','ŽN');
      //tab_ab_bw.SETFILTER(tab_ab_bw.Stat_Menge,'%1','MR');
      //tab_ab_bw.SETFILTER(tab_ab_bw.Stat_Artikel,'%1|%2','OK','NN');
      //tab_ab_bw.SETFILTER(tab_ab_bw.Stat_EK,'%1|%2','OK','NN');
      //tab_ab_bw.SETFILTER(tab_ab_bw.Stat_VK,'%1|%2','OK','NN');

      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
        var_re_menge:=0;
       rech.RESET;
       rech.SETFILTER(rech."Order No.",'%1',tab_ab_bw.AU_Nr);
       // Rechnungsmenge ohne laufender Tag *********************************
        rech.SETFILTER(rech."Posting Date",'<%1',WORKDATE);
       rech.SETFILTER(rech."Order Line No.",'%1',tab_ab_bw.POS_Nr);
       IF rech.FINDFIRST THEN BEGIN
         REPEAT
           var_re_menge:=var_re_menge+rech.Quantity;
         UNTIL rech.NEXT=0;
         IF var_re_menge>0 THEN
         BEGIN
         tab_ab_bw.Status:='RE';
         END;
         tab_ab_bw.re_menge:=var_re_menge;
         tab_ab_bw.MODIFY;
        var_re_menge:=0;
       END
        ELSE BEGIN
      //  Storno der Zeile
           tab_ab_bw.Status:='ST';
           tab_ab_bw.MODIFY;
        END;
      UNTIL tab_ab_bw.NEXT=0;
      END;

      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','NEU');
      tab_ab_bw.SETFILTER(tab_ab_bw.Status,'%1','ŽN');
      //tab_ab_bw.SETFILTER(tab_ab_bw.Stat_Menge,'%1','MR');
      //tab_ab_bw.SETFILTER(tab_ab_bw.Stat_Artikel,'%1','OK');
      //tab_ab_bw.SETFILTER(tab_ab_bw.Stat_EK,'%1','OK');
      //tab_ab_bw.SETFILTER(tab_ab_bw.Stat_VK,'%1','OK');

      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
        var_re_menge:=0;
       rech.RESET;
       rech.SETFILTER(rech."Order No.",'%1',tab_ab_bw.AU_Nr);
       // Rechnungsmenge ohne laufender Tag *********************************
        rech.SETFILTER(rech."Posting Date",'<%1',WORKDATE);

       rech.SETFILTER(rech."Order Line No.",'%1',tab_ab_bw.POS_Nr);
       IF rech.FINDFIRST THEN BEGIN
         REPEAT
           var_re_menge:=var_re_menge+rech.Quantity;
         UNTIL rech.NEXT=0;
         IF var_re_menge>0 THEN
         BEGIN
         tab_ab_bw.Status:='RE';
         END;
         tab_ab_bw.re_menge:=var_re_menge;
         tab_ab_bw.MODIFY;
        var_re_menge:=0;
       END
        ELSE BEGIN
      //  Storno der Zeile
           tab_ab_bw.Status:='ST';
           tab_ab_bw.MODIFY;
        END;
      UNTIL tab_ab_bw.NEXT=0;
      END;
      // ENDE    Feststellen, ob ein Auftrag/Pos storniert wurde

      // ANFANG  Feststellen, ob RE_Mengen mit AU_Mengen bereinstimmen
      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','ALT');
      tab_ab_bw.SETFILTER(tab_ab_bw.Status,'%1','RE');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
          IF tab_ab_bw.Menge=tab_ab_bw.re_menge THEN BEGIN
            tab_ab_bw.Status:='OK';
          END ELSE BEGIN
            tab_ab_bw.Status:='GP';
          END;
          IF tab_ab_bw.Restmenge=0 THEN BEGIN
            tab_ab_bw.Status:='FA';
          END;

          tab_ab_bw.MODIFY;
      UNTIL tab_ab_bw.NEXT=0;
      END;
      //   ENDE  Feststellen, ob RE_Mengen mit AU_Mengen bereinstimmen


      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','ALT');
      tab_ab_bw.SETFILTER(tab_ab_bw.Status,'%1','FA');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_Menge,'%1','NN');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_Artikel,'%1','NN');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_EK,'%1','NN');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_VK,'%1','NN');
      //tab_ab_bw.SETFILTER(tab_ab_bw.re_menge,'%1',tab_ab_bw.Menge);
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
      IF tab_ab_bw.re_menge=tab_ab_bw.Menge THEN BEGIN
        tab_ab_bw.Status:='OK';
        tab_ab_bw.MODIFY;
      END;
      UNTIL tab_ab_bw.NEXT=0;
      END;


      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','NEU');
      tab_ab_bw.SETFILTER(tab_ab_bw.Status,'%1','RE');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_Menge,'%1','MR');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_Artikel,'%1','OK');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_EK,'%1','OK');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_VK,'%1','OK');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
      IF ((tab_ab_bw.re_menge=tab_ab_bw.Menge) AND (tab_ab_bw.Restmenge=0)) THEN BEGIN
        tab_ab_bw.Status:='OK';
        tab_ab_bw.MODIFY;
      END;
      UNTIL tab_ab_bw.NEXT=0;
      END;

      //  ENDE   Vergleich zwischen NEU und ALT


      //  ANFANG Differenzen in AEmtl bernehmen
      tab_ab_bw.RESET;
      tab_ab_bw.SETCURRENTKEY(Belegart,AU_Nr,POS_Nr,Datum);
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1|%2', 'NEU', 'ALT');
      tab_ab_bw.SETFILTER(tab_ab_bw.Status,'%1|%2|%3|%4|%5|%6|%7', 'NP', 'ŽN', 'ST', 'GP', 'FA', 'RE','WŽ');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
          AE_mtl.INIT;
                 AE_mtl.Datum:=tab_ab_bw.Datum;
      //           AE_mtl.Datum:=WORKDATE;
                 AE_mtl.AU_Nr:=tab_ab_bw.AU_Nr;
                 AE_mtl.POS_Nr:=tab_ab_bw.POS_Nr;
                 AE_mtl.Belegart:='AEND';
                 AE_mtl.Debitor:=tab_ab_bw.Debitor;
                 AE_mtl.Deb_Nr:=tab_ab_bw.Deb_Nr;
                 AE_mtl.Artikel:=tab_ab_bw.Artikel;
                 AE_mtl.Menge:=tab_ab_bw.Menge;
                 AE_mtl.Restmenge:=tab_ab_bw.Restmenge;
                 AE_mtl.EK:=tab_ab_bw.EK;
                 AE_mtl.VK:=tab_ab_bw.VK;
                 AE_mtl."Best„tigt LD":=tab_ab_bw."Best„tigt LD";
                 AE_mtl.Wunschdatum:=tab_ab_bw.Wunschdatum;
                 AE_mtl.Status:='AE';
                 AE_mtl.Art:='TAG';
                 AE_mtl."EK Gesamt":=tab_ab_bw."EK Gesamt";
                 AE_mtl."VK Gesamt":=tab_ab_bw."VK Gesamt";
                 AE_mtl.Lager:=tab_ab_bw.Lager;
                 AE_mtl."DB %":=tab_ab_bw."DB %";
                 AE_mtl.Linie:=tab_ab_bw.Linie;
                 AE_mtl.Endkunde:=tab_ab_bw.Endkunde;
                 AE_mtl.W„hrungscode:=tab_ab_bw.W„hrungscode;
                 AE_mtl.w„_faktor:=tab_ab_bw.w„_faktor;
                 AE_mtl.Auftragsdatum:=tab_ab_bw.Auftragsdatum;
                 AE_mtl.Betreuer:=tab_ab_bw.Betreuer;
                 AE_mtl.Vertreter:=tab_ab_bw.Vertreter;
                 AE_mtl.Teams:=tab_ab_bw.Teams;
                 AE_mtl.Gebietscode:=tab_ab_bw.Gebietscode;
                 AE_mtl.PLZ:=tab_ab_bw.Plz;
                 AE_mtl."AU aus Rahmen":=tab_ab_bw."AU aus Rahmen";
                 IF AE_mtl.w„_faktor=0 THEN BEGIN
                 AE_mtl."Betrag in EUR":=AE_mtl."VK Gesamt";
                 END ELSE BEGIN
                 AE_mtl."Betrag in EUR":=(AE_mtl."VK Gesamt"/AE_mtl.w„_faktor);
                 END;


      //            tab_vkk1.RESET;
      //            tab_vkk1.SETFILTER(tab_vkk1."No.",'%1',AE_mtl.AU_Nr);
      //             IF tab_vkk1.FINDFIRST THEN
      //              BEGIN
      //
      //              AE_mtl.Deb_Nr:=tab_vkk1."Sell-to Customer No.";
      //              AE_mtl.W„hrungscode:=tab_vkk1."Currency Code";
      //              AE_mtl.w„_faktor:=tab_vkk1."Currency Factor";
      //              AE_mtl.Auftragsdatum:=tab_vkk1."Order Date";
      //              AE_mtl.Betreuer:=tab_vkk1."Betreuer Innendienst";
      //              AE_mtl.Vertreter:=tab_vkk1."Salesperson Code";
      //              AE_mtl.Teams:=tab_vkk1.Teams;
      //              AE_mtl.PLZ:=tab_vkk1."Sell-to Post Code";
      //             END;
          AE_mtl.INSERT;

      UNTIL tab_ab_bw.NEXT=0;
      END;



      //  ENDE Differenzen in AEmtl bernehmen


      // ANFANG Differenzen in Excel ausgeben

      CLEAR(Excel);
      REPEAT
      UNTIL ISCLEAR(Excel);
      CREATE(Excel,FALSE,TRUE);

      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,####';

      Sheet.Range('A1').Value := 'Auftragsberwachung  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'Datum';
      Sheet.Range('B2').Value := 'AU-Nr';
      Sheet.Range('C2').Value := 'Pos-Nr';
      Sheet.Range('D2').Value := 'Debitor';
      Sheet.Range('E2').Value := 'Artikel';
      Sheet.Range('F2').Value := 'Menge';
      Sheet.Range('G2').Value := 'Restmenge';
      Sheet.Range('H2').Value := 'Lager';
      Sheet.Range('I2').Value := 'EK';
      Sheet.Range('J2').Value := 'VK';
      Sheet.Range('K2').Value := 'Art';
      Sheet.Range('L2').Value := 'Status';
      Sheet.Range('M2').Value := 'Art Diff';
      Sheet.Range('N2').Value := 'Menge Diff';
      Sheet.Range('O2').Value := 'EK Diff';
      Sheet.Range('P2').Value := 'VK Diff';
      Sheet.Range('Q2').Value := 'WŽ-Diff';
      Sheet.Range('R2').Value := 'WŽ';
      Sheet.Range('S2').Value := 'W„ Kurs';
      Sheet.Range('T2').Value := 'RE Menge';
      Sheet.Range('U2').Value := 'urspr AU-Datum';
      j := '3';                                   // <- Import in excel ab Zeile 3





      var_AU_Nr:='AU200000';
      tab_ab_bw.RESET;
      tab_ab_bw.SETCURRENTKEY(Belegart,AU_Nr,POS_Nr,Datum);
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1|%2', 'NEU', 'ALT');
      tab_ab_bw.SETFILTER(tab_ab_bw.Status,'%1|%2|%3|%4|%5|%6|%7', 'NP','ŽN','ST','GP','FA','RE','WŽ');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
       IF tab_ab_bw.AU_Nr=var_AU_Nr THEN BEGIN
        Sheet.Range('A'+j).Value := tab_ab_bw.Datum;
        Sheet.Range('B'+j).Value := tab_ab_bw.AU_Nr;
        Sheet.Range('C'+j).Value := tab_ab_bw.POS_Nr;
        Sheet.Range('D'+j).Value := tab_ab_bw.Debitor;
        Sheet.Range('E'+j).Value := tab_ab_bw.Artikel;
        Sheet.Range('F'+j).Value := tab_ab_bw.Menge;
        Sheet.Range('G'+j).Value := tab_ab_bw.Restmenge;
        Sheet.Range('H'+j).Value := tab_ab_bw.Lager;
        Sheet.Range('I'+j).Value := FORMAT(tab_ab_bw.EK);
        Sheet.Range('J'+j).Value := FORMAT(tab_ab_bw.VK);
        Sheet.Range('K'+j).Value := tab_ab_bw.Art;
        Sheet.Range('L'+j).Value := tab_ab_bw.Status;
        Sheet.Range('M'+j).Value := tab_ab_bw.Stat_Artikel;
        Sheet.Range('N'+j).Value := tab_ab_bw.Stat_Menge;
        Sheet.Range('O'+j).Value := tab_ab_bw.Stat_EK;
        Sheet.Range('P'+j).Value := tab_ab_bw.Stat_VK;
        IF tab_ab_bw.Stat_VK='WŽ' THEN BEGIN
        Sheet.Range('Q'+j).Value := 'WŽ-Fehler';
        END;
        Sheet.Range('R'+j).Value := tab_ab_bw.W„hrungscode;
        Sheet.Range('S'+j).Value := FORMAT(tab_ab_bw.w„_faktor);
        Sheet.Range('T'+j).Value := FORMAT(tab_ab_bw.re_menge);
        Sheet.Range('U'+j).Value := tab_ab_bw.Auftragsdatum;
        j:=INCSTR(j);

       END ELSE BEGIN
        j:=INCSTR(j);
        Sheet.Range('A'+j).Value := tab_ab_bw.Datum;
        Sheet.Range('B'+j).Value := tab_ab_bw.AU_Nr;
        Sheet.Range('C'+j).Value := tab_ab_bw.POS_Nr;
        Sheet.Range('D'+j).Value := tab_ab_bw.Debitor;
        Sheet.Range('E'+j).Value := tab_ab_bw.Artikel;
        Sheet.Range('F'+j).Value := tab_ab_bw.Menge;
        Sheet.Range('G'+j).Value := tab_ab_bw.Restmenge;
        Sheet.Range('H'+j).Value := tab_ab_bw.Lager;
        Sheet.Range('I'+j).Value := FORMAT(tab_ab_bw.EK);
        Sheet.Range('J'+j).Value := FORMAT(tab_ab_bw.VK);
        Sheet.Range('K'+j).Value := tab_ab_bw.Art;
        Sheet.Range('L'+j).Value := tab_ab_bw.Status;
        Sheet.Range('M'+j).Value := tab_ab_bw.Stat_Artikel;
        Sheet.Range('N'+j).Value := tab_ab_bw.Stat_Menge;
        Sheet.Range('O'+j).Value := tab_ab_bw.Stat_EK;
        Sheet.Range('P'+j).Value := tab_ab_bw.Stat_VK;
        IF tab_ab_bw.Stat_VK='WŽ' THEN BEGIN
        Sheet.Range('Q'+j).Value := 'WŽ-Fehler';
        END;
        Sheet.Range('R'+j).Value := tab_ab_bw.W„hrungscode;
        Sheet.Range('S'+j).Value := FORMAT(tab_ab_bw.w„_faktor);
        Sheet.Range('T'+j).Value := FORMAT(tab_ab_bw.re_menge);
        Sheet.Range('U'+j).Value := tab_ab_bw.Auftragsdatum;
        j:=INCSTR(j);
        var_AU_Nr :=tab_ab_bw.AU_Nr;
       END;
      UNTIL tab_ab_bw.NEXT=0;
      END;

      Pfad_tag :=FORMAT(DATE2DMY(AE_holen_Datum_1,1));
      Pfad_monat := FORMAT(DATE2DMY(AE_holen_Datum_1,2));
      Pfad_jahr := FORMAT(DATE2DMY(AE_holen_Datum_1,3));

      Pfaddatum:='_' + Pfad_jahr + '_' + Pfad_monat + '_' + Pfad_tag;
      Pfad:='F:\Daten Neu\User\Joachim\AB-Differenzen\2017_2018\Diff'+Pfaddatum+'.xlsx';

      IF ERASE(Pfad)THEN;
      Book.SaveAs(Pfad);




      Excel.Visible(TRUE);
      // ENDE Differenzen in Excel ausgeben
      //MESSAGE(' Differenzen wurden ordnungsgem„á nach Excel exportiert. ');
    END;

    PROCEDURE "AB einfgen rcksetzen"@1140001();
    BEGIN

      //  ANFANG  Rcksetzen des Holens von neuem AB-Bestand
      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','NEU');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
        tab_ab_bw.DELETE;
      UNTIL tab_ab_bw.NEXT=0;
      END;

      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','ALT');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
        tab_ab_bw.Art:='NEU';
        tab_ab_bw.MODIFY;
      UNTIL tab_ab_bw.NEXT=0;
      END;

      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','AL1');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
        tab_ab_bw.Art:='ALT';
        tab_ab_bw.MODIFY;
      UNTIL tab_ab_bw.NEXT=0;
      END;

      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','AL2');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
        tab_ab_bw.Art:='AL1';
        tab_ab_bw.MODIFY;
      UNTIL tab_ab_bw.NEXT=0;
      END;

      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','NEU');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
        tab_ab_bw.Status:='NN';
        tab_ab_bw.Stat_Artikel:='NN';
        tab_ab_bw.Stat_Menge:='NN';
        tab_ab_bw.Stat_EK:='NN';
        tab_ab_bw.Stat_VK:='NN';
        tab_ab_bw.MODIFY;
      UNTIL tab_ab_bw.NEXT=0;
      END;
      //  ENDE  Rcksetzen des Holens von neuem AB-Bestand

      MESSAGE(' Das Rcksetzen des Auftragsbestandes wurde ordnungsgem„á erledigt. ');
    END;

    PROCEDURE "t„glichen AE einfgen"@1140003();
    BEGIN
      // ANFANG L”schen Tabelle AE_mtl
      // AE_mtl.RESET;
      // AE_mtl.DELETEALL;
      // ENDE   L”schen Tabelle AE_mtl

      // ANFANG Einfgen von neuem AE

      AE_mtl.RESET;
      tab_ab.RESET;
      tab_vkk.RESET;
      tab_vkk.SETFILTER(tab_vkk."Order Date",'%1',AE_holen_Datum_1);
      //tab_vkk.SETFILTER(tab_vkk."Document Type",'%1', tab_vkk."Document Type"::Order);
       IF tab_vkk.FINDFIRST THEN
       REPEAT
      //    AE_mtl.INIT;
      //    AE_mtl.AU_Nr:=tab_vkk."No.";
      //    AE_mtl.INSERT;

      tab_ab.RESET;
      tab_ab.SETFILTER(tab_ab."Document No.",'%1',tab_vkk."No.");
      tab_ab.SETFILTER(tab_ab."Document Type",'%1', tab_ab."Document Type"::Order);
      tab_ab.SETFILTER(tab_ab.Type,'%1',tab_ab.Type::Item);
      tab_ab.SETFILTER(tab_ab."Location Code",'%1|%2|%3|%4','ZENT','KONSI','ERSATZ','IDT');
      tab_ab.SETFILTER(tab_ab."Outstanding Quantity",'>%1',0);
       IF tab_ab.FINDFIRST  THEN
        REPEAT
          AE_mtl.INIT;
                 AE_mtl.Datum:=AE_holen_Datum_1;
                 AE_mtl.AU_Nr:=tab_ab."Document No.";
                 AE_mtl.POS_Nr:=tab_ab."Line No.";
                 AE_mtl.Belegart:='AETG';
                 AE_mtl.Deb_Nr:=tab_ab."Sell-to Customer No.";
                 AE_mtl.Artikel:=tab_ab."No.";
                 AE_mtl.Menge:=tab_ab.Quantity;
                 AE_mtl.Restmenge:=tab_ab."Outstanding Quantity";
                 AE_mtl.EK:=tab_ab."Unit Cost (LCY)";
                 AE_mtl.VK:=tab_ab."Unit Price";
                 AE_mtl."Best„tigt LD":=tab_ab."Promised Delivery Date";
                 AE_mtl.Wunschdatum:=tab_ab."Requested Delivery Date";
                 AE_mtl.Status:='AE';
                 AE_mtl.Art:='TAG';
                 AE_mtl."EK Gesamt":=ROUND(((tab_ab.Quantity)*(tab_ab."Unit Cost (LCY)")),0.01);
                 AE_mtl."VK Gesamt":=ROUND(((tab_ab.Quantity)*(tab_ab."Unit Price")),0.01);
                 AE_mtl.Lager:=tab_ab."Location Code";
                 AE_mtl."DB %":=tab_ab."Profit %";
                 AE_mtl.Linie:=tab_ab."Manufacturer Code";
                 AE_mtl.Endkunde:=tab_ab.Endkunde;
                 IF tab_ab."Blanket Order No."='' THEN BEGIN
                 END ELSE BEGIN
                 AE_mtl."AU aus Rahmen":=TRUE;
                 END;

                  tab_vkk1.RESET;
                  tab_vkk1.SETFILTER(tab_vkk1."No.",'%1',AE_mtl.AU_Nr);
                   IF tab_vkk1.FINDFIRST THEN
                    BEGIN
                    AE_mtl.Debitor:=tab_vkk1."Sell-to Customer Name";
                    AE_mtl.W„hrungscode:=tab_vkk1."Currency Code";
                    AE_mtl.w„_faktor:=tab_vkk1."Currency Factor";
                    AE_mtl.Auftragsdatum:=tab_vkk1."Order Date";
                    AE_mtl.Betreuer:=tab_vkk1."Betreuer Innendienst";
                    AE_mtl.Vertreter:=tab_vkk1."Salesperson Code";
                    AE_mtl.Teams:=tab_vkk1.Teams;
                    AE_mtl.Gebietscode:=tab_vkk1."Territory Code";
                    AE_mtl.PLZ:=tab_vkk1."Sell-to Post Code";
                   END;
                 IF AE_mtl.w„_faktor=0 THEN BEGIN
                 AE_mtl."Betrag in EUR":=AE_mtl."VK Gesamt";
                 END ELSE BEGIN
                 AE_mtl."Betrag in EUR":=(AE_mtl."VK Gesamt"/AE_mtl.w„_faktor);
                 END;
          AE_mtl.INSERT;
       UNTIL tab_ab.NEXT=0;

      UNTIL tab_vkk.NEXT=0;
      //  ENDE Einfgen von neuem AE

      // Gutschriften einspielen 28.11.2011
      AE_mtl.RESET;
      tab_guz.RESET;
      tab_guk.RESET;
      tab_guk.SETFILTER(tab_guk."Posting Date",'%1',AE_holen_Datum_1);
       IF tab_guk.FINDFIRST THEN
       REPEAT

      tab_guz.RESET;
      tab_guz.SETFILTER(tab_guz."Document No.",'%1',tab_guk."No.");
      //tab_guz.SETFILTER(tab_guz."Document Type",'%1', tab_guz."Document Type"::Order);
      tab_guz.SETFILTER(tab_guz.Type,'%1',tab_guz.Type::Item);
      tab_guz.SETFILTER(tab_guz."Location Code",'%1|%2|%3|%4','ZENT','KONSI','ERSATZ','IDT');
      tab_guz.SETFILTER(tab_guz.Quantity,'>%1',0);
       IF tab_guz.FINDFIRST  THEN
        REPEAT
          AE_mtl.INIT;
                 AE_mtl.Datum:=AE_holen_Datum_1;
                 AE_mtl.AU_Nr:=tab_guz."Document No.";
                 AE_mtl.POS_Nr:=tab_guz."Line No.";
                 AE_mtl.Belegart:='GUTG';
                 AE_mtl.Deb_Nr:=tab_guz."Sell-to Customer No.";
                 AE_mtl.Artikel:=tab_guz."No.";
                 AE_mtl.Menge:=tab_guz.Quantity;
                 AE_mtl.Restmenge:=tab_guz.Quantity;
                 AE_mtl.EK:=tab_guz."Unit Cost (LCY)";
                 AE_mtl.VK:=tab_guz."Unit Price";
      //           AE_mtl."Best„tigt LD":=tab_guz."Promised Delivery Date";
      //           AE_mtl.Wunschdatum:=tab_guz."Requested Delivery Date";
                 AE_mtl.Status:='AE';
                 AE_mtl.Art:='TAG';
                 AE_mtl."EK Gesamt":=ROUND(((tab_guz.Quantity)*(tab_guz."Unit Cost (LCY)")*(-1)),0.01);
                 AE_mtl."VK Gesamt":=ROUND(((tab_guz.Quantity)*(tab_guz."Unit Price")*(-1)),0.01);
                 AE_mtl.Lager:=tab_guz."Location Code";
      //           AE_mtl."DB %":=tab_guz."Profit %";
                 AE_mtl.Linie:=tab_guz."Manufacturer Code";
                 AE_mtl.Endkunde:=tab_guz.Endkunde;
      //            tab_guk1.RESET;
      //            tab_guk1.SETFILTER(tab_guk1."No.",'%1',AE_mtl.AU_Nr);
      //             IF tab_guk1.FINDFIRST THEN
      //              BEGIN
      //              AE_mtl.Debitor:=tab_guk1."Sell-to Customer Name";
      //              AE_mtl.W„hrungscode:=tab_guk1."Currency Code";
      //              AE_mtl.w„_faktor:=tab_guk1."Currency Factor";
      //              AE_mtl.Auftragsdatum:=tab_guk1."Posting Date";
      //              AE_mtl.Betreuer:=tab_guk1."Betreuer Innendienst";
      //              AE_mtl.Vertreter:=tab_guk1."Salesperson Code";
      //              AE_mtl.Teams:=tab_guk1.Teams;
      //              AE_mtl.PLZ:=tab_guk1."Sell-to Post Code";
      //                       END;

                    AE_mtl.Debitor:=tab_guk."Sell-to Customer Name";
                    AE_mtl.W„hrungscode:=tab_guk."Currency Code";
                    AE_mtl.w„_faktor:=tab_guk."Currency Factor";
                    AE_mtl.Auftragsdatum:=tab_guk."Posting Date";
                    AE_mtl.Betreuer:=tab_guk."Betreuer Innendienst";
                    AE_mtl.Vertreter:=tab_guk."Salesperson Code";
                    AE_mtl.Teams:=tab_guk.Teams;
                    AE_mtl.PLZ:=tab_guk."Sell-to Post Code";
                    AE_mtl.Gebietscode:=tab_guk."Territory Code";

                 IF AE_mtl.w„_faktor=0 THEN BEGIN
                 AE_mtl."Betrag in EUR":=AE_mtl."VK Gesamt";
                 END ELSE BEGIN
                 AE_mtl."Betrag in EUR":=(AE_mtl."VK Gesamt"/AE_mtl.w„_faktor);
                 END;
          AE_mtl.INSERT;
       UNTIL tab_guz.NEXT=0;

      UNTIL tab_guk.NEXT=0;
      // ENDE Gutschriften einspielen 28.11.2011


      //  // ANFANG FW-Auftr„ge in Euro umrechnen
      //AE_mtl.RESET;
      //  //AE_mtl.SETFILTER(AE_mtl.Status,'<>%1','BE');
      //AE_mtl.SETFILTER(AE_mtl.W„hrungscode,'<>%1','');
      // IF AE_mtl.FINDFIRST THEN
      // REPEAT
      //  AE_mtl."VK Gesamt":=(AE_mtl."VK Gesamt"/ AE_mtl.w„_faktor);
      //  AE_mtl.MODIFY;
      // UNTIL AE_mtl.NEXT=0;
      //  // ENDE FW-Auftr„ge in Euro umrechnen



      "Linien umsetzen";


      // ANFANG tgl. AE in Excel ausgeben z.Zt. nicht aktiv. šberprfung ber anzeigen und nach Excel kopieren
      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      //Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      //Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      //Sheet.Range('H:K').NumberFormat:='###.###,#####';
      //Sheet.Range('L:M').NumberFormat:='###.###,##';
      //Sheet.Range('Q:Q').NumberFormat:='###.###,##';

      //Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      //Sheet.Range('A2').Value := 'datum';
      //Sheet.Range('B2').Value := 'auft_nr';
      //Sheet.Range('C2').Value := 'deb_nr';
      //Sheet.Range('D2').Value := 'name';
      //Sheet.Range('E2').Value := 'menge';
      //Sheet.Range('F2').Value := 'artikel';
      //Sheet.Range('G2').Value := 'lager';
      //Sheet.Range('H2').Value := 'ek';
      //Sheet.Range('I2').Value := 'vk';
      //Sheet.Range('J2').Value := 'w„hrung';
      //Sheet.Range('K2').Value := 'w„_fakt';
      //Sheet.Range('L2').Value := 'betrag in EUR';
      //Sheet.Range('M2').Value := 'db';
      //Sheet.Range('N2').Value := 'bearb';
      //Sheet.Range('O2').Value := 'vertreter';
      //Sheet.Range('P2').Value := 'linie';
      //Sheet.Range('Q2').Value := 'ek_gesamt';
      //Sheet.Range('R2').Value := 'plz';
      //Sheet.Range('S2').Value := 'endkunde';
      //Sheet.Range('T2').Value := 'team';
      //Sheet.Range('U2').Value := 'Art';
      //Sheet.Range('V2').Value := 'Status';
      //Sheet.Range('W2').Value := 'Art Diff';
      //Sheet.Range('X2').Value := 'Menge Diff';

      //j := '3';                                   // <- Import in excel ab Zeile 3
      // AE_mtl.RESET;
      //AE_mtl.SETFILTER(AE_mtl.Belegart,'%1','AETG');
      //IF AE_mtl.FINDFIRST THEN BEGIN
      //REPEAT
      //Sheet.Range('A'+j).Value := AE_mtl.Datum;
      //Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      //Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      //Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      //Sheet.Range('E'+j).Value := AE_mtl.Menge;
      //Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      //Sheet.Range('G'+j).Value := AE_mtl.Lager;
      //Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      //Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      //Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      //Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      //Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      //Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      //Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      //Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      //Sheet.Range('P'+j).Value := AE_mtl.Linie;
      //Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      //Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      //Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      //Sheet.Range('T'+j).Value := AE_mtl.Teams;
      //j:=INCSTR(j);
      //UNTIL AE_mtl.NEXT=0;
      //END;
      // ENDE tgl. AE in Excel ausgeben
    END;

    PROCEDURE "AE aus Excel importieren"@1140004();
    BEGIN
      // Definiert die zu importierende Datei
      //CREATE (Quelle_Excel);
      //Quelle_Book := Quelle_Excel.Workbooks._Open(CurrDataport.FILENAME,0,TRUE);
      //Quelle_Sheet := Quelle_Excel.ActiveSheet;
      //Quelle_j:='1';
    END;

    PROCEDURE "tgl AE in mtl AE bernehmen"@1140005();
    BEGIN
      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1','AETG');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
        AE_mtl.RENAME(AE_mtl.Datum,AE_mtl.AU_Nr,AE_mtl.POS_Nr,AE_mtl.Deb_Nr,'AMTL');
      UNTIL AE_mtl.NEXT=0;
      END;

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1','GUTG');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
        AE_mtl.RENAME(AE_mtl.Datum,AE_mtl.AU_Nr,AE_mtl.POS_Nr,AE_mtl.Deb_Nr,'GUMT');
      UNTIL AE_mtl.NEXT=0;
      END;

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1','AEND');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
       AE_mtl.RENAME(AE_mtl.Datum,AE_mtl.AU_Nr,AE_mtl.POS_Nr,AE_mtl.Deb_Nr,'AEMT');
      UNTIL AE_mtl.NEXT=0;
      END;
    END;

    PROCEDURE AE_Verteilung@1140006();
    BEGIN
      ACS;
      Christian;
      Edeltraut;
      Hendrik;
      Maria;
      //Mirjam;   // wird zur Zeit nicht ben”tigt
      Nadine;
      Michael;   // wird jetzt fr Michael ausgefhrt
      Renate;
      Simon;
      Sylke;
      Thomas;
      Torsten;
      Werner;
    END;

    PROCEDURE ACS@1140009();
    BEGIN
      // ANFANG tgl. AE in Excel ausgeben
      CLEAR(Excel);
      REPEAT
      UNTIL ISCLEAR(Excel);
      CREATE(Excel,FALSE,TRUE);
      CREATE (wshFile,FALSE,TRUE);
      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';

      j := '3';




      AE_mtl.RESET;
      AE_mtl.SETCURRENTKEY(Datum,AU_Nr,POS_Nr,Deb_Nr,Belegart);
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Linie,'%1|%2|%3|%4','ACT','ACI','ACC','ACS');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      IF wshFile.FileExists('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\ACS\AE_mtl.xlsx') THEN wshFile.DeleteFile('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\ACS\Ae_mtl.xlsx');
      //IF ERASE('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\ACS\AE_mtl.xlsx')THEN;
      Book.SaveAs('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\ACS\AE_mtl.xlsx');
      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Christian@1140010();
    BEGIN
      // ANFANG tgl. AE in Excel ausgeben
      //CLEAR(Excel);
      //REPEAT
      //UNTIL ISCLEAR(Excel);
      //CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');;
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1','CB');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      IF wshFile.FileExists('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Christian\AE_mtl.xlsx') THEN wshFile.DeleteFile('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Christian\AE_mtl.xlsx');
      //IF ERASE('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Christian\AE_mtl.xlsx')THEN;
      Book.SaveAs('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Christian\AE_mtl.xlsx');
      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Edeltraut@1140011();
    BEGIN
      // ANFANG tgl. AE in Excel ausgeben
      //CLEAR(Excel);
      //REPEAT
      //UNTIL ISCLEAR(Excel);
      //CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1|%2','ESK','NM');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      {    //  zur Zeit nicht ben”tigt
      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1','ML');
      AE_mtl.SETFILTER(AE_mtl.Vertreter,'%1|%2|%3','ESK','TWO','TWN');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      }
      IF wshFile.FileExists('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Edeltraut\AE_mtl.xlsx') THEN wshFile.DeleteFile('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Edeltraut\AE_mtl.xlsx');
      //IF ERASE('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Edeltraut\AE_mtl.xlsx')THEN;
      Book.SaveAs('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Edeltraut\AE_mtl.xlsx');
      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Hendrik@1140016();
    BEGIN
      // ANFANG tgl. AE in Excel ausgeben
      //CLEAR(Excel);
      //REPEAT
      //UNTIL ISCLEAR(Excel);
      //CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1|%2','HB','LD');
      AE_mtl.ASCENDING:=FALSE;
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      {      //  zur Zeit nicht ben”tigt
      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1','ML');
      AE_mtl.SETFILTER(AE_mtl.Vertreter,'%1|%2|%3','HB','TWSO','TWSW');
      AE_mtl.ASCENDING:=FALSE;
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      }


      IF wshFile.FileExists('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Hendrik\AE_mtl.xlsx') THEN wshFile.DeleteFile('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Hendrik\AE_mtl.xlsx');
      //IF ERASE('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Hendrik\AE_mtl.xlsx')THEN;
      Book.SaveAs('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Hendrik\AE_mtl.xlsx');
      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Maria@1140007();
    BEGIN
      // ANFANG tgl. AE in Excel ausgeben
      //CLEAR(Excel);
      //REPEAT
      //UNTIL ISCLEAR(Excel);
      //CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1|%2','ML','IF');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      IF wshFile.FileExists('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Maria\AE_mtl.xlsx') THEN wshFile.DeleteFile('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Maria\AE_mtl.xlsx');
      //IF ERASE('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Maria\AE_mtl.xlsx')THEN;
      Book.SaveAs('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Maria\AE_mtl.xlsx');
      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Maria_system@1140062();
    BEGIN
      // ANFANG tgl. AE in Excel ausgeben
      //CLEAR(Excel);
      //REPEAT
      //UNTIL ISCLEAR(Excel);
      //CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1|%2|%3','ML','IF','RL');
      AE_mtl.SETFILTER(AE_mtl.Gebietscode,'%1','SYSTEM');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      IF wshFile.FileExists('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Maria\AE_System_mtl.xlsx') THEN wshFile.DeleteFile('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Maria\AE_System_mtl.xlsx');
      //IF ERASE('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Maria\AE_System_mtl.xlsx')THEN;
      Book.SaveAs('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Maria\AE_System_mtl.xlsx');
      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Mirjam@1140018();
    BEGIN
      // ANFANG tgl. AE in Excel ausgeben
      //CLEAR(Excel);
      //REPEAT
      //UNTIL ISCLEAR(Excel);
      //CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1|%2|%3','MA','MK','IF');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1','ML');
      AE_mtl.SETFILTER(AE_mtl.Vertreter,'%1|%2|%3','MK','MA','IF');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      IF wshFile.FileExists('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Mirjam\AE_mtl.xlsx') THEN wshFile.DeleteFile('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Mirjam\AE_mtl.xlsx');
      //IF ERASE('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Mirjam\AE_mtl.xlsx')THEN;
      Book.SaveAs('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Mirjam\AE_mtl.xlsx');
      IF wshFile.FileExists('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Inna\AE_mtl.xlsx') THEN wshFile.DeleteFile('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Inna\AE_mtl.xlsx');
      //IF ERASE('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Inna\AE_mtl.xlsx')THEN;
      Book.SaveAs('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Inna\AE_mtl.xlsx');

      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Nadine@1140019();
    BEGIN
      // ANFANG tgl. AE in Excel ausgeben
      //CLEAR(Excel);
      //REPEAT
      //UNTIL ISCLEAR(Excel);
      //CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1','NM');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      IF wshFile.FileExists('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Nadine\AE_mtl.xlsx') THEN wshFile.DeleteFile('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Nadine\AE_mtl.xlsx');
      //IF ERASE('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Nadine\AE_mtl.xlsx')THEN;
      Book.SaveAs('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Nadine\AE_mtl.xlsx');
      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Michael@1140020();
    BEGIN
      //  wird zur Zeit fr Michael benutzt



      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Vertreter,'%1','MB');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      IF wshFile.FileExists('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Michael\AE_mtl.xlsx') THEN wshFile.DeleteFile('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Michael\AE_mtl.xlsx');
      //IF ERASE('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Michael\AE_mtl.xlsx')THEN;
      Book.SaveAs('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Michael\AE_mtl.xlsx');
      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Renate@1140021();
    BEGIN
      // ANFANG tgl. AE in Excel ausgeben
      //CLEAR(Excel);
      //REPEAT
      //UNTIL ISCLEAR(Excel);
      //CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1|%2','RL','CB');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      {
      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1','ML');
      AE_mtl.SETFILTER(AE_mtl.Vertreter,'%1|%2|%3|%4|%5|%6','RL','MK','TWW','TWE','TWA','IF');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      //AE_mtl.RESET;
      //AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      //AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      //AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1|%2|%3','ML','MK','RL');
      //AE_mtl.SETFILTER(AE_mtl.Vertreter,'%1|%2|%3','TWW','TWE','TWA');
      // //AE_mtl.SETFILTER(AE_mtl.Gebietscode,'%1','WEST');
      //IF AE_mtl.FINDFIRST THEN BEGIN
      //REPEAT
      //Sheet.Range('A'+j).Value := AE_mtl.Datum;
      //Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      //Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      //Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      //Sheet.Range('E'+j).Value := AE_mtl.Menge;
      //Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      //Sheet.Range('G'+j).Value := AE_mtl.Lager;
      //Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      //Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      //Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      //Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      //Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      //Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      //Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      //Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      //Sheet.Range('P'+j).Value := AE_mtl.Linie;
      //Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      //Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      //Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      //Sheet.Range('T'+j).Value := AE_mtl.Teams;
      //Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      //j:=INCSTR(j);
      //UNTIL AE_mtl.NEXT=0;
      //END;
      }
      IF wshFile.FileExists('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Renate\AE_mtl.xlsx') THEN wshFile.DeleteFile('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Renate\AE_mtl.xlsx');
      //IF ERASE('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Renate\AE_mtl.xlsx')THEN;
      Book.SaveAs('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Renate\AE_mtl.xlsx');
      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Simon@1140022();
    BEGIN
      // ANFANG tgl. AE in Excel ausgeben
      //CLEAR(Excel);
      //REPEAT
      //UNTIL ISCLEAR(Excel);
      //CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Vertreter,'%1','SST');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      IF wshFile.FileExists('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Simon\AE_mtl.xlsx') THEN wshFile.DeleteFile('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Simon\AE_mtl.xlsx');
      //IF ERASE('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Simon\AE_mtl.xlsx')THEN;
      Book.SaveAs('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Simon\AE_mtl.xlsx');
      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Sylke@1140023();
    BEGIN
      // ANFANG tgl. AE in Excel ausgeben
      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      //CLEAR(Excel);
      //REPEAT
      //UNTIL ISCLEAR(Excel);
      //CREATE(Excel,FALSE,TRUE);

      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);

      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      IF wshFile.FileExists('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Sylke\Gesamt.xlsx') THEN wshFile.DeleteFile('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Sylke\Gesamt.xlsx');
      //IF ERASE('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Sylke\Gesamt.xlsx')THEN;
      Book.SaveAs('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Sylke\Gesamt.xlsx');
      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Thomas@1140024();
    BEGIN
      // ANFANG tgl. AE in Excel ausgeben
      //CLEAR(Excel);
      //REPEAT
      //UNTIL ISCLEAR(Excel);
      //CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);

      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      IF wshFile.FileExists('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Thomas\AE_mtl.xlsx') THEN wshFile.DeleteFile('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Thomas\AE_mtl.xlsx');
      //IF ERASE('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Thomas\AE_mtl.xlsx')THEN;
      Book.SaveAs('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Thomas\AE_mtl.xlsx');
      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Torsten@1140054();
    BEGIN
      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Vertreter,'%1','TW');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      IF wshFile.FileExists('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Torsten\AE_mtl.xlsx') THEN wshFile.DeleteFile('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Torsten\AE_mtl.xlsx');
      //IF ERASE('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Torsten\AE_mtl.xlsx')THEN;
      Book.SaveAs('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Torsten\AE_mtl.xlsx');
      Book.Close(TRUE);
    END;

    PROCEDURE Werner@1140025();
    BEGIN
      // ANFANG tgl. AE in Excel ausgeben
      //CLEAR(Excel);
      //REPEAT
      //UNTIL ISCLEAR(Excel);
      //CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Vertreter,'%1','WG');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      IF wshFile.FileExists('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Werner\AE_mtl.xlsx') THEN wshFile.DeleteFile('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Werner\AE_mtl.xlsx');
      //IF ERASE('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Werner\AE_mtl.xlsx')THEN;
      Book.SaveAs('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Werner\AE_mtl.xlsx');
      Book.Close(TRUE);

      Excel.Quit;
    END;

    PROCEDURE AE_Verteilung_mtl@1140027();
    BEGIN
      ACS_mtl;
      Christian_mtl;
      Edeltraut_mtl;
      Hendrik_mtl;
      Maria_mtl;
      //Mirjam_mtl;   //  wird zur Zeit nicht ben”tigt
      Nadine_mtl;
      Michael_mtl;   //  wird zur Zeit fr Michael benutzt
      Renate_mtl;
      Simon_mtl;
      Sylke_mtl;
      Thomas_mtl;
      Torsten_mtl;
      Werner_mtl;
    END;

    PROCEDURE AE_Verteilung_xx@1140029();
    BEGIN
      // ANFANG tgl. AE in Excel ausgeben  Gesamtliste nach vorgegebenem Datum
      //CLEAR(Excel);
      //REPEAT
      //UNTIL ISCLEAR(Excel);
      //CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      //AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1','CB');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      IF wshFile.FileExists(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Sylke\')+(Filename)) THEN wshFile.DeleteFile(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Sylke\')+(Filename));
      Book.SaveAs(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Sylke\')+(Filename));
      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE ACS_mtl@1140028();
    BEGIN
      // ANFANG tgl. AE in Excel ausgeben
      CLEAR(Excel);
      REPEAT
      UNTIL ISCLEAR(Excel);
      CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETCURRENTKEY(Datum,AU_Nr,POS_Nr,Deb_Nr,Belegart);
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Linie,'%1|%2|%3|%4','ACT','ACI','ACC','ACS');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      IF wshFile.FileExists(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\ACS\')+(Filename)) THEN wshFile.DeleteFile(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\ACS\')+(Filename));
      Book.SaveAs(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\ACS\')+(Filename));
      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Christian_mtl@1140030();
    BEGIN
      // ANFANG tgl. AE in Excel ausgeben
      //CLEAR(Excel);
      //REPEAT
      //UNTIL ISCLEAR(Excel);
      //CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1','CB');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      IF wshFile.FileExists(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Christian\')+(Filename)) THEN wshFile.DeleteFile(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Christian\')+(Filename));
      Book.SaveAs(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Christian\')+(Filename));
      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Edeltraut_mtl@1140031();
    BEGIN
      // ANFANG mtl. AE in Excel ausgeben
      //CLEAR(Excel);
      //REPEAT
      //UNTIL ISCLEAR(Excel);
      //CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1|%2','ESK','NM');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      {
      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1','ML');
      AE_mtl.SETFILTER(AE_mtl.Vertreter,'%1|%2|%3','ESK','TWO','TWN');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      //AE_mtl.RESET;
      //AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      //AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      //AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1','ML');
      //AE_mtl.SETFILTER(AE_mtl.Vertreter,'%1','TB');
      //AE_mtl.SETFILTER(AE_mtl.Gebietscode,'%1|%2','OST','NORD');
      //IF AE_mtl.FINDFIRST THEN BEGIN
      //REPEAT
      //Sheet.Range('A'+j).Value := AE_mtl.Datum;
      //Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      //Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      //Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      //Sheet.Range('E'+j).Value := AE_mtl.Menge;
      //Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      //Sheet.Range('G'+j).Value := AE_mtl.Lager;
      //Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      //Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      //Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      //Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      //Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      //Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      //Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      //Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      //Sheet.Range('P'+j).Value := AE_mtl.Linie;
      //Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      //Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      //Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      //Sheet.Range('T'+j).Value := AE_mtl.Teams;
      //Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      //j:=INCSTR(j);
      //UNTIL AE_mtl.NEXT=0;
      //END;

      }

      IF wshFile.FileExists(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Edeltraut\')+(Filename)) THEN wshFile.DeleteFile(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Edeltraut\')+(Filename));
      Book.SaveAs(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Edeltraut\')+(Filename));
      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Hendrik_mtl@1140032();
    BEGIN
      // ANFANG tgl. AE in Excel ausgeben
      //CLEAR(Excel);
      //REPEAT
      //UNTIL ISCLEAR(Excel);
      //CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1|%2','HB','LD');
      AE_mtl.ASCENDING:=FALSE;
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      {
      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1','ML');
      AE_mtl.SETFILTER(AE_mtl.Vertreter,'%1|%2|%3','HB','TWSO','TWSW');
      AE_mtl.ASCENDING:=FALSE;
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      }
      IF wshFile.FileExists(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Hendrik\')+(Filename)) THEN wshFile.DeleteFile(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Hendrik\')+(Filename));
      Book.SaveAs(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Hendrik\')+(Filename));
      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Maria_mtl@1140008();
    BEGIN
      // ANFANG mtl. AE in Excel ausgeben
      //CLEAR(Excel);
      //REPEAT
      //UNTIL ISCLEAR(Excel);
      //CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet

      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1|%2','ML','IF');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      IF wshFile.FileExists(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Maria\')+(Filename)) THEN wshFile.DeleteFile(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Maria\')+(Filename));
      Book.SaveAs(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Maria\')+(Filename));
      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Maria_mtl_system@1140063();
    BEGIN
      // ANFANG mtl. AE in Excel ausgeben
      //CLEAR(Excel);
      //REPEAT
      //UNTIL ISCLEAR(Excel);
      //CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet

      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1|%2|%3','ML','IF','RL');
      AE_mtl.SETFILTER(AE_mtl.Gebietscode,'%1','SYSTEM');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      IF wshFile.FileExists(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Maria\SYSTEM')+(Filename)) THEN wshFile.DeleteFile(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Maria\SYSTEM')+(Filename));
      Book.SaveAs(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Maria\SYSTEM')+(Filename));
      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Mirjam_mtl@1140034();
    BEGIN
      // ANFANG mtl. AE in Excel ausgeben
      //CLEAR(Excel);
      //REPEAT
      //UNTIL ISCLEAR(Excel);
      //CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet

      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1|%2|%3','MA','MK','IF');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1','ML');
      AE_mtl.SETFILTER(AE_mtl.Vertreter,'%1|%2|%3','MK','MA','IF');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      IF wshFile.FileExists(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Inna\')+(Filename)) THEN wshFile.DeleteFile(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Inna\')+(Filename));
      Book.SaveAs(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Inna\')+(Filename));
      IF wshFile.FileExists(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Mirjam\')+(Filename)) THEN wshFile.DeleteFile(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Mirjam\')+(Filename));
      Book.SaveAs(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Mirjam\')+(Filename));
      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Nadine_mtl@1140035();
    BEGIN
      // ANFANG mtl. AE in Excel ausgeben
      //CLEAR(Excel);
      //REPEAT
      //UNTIL ISCLEAR(Excel);
      //CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet

      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1','NM');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      IF wshFile.FileExists(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Nadine\')+(Filename)) THEN wshFile.DeleteFile(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Nadine\')+(Filename));
      Book.SaveAs(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Nadine\')+(Filename));
      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Michael_mtl@1140036();
    BEGIN
      //  wird momentan fr Michael benutzt


      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet

      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Vertreter,'%1','MB');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      IF wshFile.FileExists(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Michael\')+(Filename)) THEN wshFile.DeleteFile(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Michael\')+(Filename));
      Book.SaveAs(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Michael\')+(Filename));
      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Renate_mtl@1140037();
    BEGIN
      // ANFANG mtl. AE in Excel ausgeben
      //CLEAR(Excel);
      //REPEAT
      //UNTIL ISCLEAR(Excel);
      //CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1|%2','RL','CB');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      {
      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1','ML');
      AE_mtl.SETFILTER(AE_mtl.Vertreter,'%1|%2|%3|%4|%5|%6','RL','MK','TWW','TWE','TWA','IF');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      }
      IF wshFile.FileExists(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Renate\')+(Filename)) THEN wshFile.DeleteFile(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Renate\')+(Filename));
      Book.SaveAs(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Renate\')+(Filename));
      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Simon_mtl@1140038();
    BEGIN
      // ANFANG mtl. AE in Excel ausgeben
      //CLEAR(Excel);
      //REPEAT
      //UNTIL ISCLEAR(Excel);
      //CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet

      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Vertreter,'%1','SST');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      IF wshFile.FileExists(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Simon\')+(Filename)) THEN wshFile.DeleteFile(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Simon\')+(Filename));
      Book.SaveAs(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Simon\')+(Filename));
      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Sylke_mtl@1140039();
    BEGIN
      // ANFANG mtl. AE in Excel ausgeben
      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      //CLEAR(Excel);
      //REPEAT
      //UNTIL ISCLEAR(Excel);
      //CREATE(Excel,FALSE,TRUE);

      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet

      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';

      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);

      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      IF wshFile.FileExists(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Sylke\')+(Filename)) THEN wshFile.DeleteFile(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Sylke\')+(Filename));
      Book.SaveAs(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Sylke\')+(Filename));
      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Thomas_mtl@1140040();
    BEGIN
      // ANFANG mtl. AE in Excel ausgeben
      //CLEAR(Excel);
      //REPEAT
      //UNTIL ISCLEAR(Excel);
      //CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel

      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);

      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      IF wshFile.FileExists(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Thomas\')+(Filename)) THEN wshFile.DeleteFile(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Thomas\')+(Filename));
      Book.SaveAs(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Thomas\')+(Filename));
      Book.Close(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Torsten_mtl@1140055();
    BEGIN
      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;
                                       //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';

      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Vertreter,'%1','TW');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      IF wshFile.FileExists(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Torsten\')+(Filename)) THEN wshFile.DeleteFile(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Torsten\')+(Filename));
      Book.SaveAs(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Torsten\')+(Filename));
      Book.Close(TRUE);
    END;

    PROCEDURE Werner_mtl@1140041();
    BEGIN
      // ANFANG mtl. AE in Excel ausgeben
      //CLEAR(Excel);
      //REPEAT
      //UNTIL ISCLEAR(Excel);
      //CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;
                                       //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';

      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Vertreter,'%1','WG');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      IF wshFile.FileExists(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Werner\')+(Filename)) THEN wshFile.DeleteFile(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Werner\')+(Filename));
      Book.SaveAs(('F:\Daten Neu\Gemeinsame Ordner\Auftragseingang\Werner\')+(Filename));
      Book.Close(TRUE);
      Excel.Quit;
    END;

    PROCEDURE "aktuellen BB einfgen"@1140012();
    BEGIN
      //  ANFANG  L”schen und umbenennen von alten S„tzen
      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','BEšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','AL2');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
        tab_ab_bw.DELETE;
      UNTIL tab_ab_bw.NEXT=0;
      END;

      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','BEšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','AL1');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
        tab_ab_bw.Art:='AL2';
        tab_ab_bw.MODIFY;
      UNTIL tab_ab_bw.NEXT=0;
      END;

      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','BEšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','ALT');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
        tab_ab_bw.Art:='AL1';
        tab_ab_bw.MODIFY;
      UNTIL tab_ab_bw.NEXT=0;
      END;

      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','BEšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','NEU');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
        tab_ab_bw.Art:='ALT';
        tab_ab_bw.MODIFY;
      UNTIL tab_ab_bw.NEXT=0;
      END;

      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','BEšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','ALT');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
        tab_ab_bw.Status:='NN';
        tab_ab_bw.Stat_Artikel:='NN';
        tab_ab_bw.Stat_Menge:='NN';
        tab_ab_bw.Stat_EK:='NN';
        tab_ab_bw.Stat_VK:='NN';
        tab_ab_bw.MODIFY;
      UNTIL tab_ab_bw.NEXT=0;
      END;
      //  ENDE  L”schen und umbenennen von alten S„tzen




      // ANFANG Einfgen von neuem BB
      tab_be.RESET;
      tab_be.SETFILTER(tab_be."Document Type",'%1', tab_be."Document Type"::Order);
      tab_be.SETFILTER(tab_be.Type,'%1',tab_be.Type::Item);
      tab_be.SETFILTER(tab_be."Location Code",'%1|%2|%3|%4','ZENT','KONSI','ERSATZ','IDT');
      //tab_be.SETFILTER(tab_be."Outstanding Quantity",'>%1',0);
       IF tab_be.FIND('-')  THEN BEGIN
       REPEAT
          tab_ab_bw.INIT;
                 tab_ab_bw.Belegart:='BEšW';
                 tab_ab_bw.Datum:=AE_holen_Datum;
                 tab_ab_bw.AU_Nr:=tab_be."Document No.";
                 tab_ab_bw.POS_Nr:=tab_be."Line No.";
                 tab_ab_bw.Deb_Nr:=tab_be."Buy-from Vendor No.";
                 tab_ab_bw.Artikel:=tab_be."No.";
                 tab_ab_bw.Menge:=tab_be.Quantity;
                 tab_ab_bw.Restmenge:=tab_be."Outstanding Quantity";
                 tab_ab_bw.EK:=tab_be."Direct Unit Cost";
                 tab_ab_bw."Best„tigt LD":=tab_be."Promised Receipt Date";
                 tab_ab_bw.Wunschdatum:=tab_be."Requested Receipt Date";
                 tab_ab_bw.Status:='NN';
                 tab_ab_bw.Art:='NEU';
                 tab_ab_bw."EK Gesamt":=ROUND(((tab_be.Quantity)*(tab_be."Direct Unit Cost")),2);
                 tab_ab_bw.Lager:=tab_be."Location Code";
                 tab_ab_bw."DB %":=tab_be."Profit %";
                 tab_ab_bw.Linie:=tab_be."Manufacturer Code";
                 tab_ab_bw.Debitor:=tab_be.Description;
                  tab_bek.RESET;
                  tab_bek.SETFILTER(tab_bek."No.",'%1',tab_ab_bw.AU_Nr);
                   IF tab_bek.FINDFIRST THEN
                    BEGIN
      //              tab_ab_bw.Debitor:=tab_bek."Sell-to Customer Name";
                    tab_ab_bw.W„hrungscode:=tab_bek."Currency Code";
                    tab_ab_bw.Auftragsdatum:=tab_bek."Order Date";
      //              tab_ab_bw.Betreuer:=tab_bek."Betreuer Innendienst";
      //              tab_ab_bw.Vertreter:=tab_bek."Salesperson Code";
      //              tab_ab_bw.Teams:=tab_bek.Teams;
      //              tab_ab_bw.Plz:=tab_bek."Sell-to Post Code";
                   END;
          tab_ab_bw.INSERT;
       UNTIL tab_be.NEXT=0;
      END;
      "Linien umsetzen";
    END;

    PROCEDURE "Linien umsetzen"@1140013();
    BEGIN
      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Linie,'%1..%2','00','99');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
       REPEAT
      //  IF tab_ab_bw.Linie='00' THEN tab_ab_bw.Linie:='IDT';
        IF tab_ab_bw.Linie='01' THEN tab_ab_bw.Linie:='LSI';
      //  IF tab_ab_bw.Linie='02' THEN tab_ab_bw.Linie:='FUM';
      //  IF tab_ab_bw.Linie='03' THEN tab_ab_bw.Linie:='SCN';
        IF tab_ab_bw.Linie='04' THEN tab_ab_bw.Linie:='XMO';
        IF tab_ab_bw.Linie='05' THEN tab_ab_bw.Linie:='BTC';
      //  IF tab_ab_bw.Linie='06' THEN tab_ab_bw.Linie:='SMT';
        IF tab_ab_bw.Linie='07' THEN tab_ab_bw.Linie:='GEO';
        IF tab_ab_bw.Linie='08' THEN tab_ab_bw.Linie:='GSC';
      //  IF tab_ab_bw.Linie='09' THEN tab_ab_bw.Linie:='ART';
      //  IF tab_ab_bw.Linie='10' THEN tab_ab_bw.Linie:='ZOR';
        IF tab_ab_bw.Linie='11' THEN tab_ab_bw.Linie:='ECT';
        IF tab_ab_bw.Linie='12' THEN tab_ab_bw.Linie:='NEX';
      //  IF tab_ab_bw.Linie='13' THEN tab_ab_bw.Linie:='NET';
        IF tab_ab_bw.Linie='14' THEN tab_ab_bw.Linie:='FOX';
      //  IF tab_ab_bw.Linie='15' THEN tab_ab_bw.Linie:='CAV';
        IF tab_ab_bw.Linie='16' THEN tab_ab_bw.Linie:='VIA';
        IF tab_ab_bw.Linie='17' THEN tab_ab_bw.Linie:='DSP';
        IF tab_ab_bw.Linie='18' THEN tab_ab_bw.Linie:='HIF';
        IF tab_ab_bw.Linie='19' THEN tab_ab_bw.Linie:='PAI';
        IF tab_ab_bw.Linie='20' THEN tab_ab_bw.Linie:='WIL';
      //  IF tab_ab_bw.Linie='21' THEN tab_ab_bw.Linie:='TSC';
        IF tab_ab_bw.Linie='22' THEN tab_ab_bw.Linie:='SIL';
        IF tab_ab_bw.Linie='30' THEN tab_ab_bw.Linie:='ICP';
        IF tab_ab_bw.Linie='31' THEN tab_ab_bw.Linie:='STR';
      //  IF tab_ab_bw.Linie='34' THEN tab_ab_bw.Linie:='PAR';
      //  IF tab_ab_bw.Linie='37' THEN tab_ab_bw.Linie:='SYN';
      //  IF tab_ab_bw.Linie='39' THEN tab_ab_bw.Linie:='UBI';
        IF tab_ab_bw.Linie='40' THEN tab_ab_bw.Linie:='RIC';
        IF tab_ab_bw.Linie='43' THEN tab_ab_bw.Linie:='OVT';
        IF tab_ab_bw.Linie='44' THEN tab_ab_bw.Linie:='OVM';
      //  IF tab_ab_bw.Linie='45' THEN tab_ab_bw.Linie:='SIM';
      //  IF tab_ab_bw.Linie='48' THEN tab_ab_bw.Linie:='PLX';
      //  IF tab_ab_bw.Linie='49' THEN tab_ab_bw.Linie:='TEC';
      //  IF tab_ab_bw.Linie='51' THEN tab_ab_bw.Linie:='INV';
        IF tab_ab_bw.Linie='52' THEN tab_ab_bw.Linie:='ACT';
        IF tab_ab_bw.Linie='53' THEN tab_ab_bw.Linie:='ACI';
        IF tab_ab_bw.Linie='54' THEN tab_ab_bw.Linie:='GSI';
        IF tab_ab_bw.Linie='55' THEN tab_ab_bw.Linie:='AKS';
        IF tab_ab_bw.Linie='56' THEN tab_ab_bw.Linie:='IKA';
        IF tab_ab_bw.Linie='57' THEN tab_ab_bw.Linie:='ACC';
      IF tab_ab_bw.Linie='5710' THEN tab_ab_bw.Linie:='ACA';
      IF tab_ab_bw.Linie='5720' THEN tab_ab_bw.Linie:='ACP';
      IF tab_ab_bw.Linie='5730' THEN tab_ab_bw.Linie:='ASS';
        IF tab_ab_bw.Linie='58' THEN tab_ab_bw.Linie:='ACL';
        IF tab_ab_bw.Linie='59' THEN tab_ab_bw.Linie:='ACS';
      //  IF tab_ab_bw.Linie='60' THEN tab_ab_bw.Linie:='SSC';
      //  IF tab_ab_bw.Linie='61' THEN tab_ab_bw.Linie:='JEL';
      //  IF tab_ab_bw.Linie='65' THEN tab_ab_bw.Linie:='WWC';
      //  IF tab_ab_bw.Linie='66' THEN tab_ab_bw.Linie:='SYC';
      //  IF tab_ab_bw.Linie='68' THEN tab_ab_bw.Linie:='WML';
        IF tab_ab_bw.Linie='69' THEN tab_ab_bw.Linie:='CIR';
      //  IF tab_ab_bw.Linie='73' THEN tab_ab_bw.Linie:='C2M';
        IF tab_ab_bw.Linie='74' THEN tab_ab_bw.Linie:='DIG';
      //  IF tab_ab_bw.Linie='75' THEN tab_ab_bw.Linie:='PHY';
      //  IF tab_ab_bw.Linie='76' THEN tab_ab_bw.Linie:='SBT';
      //  IF tab_ab_bw.Linie='77' THEN tab_ab_bw.Linie:='CEC';
        IF tab_ab_bw.Linie='78' THEN tab_ab_bw.Linie:='HAL';
      //  IF tab_ab_bw.Linie='79' THEN tab_ab_bw.Linie:='ASD';
      //  IF tab_ab_bw.Linie='80' THEN tab_ab_bw.Linie:='MAG';
      //  IF tab_ab_bw.Linie='81' THEN tab_ab_bw.Linie:='INI';
        IF tab_ab_bw.Linie='82' THEN tab_ab_bw.Linie:='SPL';
      //  IF tab_ab_bw.Linie='83' THEN tab_ab_bw.Linie:='RLI';
      //  IF tab_ab_bw.Linie='84' THEN tab_ab_bw.Linie:='ANS';
        IF tab_ab_bw.Linie='85' THEN tab_ab_bw.Linie:='FER';
        IF tab_ab_bw.Linie='86' THEN tab_ab_bw.Linie:='FES';
        IF tab_ab_bw.Linie='87' THEN tab_ab_bw.Linie:='FET';
        IF tab_ab_bw.Linie='88' THEN tab_ab_bw.Linie:='WIS';
        IF tab_ab_bw.Linie='89' THEN tab_ab_bw.Linie:='WIT';
        IF tab_ab_bw.Linie='96' THEN tab_ab_bw.Linie:='TSG';
        IF tab_ab_bw.Linie='9610' THEN tab_ab_bw.Linie:='ASP';
        IF tab_ab_bw.Linie='9620' THEN tab_ab_bw.Linie:='FEP';
        IF tab_ab_bw.Linie='9630' THEN tab_ab_bw.Linie:='WIP';
        IF tab_ab_bw.Linie='97' THEN tab_ab_bw.Linie:='SON';
        IF tab_ab_bw.Linie='98' THEN tab_ab_bw.Linie:='SON';
        IF tab_ab_bw.Linie='99' THEN tab_ab_bw.Linie:='TOP';

        tab_ab_bw.MODIFY;
       UNTIL tab_ab_bw.NEXT=0;

      END;




      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Linie,'%1..%2','00','99');
      IF AE_mtl.FINDFIRST THEN BEGIN
       REPEAT
      //  IF AE_mtl.Linie='00' THEN AE_mtl.Linie:='IDT';
        IF AE_mtl.Linie='01' THEN AE_mtl.Linie:='LSI';
      //  IF AE_mtl.Linie='02' THEN AE_mtl.Linie:='FUM';
      //  IF AE_mtl.Linie='03' THEN AE_mtl.Linie:='SCN';
        IF AE_mtl.Linie='04' THEN AE_mtl.Linie:='XMO';
        IF AE_mtl.Linie='05' THEN AE_mtl.Linie:='BTC';
      //  IF AE_mtl.Linie='06' THEN AE_mtl.Linie:='SMT';
        IF AE_mtl.Linie='07' THEN AE_mtl.Linie:='GEO';
        IF AE_mtl.Linie='08' THEN AE_mtl.Linie:='GSC';
      //  IF AE_mtl.Linie='09' THEN AE_mtl.Linie:='ART';
      //  IF AE_mtl.Linie='10' THEN AE_mtl.Linie:='ZOR';
        IF AE_mtl.Linie='11' THEN AE_mtl.Linie:='ECT';
        IF AE_mtl.Linie='12' THEN AE_mtl.Linie:='NEX';
      //  IF AE_mtl.Linie='13' THEN AE_mtl.Linie:='NET';
        IF AE_mtl.Linie='14' THEN AE_mtl.Linie:='FOX';
      //  IF AE_mtl.Linie='15' THEN AE_mtl.Linie:='CAV';
        IF AE_mtl.Linie='16' THEN AE_mtl.Linie:='VIA';
        IF AE_mtl.Linie='17' THEN AE_mtl.Linie:='DSP';
        IF AE_mtl.Linie='18' THEN AE_mtl.Linie:='HIF';
        IF AE_mtl.Linie='19' THEN AE_mtl.Linie:='PAI';
        IF AE_mtl.Linie='20' THEN AE_mtl.Linie:='WIL';
      //  IF AE_mtl.Linie='21' THEN AE_mtl.Linie:='TSC';
        IF AE_mtl.Linie='22' THEN AE_mtl.Linie:='SIL';
        IF AE_mtl.Linie='30' THEN AE_mtl.Linie:='ICP';
        IF AE_mtl.Linie='31' THEN AE_mtl.Linie:='STR';
      //  IF AE_mtl.Linie='34' THEN AE_mtl.Linie:='PAR';
      //  IF AE_mtl.Linie='37' THEN AE_mtl.Linie:='SYN';
      //  IF AE_mtl.Linie='39' THEN AE_mtl.Linie:='UBI';
        IF AE_mtl.Linie='40' THEN AE_mtl.Linie:='RIC';
        IF AE_mtl.Linie='43' THEN AE_mtl.Linie:='OVT';
        IF AE_mtl.Linie='44' THEN AE_mtl.Linie:='OVM';
      //  IF AE_mtl.Linie='45' THEN AE_mtl.Linie:='SIM';
      //  IF AE_mtl.Linie='48' THEN AE_mtl.Linie:='PLX';
      //  IF AE_mtl.Linie='49' THEN AE_mtl.Linie:='TEC';
      //  IF AE_mtl.Linie='51' THEN AE_mtl.Linie:='INV';
        IF AE_mtl.Linie='52' THEN AE_mtl.Linie:='ACT';
        IF AE_mtl.Linie='53' THEN AE_mtl.Linie:='ACI';
        IF AE_mtl.Linie='54' THEN AE_mtl.Linie:='GSI';
        IF AE_mtl.Linie='55' THEN AE_mtl.Linie:='AKS';
        IF AE_mtl.Linie='56' THEN AE_mtl.Linie:='IKA';
        IF AE_mtl.Linie='57' THEN AE_mtl.Linie:='ACC';
      IF AE_mtl.Linie='5710' THEN AE_mtl.Linie:='ACA';
      IF AE_mtl.Linie='5720' THEN AE_mtl.Linie:='ACP';
      IF AE_mtl.Linie='5730' THEN AE_mtl.Linie:='ASS';
        IF AE_mtl.Linie='58' THEN AE_mtl.Linie:='ACL';
        IF AE_mtl.Linie='59' THEN AE_mtl.Linie:='ACS';
      //  IF AE_mtl.Linie='60' THEN AE_mtl.Linie:='SSC';
      //  IF AE_mtl.Linie='61' THEN AE_mtl.Linie:='JEL';
      //  IF AE_mtl.Linie='65' THEN AE_mtl.Linie:='WWC';
      //  IF AE_mtl.Linie='66' THEN AE_mtl.Linie:='SYC';
      //  IF AE_mtl.Linie='68' THEN AE_mtl.Linie:='WML';
        IF AE_mtl.Linie='69' THEN AE_mtl.Linie:='CIR';
      //  IF AE_mtl.Linie='73' THEN AE_mtl.Linie:='C2M';
        IF AE_mtl.Linie='74' THEN AE_mtl.Linie:='DIG';
      //  IF AE_mtl.Linie='75' THEN AE_mtl.Linie:='PHY';
      //  IF AE_mtl.Linie='76' THEN AE_mtl.Linie:='SBT';
      //  IF AE_mtl.Linie='77' THEN AE_mtl.Linie:='CEC';
        IF AE_mtl.Linie='78' THEN AE_mtl.Linie:='HAL';
      //  IF AE_mtl.Linie='79' THEN AE_mtl.Linie:='ASD';
      //  IF AE_mtl.Linie='80' THEN AE_mtl.Linie:='MAG';
      //  IF AE_mtl.Linie='81' THEN AE_mtl.Linie:='INI';
        IF AE_mtl.Linie='82' THEN AE_mtl.Linie:='SPL';
      //  IF AE_mtl.Linie='83' THEN AE_mtl.Linie:='RLI';
      //  IF AE_mtl.Linie='84' THEN AE_mtl.Linie:='ANS';
        IF AE_mtl.Linie='85' THEN AE_mtl.Linie:='FER';
        IF AE_mtl.Linie='86' THEN AE_mtl.Linie:='FES';
        IF AE_mtl.Linie='87' THEN AE_mtl.Linie:='FET';
        IF AE_mtl.Linie='88' THEN AE_mtl.Linie:='WIS';
        IF AE_mtl.Linie='89' THEN AE_mtl.Linie:='WIT';
        IF AE_mtl.Linie='96' THEN AE_mtl.Linie:='TSG';
        IF AE_mtl.Linie='9610' THEN AE_mtl.Linie:='ASP';
        IF AE_mtl.Linie='9620' THEN AE_mtl.Linie:='FEP';
        IF AE_mtl.Linie='9630' THEN AE_mtl.Linie:='WIP';
        IF AE_mtl.Linie='97' THEN AE_mtl.Linie:='SON';
        IF AE_mtl.Linie='98' THEN AE_mtl.Linie:='SON';
        IF AE_mtl.Linie='99' THEN AE_mtl.Linie:='TOP';

        AE_mtl.MODIFY;
       UNTIL AE_mtl.NEXT=0;

      END;
    END;

    PROCEDURE "BB Diff ermitteln"@1140014();
    BEGIN


      // ANFANG zurcksetzen Status auf NN zwecks Programmtests
      //        kann bei Echtbetrieb unterbleiben!!!
      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','BEšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','ALT');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
        tab_ab_bw.Status:='NN';
        tab_ab_bw.Stat_Artikel:='NN';
        tab_ab_bw.Stat_Menge:='NN';
        tab_ab_bw.Stat_EK:='NN';
        tab_ab_bw.Stat_VK:='NN';
        tab_ab_bw.MODIFY;
      UNTIL tab_ab_bw.NEXT=0;
      END;
      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','BEšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','NEU');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
        tab_ab_bw.Status:='NN';
        tab_ab_bw.Stat_Artikel:='NN';
        tab_ab_bw.Stat_Menge:='NN';
        tab_ab_bw.Stat_EK:='NN';
        tab_ab_bw.Stat_VK:='NN';
        tab_ab_bw.MODIFY;
      UNTIL tab_ab_bw.NEXT=0;
      END;
      // ENDE zurcksetzen Status auf NN zwecks Programmtests


      //  ANFANG Vergleich zwischen NEU und ALT (tab_ab_bw=NEU  und prf=ALT)
      //  ANFANG Diff. feststellen Artikel, Menge, EK, VK
      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','BEšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','NEU');
      IF tab_ab_bw.FIND('-') THEN BEGIN
      REPEAT
      prf.RESET;
      prf.SETFILTER(prf.Belegart,'%1','BEšW');
      prf.SETFILTER(prf.AU_Nr,'%1',tab_ab_bw.AU_Nr);
      prf.SETFILTER(prf.POS_Nr,'%1',tab_ab_bw.POS_Nr);
      prf.SETFILTER(prf.Art,'%1','ALT');
      IF prf.FIND('-') THEN BEGIN
        IF prf.Artikel=tab_ab_bw.Artikel THEN BEGIN
          tab_ab_bw.Stat_Artikel:='OK';
          prf.Stat_Artikel:='OK';
        END ELSE BEGIN
          tab_ab_bw.Stat_Artikel:='AF';
          tab_ab_bw.Status:='ŽN';
          prf.Stat_Artikel:='AF';
          prf.Status:='ŽN';
        END;

        IF prf.Menge=tab_ab_bw.Menge THEN BEGIN
         tab_ab_bw.Stat_Menge:='OK';
         prf.Stat_Menge:='OK';
      // ANFANG  Rechnungsmengenprfung bei Menge OK
            IF prf.Restmenge=tab_ab_bw.Restmenge THEN BEGIN
            END ELSE BEGIN
             tab_ab_bw.Stat_Menge:='MR';
             tab_ab_bw.Status:='ŽN';
             prf.Stat_Menge:='MR';
             prf.Status:='ŽN';
            END;
      // ENDE  Rechnungsmengenprfung bei Menge OK
        END ELSE BEGIN
         tab_ab_bw.Stat_Menge:='MF';
         tab_ab_bw.Status:='ŽN';
         prf.Stat_Menge:='MF';
         prf.Status:='ŽN';
        END;

        IF prf.Restmenge=tab_ab_bw.Restmenge THEN BEGIN
        END ELSE BEGIN
         tab_ab_bw.Stat_Menge:='MR';
         tab_ab_bw.Status:='ŽN';
         prf.Stat_Menge:='MR';
         prf.Status:='ŽN';
        END;


        IF prf.EK=tab_ab_bw.EK THEN BEGIN
         tab_ab_bw.Stat_EK:='OK';
         prf.Stat_EK:='OK';
        END ELSE BEGIN
         tab_ab_bw.Stat_EK:='EF';
         tab_ab_bw.Status:='ŽN';
         prf.Stat_EK:='EF';
         prf.Status:='ŽN';
        END;

      //  IF prf.VK=tab_ab_bw.VK THEN BEGIN
      //   tab_ab_bw.Stat_VK:='OK';
      //   prf.Stat_VK:='OK';
      //  END ELSE BEGIN
      //   tab_ab_bw.Stat_VK:='VF';
      //   tab_ab_bw.Status:='ŽN';
      //   prf.Stat_VK:='VF';
      //   prf.Status:='ŽN';
      //  END;
        tab_ab_bw.MODIFY;
        prf.MODIFY;
      END;
      UNTIL tab_ab_bw.NEXT=0;
      END;
      //  ENDE Diff. feststellen Artikel, Menge, EK, VK
      //  ANFANG Status auf OK setzen, wenn keine Abweichnung vorliegt
      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','BEšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','NEU');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_Artikel,'%1','OK');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_Menge,'%1','OK');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_EK,'%1','OK');
      //tab_ab_bw.SETFILTER(tab_ab_bw.Stat_VK,'%1','OK');
      IF tab_ab_bw.FIND('-') THEN BEGIN
      REPEAT
       tab_ab_bw.Status:='OK';
       tab_ab_bw.MODIFY;
      UNTIL tab_ab_bw.NEXT=0;
      END;

      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','BEšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','ALT');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_Artikel,'%1','OK');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_Menge,'%1','OK');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_EK,'%1','OK');
      //tab_ab_bw.SETFILTER(tab_ab_bw.Stat_VK,'%1','OK');
      IF tab_ab_bw.FIND('-') THEN BEGIN
      REPEAT
       tab_ab_bw.Status:='OK';
       tab_ab_bw.MODIFY;
      UNTIL tab_ab_bw.NEXT=0;
      END;
      //  ENDE   Status auf OK setzen, wenn keine Abweichnung vorliegt

      //  ANFANG Feststellen, ob neuer Auftrag/Pos vorliegt
      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','BEšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','NEU');
      tab_ab_bw.SETFILTER(tab_ab_bw.Status,'%1','NN');
      IF tab_ab_bw.FIND('-') THEN BEGIN
      REPEAT

       prf.RESET;
       tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','BEšW');
       prf.SETFILTER(prf.Art,'%1','ALT');
       prf.SETFILTER(prf.AU_Nr,'%1',tab_ab_bw.AU_Nr);
        IF prf.FINDFIRST THEN BEGIN
      //  Neue Position zu altem Auftrag
              tab_ab_bw.Status:='NP';
              tab_ab_bw.MODIFY;
        END ELSE BEGIN
      //  Neuer Auftrag
           tab_ab_bw.Status:='NA';
           tab_ab_bw.MODIFY;

        END;
      UNTIL tab_ab_bw.NEXT=0;
      END;
      //  ENDE   Feststellen, ob neuer Auftrag/Pos vorliegt

      // ANFANG  Feststellen, ob ein Auftrag/Pos storniert wurde
      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','BEšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','ALT');
      tab_ab_bw.SETFILTER(tab_ab_bw.Status,'%1','NN');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
        var_re_menge:=0;
       best.RESET;
       best.SETFILTER(best."Order No.",'%1',tab_ab_bw.AU_Nr);
       best.SETFILTER(best."Order Line No.",'%1',tab_ab_bw.POS_Nr);
       IF best.FINDFIRST THEN BEGIN
         REPEAT
           tab_ab_bw.Status:='ST';
           tab_ab_bw.MODIFY;

           var_be_menge:=var_be_menge+best.Quantity;
         UNTIL best.NEXT=0;
         IF var_be_menge>0 THEN
         BEGIN
         tab_ab_bw.Status:='BE';
         END;
         tab_ab_bw.re_menge:=var_be_menge;
         tab_ab_bw.MODIFY;
        var_be_menge:=0;
       END
        ELSE BEGIN
      //  Storno der Zeile
           tab_ab_bw.Status:='ST';
           tab_ab_bw.MODIFY;
        END;
      UNTIL tab_ab_bw.NEXT=0;
      END;


      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','BEšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','ALT');
      tab_ab_bw.SETFILTER(tab_ab_bw.Status,'%1','ŽN');
      //tab_ab_bw.SETFILTER(tab_ab_bw.Stat_Menge,'%1','MR');
      //tab_ab_bw.SETFILTER(tab_ab_bw.Stat_Artikel,'%1|%2','OK','NN');
      //tab_ab_bw.SETFILTER(tab_ab_bw.Stat_EK,'%1|%2','OK','NN');
      //tab_ab_bw.SETFILTER(tab_ab_bw.Stat_VK,'%1|%2','OK','NN');

      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
        var_be_menge:=0;
       best.RESET;
       best.SETFILTER(best."Order No.",'%1',tab_ab_bw.AU_Nr);
       best.SETFILTER(best."Order Line No.",'%1',tab_ab_bw.POS_Nr);
       IF best.FINDFIRST THEN BEGIN
         REPEAT
           var_be_menge:=var_be_menge+best.Quantity;
         UNTIL best.NEXT=0;
         IF var_be_menge>0 THEN
         BEGIN
         tab_ab_bw.Status:='BE';
         END;
         tab_ab_bw.re_menge:=var_be_menge;
         tab_ab_bw.MODIFY;
        var_be_menge:=0;
       END
        ELSE BEGIN
      //  Storno der Zeile
           tab_ab_bw.Status:='ST';
           tab_ab_bw.MODIFY;
        END;
      UNTIL tab_ab_bw.NEXT=0;
      END;

      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','BEšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','NEU');
      tab_ab_bw.SETFILTER(tab_ab_bw.Status,'%1','ŽN');
      //tab_ab_bw.SETFILTER(tab_ab_bw.Stat_Menge,'%1','MR');
      //tab_ab_bw.SETFILTER(tab_ab_bw.Stat_Artikel,'%1','OK');
      //tab_ab_bw.SETFILTER(tab_ab_bw.Stat_EK,'%1','OK');
      //tab_ab_bw.SETFILTER(tab_ab_bw.Stat_VK,'%1','OK');

      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
        var_be_menge:=0;
       best.RESET;
       best.SETFILTER(best."Order No.",'%1',tab_ab_bw.AU_Nr);
       best.SETFILTER(best."Order Line No.",'%1',tab_ab_bw.POS_Nr);
       IF best.FINDFIRST THEN BEGIN
         REPEAT
           var_be_menge:=var_be_menge+best.Quantity;
         UNTIL best.NEXT=0;
         IF var_be_menge>0 THEN
         BEGIN
         tab_ab_bw.Status:='BE';
         END;
         tab_ab_bw.re_menge:=var_be_menge;
         tab_ab_bw.MODIFY;
        var_be_menge:=0;
       END
        ELSE BEGIN
      //  Storno der Zeile
           tab_ab_bw.Status:='ST';
           tab_ab_bw.MODIFY;
        END;
      UNTIL tab_ab_bw.NEXT=0;
      END;
      // ENDE    Feststellen, ob ein Auftrag/Pos storniert wurde

      // ANFANG  Feststellen, ob BE_Mengen mit AU_Mengen bereinstimmen
      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','BEšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','ALT');
      tab_ab_bw.SETFILTER(tab_ab_bw.Status,'%1','BE');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
          IF tab_ab_bw.Menge=tab_ab_bw.re_menge THEN BEGIN
            tab_ab_bw.Status:='OK';
          END ELSE BEGIN
            tab_ab_bw.Status:='GP';
          END;
          IF tab_ab_bw.Restmenge=0 THEN BEGIN
            tab_ab_bw.Status:='FA';
          END;

          tab_ab_bw.MODIFY;
      UNTIL tab_ab_bw.NEXT=0;
      END;
      //   ENDE  Feststellen, ob BE_Mengen mit AU_Mengen bereinstimmen


      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','BEšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','ALT');
      tab_ab_bw.SETFILTER(tab_ab_bw.Status,'%1','FA');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_Menge,'%1','NN');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_Artikel,'%1','NN');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_EK,'%1','NN');
      //tab_ab_bw.SETFILTER(tab_ab_bw.Stat_VK,'%1','NN');
      //tab_ab_bw.SETFILTER(tab_ab_bw.re_menge,'%1',tab_ab_bw.Menge);
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
      IF tab_ab_bw.re_menge=tab_ab_bw.Menge THEN BEGIN
        tab_ab_bw.Status:='OK';
        tab_ab_bw.MODIFY;
      END;
      UNTIL tab_ab_bw.NEXT=0;
      END;


      tab_ab_bw.RESET;
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','BEšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1','NEU');
      tab_ab_bw.SETFILTER(tab_ab_bw.Status,'%1','BE');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_Menge,'%1','MR');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_Artikel,'%1','OK');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_EK,'%1','OK');
      //tab_ab_bw.SETFILTER(tab_ab_bw.Stat_VK,'%1','OK');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
      IF ((tab_ab_bw.re_menge=tab_ab_bw.Menge) AND (tab_ab_bw.Restmenge=0)) THEN BEGIN
        tab_ab_bw.Status:='OK';
        tab_ab_bw.MODIFY;
      END;
      UNTIL tab_ab_bw.NEXT=0;
      END;

      //  ENDE   Vergleich zwischen NEU und ALT


      // //  ANFANG Differenzen in AEmtl bernehmen
      //tab_ab_bw.RESET;
      //tab_ab_bw.SETCURRENTKEY(Belegart,AU_Nr,POS_Nr,Datum);
      //tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','BEšW');
      //tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1|%2', 'NEU', 'ALT');
      //tab_ab_bw.SETFILTER(tab_ab_bw.Status,'%1|%2|%3|%4|%5|%6', 'NP', 'ŽN', 'ST', 'GP', 'FA', 'RE');
      //IF tab_ab_bw.FINDFIRST THEN BEGIN
      //REPEAT
      //    AE_mtl.INIT;
      //           AE_mtl.Datum:=tab_ab_bw.Datum;
      ////           AE_mtl.Datum:=WORKDATE;
      //           AE_mtl.AU_Nr:=tab_ab_bw.AU_Nr;
      //           AE_mtl.POS_Nr:=tab_ab_bw.POS_Nr;
      //           AE_mtl.Belegart:='AEND';
      //           AE_mtl.Debitor:=tab_ab_bw.Debitor;
      //           AE_mtl.Deb_Nr:=tab_ab_bw.Deb_Nr;
      //           AE_mtl.Artikel:=tab_ab_bw.Artikel;
      //           AE_mtl.Menge:=tab_ab_bw.Menge;
      //           AE_mtl.Restmenge:=tab_ab_bw.Restmenge;
      //           AE_mtl.EK:=tab_ab_bw.EK;
      //           AE_mtl.VK:=tab_ab_bw.VK;
      //           AE_mtl."Best„tigt LD":=tab_ab_bw."Best„tigt LD";
      //           AE_mtl.Wunschdatum:=tab_ab_bw.Wunschdatum;
      //           AE_mtl.Status:='BE';
      //           AE_mtl.Art:='TAG';
      //           AE_mtl."EK Gesamt":=tab_ab_bw."EK Gesamt";
      //           AE_mtl."VK Gesamt":=tab_ab_bw."VK Gesamt";
      //           AE_mtl.Lager:=tab_ab_bw.Lager;
      //           AE_mtl."DB %":=tab_ab_bw."DB %";
      //           AE_mtl.Linie:=tab_ab_bw.Linie;
      //           AE_mtl.Endkunde:=tab_ab_bw.Endkunde;
      //           AE_mtl.W„hrungscode:=tab_ab_bw.W„hrungscode;
      //           AE_mtl.w„_faktor:=tab_ab_bw.w„_faktor;
      //           AE_mtl.Auftragsdatum:=tab_ab_bw.Auftragsdatum;
      //           AE_mtl.Betreuer:=tab_ab_bw.Betreuer;
      //           AE_mtl.Vertreter:=tab_ab_bw.Vertreter;
      //           AE_mtl.Teams:=tab_ab_bw.Teams;
      //           AE_mtl.PLZ:=tab_ab_bw.Plz;
      //           IF AE_mtl.w„_faktor=0 THEN BEGIN
      //           AE_mtl."Betrag in EUR":=AE_mtl."VK Gesamt";
      //           END ELSE BEGIN
      //           AE_mtl."Betrag in EUR":=(AE_mtl."VK Gesamt"/AE_mtl.w„_faktor);
      //           END;


      // //            tab_vkk1.RESET;
      //  //          tab_vkk1.SETFILTER(tab_vkk1."No.",'%1',AE_mtl.AU_Nr);
      //  //           IF tab_vkk1.FINDFIRST THEN
      //  //            BEGIN
      //  //
      //  //            AE_mtl.Deb_Nr:=tab_vkk1."Sell-to Customer No.";
      //  //            AE_mtl.W„hrungscode:=tab_vkk1."Currency Code";
      //  //            AE_mtl.w„_faktor:=tab_vkk1."Currency Factor";
      //  //            AE_mtl.Auftragsdatum:=tab_vkk1."Order Date";
      //  //            AE_mtl.Betreuer:=tab_vkk1."Betreuer Innendienst";
      //  //            AE_mtl.Vertreter:=tab_vkk1."Salesperson Code";
      //  //            AE_mtl.Teams:=tab_vkk1.Teams;
      //  //            AE_mtl.PLZ:=tab_vkk1."Sell-to Post Code";
      //  //           END;
      //    AE_mtl.INSERT;

      //UNTIL tab_ab_bw.NEXT=0;
      //END;



      //  ENDE Differenzen in AEmtl bernehmen


      // ANFANG Differenzen in Excel ausgeben

      CLEAR(Excel);
      REPEAT
      UNTIL ISCLEAR(Excel);
      CREATE(Excel,FALSE,TRUE);

      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,####';

      Sheet.Range('A1').Value := 'Bestellbestandsberwachung  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'Datum';
      Sheet.Range('B2').Value := 'AU-Nr';
      Sheet.Range('C2').Value := 'Pos-Nr';
      Sheet.Range('D2').Value := 'Debitor';
      Sheet.Range('E2').Value := 'Artikel';
      Sheet.Range('F2').Value := 'Menge';
      Sheet.Range('G2').Value := 'Restmenge';
      Sheet.Range('H2').Value := 'EK';
      Sheet.Range('I2').Value := 'VK';
      Sheet.Range('J2').Value := 'Art';
      Sheet.Range('K2').Value := 'Status';
      Sheet.Range('L2').Value := 'Art Diff';
      Sheet.Range('M2').Value := 'Menge Diff';
      Sheet.Range('N2').Value := 'EK Diff';
      Sheet.Range('O2').Value := 'VK Diff';
      Sheet.Range('P2').Value := 'WŽ';
      Sheet.Range('Q2').Value := 'W„ Kurs';
      Sheet.Range('R2').Value := 'RE Menge';
      Sheet.Range('S2').Value := 'urspr AU-Datum';
      j := '3';                                   // <- Import in excel ab Zeile 3


      var_AU_Nr:='AU200000';
      tab_ab_bw.RESET;
      tab_ab_bw.SETCURRENTKEY(Belegart,AU_Nr,POS_Nr,Datum);
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','BEšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1|%2', 'NEU', 'ALT');
      tab_ab_bw.SETFILTER(tab_ab_bw.Status,'%1|%2|%3|%4|%5|%6', 'NP', 'ŽN', 'ST', 'GP', 'FA', 'BE');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
       IF tab_ab_bw.AU_Nr=var_AU_Nr THEN BEGIN
       IF tab_ab_bw.Stat_Artikel ='AF' THEN BEGIN
        Sheet.Range('A'+j).Value := tab_ab_bw.Datum;
        Sheet.Range('B'+j).Value := tab_ab_bw.AU_Nr;
        Sheet.Range('C'+j).Value := tab_ab_bw.POS_Nr;
        Sheet.Range('D'+j).Value := tab_ab_bw.Debitor;
        Sheet.Range('E'+j).Value := tab_ab_bw.Artikel;
        Sheet.Range('F'+j).Value := tab_ab_bw.Menge;
        Sheet.Range('G'+j).Value := tab_ab_bw.Restmenge;
        Sheet.Range('H'+j).Value := FORMAT(tab_ab_bw.EK);
        Sheet.Range('I'+j).Value := FORMAT(tab_ab_bw.VK);
        Sheet.Range('J'+j).Value := tab_ab_bw.Art;
        Sheet.Range('K'+j).Value := tab_ab_bw.Status;
        Sheet.Range('L'+j).Value := tab_ab_bw.Stat_Artikel;
        Sheet.Range('M'+j).Value := tab_ab_bw.Stat_Menge;
        Sheet.Range('N'+j).Value := tab_ab_bw.Stat_EK;
        Sheet.Range('O'+j).Value := tab_ab_bw.Stat_VK;
        Sheet.Range('P'+j).Value := tab_ab_bw.W„hrungscode;
        Sheet.Range('Q'+j).Value := FORMAT(tab_ab_bw.w„_faktor);
        Sheet.Range('R'+j).Value := FORMAT(tab_ab_bw.re_menge);
        Sheet.Range('S'+j).Value := tab_ab_bw.Auftragsdatum;
        j:=INCSTR(j);
        END;
       END ELSE BEGIN

       IF tab_ab_bw.Stat_Artikel ='AF' THEN BEGIN
         j:=INCSTR(j);
        Sheet.Range('A'+j).Value := tab_ab_bw.Datum;
        Sheet.Range('B'+j).Value := tab_ab_bw.AU_Nr;
        Sheet.Range('C'+j).Value := tab_ab_bw.POS_Nr;
        Sheet.Range('D'+j).Value := tab_ab_bw.Debitor;
        Sheet.Range('E'+j).Value := tab_ab_bw.Artikel;
        Sheet.Range('F'+j).Value := tab_ab_bw.Menge;
        Sheet.Range('G'+j).Value := tab_ab_bw.Restmenge;
        Sheet.Range('H'+j).Value := FORMAT(tab_ab_bw.EK);
        Sheet.Range('I'+j).Value := FORMAT(tab_ab_bw.VK);
        Sheet.Range('J'+j).Value := tab_ab_bw.Art;
        Sheet.Range('K'+j).Value := tab_ab_bw.Status;
        Sheet.Range('L'+j).Value := tab_ab_bw.Stat_Artikel;
        Sheet.Range('M'+j).Value := tab_ab_bw.Stat_Menge;
        Sheet.Range('N'+j).Value := tab_ab_bw.Stat_EK;
        Sheet.Range('O'+j).Value := tab_ab_bw.Stat_VK;
        Sheet.Range('P'+j).Value := tab_ab_bw.W„hrungscode;
        Sheet.Range('Q'+j).Value := FORMAT(tab_ab_bw.w„_faktor);
        Sheet.Range('R'+j).Value := FORMAT(tab_ab_bw.re_menge);
        Sheet.Range('S'+j).Value := tab_ab_bw.Auftragsdatum;
        j:=INCSTR(j);
        END;
        var_AU_Nr :=tab_ab_bw.AU_Nr;
       END;
      UNTIL tab_ab_bw.NEXT=0;
      END;

      var_AU_Nr:='AU200000';
      tab_ab_bw.RESET;
      tab_ab_bw.SETCURRENTKEY(Belegart,AU_Nr,POS_Nr,Datum);
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','BEšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1|%2', 'NEU', 'ALT');
      tab_ab_bw.SETFILTER(tab_ab_bw.Stat_Artikel,'<>%1','AF');
      tab_ab_bw.SETFILTER(tab_ab_bw.Status,'%1|%2|%3|%4|%5|%6', 'NP', 'ŽN', 'ST', 'GP', 'FA', 'BE');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
       IF tab_ab_bw.AU_Nr=var_AU_Nr THEN BEGIN
        Sheet.Range('A'+j).Value := tab_ab_bw.Datum;
        Sheet.Range('B'+j).Value := tab_ab_bw.AU_Nr;
        Sheet.Range('C'+j).Value := tab_ab_bw.POS_Nr;
        Sheet.Range('D'+j).Value := tab_ab_bw.Debitor;
        Sheet.Range('E'+j).Value := tab_ab_bw.Artikel;
        Sheet.Range('F'+j).Value := tab_ab_bw.Menge;
        Sheet.Range('G'+j).Value := tab_ab_bw.Restmenge;
        Sheet.Range('H'+j).Value := FORMAT(tab_ab_bw.EK);
        Sheet.Range('I'+j).Value := FORMAT(tab_ab_bw.VK);
        Sheet.Range('J'+j).Value := tab_ab_bw.Art;
        Sheet.Range('K'+j).Value := tab_ab_bw.Status;
        Sheet.Range('L'+j).Value := tab_ab_bw.Stat_Artikel;
        Sheet.Range('M'+j).Value := tab_ab_bw.Stat_Menge;
        Sheet.Range('N'+j).Value := tab_ab_bw.Stat_EK;
        Sheet.Range('O'+j).Value := tab_ab_bw.Stat_VK;
        Sheet.Range('P'+j).Value := tab_ab_bw.W„hrungscode;
        Sheet.Range('Q'+j).Value := FORMAT(tab_ab_bw.w„_faktor);
        Sheet.Range('R'+j).Value := FORMAT(tab_ab_bw.re_menge);
        Sheet.Range('S'+j).Value := tab_ab_bw.Auftragsdatum;
        j:=INCSTR(j);
       END ELSE BEGIN
         j:=INCSTR(j);
        Sheet.Range('A'+j).Value := tab_ab_bw.Datum;
        Sheet.Range('B'+j).Value := tab_ab_bw.AU_Nr;
        Sheet.Range('C'+j).Value := tab_ab_bw.POS_Nr;
        Sheet.Range('D'+j).Value := tab_ab_bw.Debitor;
        Sheet.Range('E'+j).Value := tab_ab_bw.Artikel;
        Sheet.Range('F'+j).Value := tab_ab_bw.Menge;
        Sheet.Range('G'+j).Value := tab_ab_bw.Restmenge;
        Sheet.Range('H'+j).Value := FORMAT(tab_ab_bw.EK);
        Sheet.Range('I'+j).Value := FORMAT(tab_ab_bw.VK);
        Sheet.Range('J'+j).Value := tab_ab_bw.Art;
        Sheet.Range('K'+j).Value := tab_ab_bw.Status;
        Sheet.Range('L'+j).Value := tab_ab_bw.Stat_Artikel;
        Sheet.Range('M'+j).Value := tab_ab_bw.Stat_Menge;
        Sheet.Range('N'+j).Value := tab_ab_bw.Stat_EK;
        Sheet.Range('O'+j).Value := tab_ab_bw.Stat_VK;
        Sheet.Range('P'+j).Value := tab_ab_bw.W„hrungscode;
        Sheet.Range('Q'+j).Value := FORMAT(tab_ab_bw.w„_faktor);
        Sheet.Range('R'+j).Value := FORMAT(tab_ab_bw.re_menge);
        Sheet.Range('S'+j).Value := tab_ab_bw.Auftragsdatum;
        j:=INCSTR(j);
        var_AU_Nr :=tab_ab_bw.AU_Nr;
       END;
      UNTIL tab_ab_bw.NEXT=0;
      END;


      Book.SaveAs(('F:\Daten Neu\User\Joachim\AB-Differenzen\')+(bb_Filename));
      Book.Close(TRUE);
      Excel.Quit;

      // ENDE Differenzen in Excel ausgeben
      MESSAGE(' Differenzen wurden ordnungsgem„á nach Excel exportiert. ');
    END;

    PROCEDURE Auftrag_sichern@1140015();
    BEGIN

      // ANFANG Einfgen von neuem AU
      AE_mtl.RESET;
      tab_ab.RESET;
      tab_vkk.RESET;
      tab_vkk.SETFILTER(tab_vkk."No.",'%1',AU_Nr_sich);
      //tab_vkk.SETFILTER(tab_vkk."Order Date",'%1',AE_holen_Datum_1);
      //tab_vkk.SETFILTER(tab_vkk."Document Type",'%1', tab_vkk."Document Type"::Order);
       IF tab_vkk.FINDFIRST THEN
       REPEAT
         tab_ab.RESET;
         tab_ab.SETFILTER(tab_ab."Document No.",'%1',tab_vkk."No.");
         tab_ab.SETFILTER(tab_ab."Document Type",'%1', tab_ab."Document Type"::Order);
         tab_ab.SETFILTER(tab_ab.Type,'%1',tab_ab.Type::Item);
         tab_ab.SETFILTER(tab_ab."Location Code",'%1|%2|%3|%4','ZENT','KONSI','ERSATZ','IDT');
         tab_ab.SETFILTER(tab_ab.Quantity,'>%1',0);
           IF tab_ab.FINDFIRST  THEN
            REPEAT
             AE_mtl.INIT;
                 AE_mtl.Datum:=WORKDATE;
                 AE_mtl.AU_Nr:=tab_ab."Document No.";
                 AE_mtl.POS_Nr:=tab_ab."Line No.";
                 AE_mtl.Belegart:='AETG';
                 AE_mtl.Deb_Nr:=tab_ab."Sell-to Customer No.";
                 AE_mtl.Artikel:=tab_ab."No.";
                 AE_mtl.Menge:=tab_ab.Quantity;
                 AE_mtl.Restmenge:=tab_ab."Outstanding Quantity";
                 AE_mtl.EK:=tab_ab."Unit Cost (LCY)";
                 AE_mtl.VK:=tab_ab."Unit Price";
                 AE_mtl."Best„tigt LD":=tab_ab."Promised Delivery Date";
                 AE_mtl.Wunschdatum:=tab_ab."Requested Delivery Date";
                 AE_mtl.Status:='AE';
                 AE_mtl.Art:='TAG';
                 AE_mtl."EK Gesamt":=ROUND(((tab_ab.Quantity)*(tab_ab."Unit Cost (LCY)")),0.01);
                 AE_mtl."VK Gesamt":=ROUND(((tab_ab.Quantity)*(tab_ab."Unit Price")),0.01);
                 AE_mtl.Lager:=tab_ab."Location Code";
                 AE_mtl."DB %":=tab_ab."Profit %";
                 AE_mtl.Linie:=tab_ab."Manufacturer Code";
                 AE_mtl.Endkunde:=tab_ab.Endkunde;
                  tab_vkk1.RESET;
                  tab_vkk1.SETFILTER(tab_vkk1."No.",'%1',AE_mtl.AU_Nr);
                   IF tab_vkk1.FINDFIRST THEN
                    BEGIN
                    AE_mtl.Debitor:=tab_vkk1."Sell-to Customer Name";
                    AE_mtl.W„hrungscode:=tab_vkk1."Currency Code";
                    AE_mtl.w„_faktor:=tab_vkk1."Currency Factor";
                    AE_mtl.Auftragsdatum:=tab_vkk1."Order Date";
                    AE_mtl.Betreuer:=tab_vkk1."Betreuer Innendienst";
                    AE_mtl.Vertreter:=tab_vkk1."Salesperson Code";
                    AE_mtl.Teams:=tab_vkk1.Teams;
                    AE_mtl.Gebietscode:=tab_vkk1."Territory Code";
                    AE_mtl.PLZ:=tab_vkk1."Sell-to Post Code";
                   END;
                 IF AE_mtl.w„_faktor=0 THEN BEGIN
                 AE_mtl."Betrag in EUR":=AE_mtl."VK Gesamt";
                 END ELSE BEGIN
                 AE_mtl."Betrag in EUR":=(AE_mtl."VK Gesamt"/AE_mtl.w„_faktor);
                 END;
            AE_mtl.INSERT;
         UNTIL tab_ab.NEXT=0;

      UNTIL tab_vkk.NEXT=0;
      //  ENDE Einfgen von neuem AU





      "Linien umsetzen";
    END;

    PROCEDURE Auftrag_Arch_sichern@1140065();
    BEGIN
      // ANFANG Einfgen von archiviertem AU
      AE_mtl.RESET;
      tab_ab_arch.RESET;
      tab_vkk_arch.RESET;
      tab_vkk_arch.SETFILTER(tab_vkk_arch."No.",'%1',AU_Arch_Nr_sich);
      //tab_vkk.SETFILTER(tab_vkk."Order Date",'%1',AE_holen_Datum_1);
      //tab_vkk.SETFILTER(tab_vkk."Document Type",'%1', tab_vkk."Document Type"::Order);
       IF tab_vkk_arch.FINDFIRST THEN
       REPEAT
         tab_ab_arch.RESET;
         tab_ab_arch.SETFILTER(tab_ab_arch."Document No.",'%1',tab_vkk_arch."No.");
         tab_ab_arch.SETFILTER(tab_ab_arch."Document Type",'%1', tab_ab_arch."Document Type"::Order);
         tab_ab_arch.SETFILTER(tab_ab_arch.Type,'%1',tab_ab_arch.Type::Item);
         tab_ab_arch.SETFILTER(tab_ab_arch."Location Code",'%1|%2|%3|%4','ZENT','KONSI','ERSATZ','IDT');
         tab_ab_arch.SETFILTER(tab_ab_arch.Quantity,'>%1',0);
           IF tab_ab_arch.FINDFIRST  THEN
            REPEAT
             AE_mtl.INIT;
                 AE_mtl.Datum:=WORKDATE;
                 AE_mtl.AU_Nr:=tab_ab_arch."Document No.";
                 AE_mtl.POS_Nr:=tab_ab_arch."Line No.";
                 AE_mtl.Belegart:='AETG';
                 AE_mtl.Deb_Nr:=tab_ab_arch."Sell-to Customer No.";
                 AE_mtl.Artikel:=tab_ab_arch."No.";
                 AE_mtl.Menge:=tab_ab_arch.Quantity;
                 AE_mtl.Restmenge:=tab_ab_arch."Outstanding Quantity";
                 AE_mtl.EK:=tab_ab_arch."Unit Cost (LCY)";
                 AE_mtl.VK:=tab_ab_arch."Unit Price";
                 AE_mtl."Best„tigt LD":=tab_ab_arch."Promised Delivery Date";
                 AE_mtl.Wunschdatum:=tab_ab_arch."Requested Delivery Date";
                 AE_mtl.Status:='AE';
                 AE_mtl.Art:='TAG';
                 AE_mtl."EK Gesamt":=ROUND(((tab_ab_arch.Quantity)*(tab_ab_arch."Unit Cost (LCY)")),0.01);
                 AE_mtl."VK Gesamt":=ROUND(((tab_ab_arch.Quantity)*(tab_ab_arch."Unit Price")),0.01);
                 AE_mtl.Lager:=tab_ab_arch."Location Code";
                 AE_mtl."DB %":=tab_ab_arch."Profit %";
                 AE_mtl.Linie:=tab_ab_arch."Manufacturer Code";
                 AE_mtl.Endkunde:=tab_ab_arch.Endkunde;
                  tab_vkk1_arch.RESET;
                  tab_vkk1_arch.SETFILTER(tab_vkk1_arch."No.",'%1',AE_mtl.AU_Nr);
                   IF tab_vkk1_arch.FINDFIRST THEN
                    BEGIN
                    AE_mtl.Debitor:=tab_vkk1_arch."Sell-to Customer Name";
                    AE_mtl.W„hrungscode:=tab_vkk1_arch."Currency Code";
                    AE_mtl.w„_faktor:=tab_vkk1_arch."Currency Factor";
                    AE_mtl.Auftragsdatum:=tab_vkk1_arch."Order Date";
                    AE_mtl.Betreuer:=tab_vkk1_arch."Betreuer Innendienst";
                    AE_mtl.Vertreter:=tab_vkk1_arch."Salesperson Code";
                    AE_mtl.Teams:=tab_vkk1_arch.Teams;
                    AE_mtl.Gebietscode:=tab_vkk1_arch."Territory Code";
                    AE_mtl.PLZ:=tab_vkk1_arch."Sell-to Post Code";
                   END;
                 IF AE_mtl.w„_faktor=0 THEN BEGIN
                 AE_mtl."Betrag in EUR":=AE_mtl."VK Gesamt";
                 END ELSE BEGIN
                 AE_mtl."Betrag in EUR":=(AE_mtl."VK Gesamt"/AE_mtl.w„_faktor);
                 END;
            AE_mtl.INSERT;
         UNTIL tab_ab_arch.NEXT=0;

      UNTIL tab_vkk_arch.NEXT=0;
      //  ENDE Einfgen von archiviertem AU





      "Linien umsetzen";
    END;

    PROCEDURE "Konto Salden holen"@1140026();
    BEGIN
      // ANFANG Kontensalden in Excel ausgeben

      IF ISCLEAR(Excel) THEN
        CREATE(Excel,FALSE,TRUE);                                            //erzeugt excel

      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('A2').Value := WORKDATE;



         IF kto_datum = 010199D THEN BEGIN
         kto_datum:=WORKDATE;
         END ELSE BEGIN
         END;
      sum_konten:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'<=%1',kto_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4021');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten:=sum_konten+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;
      sum_konten1:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'<=%1',kto_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4022');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten1:=sum_konten1+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;

      sum_konten2:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'<=%1',kto_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4023');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten2:=sum_konten2+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
            END;

      sum_konten3:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'<=%1',kto_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4118');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten3:=sum_konten3+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;

      sum_konten4:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'<=%1',kto_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4120');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten4:=sum_konten4+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;

      sum_konten5:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'<=%1',kto_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4122');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten5:=sum_konten5+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;


      sum_konten6:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'<=%1',kto_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4221');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten6:=sum_konten6+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;

      sum_konten7:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'<=%1',kto_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4222');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten7:=sum_konten7+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;

      sum_konten8:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'<=%1',kto_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4223');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten8:=sum_konten8+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;


      sum_konten9:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'<=%1',kto_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4317');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten9:=sum_konten9+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;
      sum_konten10:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'<=%1',kto_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4338');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten10:=sum_konten10+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;
      sum_konten11:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'<=%1',kto_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4407');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten11:=sum_konten11+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;
      sum_konten12:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'<=%1',kto_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4408');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten12:=sum_konten12+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;
      sum_konten13:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'<=%1',kto_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4412');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten13:=sum_konten13+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;
      sum_konten14:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'<=%1',kto_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4416');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten14:=sum_konten14+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;
      sum_konten15:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'<=%1',kto_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4418');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten15:=sum_konten15+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;
      sum_konten16:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'<=%1',kto_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4421');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten16:=sum_konten16+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;
      sum_konten17:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'<=%1',kto_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4422');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten17:=sum_konten17+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;
      sum_konten18:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'<=%1',kto_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4423');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten18:=sum_konten18+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;
      sum_konten19:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'<=%1',kto_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4424');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten19:=sum_konten19+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;

      sum_konten20:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'<=%1',kto_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4690');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten20:=sum_konten20+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;



      Sheet.Range('C1').Value := '4021';
      Sheet.Range('D1').Value := '4022';
      Sheet.Range('E1').Value := '4023';
      Sheet.Range('F1').Value := '4118';
      Sheet.Range('G1').Value := '4120';
      Sheet.Range('H1').Value := '4122';
      Sheet.Range('I1').Value := '4221';
      Sheet.Range('J1').Value := '4222';
      Sheet.Range('K1').Value := '4223';
      Sheet.Range('L1').Value := '4317';
      Sheet.Range('M1').Value := '4338';
      Sheet.Range('N1').Value := '4407';
      Sheet.Range('O1').Value := '4408';
      Sheet.Range('P1').Value := '4412';
      Sheet.Range('Q1').Value := '4416';
      Sheet.Range('R1').Value := '4418';
      Sheet.Range('S1').Value := '4421';
      Sheet.Range('T1').Value := '4422';
      Sheet.Range('U1').Value := '4423';
      Sheet.Range('V1').Value := '4424';
      Sheet.Range('W1').Value := '4690';

      Sheet.Range('C2').Value :=FORMAT(sum_konten*(-1));
      Sheet.Range('D2').Value :=FORMAT(sum_konten1*(-1));
      Sheet.Range('E2').Value :=FORMAT(sum_konten2*(-1));
      Sheet.Range('F2').Value :=FORMAT(sum_konten3*(-1));
      Sheet.Range('G2').Value :=FORMAT(sum_konten4*(-1));
      Sheet.Range('H2').Value :=FORMAT(sum_konten5*(-1));
      Sheet.Range('I2').Value :=FORMAT(sum_konten6*(-1));
      Sheet.Range('J2').Value :=FORMAT(sum_konten7*(-1));
      Sheet.Range('K2').Value :=FORMAT(sum_konten8*(-1));
      Sheet.Range('L2').Value :=FORMAT(sum_konten9*(-1));
      Sheet.Range('M2').Value :=FORMAT(sum_konten10*(-1));
      Sheet.Range('N2').Value :=FORMAT(sum_konten11*(-1));
      Sheet.Range('O2').Value :=FORMAT(sum_konten12*(-1));
      Sheet.Range('P2').Value :=FORMAT(sum_konten13*(-1));
      Sheet.Range('Q2').Value :=FORMAT(sum_konten14*(-1));
      Sheet.Range('R2').Value :=FORMAT(sum_konten15*(-1));
      Sheet.Range('S2').Value :=FORMAT(sum_konten16*(-1));
      Sheet.Range('T2').Value :=FORMAT(sum_konten17*(-1));
      Sheet.Range('U2').Value :=FORMAT(sum_konten18*(-1));
      Sheet.Range('V2').Value :=FORMAT(sum_konten19*(-1));
      Sheet.Range('W2').Value :=FORMAT(sum_konten20*(-1));


      sum_konten:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'%1',saldo_heute_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4021');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten:=sum_konten+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;
      sum_konten1:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'%1',saldo_heute_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4022');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten1:=sum_konten1+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;

      sum_konten2:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'%1',saldo_heute_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4023');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten2:=sum_konten2+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
            END;

      sum_konten3:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'%1',saldo_heute_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4118');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten3:=sum_konten3+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;

      sum_konten4:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'%1',saldo_heute_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4120');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten4:=sum_konten4+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;

      sum_konten5:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'%1',saldo_heute_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4122');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten5:=sum_konten5+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;


      sum_konten6:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'%1',saldo_heute_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4221');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten6:=sum_konten6+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;

      sum_konten7:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'%1',saldo_heute_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4222');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten7:=sum_konten7+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;

      sum_konten8:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'%1',saldo_heute_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4223');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten8:=sum_konten8+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;


      sum_konten9:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'%1',saldo_heute_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4317');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten9:=sum_konten9+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;


      sum_konten10:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'%1',saldo_heute_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4338');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten10:=sum_konten10+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;

      sum_konten11:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'%1',saldo_heute_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4407');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten11:=sum_konten11+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;

      sum_konten12:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'%1',saldo_heute_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4408');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten12:=sum_konten12+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;

      sum_konten13:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'%1',saldo_heute_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4412');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten13:=sum_konten13+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;

      sum_konten14:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'%1',saldo_heute_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4416');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten14:=sum_konten14+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;

      sum_konten15:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'%1',saldo_heute_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4418');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten15:=sum_konten15+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;

      sum_konten16:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'%1',saldo_heute_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4421');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten16:=sum_konten16+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;

      sum_konten17:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'%1',saldo_heute_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4422');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten17:=sum_konten17+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;

      sum_konten18:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'%1',saldo_heute_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4423');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten18:=sum_konten18+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;

      sum_konten19:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'%1',saldo_heute_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4424');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten19:=sum_konten19+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;

      sum_konten20:=0;
         sachposten.RESET;
         sachposten.SETFILTER(sachposten."Posting Date",'%1',saldo_heute_datum);
         sachposten.SETFILTER(sachposten."G/L Account No.",'%1','4690');
         IF sachposten.FINDFIRST THEN BEGIN
          REPEAT
            sum_konten20:=sum_konten20+sachposten.Amount;
          UNTIL sachposten.NEXT=0;
         END;


      Sheet.Range('A4').Value :='Tagessaldo';
      Sheet.Range('C4').Value :=FORMAT(sum_konten*(-1));
      Sheet.Range('D4').Value :=FORMAT(sum_konten1*(-1));
      Sheet.Range('E4').Value :=FORMAT(sum_konten2*(-1));
      Sheet.Range('F4').Value :=FORMAT(sum_konten3*(-1));
      Sheet.Range('G4').Value :=FORMAT(sum_konten4*(-1));
      Sheet.Range('H4').Value :=FORMAT(sum_konten5*(-1));
      Sheet.Range('I4').Value :=FORMAT(sum_konten6*(-1));
      Sheet.Range('J4').Value :=FORMAT(sum_konten7*(-1));
      Sheet.Range('K4').Value :=FORMAT(sum_konten8*(-1));
      Sheet.Range('L4').Value :=FORMAT(sum_konten9*(-1));
      Sheet.Range('M4').Value :=FORMAT(sum_konten10*(-1));
      Sheet.Range('N4').Value :=FORMAT(sum_konten11*(-1));
      Sheet.Range('O4').Value :=FORMAT(sum_konten12*(-1));
      Sheet.Range('P4').Value :=FORMAT(sum_konten13*(-1));
      Sheet.Range('Q4').Value :=FORMAT(sum_konten14*(-1));
      Sheet.Range('R4').Value :=FORMAT(sum_konten15*(-1));
      Sheet.Range('S4').Value :=FORMAT(sum_konten16*(-1));
      Sheet.Range('T4').Value :=FORMAT(sum_konten17*(-1));
      Sheet.Range('U4').Value :=FORMAT(sum_konten18*(-1));
      Sheet.Range('V4').Value :=FORMAT(sum_konten19*(-1));
      Sheet.Range('W4').Value :=FORMAT(sum_konten20*(-1));



      //IF ERASE('F:\Daten Neu\User\Uwe\Test_Kontensalden.xlsx')THEN;
      //Book.SaveAs('F:\Daten Neu\User\Uwe\Test_Kontensalden.xlsx');
      //Book.Close(TRUE);
      //Excel.Quit;
      Excel.Visible(TRUE);
    END;

    PROCEDURE "AE Salden t„gl gesamt"@1140044();
    BEGIN
      // ANFANG tgl. AE als Gesamtsumme in Excel ausgeben
      CLEAR(Excel);
      REPEAT
      UNTIL ISCLEAR(Excel);
      CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet

      Sheet.Range('G:G').NumberFormat:='###.###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'Datum';
      Sheet.Range('B2').Value := 'Betrag in EUR';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');;
      AE_mtl.SETFILTER(AE_mtl.Datum,'>%1',010714D);
      IF AE_mtl.FINDFIRST THEN BEGIN
      AE_t„gl_datum := AE_mtl.Datum;
      REPEAT
      Sheet.Range('A'+j).Value := AE_t„gl_datum;
      IF AE_t„gl_datum=AE_mtl.Datum THEN BEGIN
      AE_t„gl_gesamt:=AE_t„gl_gesamt + AE_mtl."Betrag in EUR";
      END ELSE BEGIN
      Sheet.Range('B'+j).Value := FORMAT(AE_t„gl_gesamt);
      AE_t„gl_gesamt:=0;
      AE_t„gl_gesamt:=AE_t„gl_gesamt + AE_mtl."Betrag in EUR";
      j:=INCSTR(j);
      END;

      AE_t„gl_datum := AE_mtl.Datum;
      UNTIL AE_mtl.NEXT=0;
      END;
      Excel.Visible(TRUE);
    END;

    PROCEDURE AE_Vertrieb1@1140047();
    BEGIN
      CLEAR(Excel);
      REPEAT
      UNTIL ISCLEAR(Excel);
      CREATE(Excel,FALSE,TRUE);
      CREATE (wshFile,FALSE,TRUE);

      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1|%2','ESK','NM');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      {
      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1','ML');
      AE_mtl.SETFILTER(AE_mtl.Vertreter,'%1|%2|%3','ESK','TWO','TWN');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      }
      tab_vkk.RESET;
      tab_vkk.SETFILTER(tab_vkk."Order Date",'%1',AE_holen_Datum);
      tab_vkk.SETFILTER(tab_vkk."Document Type",'%1',tab_vkk."Document Type"::Order);
      tab_vkk.SETFILTER(tab_vkk."Betreuer Innendienst",'%1|%2','ESK','NM');
      IF tab_vkk.FINDFIRST THEN BEGIN
      REPEAT
      tab_ab.RESET;
      tab_ab.SETFILTER(tab_ab."Document No.",'%1',tab_vkk."No.");
      tab_ab.SETFILTER(tab_ab.Type,'%1',tab_ab.Type::Item);
      tab_ab.SETFILTER(tab_ab."Outstanding Quantity",'>%1',0);
      tab_ab.SETFILTER(tab_ab."Location Code",'%1|%2|%3|%4','ZENT','KONSI','ERSATZ','IDT');
      IF tab_ab.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := tab_vkk."Order Date";
      Sheet.Range('B'+j).Value := tab_vkk."No.";
      Sheet.Range('C'+j).Value := tab_vkk."Sell-to Customer No.";
      Sheet.Range('D'+j).Value := tab_vkk."Sell-to Customer Name";
      Sheet.Range('E'+j).Value := FORMAT(tab_ab.Quantity);
      Sheet.Range('F'+j).Value := tab_ab."No.";
      Sheet.Range('G'+j).Value := tab_ab."Location Code";
      Sheet.Range('H'+j).Value := FORMAT(tab_ab."Unit Cost (LCY)");
      Sheet.Range('I'+j).Value := FORMAT(tab_ab."Unit Price");
      Sheet.Range('J'+j).Value := tab_vkk."Currency Code";
      Sheet.Range('K'+j).Value := FORMAT(tab_vkk."Currency Factor");
      //Sheet.Range('L'+j).Value := FORMAT(tab_ab."Line Amount");
      Sheet.Range('L'+j).Value := FORMAT(tab_ab."Outstanding Amount (LCY)");
      Sheet.Range('M'+j).Value := FORMAT(tab_ab."Profit %");
      Sheet.Range('N'+j).Value := tab_vkk."Betreuer Innendienst";
      Sheet.Range('O'+j).Value := tab_vkk."Salesperson Code";
      Artikel.RESET;
      Artikel.SETFILTER(Artikel."No.",'%1',tab_ab."No.");
      IF Artikel.FINDFIRST THEN BEGIN
      Sheet.Range('P'+j).Value := Artikel.Herstellerkurzname;
      END;
      Sheet.Range('Q'+j).Value := FORMAT(tab_ab."Outstanding Quantity"*tab_ab."Unit Cost (LCY)");
      Sheet.Range('R'+j).Value := tab_vkk."Sell-to Post Code";
      Sheet.Range('S'+j).Value := tab_ab.Endkunde;
      Sheet.Range('T'+j).Value := tab_vkk.Teams;
      Sheet.Range('U'+j).Value := tab_vkk."Territory Code";
      j:=INCSTR(j);
      UNTIL tab_ab.NEXT=0;
      END;
      UNTIL tab_vkk.NEXT=0;
      END;
      {
      tab_vkk.RESET;
      tab_vkk.SETFILTER(tab_vkk."Order Date",'%1',AE_holen_Datum);
      tab_vkk.SETFILTER(tab_vkk."Document Type",'%1',tab_vkk."Document Type"::Order);
      tab_vkk.SETFILTER(tab_vkk."Betreuer Innendienst",'%1','ML');
      tab_vkk.SETFILTER(tab_vkk."Salesperson Code",'%1|%2|%3','ESK','TWO','TWN');
      IF tab_vkk.FINDFIRST THEN BEGIN
      REPEAT
      tab_ab.RESET;
      tab_ab.SETFILTER(tab_ab."Document No.",'%1',tab_vkk."No.");
      tab_ab.SETFILTER(tab_ab.Type,'%1',tab_ab.Type::Item);
      tab_ab.SETFILTER(tab_ab."Outstanding Quantity",'>%1',0);
      tab_ab.SETFILTER(tab_ab."Location Code",'%1|%2|%3|%4','ZENT','KONSI','ERSATZ','IDT');
      IF tab_ab.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := tab_vkk."Order Date";
      Sheet.Range('B'+j).Value := tab_vkk."No.";
      Sheet.Range('C'+j).Value := tab_vkk."Sell-to Customer No.";
      Sheet.Range('D'+j).Value := tab_vkk."Sell-to Customer Name";
      Sheet.Range('E'+j).Value := FORMAT(tab_ab.Quantity);
      Sheet.Range('F'+j).Value := tab_ab."No.";
      Sheet.Range('G'+j).Value := tab_ab."Location Code";
      Sheet.Range('H'+j).Value := FORMAT(tab_ab."Unit Cost (LCY)");
      Sheet.Range('I'+j).Value := FORMAT(tab_ab."Unit Price");
      Sheet.Range('J'+j).Value := tab_vkk."Currency Code";
      Sheet.Range('K'+j).Value := FORMAT(tab_vkk."Currency Factor");
      Sheet.Range('L'+j).Value := FORMAT(tab_ab."Outstanding Amount (LCY)");
      Sheet.Range('M'+j).Value := FORMAT(tab_ab."Profit %");
      Sheet.Range('N'+j).Value := tab_vkk."Betreuer Innendienst";
      Sheet.Range('O'+j).Value := tab_vkk."Salesperson Code";
      Artikel.RESET;
      Artikel.SETFILTER(Artikel."No.",'%1',tab_ab."No.");
      IF Artikel.FINDFIRST THEN BEGIN
      Sheet.Range('P'+j).Value := Artikel.Herstellerkurzname;
      END;
      Sheet.Range('Q'+j).Value := FORMAT(tab_ab."Outstanding Quantity"*tab_ab."Unit Cost (LCY)");
      Sheet.Range('R'+j).Value := tab_vkk."Sell-to Post Code";
      Sheet.Range('S'+j).Value := tab_ab.Endkunde;
      Sheet.Range('T'+j).Value := tab_vkk.Teams;
      Sheet.Range('U'+j).Value := tab_vkk."Territory Code";
      j:=INCSTR(j);
      UNTIL tab_ab.NEXT=0;
      END;
      UNTIL tab_vkk.NEXT=0;
      END;
      }
      IF wshFile.FileExists(('F:\Daten Neu\User\Edeltraut\')+(Filename)) THEN wshFile.DeleteFile(('F:\Daten Neu\User\Edeltraut\')+(Filename));
      Book.SaveAs(('F:\Daten Neu\User\Edeltraut\')+(Filename));
      Book.Close(TRUE);
      //Excel.Quit;

       AE_Vertrieb2;
    END;

    PROCEDURE AE_Vertrieb2@1140048();
    BEGIN
      CLEAR(Excel);
      REPEAT
      UNTIL ISCLEAR(Excel);
      CREATE(Excel,FALSE,TRUE);

      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1|%2','RL','CB');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;


      {
      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1','ML');
      AE_mtl.SETFILTER(AE_mtl.Vertreter,'%1|%2|%3|%4|%5','RL','MK','TWW','TWE','TWA');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      }
      tab_vkk.RESET;
      tab_vkk.SETFILTER(tab_vkk."Order Date",'%1',AE_holen_Datum);
      tab_vkk.SETFILTER(tab_vkk."Document Type",'%1',tab_vkk."Document Type"::Order);
      tab_vkk.SETFILTER(tab_vkk."Betreuer Innendienst",'%1|%2','RL','CB');
      IF tab_vkk.FINDFIRST THEN BEGIN
      REPEAT
      tab_ab.RESET;
      tab_ab.SETFILTER(tab_ab."Document No.",'%1',tab_vkk."No.");
      tab_ab.SETFILTER(tab_ab.Type,'%1',tab_ab.Type::Item);
      tab_ab.SETFILTER(tab_ab."Outstanding Quantity",'>%1',0);
      tab_ab.SETFILTER(tab_ab."Location Code",'%1|%2|%3|%4','ZENT','KONSI','ERSATZ','IDT');
      IF tab_ab.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := tab_vkk."Order Date";
      Sheet.Range('B'+j).Value := tab_vkk."No.";
      Sheet.Range('C'+j).Value := tab_vkk."Sell-to Customer No.";
      Sheet.Range('D'+j).Value := tab_vkk."Sell-to Customer Name";
      Sheet.Range('E'+j).Value := FORMAT(tab_ab.Quantity);
      Sheet.Range('F'+j).Value := tab_ab."No.";
      Sheet.Range('G'+j).Value := tab_ab."Location Code";
      Sheet.Range('H'+j).Value := FORMAT(tab_ab."Unit Cost (LCY)");
      Sheet.Range('I'+j).Value := FORMAT(tab_ab."Unit Price");
      Sheet.Range('J'+j).Value := tab_vkk."Currency Code";
      Sheet.Range('K'+j).Value := FORMAT(tab_vkk."Currency Factor");
      //Sheet.Range('L'+j).Value := FORMAT(tab_ab."Line Amount");
      Sheet.Range('L'+j).Value := FORMAT(tab_ab."Outstanding Amount (LCY)");
      Sheet.Range('M'+j).Value := FORMAT(tab_ab."Profit %");
      Sheet.Range('N'+j).Value := tab_vkk."Betreuer Innendienst";
      Sheet.Range('O'+j).Value := tab_vkk."Salesperson Code";
      Artikel.RESET;
      Artikel.SETFILTER(Artikel."No.",'%1',tab_ab."No.");
      IF Artikel.FINDFIRST THEN BEGIN
      Sheet.Range('P'+j).Value := Artikel.Herstellerkurzname;
      END;
      Sheet.Range('Q'+j).Value := FORMAT(tab_ab."Outstanding Quantity"*tab_ab."Unit Cost (LCY)");
      Sheet.Range('R'+j).Value := tab_vkk."Sell-to Post Code";
      Sheet.Range('S'+j).Value := tab_ab.Endkunde;
      Sheet.Range('T'+j).Value := tab_vkk.Teams;
      Sheet.Range('U'+j).Value := tab_vkk."Territory Code";
      j:=INCSTR(j);
      UNTIL tab_ab.NEXT=0;
      END;
      UNTIL tab_vkk.NEXT=0;
      END;
      {
      tab_vkk.RESET;
      tab_vkk.SETFILTER(tab_vkk."Order Date",'%1',AE_holen_Datum);
      tab_vkk.SETFILTER(tab_vkk."Document Type",'%1',tab_vkk."Document Type"::Order);
      tab_vkk.SETFILTER(tab_vkk."Betreuer Innendienst",'%1','ML');
      tab_vkk.SETFILTER(tab_vkk."Salesperson Code",'%1|%2|%3|%4|%5','RL','MK','TWW','TWE','TWA');
      IF tab_vkk.FINDFIRST THEN BEGIN
      REPEAT
      tab_ab.RESET;
      tab_ab.SETFILTER(tab_ab."Document No.",'%1',tab_vkk."No.");
      tab_ab.SETFILTER(tab_ab.Type,'%1',tab_ab.Type::Item);
      tab_ab.SETFILTER(tab_ab."Outstanding Quantity",'>%1',0);
      tab_ab.SETFILTER(tab_ab."Location Code",'%1|%2|%3|%4','ZENT','KONSI','ERSATZ','IDT');
      IF tab_ab.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := tab_vkk."Order Date";
      Sheet.Range('B'+j).Value := tab_vkk."No.";
      Sheet.Range('C'+j).Value := tab_vkk."Sell-to Customer No.";
      Sheet.Range('D'+j).Value := tab_vkk."Sell-to Customer Name";
      Sheet.Range('E'+j).Value := FORMAT(tab_ab.Quantity);
      Sheet.Range('F'+j).Value := tab_ab."No.";
      Sheet.Range('G'+j).Value := tab_ab."Location Code";
      Sheet.Range('H'+j).Value := FORMAT(tab_ab."Unit Cost (LCY)");
      Sheet.Range('I'+j).Value := FORMAT(tab_ab."Unit Price");
      Sheet.Range('J'+j).Value := tab_vkk."Currency Code";
      Sheet.Range('K'+j).Value := FORMAT(tab_vkk."Currency Factor");
      Sheet.Range('L'+j).Value := FORMAT(tab_ab."Outstanding Amount (LCY)");
      Sheet.Range('M'+j).Value := FORMAT(tab_ab."Profit %");
      Sheet.Range('N'+j).Value := tab_vkk."Betreuer Innendienst";
      Sheet.Range('O'+j).Value := tab_vkk."Salesperson Code";
      Artikel.RESET;
      Artikel.SETFILTER(Artikel."No.",'%1',tab_ab."No.");
      IF Artikel.FINDFIRST THEN BEGIN
      Sheet.Range('P'+j).Value := Artikel.Herstellerkurzname;
      END;
      Sheet.Range('Q'+j).Value := FORMAT(tab_ab."Outstanding Quantity"*tab_ab."Unit Cost (LCY)");
      Sheet.Range('R'+j).Value := tab_vkk."Sell-to Post Code";
      Sheet.Range('S'+j).Value := tab_ab.Endkunde;
      Sheet.Range('T'+j).Value := tab_vkk.Teams;
      Sheet.Range('U'+j).Value := tab_vkk."Territory Code";
      j:=INCSTR(j);
      UNTIL tab_ab.NEXT=0;
      END;
      UNTIL tab_vkk.NEXT=0;
      END;
      }
      IF wshFile.FileExists(('F:\Daten Neu\User\Renate\')+(Filename)) THEN wshFile.DeleteFile(('F:\Daten Neu\User\Renate\')+(Filename));
      Book.SaveAs(('F:\Daten Neu\User\Renate\')+(Filename));
      Book.Close(TRUE);
      //Excel.Quit;
      AE_Vertrieb3;
    END;

    PROCEDURE AE_Vertrieb3@1140059();
    BEGIN
      CLEAR(Excel);
      REPEAT
      UNTIL ISCLEAR(Excel);
      CREATE(Excel,FALSE,TRUE);

      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1|%2','HB','LD');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      {
      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1','ML');
      AE_mtl.SETFILTER(AE_mtl.Vertreter,'%1|%2|%3','HB','TWSO','TWSW');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      }
      tab_vkk.RESET;
      tab_vkk.SETFILTER(tab_vkk."Order Date",'%1',AE_holen_Datum);
      tab_vkk.SETFILTER(tab_vkk."Document Type",'%1',tab_vkk."Document Type"::Order);
      tab_vkk.SETFILTER(tab_vkk."Betreuer Innendienst",'%1|%2','HB','LD');
      IF tab_vkk.FINDFIRST THEN BEGIN
      REPEAT
      tab_ab.RESET;
      tab_ab.SETFILTER(tab_ab."Document No.",'%1',tab_vkk."No.");
      tab_ab.SETFILTER(tab_ab.Type,'%1',tab_ab.Type::Item);
      tab_ab.SETFILTER(tab_ab."Outstanding Quantity",'>%1',0);
      tab_ab.SETFILTER(tab_ab."Location Code",'%1|%2|%3|%4','ZENT','KONSI','ERSATZ','IDT');
      IF tab_ab.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := tab_vkk."Order Date";
      Sheet.Range('B'+j).Value := tab_vkk."No.";
      Sheet.Range('C'+j).Value := tab_vkk."Sell-to Customer No.";
      Sheet.Range('D'+j).Value := tab_vkk."Sell-to Customer Name";
      Sheet.Range('E'+j).Value := FORMAT(tab_ab.Quantity);
      Sheet.Range('F'+j).Value := tab_ab."No.";
      Sheet.Range('G'+j).Value := tab_ab."Location Code";
      Sheet.Range('H'+j).Value := FORMAT(tab_ab."Unit Cost (LCY)");
      Sheet.Range('I'+j).Value := FORMAT(tab_ab."Unit Price");
      Sheet.Range('J'+j).Value := tab_vkk."Currency Code";
      Sheet.Range('K'+j).Value := FORMAT(tab_vkk."Currency Factor");
      //Sheet.Range('L'+j).Value := FORMAT(tab_ab."Line Amount");
      Sheet.Range('L'+j).Value := FORMAT(tab_ab."Outstanding Amount (LCY)");
      Sheet.Range('M'+j).Value := FORMAT(tab_ab."Profit %");
      Sheet.Range('N'+j).Value := tab_vkk."Betreuer Innendienst";
      Sheet.Range('O'+j).Value := tab_vkk."Salesperson Code";
      Artikel.RESET;
      Artikel.SETFILTER(Artikel."No.",'%1',tab_ab."No.");
      IF Artikel.FINDFIRST THEN BEGIN
      Sheet.Range('P'+j).Value := Artikel.Herstellerkurzname;
      END;
      Sheet.Range('Q'+j).Value := FORMAT(tab_ab."Outstanding Quantity"*tab_ab."Unit Cost (LCY)");
      Sheet.Range('R'+j).Value := tab_vkk."Sell-to Post Code";
      Sheet.Range('S'+j).Value := tab_ab.Endkunde;
      Sheet.Range('T'+j).Value := tab_vkk.Teams;
      Sheet.Range('U'+j).Value := tab_vkk."Territory Code";
      j:=INCSTR(j);
      UNTIL tab_ab.NEXT=0;
      END;
      UNTIL tab_vkk.NEXT=0;
      END;
      {
      tab_vkk.RESET;
      tab_vkk.SETFILTER(tab_vkk."Order Date",'%1',AE_holen_Datum);
      tab_vkk.SETFILTER(tab_vkk."Document Type",'%1',tab_vkk."Document Type"::Order);
      tab_vkk.SETFILTER(tab_vkk."Betreuer Innendienst",'%1','ML');
      tab_vkk.SETFILTER(tab_vkk."Salesperson Code",'%1|%2|%3','HB','TWSO','TWSW');
      IF tab_vkk.FINDFIRST THEN BEGIN
      REPEAT
      tab_ab.RESET;
      tab_ab.SETFILTER(tab_ab."Document No.",'%1',tab_vkk."No.");
      tab_ab.SETFILTER(tab_ab.Type,'%1',tab_ab.Type::Item);
      tab_ab.SETFILTER(tab_ab."Outstanding Quantity",'>%1',0);
      tab_ab.SETFILTER(tab_ab."Location Code",'%1|%2|%3|%4','ZENT','KONSI','ERSATZ','IDT');
      IF tab_ab.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := tab_vkk."Order Date";
      Sheet.Range('B'+j).Value := tab_vkk."No.";
      Sheet.Range('C'+j).Value := tab_vkk."Sell-to Customer No.";
      Sheet.Range('D'+j).Value := tab_vkk."Sell-to Customer Name";
      Sheet.Range('E'+j).Value := FORMAT(tab_ab.Quantity);
      Sheet.Range('F'+j).Value := tab_ab."No.";
      Sheet.Range('G'+j).Value := tab_ab."Location Code";
      Sheet.Range('H'+j).Value := FORMAT(tab_ab."Unit Cost (LCY)");
      Sheet.Range('I'+j).Value := FORMAT(tab_ab."Unit Price");
      Sheet.Range('J'+j).Value := tab_vkk."Currency Code";
      Sheet.Range('K'+j).Value := FORMAT(tab_vkk."Currency Factor");
      Sheet.Range('L'+j).Value := FORMAT(tab_ab."Outstanding Amount (LCY)");
      Sheet.Range('M'+j).Value := FORMAT(tab_ab."Profit %");
      Sheet.Range('N'+j).Value := tab_vkk."Betreuer Innendienst";
      Sheet.Range('O'+j).Value := tab_vkk."Salesperson Code";
      Artikel.RESET;
      Artikel.SETFILTER(Artikel."No.",'%1',tab_ab."No.");
      IF Artikel.FINDFIRST THEN BEGIN
      Sheet.Range('P'+j).Value := Artikel.Herstellerkurzname;
      END;
      Sheet.Range('Q'+j).Value := FORMAT(tab_ab."Outstanding Quantity"*tab_ab."Unit Cost (LCY)");
      Sheet.Range('R'+j).Value := tab_vkk."Sell-to Post Code";
      Sheet.Range('S'+j).Value := tab_ab.Endkunde;
      Sheet.Range('T'+j).Value := tab_vkk.Teams;
      Sheet.Range('U'+j).Value := tab_vkk."Territory Code";
      j:=INCSTR(j);
      UNTIL tab_ab.NEXT=0;
      END;
      UNTIL tab_vkk.NEXT=0;
      END;
      }
      IF wshFile.FileExists(('F:\Daten Neu\User\Hendrik\AU Eingang Uwe\')+(Filename)) THEN wshFile.DeleteFile(('F:\Daten Neu\User\Hendrik\AU Eingang Uwe\')+(Filename));
      Book.SaveAs(('F:\Daten Neu\User\Hendrik\AU Eingang Uwe\')+(Filename));
      Book.Close(TRUE);
      Excel.Quit;
    END;

    PROCEDURE AE_Vertrieb4@1140061();
    BEGIN
      CLEAR(Excel);
      REPEAT
      UNTIL ISCLEAR(Excel);
      CREATE(Excel,FALSE,TRUE);
      CREATE (wshFile,FALSE,TRUE);

      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,##';


      Sheet.Range('A1').Value := 'Auftragseingang  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'datum';
      Sheet.Range('B2').Value := 'auft_nr';
      Sheet.Range('C2').Value := 'deb_nr';
      Sheet.Range('D2').Value := 'name';
      Sheet.Range('E2').Value := 'menge';
      Sheet.Range('F2').Value := 'artikel';
      Sheet.Range('G2').Value := 'lager';
      Sheet.Range('H2').Value := 'ek';
      Sheet.Range('I2').Value := 'vk';
      Sheet.Range('J2').Value := 'w„hrung';
      Sheet.Range('K2').Value := 'w„_fakt';
      Sheet.Range('L2').Value := 'betrag in EUR';
      Sheet.Range('M2').Value := 'db';
      Sheet.Range('N2').Value := 'bearb';
      Sheet.Range('O2').Value := 'vertreter';
      Sheet.Range('P2').Value := 'linie';
      Sheet.Range('Q2').Value := 'ek_gesamt';
      Sheet.Range('R2').Value := 'plz';
      Sheet.Range('S2').Value := 'endkunde';
      Sheet.Range('T2').Value := 'team';
      Sheet.Range('U2').Value := 'gebiet';
      j := '3';

      AE_mtl.RESET;
      AE_mtl.SETFILTER(AE_mtl.Belegart,'%1|%2|%3','AMTL','AEMT','GUMT');
      AE_mtl.SETFILTER(AE_mtl.Datum,'%1..%2',Datum_von,Datum_bis);
      AE_mtl.SETFILTER(AE_mtl.Betreuer,'%1|%2|%3','ML','TK','RL');
      AE_mtl.SETFILTER(AE_mtl.Gebietscode,'%1','SYSTEM');
      IF AE_mtl.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := AE_mtl.Datum;
      Sheet.Range('B'+j).Value := AE_mtl.AU_Nr;
      Sheet.Range('C'+j).Value := AE_mtl.Deb_Nr;
      Sheet.Range('D'+j).Value := AE_mtl.Debitor;
      Sheet.Range('E'+j).Value := AE_mtl.Menge;
      Sheet.Range('F'+j).Value := AE_mtl.Artikel;
      Sheet.Range('G'+j).Value := AE_mtl.Lager;
      Sheet.Range('H'+j).Value := FORMAT(AE_mtl.EK);
      Sheet.Range('I'+j).Value := FORMAT(AE_mtl.VK);
      Sheet.Range('J'+j).Value := AE_mtl.W„hrungscode;
      Sheet.Range('K'+j).Value := FORMAT(AE_mtl.w„_faktor);
      Sheet.Range('L'+j).Value := FORMAT(AE_mtl."Betrag in EUR");
      Sheet.Range('M'+j).Value := FORMAT(AE_mtl."DB %");
      Sheet.Range('N'+j).Value := AE_mtl.Betreuer;
      Sheet.Range('O'+j).Value := AE_mtl.Vertreter;
      Sheet.Range('P'+j).Value := AE_mtl.Linie;
      Sheet.Range('Q'+j).Value := FORMAT(AE_mtl."EK Gesamt");
      Sheet.Range('R'+j).Value := AE_mtl.PLZ;
      Sheet.Range('S'+j).Value := AE_mtl.Endkunde;
      Sheet.Range('T'+j).Value := AE_mtl.Teams;
      Sheet.Range('U'+j).Value := AE_mtl.Gebietscode;
      j:=INCSTR(j);
      UNTIL AE_mtl.NEXT=0;
      END;
      tab_vkk.RESET;
      tab_vkk.SETFILTER(tab_vkk."Order Date",'%1',AE_holen_Datum);
      tab_vkk.SETFILTER(tab_vkk."Document Type",'%1',tab_vkk."Document Type"::Order);
      tab_vkk.SETFILTER(tab_vkk."Betreuer Innendienst",'%1|%2|%3','ML','TK','RL');
      tab_vkk.SETFILTER(tab_vkk."Territory Code",'%1','SYSTEM');

      IF tab_vkk.FINDFIRST THEN BEGIN
      REPEAT
      tab_ab.RESET;
      tab_ab.SETFILTER(tab_ab."Document No.",'%1',tab_vkk."No.");
      tab_ab.SETFILTER(tab_ab.Type,'%1',tab_ab.Type::Item);
      tab_ab.SETFILTER(tab_ab."Outstanding Quantity",'>%1',0);
      tab_ab.SETFILTER(tab_ab."Location Code",'%1|%2|%3|%4','ZENT','KONSI','ERSATZ','IDT');
      IF tab_ab.FINDFIRST THEN BEGIN
      REPEAT
      Sheet.Range('A'+j).Value := tab_vkk."Order Date";
      Sheet.Range('B'+j).Value := tab_vkk."No.";
      Sheet.Range('C'+j).Value := tab_vkk."Sell-to Customer No.";
      Sheet.Range('D'+j).Value := tab_vkk."Sell-to Customer Name";
      Sheet.Range('E'+j).Value := FORMAT(tab_ab.Quantity);
      Sheet.Range('F'+j).Value := tab_ab."No.";
      Sheet.Range('G'+j).Value := tab_ab."Location Code";
      Sheet.Range('H'+j).Value := FORMAT(tab_ab."Unit Cost (LCY)");
      Sheet.Range('I'+j).Value := FORMAT(tab_ab."Unit Price");
      Sheet.Range('J'+j).Value := tab_vkk."Currency Code";
      Sheet.Range('K'+j).Value := FORMAT(tab_vkk."Currency Factor");
      //Sheet.Range('L'+j).Value := FORMAT(tab_ab."Line Amount");
      Sheet.Range('L'+j).Value := FORMAT(tab_ab."Outstanding Amount (LCY)");
      Sheet.Range('M'+j).Value := FORMAT(tab_ab."Profit %");
      Sheet.Range('N'+j).Value := tab_vkk."Betreuer Innendienst";
      Sheet.Range('O'+j).Value := tab_vkk."Salesperson Code";
      Artikel.RESET;
      Artikel.SETFILTER(Artikel."No.",'%1',tab_ab."No.");
      IF Artikel.FINDFIRST THEN BEGIN
      Sheet.Range('P'+j).Value := Artikel.Herstellerkurzname;
      END;
      Sheet.Range('Q'+j).Value := FORMAT(tab_ab."Outstanding Quantity"*tab_ab."Unit Cost (LCY)");
      Sheet.Range('R'+j).Value := tab_vkk."Sell-to Post Code";
      Sheet.Range('S'+j).Value := tab_ab.Endkunde;
      Sheet.Range('T'+j).Value := tab_vkk.Teams;
      Sheet.Range('U'+j).Value := tab_vkk."Territory Code";
      j:=INCSTR(j);
      UNTIL tab_ab.NEXT=0;
      END;
      UNTIL tab_vkk.NEXT=0;
      END;
      IF wshFile.FileExists(('F:\Daten Neu\User\Maria\AUFTRAGSEINGANG\')+(Filename)) THEN wshFile.DeleteFile(('F:\Daten Neu\User\Maria\AUFTRAGSEINGANG\')+(Filename));
      Book.SaveAs(('F:\Daten Neu\User\Maria\AUFTRAGSEINGANG\')+(Filename));
      Book.Close(TRUE);
      Excel.Quit;
    END;

    PROCEDURE Debitor_šberprfung@1140053();
    BEGIN
      // ANFANG Debitorberprfung
      CLEAR(Excel);
      REPEAT
      UNTIL ISCLEAR(Excel);
      CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet

      Sheet.Range('A1').Value := 'Debitorberprfung'; // definiert die Beschriftung der berschriftszeile
      Sheet.Range('C1').Value := WORKDATE;
      j := '3';

      deb.RESET;
      deb.SETFILTER(deb."VAT Bus. Posting Group",'%1','');
      IF deb.FINDFIRST THEN BEGIN
      Sheet.Range('A'+j).Value :='MWSt-Gesch„ftsbuchungsgruppe ist leer';
      j:=INCSTR(j);
      REPEAT
      Sheet.Range('A'+j).Value :=deb."No.";
      Sheet.Range('B'+j).Value :=deb.Name;
      Sheet.Range('C'+j).Value :=deb."Salesperson Code";
      v_hypernr:= deb."No.";
      v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
                   'target=Page%2021%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + deb."No." + '")';
      j:=INCSTR(j);
      UNTIL deb.NEXT=0;
      j:=INCSTR(j);
      END;


      deb.RESET;
      deb.SETFILTER(deb."Payment Terms Code",'%1','');
      IF deb.FINDFIRST THEN BEGIN
      Sheet.Range('A'+j).Value :='Zahlungsbedingungscode ist leer';
      j:=INCSTR(j);
      REPEAT
      Sheet.Range('A'+j).Value :=deb."No.";
      Sheet.Range('B'+j).Value :=deb.Name;
      Sheet.Range('C'+j).Value :=deb."Salesperson Code";
      v_hypernr:= deb."No.";
      v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
                   'target=Page%2021%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + deb."No." + '")';
      j:=INCSTR(j);
      UNTIL deb.NEXT=0;
      j:=INCSTR(j);
      END;


      deb.RESET;
      deb.SETFILTER(deb."Salesperson Code",'%1','');
      IF deb.FINDFIRST THEN BEGIN
      Sheet.Range('A'+j).Value :='Verk„ufercode ist leer';
      j:=INCSTR(j);
      REPEAT
      Sheet.Range('A'+j).Value :=deb."No.";
      Sheet.Range('B'+j).Value :=deb.Name;
      Sheet.Range('C'+j).Value :=deb."Salesperson Code";
      v_hypernr:= deb."No.";
      v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
                   'target=Page%2021%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + deb."No." + '")';
      j:=INCSTR(j);
      UNTIL deb.NEXT=0;
      j:=INCSTR(j);
      END;


      deb.RESET;
      deb.SETFILTER(deb."Customer Posting Group",'%1','');
      IF deb.FINDFIRST THEN BEGIN
      Sheet.Range('A'+j).Value :='Debitorenbuchungsgruppe ist leer';
      j:=INCSTR(j);
      REPEAT
      Sheet.Range('A'+j).Value :=deb."No.";
      Sheet.Range('B'+j).Value :=deb.Name;
      Sheet.Range('C'+j).Value :=deb."Salesperson Code";
      v_hypernr:= deb."No.";
      v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
                   'target=Page%2021%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + deb."No." + '")';
      j:=INCSTR(j);
      UNTIL deb.NEXT=0;
      j:=INCSTR(j);
      END;


      deb.RESET;
      deb.SETFILTER(deb."Shipping Agent Code",'%1','');
      IF deb.FINDFIRST THEN BEGIN
      Sheet.Range('A'+j).Value :='Zustellercode ist leer';
      j:=INCSTR(j);
      REPEAT
      Sheet.Range('A'+j).Value :=deb."No.";
      Sheet.Range('B'+j).Value :=deb.Name;
      Sheet.Range('C'+j).Value :=deb."Salesperson Code";
      v_hypernr:= deb."No.";
      v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
                   'target=Page%2021%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + deb."No." + '")';
      j:=INCSTR(j);
      UNTIL deb.NEXT=0;
      j:=INCSTR(j);
      END;

      {
      deb.RESET;
      deb.SETFILTER(deb."Shipping Agent Code",'%1','*-RG4');
      deb.SETFILTER(deb."Rech via EMail-Adresse",'%1','');
      IF deb.FINDFIRST THEN BEGIN
      Sheet.Range('A'+j).Value :='Zustellercode ist xxx-RG4 und kein Eintrag RECH via Email-Adresse';
      j:=INCSTR(j);
      REPEAT
      Sheet.Range('A'+j).Value :=deb."No.";
      Sheet.Range('B'+j).Value :=deb.Name;
      Sheet.Range('C'+j).Value :=deb."Salesperson Code";
      Sheet.Range('D'+j).Value :=deb."Betreuer Innendienst";
      Sheet.Range('E'+j).Value :=deb."Shipping Agent Code";
      IF deb."Rech via EMail"=FALSE THEN Sheet.Range('F'+j).Value :='Kein H„kchen Rech via Email gesetzt!';
      IF deb."Original RE nicht drucken"=FALSE THEN Sheet.Range('G'+j).Value :='Kein H„kchen "Original-RE nicht drucken" gesetzt!';
      v_hypernr:= deb."No.";
      v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
                   'target=Page%2021%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + deb."No." + '")';
      j:=INCSTR(j);
      UNTIL deb.NEXT=0;
      j:=INCSTR(j);
      END;
      }


      deb.RESET;
      deb.SETFILTER(deb."Shipping Agent Code",'%1','*-RG4');
      deb.SETFILTER(deb."Rech via EMail",'%1',FALSE);
      IF deb.FINDFIRST THEN BEGIN
      Sheet.Range('A'+j).Value :='Zustellercode ist xxx-RG4 und kein H„kchen "Rech via Email" gesetzt!';
      j:=INCSTR(j);
      REPEAT
      Sheet.Range('A'+j).Value :=deb."No.";
      Sheet.Range('B'+j).Value :=deb.Name;
      Sheet.Range('C'+j).Value :=deb."Salesperson Code";
      Sheet.Range('D'+j).Value :=deb."Betreuer Innendienst";
      Sheet.Range('E'+j).Value :=deb."Shipping Agent Code";
      IF deb."Rech via EMail"=FALSE THEN Sheet.Range('F'+j).Value :='Kein H„kchen Rech via Email gesetzt!';
      IF deb."Original RE nicht drucken"=FALSE THEN Sheet.Range('G'+j).Value :='Kein H„kchen "Original-RE nicht drucken" gesetzt!';
      v_hypernr:= deb."No.";
      v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
                   'target=Page%2021%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + deb."No." + '")';
      j:=INCSTR(j);
      UNTIL deb.NEXT=0;
      j:=INCSTR(j);
      END;



      deb.RESET;
      deb.SETFILTER(deb."Shipping Agent Code",'%1','*-RG4');
      deb.SETFILTER(deb."Original RE nicht drucken",'%1',FALSE);
      IF deb.FINDFIRST THEN BEGIN
      Sheet.Range('A'+j).Value :='Zustellercode ist xxx-RG4 und kein H„kchen "Original-RE nicht drucken" gesetzt!';
      j:=INCSTR(j);
      REPEAT
      Sheet.Range('A'+j).Value :=deb."No.";
      Sheet.Range('B'+j).Value :=deb.Name;
      Sheet.Range('C'+j).Value :=deb."Salesperson Code";
      Sheet.Range('D'+j).Value :=deb."Betreuer Innendienst";
      Sheet.Range('E'+j).Value :=deb."Shipping Agent Code";
      v_hypernr:= deb."No.";
      v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
                   'target=Page%2021%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + deb."No." + '")';
      j:=INCSTR(j);
      UNTIL deb.NEXT=0;
      j:=INCSTR(j);
      END;


      deb.RESET;
      deb.SETFILTER(deb."Shipping Agent Code",'%1','*-RG4');
      IF deb.FINDFIRST THEN BEGIN
      REPEAT
      Lief_adr.RESET;
      Lief_adr.SETFILTER(Lief_adr."Customer No.",'%1',deb."No.");
      Lief_adr.SETFILTER(Lief_adr."Shipping Agent Code",'<>%1&<>%2&<>%3&<>%4&<>%5&<>%6&<>%7','UPS-RG4','DHL-RG4','ABH-RG4','FEDEX-RG4','TNT-RG4','EIGEN-RG4','DIREKT-RG4');
      IF Lief_adr.FINDFIRST THEN BEGIN
          IF (deb."No."='100101') AND (Lief_adr."Shipping Agent Code"='POST') THEN BEGIN
          END ELSE BEGIN
             IF (deb."No."='738480') AND (Lief_adr."Shipping Agent Code"='EMAIL') THEN BEGIN
             END ELSE BEGIN
              Sheet.Range('A'+j).Value :='Zustellercode ist xxx-RG4 aber nicht in der Lieferadresse';
              j:=INCSTR(j);
              REPEAT
      //        Sheet.Range('A'+j).Value :=deb."No.";
              Sheet.Range('B'+j).Value :=deb.Name;
              Sheet.Range('C'+j).Value :=deb."Salesperson Code";
              Sheet.Range('D'+j).Value :=deb."Betreuer Innendienst";
              Sheet.Range('E'+j).Value :=deb."Shipping Agent Code";
              Sheet.Range('F'+j).Value :=Lief_adr."Shipping Agent Code";
              Sheet.Range('G'+j).Value :=Lief_adr."Customer No.";
              Sheet.Range('H'+j).Value :=Lief_adr.Code;
              v_hypernr:= deb."No.";
              v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
                           'target=Page%2021%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
              Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + deb."No." + '")';
      //        Sheet.Range('J'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";dep."No.")';
              j:=INCSTR(j);
              UNTIL Lief_adr.NEXT=0;
              j:=INCSTR(j);
          END;
          END;
          END;
      UNTIL deb.NEXT=0;
      j:=INCSTR(j);
      END;



      {
      deb.RESET;
      deb.SETFILTER(deb."Rech via EMail",'%1',TRUE);
      deb.SETFILTER(deb."Rech EMail-Adresse",'%1','');
      IF deb.FINDFIRST THEN BEGIN
      Sheet.Range('A'+j).Value :='H„kchen Rech via Email gesetzt und kein Eintrag RECH via Email-Adresse';
      j:=INCSTR(j);
      REPEAT
      //Sheet.Range('A'+j).Value :=deb."No.";
      v_hypernr:= deb."No.";
      v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
                   'target=Page%2021%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + deb."No." + '")';
      Sheet.Range('B'+j).Value :=deb.Name;
      Sheet.Range('C'+j).Value :=deb."Salesperson Code";
      Sheet.Range('D'+j).Value :=deb."Betreuer Innendienst";
      Sheet.Range('E'+j).Value :=deb."Shipping Agent Code";
      Sheet.Range('F'+j).Value :=deb."Rech via EMail";
      Sheet.Range('G'+j).Value :=deb."Rech EMail-Adresse";
      j:=INCSTR(j);
      UNTIL deb.NEXT=0;
      j:=INCSTR(j);
      END;
      }






      deb.RESET;
      deb.SETFILTER(deb."Country/Region Code",'%1','');
      IF deb.FINDFIRST THEN BEGIN
      Sheet.Range('A'+j).Value :='L„ndercode ist leer';
      j:=INCSTR(j);
      REPEAT
      Sheet.Range('A'+j).Value :=deb."No.";
      Sheet.Range('B'+j).Value :=deb.Name;
      Sheet.Range('C'+j).Value :=deb."Salesperson Code";
      v_hypernr:= deb."No.";
      v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
                   'target=Page%2021%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + deb."No." + '")';
      j:=INCSTR(j);
      UNTIL deb.NEXT=0;
      j:=INCSTR(j);
      END;


      deb.RESET;
      deb.SETFILTER(deb."Location Code",'%1','');
      IF deb.FINDFIRST THEN BEGIN
      Sheet.Range('A'+j).Value :='Lagerortcode ist leer';
      j:=INCSTR(j);
      REPEAT
      Sheet.Range('A'+j).Value :=deb."No.";
      Sheet.Range('B'+j).Value :=deb.Name;
      Sheet.Range('C'+j).Value :=deb."Salesperson Code";
      v_hypernr:= deb."No.";
      v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
                   'target=Page%2021%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + deb."No." + '")';
      j:=INCSTR(j);
      UNTIL deb.NEXT=0;
      j:=INCSTR(j);
      END;


      deb.RESET;
      deb.SETFILTER(deb."Gen. Bus. Posting Group",'%1','');
      IF deb.FINDFIRST THEN BEGIN
      Sheet.Range('A'+j).Value :='Gesch„ftsbuchungsgruppe ist leer';
      j:=INCSTR(j);
      REPEAT
      Sheet.Range('A'+j).Value :=deb."No.";
      Sheet.Range('B'+j).Value :=deb.Name;
      Sheet.Range('C'+j).Value :=deb."Salesperson Code";
      v_hypernr:= deb."No.";
      v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
                   'target=Page%2021%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + deb."No." + '")';
      j:=INCSTR(j);
      UNTIL deb.NEXT=0;
      j:=INCSTR(j);
      END;


      deb.RESET;
      deb.SETFILTER(deb."Territory Code",'%1','');
      IF deb.FINDFIRST THEN BEGIN
      Sheet.Range('A'+j).Value :='Gebietscode ist leer';
      j:=INCSTR(j);
      REPEAT
      Sheet.Range('A'+j).Value :=deb."No.";
      Sheet.Range('B'+j).Value :=deb.Name;
      Sheet.Range('C'+j).Value :=deb."Salesperson Code";
      v_hypernr:= deb."No.";
      v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
                   'target=Page%2021%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + deb."No." + '")';
      j:=INCSTR(j);
      UNTIL deb.NEXT=0;
      j:=INCSTR(j);
      END;


      deb.RESET;
      deb.SETFILTER(deb."Shipment Method Code",'%1','');
      IF deb.FINDFIRST THEN BEGIN
      Sheet.Range('A'+j).Value :='Lieferbedingungscode ist leer';
      j:=INCSTR(j);
      REPEAT
      Sheet.Range('A'+j).Value :=deb."No.";
      Sheet.Range('B'+j).Value :=deb.Name;
      Sheet.Range('C'+j).Value :=deb."Salesperson Code";
      v_hypernr:= deb."No.";
      v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
                   'target=Page%2021%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + deb."No." + '")';
      j:=INCSTR(j);
      UNTIL deb.NEXT=0;
      j:=INCSTR(j);
      END;


      deb.RESET;
      deb.SETFILTER(deb."Betreuer Innendienst",'%1','');
      IF deb.FINDFIRST THEN BEGIN
      Sheet.Range('A'+j).Value :='Betreuer Innendienst ist leer';
      j:=INCSTR(j);
      REPEAT
      Sheet.Range('A'+j).Value :=deb."No.";
      Sheet.Range('B'+j).Value :=deb.Name;
      Sheet.Range('C'+j).Value :=deb."Salesperson Code";
      v_hypernr:= deb."No.";
      v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
                   'target=Page%2021%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + deb."No." + '")';
      j:=INCSTR(j);
      UNTIL deb.NEXT=0;
      j:=INCSTR(j);
      END;


      deb.RESET;
      deb.SETFILTER(deb."Reminder Terms Code",'%1','');
      IF deb.FINDFIRST THEN BEGIN
      Sheet.Range('A'+j).Value :='Mahnmethode ist leer';
      j:=INCSTR(j);
      REPEAT
      Sheet.Range('A'+j).Value :=deb."No.";
      Sheet.Range('B'+j).Value :=deb.Name;
      Sheet.Range('C'+j).Value :=deb."Salesperson Code";
      v_hypernr:= deb."No.";
      v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
                   'target=Page%2021%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + deb."No." + '")';
      j:=INCSTR(j);
      UNTIL deb.NEXT=0;
      j:=INCSTR(j);
      END;


      deb.RESET;
      deb.SETFILTER(deb."Country/Region Code",'%1','DE');
      deb.SETFILTER(deb."Gen. Bus. Posting Group",'%1','EU');
      IF deb.FINDFIRST THEN BEGIN
      Sheet.Range('A'+j).Value :='L„ndercode DE und Gesch„ftsbuchungsgruppe EU stimmen nicht berein';
      j:=INCSTR(j);
      REPEAT
      Sheet.Range('A'+j).Value :=deb."No.";
      Sheet.Range('B'+j).Value :=deb.Name;
      Sheet.Range('C'+j).Value :=deb."Salesperson Code";
      Sheet.Range('D'+j).Value :=deb."Gen. Bus. Posting Group";
      Sheet.Range('E'+j).Value :=deb."Country/Region Code";
      j:=INCSTR(j);
      UNTIL deb.NEXT=0;
      j:=INCSTR(j);
      END;

      deb.RESET;
      deb.SETFILTER(deb."Gen. Bus. Posting Group",'%1','EU');
      deb.SETFILTER(deb."Country/Region Code",'%1|%2|%3|%4|%5|%6|%7|%8|%9','AT','BE','BG','CY','CZ','DK','EE','ES','FI');
      deb.SETFILTER(deb."Gen. Bus. Posting Group",'<>%1','EU');
      IF deb.FINDFIRST THEN BEGIN
      Sheet.Range('A'+j).Value :='L„ndercode XX und Gesch„ftsbuchungsgruppe EU stimmen nicht berein';
      j:=INCSTR(j);
      REPEAT
      Sheet.Range('A'+j).Value :=deb."No.";
      Sheet.Range('B'+j).Value :=deb.Name;
      Sheet.Range('C'+j).Value :=deb."Salesperson Code";
      Sheet.Range('D'+j).Value :=deb."Gen. Bus. Posting Group";
      Sheet.Range('E'+j).Value :=deb."Country/Region Code";
      j:=INCSTR(j);
      UNTIL deb.NEXT=0;
      j:=INCSTR(j);
      END;


      deb.RESET;
      deb.SETFILTER(deb."Gen. Bus. Posting Group",'%1','EU');
      deb.SETFILTER(deb."Country/Region Code",'%1|%2|%3|%4|%5|%6|%7|%8|%9','FR','GB','GR','HU','IE','IT','LT','LU','LV');
      deb.SETFILTER(deb."Gen. Bus. Posting Group",'<>%1','EU');
      IF deb.FINDFIRST THEN BEGIN
      Sheet.Range('A'+j).Value :='L„ndercode XX und Gesch„ftsbuchungsgruppe EU stimmen nicht berein';
      j:=INCSTR(j);
      REPEAT
      Sheet.Range('A'+j).Value :=deb."No.";
      Sheet.Range('B'+j).Value :=deb.Name;
      Sheet.Range('C'+j).Value :=deb."Salesperson Code";
      Sheet.Range('D'+j).Value :=deb."Gen. Bus. Posting Group";
      Sheet.Range('E'+j).Value :=deb."Country/Region Code";
      j:=INCSTR(j);
      UNTIL deb.NEXT=0;
      j:=INCSTR(j);
      END;


      deb.RESET;
      deb.SETFILTER(deb."Gen. Bus. Posting Group",'%1','EU');
      deb.SETFILTER(deb."Country/Region Code",'%1|%2|%3|%4|%5|%6|%7|%8','MT','NL','PL','PT','RO','SE','SI','SK');
      deb.SETFILTER(deb."Gen. Bus. Posting Group",'<>%1','EU');
      IF deb.FINDFIRST THEN BEGIN
      Sheet.Range('A'+j).Value :='L„ndercode XX und Gesch„ftsbuchungsgruppe EU stimmen nicht berein';
      j:=INCSTR(j);
      REPEAT
      Sheet.Range('A'+j).Value :=deb."No.";
      Sheet.Range('B'+j).Value :=deb.Name;
      Sheet.Range('C'+j).Value :=deb."Salesperson Code";
      Sheet.Range('D'+j).Value :=deb."Gen. Bus. Posting Group";
      Sheet.Range('E'+j).Value :=deb."Country/Region Code";
      j:=INCSTR(j);
      UNTIL deb.NEXT=0;
      j:=INCSTR(j);
      END;

      deb.RESET;
      deb.SETFILTER(deb.Warenkreditversicherung,'%1','GEMELDET');
      //deb.SETFILTER(deb."Credit Limit (LCY)",'<%1', 10000);
      IF deb.FINDFIRST THEN BEGIN
      Sheet.Range('A'+j).Value :='Kreditlimiteintr„ge stimmen bei "GEMELDET" nicht berein';
      j:=INCSTR(j);
      REPEAT
      OK:=TRUE;
      IF ((deb."WKV-Info"='12K') AND (deb."Credit Limit (LCY)"<>12000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='15K') AND (deb."Credit Limit (LCY)"<>15000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='20K') AND (deb."Credit Limit (LCY)"<>20000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='25K') AND (deb."Credit Limit (LCY)"<>25000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='30K') AND (deb."Credit Limit (LCY)"<>30000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='35K') AND (deb."Credit Limit (LCY)"<>35000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='40K') AND (deb."Credit Limit (LCY)"<>40000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='45K') AND (deb."Credit Limit (LCY)"<>45000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='50K') AND (deb."Credit Limit (LCY)"<>50000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='50K unver„ndert') AND (deb."Credit Limit (LCY)"<>50000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='60K') AND (deb."Credit Limit (LCY)"<>60000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='70K') AND (deb."Credit Limit (LCY)"<>70000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='75K') AND (deb."Credit Limit (LCY)"<>75000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='80K') AND (deb."Credit Limit (LCY)"<>80000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='90K') AND (deb."Credit Limit (LCY)"<>90000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='100K') AND (deb."Credit Limit (LCY)"<>100000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='113K') AND (deb."Credit Limit (LCY)"<>113000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='125K') AND (deb."Credit Limit (LCY)"<>125000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='150K') AND (deb."Credit Limit (LCY)"<>150000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='200K') AND (deb."Credit Limit (LCY)"<>200000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='250K') AND (deb."Credit Limit (LCY)"<>250000)) THEN OK:=FALSE;
      IF OK=FALSE THEN BEGIN
      deb.CALCFIELDS(deb."Balance (LCY)");
      Sheet.Range('A'+j).Value :=deb."No.";
      Sheet.Range('B'+j).Value :=deb.Name;
      Sheet.Range('C'+j).Value :=deb."Salesperson Code";
      Sheet.Range('D'+j).Value :=deb.Warenkreditversicherung;
      Sheet.Range('E'+j).Value :=deb."Credit Limit (LCY)";
      Sheet.Range('F'+j).Value :=deb."WKV-Info";
      Sheet.Range('G'+j).Value :=deb."Balance (LCY)";
      v_hypernr:= deb."No.";
      v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
                   'target=Page%2021%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + deb."No." + '")';
      j:=INCSTR(j);
      END;
      IF ((deb."WKV-Info"='12K') AND (deb."Credit Limit (LCY)"=12000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='15K') AND (deb."Credit Limit (LCY)"=15000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='20K') AND (deb."Credit Limit (LCY)"=20000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='25K') AND (deb."Credit Limit (LCY)"=25000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='30K') AND (deb."Credit Limit (LCY)"=30000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='35K') AND (deb."Credit Limit (LCY)"=35000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='40K') AND (deb."Credit Limit (LCY)"=40000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='45K') AND (deb."Credit Limit (LCY)"=45000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='50K') AND (deb."Credit Limit (LCY)"=50000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='50K unver„ndert') AND (deb."Credit Limit (LCY)"=50000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='60K') AND (deb."Credit Limit (LCY)"=60000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='70K') AND (deb."Credit Limit (LCY)"=70000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='75K') AND (deb."Credit Limit (LCY)"=75000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='80K') AND (deb."Credit Limit (LCY)"=80000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='90K') AND (deb."Credit Limit (LCY)"=90000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='100K') AND (deb."Credit Limit (LCY)"=100000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='113K') AND (deb."Credit Limit (LCY)"=113000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='125K') AND (deb."Credit Limit (LCY)"=125000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='150K') AND (deb."Credit Limit (LCY)"=150000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='200K') AND (deb."Credit Limit (LCY)"=200000)) THEN OK:=FALSE;
      IF ((deb."WKV-Info"='250K') AND (deb."Credit Limit (LCY)"=250000)) THEN OK:=FALSE;

      IF OK=TRUE THEN BEGIN
       IF deb."WKV-Info"<>'' THEN BEGIN
            Sheet.Range('A'+j).Value :='Programmabfrage einfgen mit';
            Sheet.Range('F'+j).Value :=deb."WKV-Info";
           j:=INCSTR(j);
         END;
      END;
      UNTIL deb.NEXT=0;
      j:=INCSTR(j);
      END;

      deb.RESET;
      deb.SETFILTER(deb."Credit Limit (LCY)",'>%1', 11000);
      deb.SETFILTER(deb.Warenkreditversicherung,'%1','');
      //deb.SETFILTER(deb.Warenkreditversicherung,'<>%1&<>%2&<>%3','GEMELDET','UNVERSICHERT','@-RATING');
      IF deb.FINDFIRST THEN BEGIN
      Sheet.Range('A'+j).Value :='Kreditlimiteintr„ge ber 11.000 ohne GEMELDET oder UNVERSICHERT';
      j:=INCSTR(j);
      REPEAT
      deb.CALCFIELDS(deb."Balance (LCY)");
      Sheet.Range('A'+j).Value :=deb."No.";
      Sheet.Range('B'+j).Value :=deb.Name;
      Sheet.Range('C'+j).Value :=deb."Salesperson Code";
      Sheet.Range('D'+j).Value :=deb.Warenkreditversicherung;
      Sheet.Range('E'+j).Value :=deb."Credit Limit (LCY)";
      Sheet.Range('F'+j).Value :=deb."WKV-Info";
      Sheet.Range('G'+j).Value :=deb."Balance (LCY)";
      v_hypernr:= deb."No.";
      v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
                   'target=Page%2021%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + deb."No." + '")';
      j:=INCSTR(j);
      UNTIL deb.NEXT=0;
      j:=INCSTR(j);
      END;



      deb.RESET;
      deb.SETFILTER(deb."No.",'<>%1','0');
      IF deb.FINDFIRST THEN BEGIN
      Sheet.Range('A'+j).Value :='Saldo gr”áer Kreditlimit';
      j:=INCSTR(j);
      REPEAT
      deb.CALCFIELDS(deb."Balance (LCY)");
      IF deb."Balance (LCY)" > deb."Credit Limit (LCY)" THEN BEGIN
      Sheet.Range('A'+j).Value :=deb."No.";
      Sheet.Range('B'+j).Value :=deb.Name;
      Sheet.Range('C'+j).Value :=deb."Salesperson Code";
      Sheet.Range('D'+j).Value :=deb.Warenkreditversicherung;
      Sheet.Range('E'+j).Value :=deb."Credit Limit (LCY)";
      Sheet.Range('F'+j).Value :=deb."WKV-Info";
      Sheet.Range('G'+j).Value :=deb."Balance (LCY)";
      v_hypernr:= deb."No.";
      v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
                   'target=Page%2021%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + deb."No." + '")';
      j:=INCSTR(j);
      END;
      UNTIL deb.NEXT=0;
      j:=INCSTR(j);
      END;





      j:=INCSTR(j);
      Excel.Visible(TRUE);
    END;

    PROCEDURE ID_Prove@1140056();
    BEGIN
      // ANFANG Daten fr ID_PROVE bereitstellen
      CLEAR(Excel);
      REPEAT
      UNTIL ISCLEAR(Excel);
      CREATE(Excel,FALSE,TRUE); //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('J:J').NumberFormat:='@';
      //Excel.Visible(TRUE);

      Sheet.Range('A1').Value := 'No_'; // definiert die Beschriftung der berschriftszeile
      Sheet.Range('B1').Value := 'Company Name';
      Sheet.Range('C1').Value := 'Name 2';
      Sheet.Range('D1').Value := 'First Name';
      Sheet.Range('E1').Value := 'Surname';
      Sheet.Range('F1').Value := 'Address';
      Sheet.Range('G1').Value := 'Address 2';
      Sheet.Range('H1').Value := 'Post Code';
      Sheet.Range('I1').Value := 'City';
      Sheet.Range('J1').Value := 'Nummer';
      j := '2';
      kontakt.RESET;
      kontakt.SETFILTER(kontakt.Type,'%1',0);
      IF kontakt.FINDFIRST THEN BEGIN
      REPEAT
         Sheet.Range('A'+j).Value :=kontakt."No.";
         Sheet.Range('B'+j).Value :=kontakt."Company Name";
         Sheet.Range('C'+j).Value :=kontakt."Name 2";
         Sheet.Range('D'+j).Value :=kontakt."First Name";
         Sheet.Range('E'+j).Value :=kontakt.Surname;
         Sheet.Range('F'+j).Value :=kontakt.Address;
         Sheet.Range('G'+j).Value :=kontakt."Address 2";
         Sheet.Range('H'+j).Value :=kontakt."Post Code";
         Sheet.Range('I'+j).Value :=kontakt.City;
         v_kontaktnr:=FORMAT(kontakt."No.");
         v_kontaktnr:=COPYSTR(v_kontaktnr,4);
         Sheet.Range('J'+j).Value :=v_kontaktnr;
          j:=INCSTR(j);
      UNTIL kontakt.NEXT=0;
      END;

      //Dateiname := 'D:\id_prove\2.91\Import\adr_nav_neu_text.csv';
      Dateiname := 'R:\id_prove\Import\adr_nav_neu_text.csv';
      IF ERASE('R:\id_prove\Import\adr_nav_neu_text.csv')THEN;
      //IF ERASE('D:\id_prove\2.91\Import\adr_nav_neu_text.csv')THEN;
      Book.SaveAs(Dateiname,6);//.csv Pageat
      Book.Close(TRUE);
      MESSAGE('ID-Prove Teil 1 abgeschlossen und gespeichert');
      ID_Prove_2;
    END;

    PROCEDURE ID_Prove_2@1140057();
    BEGIN
      // ANFANG Daten fr ID_PROVE bereitstellen
      CLEAR(Excel);
      REPEAT
      UNTIL ISCLEAR(Excel);
      CREATE(Excel,FALSE,TRUE);

      //CREATE(Excel,FALSE,TRUE);                                              //erzeugt excel
      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('J:J').NumberFormat:='@';
      //Excel.Visible(TRUE);

      Sheet.Range('A1').Value := 'No_'; // definiert die Beschriftung der berschriftszeile
      Sheet.Range('B1').Value := 'Company Name';
      Sheet.Range('C1').Value := 'Name 2';
      Sheet.Range('D1').Value := 'First Name';
      Sheet.Range('E1').Value := 'Surname';
      Sheet.Range('F1').Value := 'Address';
      Sheet.Range('G1').Value := 'Address 2';
      Sheet.Range('H1').Value := 'Post Code';
      Sheet.Range('I1').Value := 'City';
      Sheet.Range('J1').Value := 'Nummer';
      j := '2';
      kontakt.RESET;
      kontakt.SETFILTER(kontakt.Type,'%1',1);
      kontakt.SETFILTER(kontakt."Unternehmen verlassen",'%1',FALSE);
      IF kontakt.FINDFIRST THEN BEGIN
      REPEAT
         Sheet.Range('A'+j).Value :=kontakt."No.";
         Sheet.Range('B'+j).Value :=kontakt."Company Name";
         Sheet.Range('C'+j).Value :=kontakt."Name 2";
         Sheet.Range('D'+j).Value :=kontakt."First Name";
         Sheet.Range('E'+j).Value :=kontakt.Surname;
         Sheet.Range('F'+j).Value :=kontakt.Address;
         Sheet.Range('G'+j).Value :=kontakt."Address 2";
         Sheet.Range('H'+j).Value :=kontakt."Post Code";
         Sheet.Range('I'+j).Value :=kontakt.City;
         v_kontaktnr:=FORMAT(kontakt."No.");
         v_kontaktnr:=COPYSTR(v_kontaktnr,4);
         Sheet.Range('J'+j).Value :=v_kontaktnr;
          j:=INCSTR(j);
      UNTIL kontakt.NEXT=0;
      END;
      //Dateiname := 'D:\id_prove\2.91\Import\adr_nav_name_text.csv';
      Dateiname := 'R:\id_prove\Import\adr_nav_name_text.csv';
      IF ERASE('R:\id_prove\Import\adr_nav_name_text.csv')THEN;
      //IF ERASE('D:\id_prove\2.91\Import\adr_nav_name_text.csv')THEN;
      Book.SaveAs(Dateiname,6);//.csv Pageat
      Book.Close(TRUE);
      //Excel.Quit;
      MESSAGE('ID-Prove Datenbernahme abgeschlossen und gespeichert');
       CLEAR(Excel);
    END;

    PROCEDURE t„gl_AE_Saldo_abstimmen@1140058();
    BEGIN
      // ANFANG Differenzen in Excel ausgeben

      //IF ISCLEAR(Excel) THEN
      //  CREATE(Excel,FALSE,TRUE);                                            //erzeugt excel
      CLEAR(Excel);
      REPEAT
      UNTIL ISCLEAR(Excel);
      CREATE(Excel,FALSE,TRUE);

      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
      Sheet.Range('H:I').NumberFormat:='###.###,#####';
      Sheet.Range('L:M').NumberFormat:='###.###,##';
      Sheet.Range('Q:Q').NumberFormat:='###.###,####';

      Sheet.Range('A1').Value := 'Auftragsberwachung  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'Datum';
      Sheet.Range('B2').Value := 'AU-Nr';
      Sheet.Range('C2').Value := 'Pos-Nr';
      Sheet.Range('D2').Value := 'Debitor';
      Sheet.Range('E2').Value := 'Artikel';
      Sheet.Range('F2').Value := 'Menge';
      Sheet.Range('G2').Value := 'Restmenge';
      Sheet.Range('H2').Value := 'EK';
      Sheet.Range('I2').Value := 'VK';
      Sheet.Range('J2').Value := 'Art';
      Sheet.Range('K2').Value := 'Status';
      Sheet.Range('L2').Value := 'Art Diff';
      Sheet.Range('M2').Value := 'Menge Diff';
      Sheet.Range('N2').Value := 'EK Diff';
      Sheet.Range('O2').Value := 'VK Diff';
      Sheet.Range('P2').Value := 'WŽ-Diff';
      Sheet.Range('Q2').Value := 'WŽ';
      Sheet.Range('R2').Value := 'W„ Kurs';
      Sheet.Range('S2').Value := 'RE Menge';
      Sheet.Range('T2').Value := 'urspr AU-Datum';
      j := '3';                                   // <- Import in excel ab Zeile 3




      var_AU_Nr:='AU200000';
      tab_ab_bw.RESET;
      tab_ab_bw.SETCURRENTKEY(Belegart,AU_Nr,POS_Nr,Datum);
      tab_ab_bw.SETFILTER(tab_ab_bw.Belegart,'%1','AUšW');
      tab_ab_bw.SETFILTER(tab_ab_bw.Art,'%1|%2', 'NEU', 'ALT');
      tab_ab_bw.SETFILTER(tab_ab_bw.Status,'%1|%2|%3|%4|%5|%6|%7', 'NP','ŽN','ST','GP','FA','RE','WŽ');
      IF tab_ab_bw.FINDFIRST THEN BEGIN
      REPEAT
       IF tab_ab_bw.AU_Nr=var_AU_Nr THEN BEGIN
        Sheet.Range('A'+j).Value := tab_ab_bw.Datum;
        Sheet.Range('B'+j).Value := tab_ab_bw.AU_Nr;
        Sheet.Range('C'+j).Value := tab_ab_bw.POS_Nr;
        Sheet.Range('D'+j).Value := tab_ab_bw.Debitor;
        Sheet.Range('E'+j).Value := tab_ab_bw.Artikel;
        Sheet.Range('F'+j).Value := tab_ab_bw.Menge;
        Sheet.Range('G'+j).Value := tab_ab_bw.Restmenge;
        Sheet.Range('H'+j).Value := FORMAT(tab_ab_bw.EK);
        Sheet.Range('I'+j).Value := FORMAT(tab_ab_bw.VK);
        Sheet.Range('J'+j).Value := tab_ab_bw.Art;
        Sheet.Range('K'+j).Value := tab_ab_bw.Status;
        Sheet.Range('L'+j).Value := tab_ab_bw.Stat_Artikel;
        Sheet.Range('M'+j).Value := tab_ab_bw.Stat_Menge;
        Sheet.Range('N'+j).Value := tab_ab_bw.Stat_EK;
        Sheet.Range('O'+j).Value := tab_ab_bw.Stat_VK;
        IF tab_ab_bw.Stat_VK='WŽ' THEN BEGIN
        Sheet.Range('P'+j).Value := 'WŽ-Fehler';
        END;
        Sheet.Range('Q'+j).Value := tab_ab_bw.W„hrungscode;
        Sheet.Range('R'+j).Value := FORMAT(tab_ab_bw.w„_faktor);
        Sheet.Range('S'+j).Value := FORMAT(tab_ab_bw.re_menge);
        Sheet.Range('T'+j).Value := tab_ab_bw.Auftragsdatum;
        j:=INCSTR(j);

       END ELSE BEGIN
        j:=INCSTR(j);
        Sheet.Range('A'+j).Value := tab_ab_bw.Datum;
        Sheet.Range('B'+j).Value := tab_ab_bw.AU_Nr;
        Sheet.Range('C'+j).Value := tab_ab_bw.POS_Nr;
        Sheet.Range('D'+j).Value := tab_ab_bw.Debitor;
        Sheet.Range('E'+j).Value := tab_ab_bw.Artikel;
        Sheet.Range('F'+j).Value := tab_ab_bw.Menge;
        Sheet.Range('G'+j).Value := tab_ab_bw.Restmenge;
        Sheet.Range('H'+j).Value := FORMAT(tab_ab_bw.EK);
        Sheet.Range('I'+j).Value := FORMAT(tab_ab_bw.VK);
        Sheet.Range('J'+j).Value := tab_ab_bw.Art;
        Sheet.Range('K'+j).Value := tab_ab_bw.Status;
        Sheet.Range('L'+j).Value := tab_ab_bw.Stat_Artikel;
        Sheet.Range('M'+j).Value := tab_ab_bw.Stat_Menge;
        Sheet.Range('N'+j).Value := tab_ab_bw.Stat_EK;
        Sheet.Range('O'+j).Value := tab_ab_bw.Stat_VK;
        IF tab_ab_bw.Stat_VK='WŽ' THEN BEGIN
        Sheet.Range('P'+j).Value := 'WŽ-Fehler';
        END;
        Sheet.Range('Q'+j).Value := tab_ab_bw.W„hrungscode;
        Sheet.Range('R'+j).Value := FORMAT(tab_ab_bw.w„_faktor);
        Sheet.Range('S'+j).Value := FORMAT(tab_ab_bw.re_menge);
        Sheet.Range('T'+j).Value := tab_ab_bw.Auftragsdatum;
        j:=INCSTR(j);
        var_AU_Nr :=tab_ab_bw.AU_Nr;
       END;
      UNTIL tab_ab_bw.NEXT=0;
      END;

      Excel.Visible(TRUE);
      // ENDE Differenzen in Excel ausgeben


      //IF ERASE('F:\Daten Neu\User\Joachim\AB-Differenzen\2013_2014\Testspeicherung.xlsx')THEN;
      //Book.SaveAs('F:\Daten Neu\User\Joachim\AB-Differenzen\2013_2014\Testspeicherung.xlsx');
      //Book.Close(TRUE);
      // ///Excel.Visible(TRUE);
      // //Excel.Quit;

      Pfad_tag :=FORMAT(DATE2DMY(AE_holen_Datum_1,1));
      Pfad_monat := FORMAT(DATE2DMY(AE_holen_Datum_1,2));
      Pfad_jahr := FORMAT(DATE2DMY(AE_holen_Datum_1,3));

      Pfaddatum:='_' + Pfad_jahr + '_' + Pfad_monat + '_' + Pfad_tag;
      Pfad:='F:\Daten Neu\User\Joachim\AB-Differenzen\2013_2014\Diff'+Pfaddatum+'.xlsx';

      IF ERASE(Pfad)THEN;
      Book.SaveAs(Pfad);
      //Book.Close(TRUE);


      MESSAGE(' Differenzen wurden ordnungsgem„á nach Excel exportiert. ');
    END;

    PROCEDURE N2_berprfen@1140060();
    BEGIN
      CLEAR(Excel);
      REPEAT
      UNTIL ISCLEAR(Excel);
      CREATE(Excel,FALSE,TRUE);

      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet

      Sheet.Range('A1').Value := 'N2 šberprfung  '; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'Nr';
      Sheet.Range('B2').Value := 'Firma';
      Sheet.Range('C2').Value := 'Verk„ufer';
      Sheet.Range('D2').Value := 'N2';
      Sheet.Range('E2').Value := 'BBL';
      Sheet.Range('F2').Value := 'Anzahl';
      Sheet.Range('G2').Value := 'ZENT/KONSI';
      Sheet.Range('H2').Value := 'MUST';
      Sheet.Range('I2').Value := 'Gutschriften';

      j := '3';

      deb.RESET;
      deb.SETFILTER(deb."Shipping Agent Code",'%1|%2','N2','N1');
      deb.CALCFIELDS("No. of Pstd. Invoices");
      deb.SETFILTER(deb."No. of Pstd. Invoices",'>%1',1);
      IF deb.FINDFIRST THEN BEGIN
      REPEAT
      v_hypernr:= deb."No.";
      v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
                   'target=Page%2021%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + deb."No." + '")';


      //  Sheet.Range('A'+j).Value := deb."No.";
        Sheet.Range('B'+j).Value := deb.Name;
        Sheet.Range('C'+j).Value := deb."Salesperson Code";
        Sheet.Range('D'+j).Value := deb."Shipping Agent Code";
        Sheet.Range('E'+j).Value := deb."Payment Terms Code";
        deb.CALCFIELDS("No. of Pstd. Invoices");
        Sheet.Range('F'+j).Value := deb."No. of Pstd. Invoices";
        anz_zent := 0;
        anz_must := 0;
        anz_gutschr := 0;
        vkrk.RESET;
        vkrk.SETFILTER(vkrk."Sell-to Customer No.",'%1',deb."No.");
        IF vkrk.FINDFIRST THEN BEGIN
        REPEAT
         IF vkrk."Location Code"='ZENT' THEN anz_zent:= anz_zent+1;
         IF vkrk."Location Code"='MUST' THEN anz_must:= anz_must+1;
         IF vkrk."Location Code"='KONSI' THEN anz_zent:= anz_zent+1;
        UNTIL vkrk.NEXT=0;
        END;
        tab_guk.RESET;
        tab_guk.SETFILTER(tab_guk."Sell-to Customer No.",'%1',deb."No.");
        IF tab_guk.FINDFIRST THEN BEGIN
        REPEAT
        IF tab_guk."Location Code"='ZENT' THEN anz_gutschr:= anz_gutschr+1;
        IF tab_guk."Location Code"='KONSI' THEN anz_gutschr:= anz_gutschr+1;
        UNTIL tab_guk.NEXT=0;
        END;
        Sheet.Range('G'+j).Value := FORMAT(anz_zent);
        Sheet.Range('H'+j).Value := FORMAT(anz_must);
        Sheet.Range('I'+j).Value := FORMAT(anz_gutschr);

        j:=INCSTR(j);
      UNTIL deb.NEXT=0;
      END;

      deb.RESET;
      deb.SETFILTER(deb."Payment Terms Code",'%1','BBL');
      deb.CALCFIELDS("No. of Pstd. Invoices");
      deb.SETFILTER(deb."No. of Pstd. Invoices",'>%1',1);
      IF deb.FINDFIRST THEN BEGIN
      REPEAT
      v_hypernr:= deb."No.";
      v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
                   'target=Page%2021%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + deb."No." + '")';


      //  Sheet.Range('A'+j).Value := deb."No.";
        Sheet.Range('B'+j).Value := deb.Name;
        Sheet.Range('C'+j).Value := deb."Salesperson Code";
        Sheet.Range('D'+j).Value := deb."Shipping Agent Code";
        Sheet.Range('E'+j).Value := deb."Payment Terms Code";
        deb.CALCFIELDS("No. of Pstd. Invoices");
        Sheet.Range('F'+j).Value := deb."No. of Pstd. Invoices";
        anz_zent := 0;
        anz_must := 0;
        anz_gutschr := 0;
        vkrk.RESET;
        vkrk.SETFILTER(vkrk."Sell-to Customer No.",'%1',deb."No.");
        IF vkrk.FINDFIRST THEN BEGIN
        REPEAT
         IF vkrk."Location Code"='ZENT' THEN anz_zent:= anz_zent+1;
         IF vkrk."Location Code"='MUST' THEN anz_must:= anz_must+1;
         IF vkrk."Location Code"='KONSI' THEN anz_zent:= anz_zent+1;
        UNTIL vkrk.NEXT=0;
        Sheet.Range('J'+j).Value := vkrk."Posting Date";
        END;
        tab_guk.RESET;
        tab_guk.SETFILTER(tab_guk."Sell-to Customer No.",'%1',deb."No.");
        IF tab_guk.FINDFIRST THEN BEGIN
        REPEAT
        IF tab_guk."Location Code"='ZENT' THEN anz_gutschr:= anz_gutschr+1;
        IF tab_guk."Location Code"='KONSI' THEN anz_gutschr:= anz_gutschr+1;
        UNTIL tab_guk.NEXT=0;
        END;
        Sheet.Range('G'+j).Value := FORMAT(anz_zent);
        Sheet.Range('H'+j).Value := FORMAT(anz_must);
        Sheet.Range('I'+j).Value := FORMAT(anz_gutschr);

        j:=INCSTR(j);
      UNTIL deb.NEXT=0;
      END;



      Excel.Visible(TRUE);
      //Excel.Quit;
    END;

    PROCEDURE Abstimm_tab_belege@1140064();
    BEGIN
      {
      //     Listung der Rechnungen und Belege ist ausgeklammert.
      //     3. Teil berprft die einzelnen Rechnungen mit den Belegen und listet
      //     alle Rechnungen die keinen Eintrag in Belege haben.
      //     (Es sollten nur die Rechnungen des lfd. Tages sein, da diese noch nicht in die Tabelle Belege kopiert wurden.)
      CLEAR(Excel);
      REPEAT
      UNTIL ISCLEAR(Excel);
      CREATE(Excel,FALSE,TRUE);

      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet


      Sheet.Range('A1').Value := 'šberprfung der Rechnungen mit Tabelle Belege'; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'Rech Nr';
      Sheet.Range('B2').Value := 'Zeilen Nr';
      Sheet.Range('C2').Value := 'Artikel Nr';
      Sheet.Range('D2').Value := 'Menge';
      Sheet.Range('E2').Value := 'Preis';
      Sheet.Range('F2').Value := 'Buch.Datum';
      j := '3';

      rech.RESET;
      rech.SETFILTER(rech."Posting Date",'>%1',300614D);
      rech.SETFILTER(rech.Quantity,'>%1',0);
      rech.SETFILTER(rech.Type,'%1',rech.Type::Item);
      IF rech.FINDFIRST THEN BEGIN
      REPEAT
        Sheet.Range('A'+j).Value := rech."Document No.";
        Sheet.Range('B'+j).Value := rech."Line No.";
        Sheet.Range('C'+j).Value := rech."No.";
        Sheet.Range('D'+j).Value := FORMAT(rech.Quantity);
        Sheet.Range('E'+j).Value := rech."Unit Price";
        Sheet.Range('F'+j).Value := rech."Posting Date";
        j:=INCSTR(j);
      UNTIL rech.NEXT=0;
      END;
      Excel.Visible(TRUE);


      CLEAR(Excel);
      REPEAT
      UNTIL ISCLEAR(Excel);
      CREATE(Excel,FALSE,TRUE);

      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet


      Sheet.Range('A1').Value := 'šberprfung Tabelle Belege mit den Rechnungen'; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'Beleg Nr';
      Sheet.Range('B2').Value := 'Zeilen Nr';
      Sheet.Range('C2').Value := 'Artikel Nr';
      Sheet.Range('D2').Value := 'Menge';
      Sheet.Range('E2').Value := 'Preis';
      Sheet.Range('F2').Value := 'Buch.Datum';
      j := '3';

      Beleg.RESET;
      Beleg.SETFILTER(Beleg.Belegdatum,'>%1',300614D);
      Beleg.SETFILTER(Beleg.Menge,'>%1',0);
      Beleg.SETFILTER(Beleg.Belegart,'%1',Beleg.Belegart::Invoice);
      IF Beleg.FINDFIRST THEN BEGIN
      REPEAT
        Sheet.Range('A'+j).Value := Beleg."Belegnr.";
        Sheet.Range('B'+j).Value := Beleg."Zeilennr.";
        Sheet.Range('C'+j).Value := Beleg."Artikelnr.";
        Sheet.Range('D'+j).Value := FORMAT(Beleg.Menge);
        Sheet.Range('E'+j).Value := Beleg."VK-Preis";
        Sheet.Range('F'+j).Value := Beleg.Belegdatum;
        j:=INCSTR(j);
      UNTIL Beleg.NEXT=0;
      END;
      Excel.Visible(TRUE);

      }

      CLEAR(Excel);
      REPEAT
      UNTIL ISCLEAR(Excel);
      CREATE(Excel,FALSE,TRUE);

      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet


      Sheet.Range('A1').Value := 'šberprfung der Rechnungen mit Tabelle Belege'; // definiert die Beschriftung der berschriftszeile

      Sheet.Range('A2').Value := 'Rech Nr';
      Sheet.Range('B2').Value := 'Zeilen Nr';
      Sheet.Range('C2').Value := 'Artikel Nr';
      Sheet.Range('D2').Value := 'Menge';
      Sheet.Range('E2').Value := 'Preis';
      Sheet.Range('F2').Value := 'Buch.Datum';
      j := '3';

      rech.RESET;
      rech.SETFILTER(rech."Posting Date",'>%1',300614D);
      rech.SETFILTER(rech.Quantity,'>%1',0);
      rech.SETFILTER(rech.Type,'%1',rech.Type::Item);
      IF rech.FINDFIRST THEN BEGIN
      REPEAT
       Beleg.RESET;
       Beleg.SETFILTER(Beleg."Belegnr.",'%1',rech."Document No.");
       Beleg.SETFILTER(Beleg."Zeilennr.",'%1',rech."Line No.");
        IF Beleg.FINDFIRST THEN BEGIN
        END ELSE BEGIN
          Sheet.Range('A'+j).Value := rech."Document No.";
          Sheet.Range('B'+j).Value := rech."Line No.";
          Sheet.Range('C'+j).Value := rech."No.";
          Sheet.Range('D'+j).Value := FORMAT(rech.Quantity);
          Sheet.Range('E'+j).Value := rech."Unit Price";
          Sheet.Range('F'+j).Value := rech."Posting Date";
          Sheet.Range('G'+j).Value := 'Rechnung fehlt in Tabelle Belege';
          j:=INCSTR(j);
        END;
      UNTIL rech.NEXT=0;
      END;
      Excel.Visible(TRUE);
    END;

    PROCEDURE geschenk_adr_liste@1140066();
    BEGIN
      CLEAR(Excel);
      REPEAT
      UNTIL ISCLEAR(Excel);
      CREATE(Excel,FALSE,TRUE);

      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet


      Sheet.Range('A1').Value := 'Adressliste:  Mailing fr Geschenkversand'; // definiert die Beschriftung der berschriftszeile
      Sheet.Range('A2').Value := 'Filter Aktion:';
      Sheet.Range('C2').Value := 'Geschenk';
      Sheet.Range('A3').Value := 'Filter Betreff:';
      Sheet.Range('C3').Value := 'Fan-Schminke 6/2016';

      Sheet.Range('A4').Value := 'Kontaktnr';
      Sheet.Range('B4').Value := 'Mandanennr';
      Sheet.Range('C4').Value := 'Aktion';
      Sheet.Range('D4').Value := 'Betreff';
      Sheet.Range('E4').Value := 'Statustext';
      Sheet.Range('F4').Value := 'Anzahl';
      Sheet.Range('G4').Value := 'Bearbeiter';
      Sheet.Range('H4').Value := 'Anrede';
      Sheet.Range('I4').Value := 'Titel';
      Sheet.Range('J4').Value := 'Vorname';
      Sheet.Range('K4').Value := 'Name';
      Sheet.Range('L4').Value := 'Firma1';
      Sheet.Range('M4').Value := 'Firma2';
      Sheet.Range('N4').Value := 'Strasse1';
      Sheet.Range('O4').Value := 'Strasse2';
      Sheet.Range('P4').Value := 'Land';
      Sheet.Range('Q4').Value := 'Plz';
      Sheet.Range('R4').Value := 'Ort';

      j := '5';

      tab_geschenk.RESET;
      tab_geschenk.SETFILTER(tab_geschenk.Aktion,'%1',tab_geschenk.Aktion::Geschenk);
      tab_geschenk.SETFILTER(tab_geschenk.Betreff,'%1','Fan-Schminke 6/2016');
      IF tab_geschenk.FINDFIRST THEN BEGIN
      REPEAT
         kontakt.RESET;
         kontakt.SETFILTER(kontakt."No.",'%1',tab_geschenk."Kontaktnr.");
         IF kontakt.FINDFIRST THEN BEGIN

          Sheet.Range('A'+j).Value := tab_geschenk."Kontaktnr.";
          Sheet.Range('B'+j).Value := tab_geschenk."Mandantennr.";
          Sheet.Range('C'+j).Value := tab_geschenk.Aktion;
          Sheet.Range('D'+j).Value := tab_geschenk.Betreff;
          Sheet.Range('E'+j).Value := tab_geschenk.Statustext;
          Sheet.Range('F'+j).Value := tab_geschenk.Anzahl;
          Sheet.Range('G'+j).Value := tab_geschenk."Zust„ndig Bearb";
          IF kontakt."Salutation Code"='MANDANT' THEN BEGIN
          Sheet.Range('H'+j).Value := 'Fa.';
          END;
          IF kontakt."Salutation Code"='HERR' THEN BEGIN
          Sheet.Range('H'+j).Value := 'Herr';
          Sheet.Range('I'+j).Value := kontakt."Job Title";
          Sheet.Range('J'+j).Value := kontakt."First Name";
          Sheet.Range('K'+j).Value := kontakt.Surname;
          END;
          IF kontakt."Salutation Code"='FRAU' THEN BEGIN
          Sheet.Range('H'+j).Value := 'Frau';
          Sheet.Range('I'+j).Value := kontakt."Job Title";
          Sheet.Range('J'+j).Value := kontakt."First Name";
          Sheet.Range('K'+j).Value := kontakt.Surname;
          END;
          kontakt1.RESET;
          kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
          IF kontakt1.FINDFIRST THEN BEGIN
          Sheet.Range('L'+j).Value := kontakt1.Name;
          Sheet.Range('M'+j).Value := kontakt1."Name 2"
          END;
          Sheet.Range('N'+j).Value := kontakt.Address;
          Sheet.Range('O'+j).Value := kontakt."Address 2";
          Sheet.Range('P'+j).Value := kontakt."Country/Region Code";
          Sheet.Range('Q'+j).Value := FORMAT(kontakt."Country/Region Code"+' '+kontakt."Post Code");
          Sheet.Range('R'+j).Value := kontakt.City;
          Sheet.Range('S'+j).Value := kontakt."Unternehmen verlassen";
          j:=INCSTR(j);

         END;
      UNTIL tab_geschenk.NEXT=0;
      END;

      Excel.Visible(TRUE);
    END;

    PROCEDURE geschenk_adr_liste_bersicht@1140067();
    BEGIN
      CLEAR(Excel);
      REPEAT
      UNTIL ISCLEAR(Excel);
      CREATE(Excel,FALSE,TRUE);

      Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
      Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet


      Sheet.Range('A1').Value := 'Adressliste fr Geschenkversand'; // definiert die Beschriftung der berschriftszeile
      //Sheet.Range('A2').Value := 'Filter Aktion:';
      //Sheet.Range('C2').Value := 'Geschenk';
      //Sheet.Range('A3').Value := 'Filter Betreff:';
      //Sheet.Range('C3').Value := 'Fan-Schminke 6/2016';

      Sheet.Range('A4').Value := 'Kontaktnr';
      Sheet.Range('B4').Value := 'Mandanennr';
      Sheet.Range('C4').Value := 'Aktion';
      Sheet.Range('D4').Value := 'Betreff';
      Sheet.Range('E4').Value := 'Statustext';
      Sheet.Range('F4').Value := 'Anzahl';
      Sheet.Range('G4').Value := 'Bearbeiter';
      Sheet.Range('H4').Value := 'Anrede';
      Sheet.Range('I4').Value := 'Titel';
      Sheet.Range('J4').Value := 'Vorname';
      Sheet.Range('K4').Value := 'Name';
      Sheet.Range('L4').Value := 'Firma1';
      Sheet.Range('M4').Value := 'Firma2';
      Sheet.Range('N4').Value := 'Strasse1';
      Sheet.Range('O4').Value := 'Strasse2';
      Sheet.Range('P4').Value := 'Land';
      Sheet.Range('Q4').Value := 'Plz';
      Sheet.Range('R4').Value := 'Ort';
      Sheet.Range('S4').Value := 'Unternehmen verlassen';
      Sheet.Range('T4').Value := 'Fan-Schminke 6/2006';
      Sheet.Range('u4').Value := 'Test fr weiteres Geschenk';
      //  hier weitere Aktionen eintragen und weiter unten auswerten


      j := '5';

      kontakt.RESET;
      //kontakt.SETFILTER(kontakt.Type,'%1',kontakt.Type::Person);
      kontakt.SETFILTER(kontakt."Unternehmen verlassen",'%1',FALSE);
      IF kontakt.FINDFIRST THEN BEGIN
      REPEAT
          tab_geschenk.RESET;
          tab_geschenk.SETFILTER(tab_geschenk."Kontaktnr.",'%1',kontakt."No.");
          tab_geschenk.SETFILTER(tab_geschenk.Aktion,'%1',tab_geschenk.Aktion::Geschenk);
          IF tab_geschenk.FINDFIRST THEN BEGIN
          REPEAT

      v_hypernr:= kontakt."No.";
      v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
                   'target=Page%205050%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      Sheet.Range('A'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + kontakt."No." + '")';

      v_hypernr:= kontakt."Company No.";
      v_hyperlink:='navision://client/run?servername=w2k3-sql2005-na%26database=DynamicsNav%26company=TOPAS%26'+
                   'target=Page%205050%26view=SORTING(Field1)%26position=Field1=0('+v_hypernr+')%26servertype=MSSQL';
      Sheet.Range('B'+j).Value := '=HYPERLINK("'+ v_hyperlink +'";"' + kontakt."Company No." + '")';


      //    Sheet.Range('A'+j).Value := tab_geschenk."Kontaktnr.";
      //    Sheet.Range('B'+j).Value := tab_geschenk."Mandantennr.";
          Sheet.Range('C'+j).Value := kontakt."Salesperson Code";
          Sheet.Range('D'+j).Value := kontakt."Betreuer Innendienst";
          Sheet.Range('E'+j).Value := kontakt."Territory Code";
          Sheet.Range('F'+j).Value := tab_geschenk.Statustext;

          Sheet.Range('G'+j).Value := tab_geschenk."Zust„ndig Bearb";
          IF kontakt."Salutation Code"='MANDANT' THEN BEGIN
          Sheet.Range('H'+j).Value := 'Fa.';
          END;
          IF kontakt."Salutation Code"='HERR' THEN BEGIN
          Sheet.Range('H'+j).Value := 'Herr';
          Sheet.Range('I'+j).Value := kontakt."Job Title";
          Sheet.Range('J'+j).Value := kontakt."First Name";
          Sheet.Range('K'+j).Value := kontakt.Surname;
          END;
          IF kontakt."Salutation Code"='FRAU' THEN BEGIN
          Sheet.Range('H'+j).Value := 'Frau';
          Sheet.Range('I'+j).Value := kontakt."Job Title";
          Sheet.Range('J'+j).Value := kontakt."First Name";
          Sheet.Range('K'+j).Value := kontakt.Surname;
          END;
          kontakt1.RESET;
          kontakt1.SETFILTER(kontakt1."No.",'%1',kontakt."Company No.");
          IF kontakt1.FINDFIRST THEN BEGIN
          Sheet.Range('L'+j).Value := kontakt1.Name;
          Sheet.Range('M'+j).Value := kontakt1."Name 2"
          END;
          Sheet.Range('N'+j).Value := kontakt.Address;
          Sheet.Range('O'+j).Value := kontakt."Address 2";
          Sheet.Range('P'+j).Value := kontakt."Country/Region Code";
          Sheet.Range('Q'+j).Value := FORMAT(kontakt."Country/Region Code"+' '+kontakt."Post Code");
          Sheet.Range('R'+j).Value := kontakt.City;
          Sheet.Range('S'+j).Value := kontakt."Unternehmen verlassen";
          IF tab_geschenk.Betreff='Fan-Schminke 6/2016' THEN
          Sheet.Range('T'+j).Value := tab_geschenk.Anzahl;
          IF tab_geschenk.Betreff='Test' THEN
          Sheet.Range('U'+j).Value := tab_geschenk.Anzahl;

      // weitere Aktionen hier auswerten mit IF Abfrage
      // aus dem Tabellen FELD Betreff
          j:=INCSTR(j);

          UNTIL tab_geschenk.NEXT=0;
          END;
      UNTIL kontakt.NEXT=0;
      END;
      Excel.Visible(TRUE);
    END;

    EVENT Sheet1@1140127::SelectionChange@1543(Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Range");
    BEGIN
    END;

    EVENT Sheet1@1140127::BeforeDoubleClick@1537(Target@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Range";VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Sheet1@1140127::BeforeRightClick@1534(Target@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Range";VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Sheet1@1140127::Activate@304();
    BEGIN
    END;

    EVENT Sheet1@1140127::Deactivate@1530();
    BEGIN
    END;

    EVENT Sheet1@1140127::Calculate@279();
    BEGIN
    END;

    EVENT Sheet1@1140127::Change@1545(Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Range");
    BEGIN
    END;

    EVENT Sheet1@1140127::FollowHyperlink@1470(Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00024431-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Hyperlink");
    BEGIN
    END;

    EVENT Sheet1@1140127::PivotTableUpdate@2156(Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable");
    BEGIN
    END;

    EVENT Sheet1@1140127::PivotTableAfterValueChange@2886(TargetPivotTable@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable";TargetRange@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Range");
    BEGIN
    END;

    EVENT Sheet1@1140127::PivotTableBeforeAllocateChanges@2889(TargetPivotTable@1140003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable";ValueChangeStart@1140002 : Integer;ValueChangeEnd@1140001 : Integer;VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Sheet1@1140127::PivotTableBeforeCommitChanges@2892(TargetPivotTable@1140003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable";ValueChangeStart@1140002 : Integer;ValueChangeEnd@1140001 : Integer;VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Sheet1@1140127::PivotTableBeforeDiscardChanges@2893(TargetPivotTable@1140002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable";ValueChangeStart@1140001 : Integer;ValueChangeEnd@1140000 : Integer);
    BEGIN
    END;

    EVENT Sheet1@1140127::PivotTableChangeSync@2894(Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable");
    BEGIN
    END;

    EVENT Book1@1140128::Open@1923();
    BEGIN
    END;

    EVENT Book1@1140128::Activate@304();
    BEGIN
    END;

    EVENT Book1@1140128::Deactivate@1530();
    BEGIN
    END;

    EVENT Book1@1140128::BeforeClose@1546(VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book1@1140128::BeforeSave@1547(SaveAsUI@1140001 : Boolean;VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book1@1140128::BeforePrint@1549(VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book1@1140128::NewSheet@1550(Sh@1140000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Book1@1140128::AddinInstall@1552();
    BEGIN
    END;

    EVENT Book1@1140128::AddinUninstall@1553();
    BEGIN
    END;

    EVENT Book1@1140128::WindowResize@1554(Wn@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Window");
    BEGIN
    END;

    EVENT Book1@1140128::WindowActivate@1556(Wn@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Window");
    BEGIN
    END;

    EVENT Book1@1140128::WindowDeactivate@1557(Wn@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Window");
    BEGIN
    END;

    EVENT Book1@1140128::SheetSelectionChange@1558(Sh@1140001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Range");
    BEGIN
    END;

    EVENT Book1@1140128::SheetBeforeDoubleClick@1559(Sh@1140002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Range";VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book1@1140128::SheetBeforeRightClick@1560(Sh@1140002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Range";VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book1@1140128::SheetActivate@1561(Sh@1140000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Book1@1140128::SheetDeactivate@1562(Sh@1140000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Book1@1140128::SheetCalculate@1563(Sh@1140000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Book1@1140128::SheetChange@1564(Sh@1140001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Range");
    BEGIN
    END;

    EVENT Book1@1140128::SheetFollowHyperlink@1854(Sh@1140001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00024431-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Hyperlink");
    BEGIN
    END;

    EVENT Book1@1140128::SheetPivotTableUpdate@2157(Sh@1140001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable");
    BEGIN
    END;

    EVENT Book1@1140128::PivotTableCloseConnection@2158(Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable");
    BEGIN
    END;

    EVENT Book1@1140128::PivotTableOpenConnection@2159(Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable");
    BEGIN
    END;

    EVENT Book1@1140128::Sync@2266(SyncEventType@1140000 : Integer);
    BEGIN
    END;

    EVENT Book1@1140128::BeforeXmlImport@2283(Map@1140003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.XmlMap";Url@1140002 : Text[1024];IsRefresh@1140001 : Boolean;VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book1@1140128::AfterXmlImport@2285(Map@1140002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.XmlMap";IsRefresh@1140001 : Boolean;Result@1140000 : Integer);
    BEGIN
    END;

    EVENT Book1@1140128::RowsetComplete@2610(Description@1140002 : Text[1024];Sheet@1140001 : Text[1024];Success@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book1@1140128::SheetPivotTableAfterValueChange@2895(Sh@1140002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable";TargetRange@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Range");
    BEGIN
    END;

    EVENT Book1@1140128::SheetPivotTableBeforeAllocateChanges@2896(Sh@1140004 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1140003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable";ValueChangeStart@1140002 : Integer;ValueChangeEnd@1140001 : Integer;VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book1@1140128::SheetPivotTableChangeSync@2899(Sh@1140001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable");
    BEGIN
    END;

    EVENT Book1@1140128::AfterSave@2900(Success@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book1@1140128::NewChart@2901(Ch@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020821-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Chart");
    BEGIN
    END;

    EVENT Sheet@1140161::SelectionChange@1543(Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Range");
    BEGIN
    END;

    EVENT Sheet@1140161::BeforeDoubleClick@1537(Target@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Range";VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Sheet@1140161::BeforeRightClick@1534(Target@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Range";VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Sheet@1140161::Activate@304();
    BEGIN
    END;

    EVENT Sheet@1140161::Deactivate@1530();
    BEGIN
    END;

    EVENT Sheet@1140161::Calculate@279();
    BEGIN
    END;

    EVENT Sheet@1140161::Change@1545(Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Range");
    BEGIN
    END;

    EVENT Sheet@1140161::FollowHyperlink@1470(Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00024431-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Hyperlink");
    BEGIN
    END;

    EVENT Sheet@1140161::PivotTableUpdate@2156(Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable");
    BEGIN
    END;

    EVENT Sheet@1140161::PivotTableAfterValueChange@2886(TargetPivotTable@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable";TargetRange@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Range");
    BEGIN
    END;

    EVENT Sheet@1140161::PivotTableBeforeAllocateChanges@2889(TargetPivotTable@1140003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable";ValueChangeStart@1140002 : Integer;ValueChangeEnd@1140001 : Integer;VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Sheet@1140161::PivotTableBeforeCommitChanges@2892(TargetPivotTable@1140003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable";ValueChangeStart@1140002 : Integer;ValueChangeEnd@1140001 : Integer;VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Sheet@1140161::PivotTableBeforeDiscardChanges@2893(TargetPivotTable@1140002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable";ValueChangeStart@1140001 : Integer;ValueChangeEnd@1140000 : Integer);
    BEGIN
    END;

    EVENT Sheet@1140161::PivotTableChangeSync@2894(Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable");
    BEGIN
    END;

    EVENT Book@1140163::Open@1923();
    BEGIN
    END;

    EVENT Book@1140163::Activate@304();
    BEGIN
    END;

    EVENT Book@1140163::Deactivate@1530();
    BEGIN
    END;

    EVENT Book@1140163::BeforeClose@1546(VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book@1140163::BeforeSave@1547(SaveAsUI@1140001 : Boolean;VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book@1140163::BeforePrint@1549(VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book@1140163::NewSheet@1550(Sh@1140000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Book@1140163::AddinInstall@1552();
    BEGIN
    END;

    EVENT Book@1140163::AddinUninstall@1553();
    BEGIN
    END;

    EVENT Book@1140163::WindowResize@1554(Wn@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Window");
    BEGIN
    END;

    EVENT Book@1140163::WindowActivate@1556(Wn@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Window");
    BEGIN
    END;

    EVENT Book@1140163::WindowDeactivate@1557(Wn@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Window");
    BEGIN
    END;

    EVENT Book@1140163::SheetSelectionChange@1558(Sh@1140001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Range");
    BEGIN
    END;

    EVENT Book@1140163::SheetBeforeDoubleClick@1559(Sh@1140002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Range";VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book@1140163::SheetBeforeRightClick@1560(Sh@1140002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Range";VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book@1140163::SheetActivate@1561(Sh@1140000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Book@1140163::SheetDeactivate@1562(Sh@1140000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Book@1140163::SheetCalculate@1563(Sh@1140000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Book@1140163::SheetChange@1564(Sh@1140001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Range");
    BEGIN
    END;

    EVENT Book@1140163::SheetFollowHyperlink@1854(Sh@1140001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00024431-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Hyperlink");
    BEGIN
    END;

    EVENT Book@1140163::SheetPivotTableUpdate@2157(Sh@1140001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable");
    BEGIN
    END;

    EVENT Book@1140163::PivotTableCloseConnection@2158(Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable");
    BEGIN
    END;

    EVENT Book@1140163::PivotTableOpenConnection@2159(Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable");
    BEGIN
    END;

    EVENT Book@1140163::Sync@2266(SyncEventType@1140000 : Integer);
    BEGIN
    END;

    EVENT Book@1140163::BeforeXmlImport@2283(Map@1140003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.XmlMap";Url@1140002 : Text[1024];IsRefresh@1140001 : Boolean;VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book@1140163::AfterXmlImport@2285(Map@1140002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.XmlMap";IsRefresh@1140001 : Boolean;Result@1140000 : Integer);
    BEGIN
    END;

    EVENT Book@1140163::BeforeXmlExport@2287(Map@1140002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.XmlMap";Url@1140001 : Text[1024];VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book@1140163::AfterXmlExport@2288(Map@1140002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.XmlMap";Url@1140001 : Text[1024];Result@1140000 : Integer);
    BEGIN
    END;

    EVENT Book@1140163::RowsetComplete@2610(Description@1140002 : Text[1024];Sheet@1140001 : Text[1024];Success@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book@1140163::SheetPivotTableAfterValueChange@2895(Sh@1140002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable";TargetRange@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Range");
    BEGIN
    END;

    EVENT Book@1140163::SheetPivotTableBeforeAllocateChanges@2896(Sh@1140004 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1140003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable";ValueChangeStart@1140002 : Integer;ValueChangeEnd@1140001 : Integer;VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book@1140163::SheetPivotTableBeforeCommitChanges@2897(Sh@1140004 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1140003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable";ValueChangeStart@1140002 : Integer;ValueChangeEnd@1140001 : Integer;VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book@1140163::SheetPivotTableBeforeDiscardChanges@2898(Sh@1140003 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1140002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable";ValueChangeStart@1140001 : Integer;ValueChangeEnd@1140000 : Integer);
    BEGIN
    END;

    EVENT Book@1140163::SheetPivotTableChangeSync@2899(Sh@1140001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable");
    BEGIN
    END;

    EVENT Book@1140163::AfterSave@2900(Success@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book@1140163::NewChart@2901(Ch@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020821-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Chart");
    BEGIN
    END;

    EVENT Excel@1140164::NewWorkbook@1565(Wb@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Workbook");
    BEGIN
    END;

    EVENT Excel@1140164::SheetSelectionChange@1558(Sh@1140001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Range");
    BEGIN
    END;

    EVENT Excel@1140164::SheetBeforeDoubleClick@1559(Sh@1140002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Range";VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1140164::SheetBeforeRightClick@1560(Sh@1140002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Range";VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1140164::SheetActivate@1561(Sh@1140000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Excel@1140164::SheetDeactivate@1562(Sh@1140000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Excel@1140164::SheetCalculate@1563(Sh@1140000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Excel@1140164::SheetChange@1564(Sh@1140001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Range");
    BEGIN
    END;

    EVENT Excel@1140164::WorkbookOpen@1567(Wb@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Workbook");
    BEGIN
    END;

    EVENT Excel@1140164::WorkbookActivate@1568(Wb@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Workbook");
    BEGIN
    END;

    EVENT Excel@1140164::WorkbookDeactivate@1569(Wb@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Workbook");
    BEGIN
    END;

    EVENT Excel@1140164::WorkbookBeforeClose@1570(Wb@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Workbook";VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1140164::WorkbookBeforeSave@1571(Wb@1140002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Workbook";SaveAsUI@1140001 : Boolean;VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1140164::WorkbookBeforePrint@1572(Wb@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Workbook";VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1140164::WorkbookNewSheet@1573(Wb@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Workbook";Sh@1140000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Excel@1140164::WorkbookAddinInstall@1574(Wb@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Workbook");
    BEGIN
    END;

    EVENT Excel@1140164::WorkbookAddinUninstall@1575(Wb@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Workbook");
    BEGIN
    END;

    EVENT Excel@1140164::WindowResize@1554(Wb@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Workbook";Wn@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Window");
    BEGIN
    END;

    EVENT Excel@1140164::WindowActivate@1556(Wb@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Workbook";Wn@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Window");
    BEGIN
    END;

    EVENT Excel@1140164::WindowDeactivate@1557(Wb@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Workbook";Wn@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020893-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Window");
    BEGIN
    END;

    EVENT Excel@1140164::SheetFollowHyperlink@1854(Sh@1140001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00024431-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Hyperlink");
    BEGIN
    END;

    EVENT Excel@1140164::SheetPivotTableUpdate@2157(Sh@1140001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable");
    BEGIN
    END;

    EVENT Excel@1140164::WorkbookPivotTableCloseConnection@2160(Wb@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Workbook";Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable");
    BEGIN
    END;

    EVENT Excel@1140164::WorkbookPivotTableOpenConnection@2161(Wb@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Workbook";Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable");
    BEGIN
    END;

    EVENT Excel@1140164::WorkbookSync@2289(Wb@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Workbook";SyncEventType@1140000 : Integer);
    BEGIN
    END;

    EVENT Excel@1140164::WorkbookBeforeXmlImport@2290(Wb@1140004 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Workbook";Map@1140003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.XmlMap";Url@1140002 : Text[1024];IsRefresh@1140001 : Boolean;VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1140164::WorkbookAfterXmlImport@2291(Wb@1140003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Workbook";Map@1140002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.XmlMap";IsRefresh@1140001 : Boolean;Result@1140000 : Integer);
    BEGIN
    END;

    EVENT Excel@1140164::WorkbookBeforeXmlExport@2292(Wb@1140003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Workbook";Map@1140002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.XmlMap";Url@1140001 : Text[1024];VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1140164::WorkbookAfterXmlExport@2293(Wb@1140003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Workbook";Map@1140002 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{0002447B-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.XmlMap";Url@1140001 : Text[1024];Result@1140000 : Integer);
    BEGIN
    END;

    EVENT Excel@1140164::WorkbookRowsetComplete@2611(Wb@1140003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Workbook";Description@1140002 : Text[1024];Sheet@1140001 : Text[1024];Success@1140000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1140164::AfterCalculate@2612();
    BEGIN
    END;

    EVENT Excel@1140164::SheetPivotTableAfterValueChange@2895(Sh@1140002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable";TargetRange@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020846-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Range");
    BEGIN
    END;

    EVENT Excel@1140164::SheetPivotTableBeforeCommitChanges@2897(Sh@1140004 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";TargetPivotTable@1140003 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020872-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.PivotTable";ValueChangeStart@1140002 : Integer;ValueChangeEnd@1140001 : Integer;VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1140164::ProtectedViewWindowOpen@2903(Pvw@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{000244CD-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.ProtectedViewWindow");
    BEGIN
    END;

    EVENT Excel@1140164::ProtectedViewWindowResize@2908(Pvw@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{000244CD-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.ProtectedViewWindow");
    BEGIN
    END;

    EVENT Excel@1140164::ProtectedViewWindowActivate@2909(Pvw@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{000244CD-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.ProtectedViewWindow");
    BEGIN
    END;

    EVENT Excel@1140164::ProtectedViewWindowDeactivate@2910(Pvw@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{000244CD-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.ProtectedViewWindow");
    BEGIN
    END;

    EVENT Excel@1140164::WorkbookAfterSave@2911(Wb@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Workbook";Success@1140000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1140164::WorkbookNewChart@2912(Wb@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020819-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Workbook";Ch@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.7:{00020821-0000-0000-C000-000000000046}:'Microsoft Excel 14.0 Object Library'.Chart");
    BEGIN
    END;

    BEGIN
    END.
  }
}

