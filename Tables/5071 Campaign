OBJECT Table 5071 Campaign
{
  OBJECT-PROPERTIES
  {
    Date=11.09.17;
    Time=18:44:40;
    Modified=Yes;
    Version List=NAVW19.00,TOP1.01;
  }
  PROPERTIES
  {
    DataCaptionFields=No.,Description;
    OnInsert=BEGIN
               IF "No." = '' THEN BEGIN
                 RMSetup.GET;
                 RMSetup.TESTFIELD("Campaign Nos.");
                 NoSeriesMgt.InitSeries(RMSetup."Campaign Nos.",xRec."No. Series",0D,"No.","No. Series");
                 //TOPAS 14.11.16 ST Beginn
                 "Angelegt am"  := WORKDATE;
                 "Angelegt von" := USERID;
                 //TOPAS Ende
               END;

               DimMgt.UpdateDefaultDim(
                 DATABASE::Campaign,"No.",
                 "Global Dimension 1 Code","Global Dimension 2 Code");
             END;

    OnModify=BEGIN
               "Last Date Modified" := TODAY;
               //TOPAS 14.11.16 ST Beginn
               "Korrigiert von"     := USERID;
               //TOPAS Ende

               IF ("Starting Date" <> xRec."Starting Date") OR
                  ("Ending Date" <> xRec."Ending Date")
               THEN
                 UpdateDates;
             END;

    OnDelete=VAR
               SalesPrice@1001 : Record 7002;
               SalesLineDisc@1000 : Record 7004;
             BEGIN
               DimMgt.DeleteDefaultDim(DATABASE::Campaign,"No.");

               RMCommentLine.SETRANGE("Table Name",RMCommentLine."Table Name"::Campaign);
               RMCommentLine.SETRANGE("No.","No.");
               RMCommentLine.DELETEALL;

               CampaignEntry.SETCURRENTKEY("Campaign No.");
               CampaignEntry.SETRANGE("Campaign No.","No.");
               CampaignEntry.DELETEALL;

               CampaignMgmt.DeactivateCampaign(Rec,FALSE);

               SalesPrice.SETRANGE("Sales Type",SalesPrice."Sales Type"::Campaign);
               SalesPrice.SETRANGE("Sales Code","No.");
               SalesPrice.DELETEALL;

               SalesLineDisc.SETRANGE("Sales Type",SalesLineDisc."Sales Type"::Campaign);
               SalesLineDisc.SETRANGE("Sales Code","No.");
               SalesLineDisc.DELETEALL;

               //TOPAS 16.05.17 ST - L”schroutinen noch anpassen und berarbeiten
               //Beteiligte.SETRANGE(Beteiligte."Kampagnennr.","No.");
               //Beteiligte.DELETEALL;

               //Linien.SETRANGE(Linien."Kampagnennr.","No.");
               //Linien.DELETEALL;

               //Projektartikel.SETRANGE(Projektartikel."Kampagnennr.","No.");
               //Projektartikel.DELETEALL;

               //Memokopf.SETRANGE(Memokopf."Kampagnennr.","No.");
               //Memokopf.DELETEALL;
               //TOPAS Ende
             END;

    OnRename=BEGIN
               "Last Date Modified" := TODAY;
             END;

    CaptionML=[DEU=Kampagne;
               ENU=Campaign];
    LookupPageID=Page50064;
  }
  FIELDS
  {
    { 1   ;   ;No.                 ;Code20        ;OnValidate=BEGIN
                                                                IF "No." <> xRec."No." THEN BEGIN
                                                                  RMSetup.GET;
                                                                  NoSeriesMgt.TestManual(RMSetup."Campaign Nos.");
                                                                  "No. Series" := '';
                                                                END;
                                                              END;

                                                   CaptionML=[DEU=Nr.;
                                                              ENU=No.] }
    { 2   ;   ;Description         ;Text50        ;OnValidate=BEGIN
                                                                //TOPAS 14.07.17 ST
                                                                IF (Rec.Description <> xRec.Description) AND (xRec.Description <> '') THEN
                                                                  IF CONFIRM(Text002,FALSE) THEN BEGIN
                                                                    Ansprechpartner.RESET;
                                                                    Ansprechpartner.SETRANGE("Kampagnennr.","No.");
                                                                    IF Ansprechpartner.FINDFIRST THEN
                                                                      Ansprechpartner.MODIFYALL(Projektname,Description);
                                                                  END
                                                                ELSE
                                                                  Description := xRec.Description;

                                                                IF xRec.Description = '' THEN
                                                                  Ansprechpartner.RESET;
                                                                  Ansprechpartner.SETRANGE("Kampagnennr.","No.");
                                                                  IF Ansprechpartner.FINDFIRST THEN
                                                                    Ansprechpartner.MODIFYALL(Projektname,Description) ;
                                                                //TOPAS Ende
                                                              END;

                                                   CaptionML=[DEU=Beschreibung;
                                                              ENU=Description] }
    { 3   ;   ;Starting Date       ;Date          ;OnValidate=BEGIN
                                                                IF ("Starting Date" > "Ending Date") AND ("Ending Date" > 0D) THEN
                                                                  ERROR(Text000,FIELDCAPTION("Starting Date"),FIELDCAPTION("Ending Date"));
                                                              END;

                                                   CaptionML=[DEU=Startdatum;
                                                              ENU=Starting Date] }
    { 4   ;   ;Ending Date         ;Date          ;OnValidate=BEGIN
                                                                IF ("Ending Date" < "Starting Date") AND ("Ending Date" > 0D) THEN
                                                                  ERROR(Text001,FIELDCAPTION("Ending Date"),FIELDCAPTION("Starting Date"));
                                                              END;

                                                   CaptionML=[DEU=Enddatum;
                                                              ENU=Ending Date] }
    { 5   ;   ;Salesperson Code    ;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=[DEU=Verk„ufercode;
                                                              ENU=Salesperson Code] }
    { 6   ;   ;Comment             ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Rlshp. Mgt. Comment Line" WHERE (Table Name=CONST(Campaign),
                                                                                                       No.=FIELD(No.)));
                                                   CaptionML=[DEU=Bemerkung;
                                                              ENU=Comment];
                                                   Editable=No }
    { 7   ;   ;Last Date Modified  ;Date          ;CaptionML=[DEU=Korrigiert am;
                                                              ENU=Last Date Modified];
                                                   Editable=No }
    { 8   ;   ;No. Series          ;Code10        ;TableRelation="No. Series";
                                                   CaptionML=[DEU=Nummernserie;
                                                              ENU=No. Series];
                                                   Editable=No }
    { 9   ;   ;Global Dimension 1 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(1));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(1,"Global Dimension 1 Code");
                                                              END;

                                                   CaptionML=[DEU=Globaler Dimensionscode 1;
                                                              ENU=Global Dimension 1 Code];
                                                   CaptionClass='1,1,1' }
    { 10  ;   ;Global Dimension 2 Code;Code20     ;TableRelation="Dimension Value".Code WHERE (Global Dimension No.=CONST(2));
                                                   OnValidate=BEGIN
                                                                ValidateShortcutDimCode(2,"Global Dimension 2 Code");
                                                              END;

                                                   CaptionML=[DEU=Globaler Dimensionscode 2;
                                                              ENU=Global Dimension 2 Code];
                                                   CaptionClass='1,1,2' }
    { 11  ;   ;Status Code         ;Code10        ;TableRelation="Campaign Status";
                                                   CaptionML=[DEU=Statuscode;
                                                              ENU=Status Code] }
    { 12  ;   ;Target Contacts Contacted;Integer  ;FieldClass=FlowField;
                                                   CalcFormula=Count("Interaction Log Entry" WHERE (Campaign No.=FIELD(No.),
                                                                                                    Campaign Target=CONST(Yes),
                                                                                                    Canceled=CONST(No),
                                                                                                    Date=FIELD(Date Filter),
                                                                                                    Postponed=CONST(No)));
                                                   CaptionML=[DEU=Anzahl Kontaktaufnahmen;
                                                              ENU=Target Contacts Contacted];
                                                   Editable=No }
    { 13  ;   ;Contacts Responded  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Interaction Log Entry" WHERE (Campaign No.=FIELD(No.),
                                                                                                    Campaign Response=CONST(Yes),
                                                                                                    Canceled=CONST(No),
                                                                                                    Date=FIELD(Date Filter),
                                                                                                    Postponed=CONST(No)));
                                                   CaptionML=[DEU=Anzahl Kontaktantworten;
                                                              ENU=Contacts Responded];
                                                   Editable=No }
    { 14  ;   ;Duration (Min.)     ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Interaction Log Entry"."Duration (Min.)" WHERE (Campaign No.=FIELD(No.),
                                                                                                                    Canceled=CONST(No),
                                                                                                                    Date=FIELD(Date Filter),
                                                                                                                    Postponed=CONST(No)));
                                                   CaptionML=[DEU=Dauer (Min.);
                                                              ENU=Duration (Min.)];
                                                   DecimalPlaces=0:0;
                                                   Editable=No }
    { 16  ;   ;Cost (LCY)          ;Decimal       ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Interaction Log Entry"."Cost (LCY)" WHERE (Campaign No.=FIELD(No.),
                                                                                                               Canceled=CONST(No),
                                                                                                               Date=FIELD(Date Filter),
                                                                                                               Postponed=CONST(No)));
                                                   CaptionML=[DEU=Einstandsbetrag (MW);
                                                              ENU=Cost (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 17  ;   ;No. of Opportunities;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Opportunity Entry" WHERE (Campaign No.=FIELD(No.),
                                                                                                Active=CONST(Yes)));
                                                   CaptionML=[DEU=Anzahl Verkaufschancen;
                                                              ENU=No. of Opportunities];
                                                   Editable=No }
    { 18  ;   ;Estimated Value (LCY);Decimal      ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Opportunity Entry"."Estimated Value (LCY)" WHERE (Campaign No.=FIELD(No.),
                                                                                                                      Active=CONST(Yes)));
                                                   CaptionML=[DEU=Erwarteter Wert (MW);
                                                              ENU=Estimated Value (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 19  ;   ;Calcd. Current Value (LCY);Decimal ;FieldClass=FlowField;
                                                   CalcFormula=Sum("Opportunity Entry"."Calcd. Current Value (LCY)" WHERE (Campaign No.=FIELD(No.),
                                                                                                                           Active=CONST(Yes)));
                                                   CaptionML=[DEU=Berech. aktueller Wert (MW);
                                                              ENU=Calcd. Current Value (LCY)];
                                                   Editable=No;
                                                   AutoFormatType=1 }
    { 20  ;   ;Date Filter         ;Date          ;FieldClass=FlowFilter;
                                                   CaptionML=[DEU=Datumsfilter;
                                                              ENU=Date Filter] }
    { 23  ;   ;Action Taken Filter ;Option        ;FieldClass=FlowFilter;
                                                   CaptionML=[DEU=Kriterienaktionsfilter;
                                                              ENU=Action Taken Filter];
                                                   OptionCaptionML=[DEU=" ,N„chster Schritt,Vorheriger Schritt,Aktualisiert,Gesprungen,Gewonnen,Verloren";
                                                                    ENU=" ,Next,Previous,Updated,Jumped,Won,Lost"];
                                                   OptionString=[ ,Next,Previous,Updated,Jumped,Won,Lost] }
    { 24  ;   ;Sales Cycle Filter  ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation="Sales Cycle";
                                                   CaptionML=[DEU=Verkaufsprozessfilter;
                                                              ENU=Sales Cycle Filter] }
    { 25  ;   ;Sales Cycle Stage Filter;Integer   ;FieldClass=FlowFilter;
                                                   TableRelation="Sales Cycle Stage".Stage WHERE (Sales Cycle Code=FIELD(Sales Cycle Filter));
                                                   CaptionML=[DEU=Verkaufsprozess-Stufenfilter;
                                                              ENU=Sales Cycle Stage Filter] }
    { 26  ;   ;Probability % Filter;Decimal       ;FieldClass=FlowFilter;
                                                   CaptionML=[DEU=Wahrscheinlichkeit % Filter;
                                                              ENU=Probability % Filter];
                                                   DecimalPlaces=1:1;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 27  ;   ;Completed % Filter  ;Decimal       ;FieldClass=FlowFilter;
                                                   CaptionML=[DEU=Abgeschlossen % Filter;
                                                              ENU=Completed % Filter];
                                                   DecimalPlaces=1:1;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 28  ;   ;Contact Filter      ;Code20        ;FieldClass=FlowFilter;
                                                   TableRelation=Contact;
                                                   CaptionML=[DEU=Kontaktfilter;
                                                              ENU=Contact Filter] }
    { 29  ;   ;Contact Company Filter;Code20      ;FieldClass=FlowFilter;
                                                   TableRelation=Contact WHERE (Type=CONST(Company));
                                                   CaptionML=[DEU=Kontakt Unternehmensfilter;
                                                              ENU=Contact Company Filter] }
    { 30  ;   ;Estimated Value Filter;Decimal     ;FieldClass=FlowFilter;
                                                   CaptionML=[DEU=Erwarteter Wert Filter;
                                                              ENU=Estimated Value Filter];
                                                   AutoFormatType=1 }
    { 31  ;   ;Calcd. Current Value Filter;Decimal;FieldClass=FlowFilter;
                                                   CaptionML=[DEU=Berech. aktueller Wert Filter;
                                                              ENU=Calcd. Current Value Filter];
                                                   AutoFormatType=1 }
    { 32  ;   ;Chances of Success % Filter;Decimal;FieldClass=FlowFilter;
                                                   CaptionML=[DEU=Erfolgschancen % Filter;
                                                              ENU=Chances of Success % Filter];
                                                   DecimalPlaces=0:0;
                                                   MinValue=0;
                                                   MaxValue=100 }
    { 33  ;   ;To-do Status Filter ;Option        ;FieldClass=FlowFilter;
                                                   CaptionML=[DEU=Aufgabenstatusfilter;
                                                              ENU=To-do Status Filter];
                                                   OptionCaptionML=[DEU=Nicht begonnen,In Bearbeitung,Erledigt,Warten,Zurckgestellt;
                                                                    ENU=Not Started,In Progress,Completed,Waiting,Postponed];
                                                   OptionString=Not Started,In Progress,Completed,Waiting,Postponed }
    { 34  ;   ;To-do Closed Filter ;Boolean       ;FieldClass=FlowFilter;
                                                   CaptionML=[DEU=Abgeschlossene Aufgaben Filter;
                                                              ENU=To-do Closed Filter] }
    { 35  ;   ;Priority Filter     ;Option        ;FieldClass=FlowFilter;
                                                   CaptionML=[DEU=Priorit„tenfilter;
                                                              ENU=Priority Filter];
                                                   OptionCaptionML=[DEU=Niedrig,Normal,Hoch;
                                                                    ENU=Low,Normal,High];
                                                   OptionString=Low,Normal,High }
    { 36  ;   ;Team Filter         ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Team;
                                                   CaptionML=[DEU=Teamfilter;
                                                              ENU=Team Filter] }
    { 37  ;   ;Salesperson Filter  ;Code10        ;FieldClass=FlowFilter;
                                                   TableRelation=Salesperson/Purchaser;
                                                   CaptionML=[DEU=Verk„uferfilter;
                                                              ENU=Salesperson Filter] }
    { 38  ;   ;Opportunity Entry Exists;Boolean   ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Opportunity Entry" WHERE (Campaign No.=FIELD(No.),
                                                                                                Active=CONST(Yes),
                                                                                                Salesperson Code=FIELD(Salesperson Filter),
                                                                                                Contact No.=FIELD(Contact Filter),
                                                                                                Contact Company No.=FIELD(Contact Company Filter),
                                                                                                Sales Cycle Code=FIELD(Sales Cycle Filter),
                                                                                                Sales Cycle Stage=FIELD(Sales Cycle Stage Filter),
                                                                                                Action Taken=FIELD(Action Taken Filter),
                                                                                                Estimated Value (LCY)=FIELD(Estimated Value Filter),
                                                                                                Calcd. Current Value (LCY)=FIELD(Calcd. Current Value Filter),
                                                                                                Completed %=FIELD(Completed % Filter),
                                                                                                Chances of Success %=FIELD(Chances of Success % Filter),
                                                                                                Probability %=FIELD(Probability % Filter),
                                                                                                Estimated Close Date=FIELD(Date Filter),
                                                                                                Close Opportunity Code=FIELD(Close Opportunity Filter)));
                                                   CaptionML=[DEU=Verkaufschancenposten vorh.;
                                                              ENU=Opportunity Entry Exists];
                                                   Editable=No }
    { 39  ;   ;To-do Entry Exists  ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist(To-do WHERE (Campaign No.=FIELD(No.),
                                                                                  Contact No.=FIELD(Contact Filter),
                                                                                  Contact Company No.=FIELD(Contact Company Filter),
                                                                                  Salesperson Code=FIELD(Salesperson Filter),
                                                                                  Team Code=FIELD(Team Filter),
                                                                                  Status=FIELD(To-do Status Filter),
                                                                                  Closed=FIELD(To-do Closed Filter),
                                                                                  Priority=FIELD(Priority Filter),
                                                                                  Date=FIELD(Date Filter)));
                                                   CaptionML=[DEU=Aufgabenposten vorhanden;
                                                              ENU=To-do Entry Exists];
                                                   Editable=No }
    { 40  ;   ;Close Opportunity Filter;Code10    ;FieldClass=FlowFilter;
                                                   TableRelation="Close Opportunity Code";
                                                   CaptionML=[DEU=Verkaufschancenabschlussfilter;
                                                              ENU=Close Opportunity Filter] }
    { 41  ;   ;Activated           ;Boolean       ;FieldClass=FlowField;
                                                   CalcFormula=Exist("Campaign Target Group" WHERE (Campaign No.=FIELD(No.)));
                                                   CaptionML=[DEU=Aktiviert;
                                                              ENU=Activated];
                                                   Editable=No }
    { 50214;  ;Gltigkeitsdatum    ;Text10        ;Description=TOPAS 27.06.16 ST - Betrifft Hersteller Projektnr. }
    { 51301;  ;Projektstatus       ;Code15        ;TableRelation=Optionstabelle.Code WHERE (Tabellen ID=FILTER(5071),
                                                                                            Feld ID=FILTER(51301));
                                                   OnValidate=BEGIN
                                                                Ansprechpartner.SETFILTER(Ansprechpartner."Kampagnennr.",'%1',Rec."No.");
                                                                IF Ansprechpartner.FINDFIRST THEN
                                                                  Ansprechpartner.MODIFYALL(Ansprechpartner.Projektstatus, Rec.Projektstatus);
                                                              END;

                                                   CaptionML=DEU=Projektstatus;
                                                   Description=TOPAS,ST }
    { 51302;  ;Projektklasse       ;Code15        ;TableRelation=Optionstabelle.Code WHERE (Tabellen ID=FILTER(5071),
                                                                                            Feld ID=FILTER(51302));
                                                   OnValidate=BEGIN
                                                                Ansprechpartner.SETFILTER(Ansprechpartner."Kampagnennr.",'%1',Rec."No.");
                                                                IF Ansprechpartner.FINDFIRST THEN
                                                                  Ansprechpartner.MODIFYALL(Ansprechpartner.Projektklasse, Rec.Projektklasse);
                                                              END;

                                                   CaptionML=DEU=Projektklasse;
                                                   Description=TOPAS,ST }
    { 51303;  ;Projektvolumen      ;Decimal       ;OnValidate=BEGIN
                                                                IF Projektvolumen <> xRec.Projektvolumen THEN
                                                                  "Projektwert aktuell" := FALSE;
                                                              END;

                                                   CaptionML=DEU=Projektvolumen;
                                                   Description=TOPAS,ST }
    { 51304;  ;Projektwert         ;Decimal       ;OnValidate=BEGIN
                                                                IF Projektwert <> xRec.Projektwert THEN
                                                                  "Projektwert aktuell" := FALSE;
                                                              END;

                                                   CaptionML=DEU=Projektwert;
                                                   Description=TOPAS,ST }
    { 51305;  ;Angelegt von        ;Code20        ;CaptionML=DEU=Angelegt von;
                                                   Description=TOPAS,ST }
    { 51306;  ;Angelegt am         ;Date          ;CaptionML=DEU=Angelegt am;
                                                   Description=TOPAS,ST }
    { 51307;  ;Korrigiert von      ;Code20        ;CaptionML=DEU=Korrigiert von;
                                                   Description=TOPAS,ST }
    { 51308;  ;Aktueller Serienstart;Text20       ;Description=TOPAS 11.05.09 ST }
    { 51309;  ;Aktueller Stand     ;Option        ;OptionString=[ ,,,vorgezogen,,,l„uft,,,verz”gert];
                                                   Description=TOPAS 11.05.09 ST }
    { 51310;  ;Ang. Provision %    ;Decimal       ;OnValidate=BEGIN
                                                                IF "Ang. Provision %" <> xRec."Ang. Provision %" THEN
                                                                  "Projektwert aktuell" := FALSE;
                                                              END;

                                                   Description=TOPAS 03.07.08 ST }
    { 51311;  ;Applikation         ;Text50        ;CaptionML=DEU=Applikation;
                                                   Description=TOPAS,ST }
    { 51314;  ;Hersteller Projektnr.;Text30       ;CaptionML=DEU=Hersteller Projektnr.;
                                                   Description=TOPAS,ST }
    { 51315;  ;Inaktiv             ;Boolean       ;Description=TOPAS,ST }
    { 51316;  ;Kalk. Provision     ;Decimal       ;Description=TOPAS 07.11.08 ST }
    { 51317;  ;N„chste Aufgabe am  ;Date          ;FieldClass=FlowField;
                                                   CalcFormula=Min(To-do.Date WHERE (Campaign No.=FIELD(No.),
                                                                                     Closed=CONST(No),
                                                                                     System To-do Type=CONST(Organizer)));
                                                   Description=TOPAS 06.04.09 ST;
                                                   Editable=No }
    { 51318;  ;Projektwert aktuell ;Boolean       ;Description=TOPAS 22.10.08 ST }
    { 51319;  ;Prototyping         ;Text20        ;CaptionML=DEU=Prototyping;
                                                   Description=TOPAS,ST }
    { 51320;  ;REP-Projekt         ;Boolean       ;OnValidate=BEGIN
                                                                IF "REP-Projekt" <> xRec."REP-Projekt" THEN
                                                                  "Projektwert aktuell" := FALSE;
                                                              END;

                                                   Description=TOPAS 03.07.08 ST }
    { 51321;  ;Serienstart (geplant);Text20       ;CaptionML=DEU=Serienstart (geplant);
                                                   Description=TOPAS,ST }
    { 51324;  ;Vorserienstart      ;Text20        ;CaptionML=DEU=Vorserienstart;
                                                   Description=TOPAS,ST }
    { 51325;  ;W„hrungscode        ;Code15        ;TableRelation=Optionstabelle.Code WHERE (Tabellen ID=FILTER(5071),
                                                                                            Feld ID=FILTER(51325));
                                                   CaptionML=DEU=W„hrungscode;
                                                   Description=TOPAS,ST }
    { 51326;  ;Wettbewerb          ;Text80        ;CaptionML=DEU=Wettbewerb;
                                                   Description=TOPAS 02.07.08 ST }
    { 51330;  ;Hauptbeteiligter    ;Code20        ;FieldClass=FlowField;
                                                   CalcFormula=Lookup("Ansprechpartner Auswahl"."Kontakt Mandantennr." WHERE (Kampagnennr.=FIELD(No.),
                                                                                                                              Typ=FILTER(Company),
                                                                                                                              Fhrungsrolle=FILTER(Yes)));
                                                   Description=TOPAS 11.09.17 ST - Anzeige des Hauptbeteiligten eines Projektes }
    { 51400;  ;Anzahl Beteiligte   ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Ansprechpartner Auswahl" WHERE (Kampagnennr.=FIELD(No.)));
                                                   Description=TOPAS 10.01.17 ST;
                                                   Editable=No }
    { 51401;  ;Anzahl Linien       ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Linienauswahl WHERE (Kampagnennr.=FIELD(No.)));
                                                   Description=TOPAS 10.01.17 ST;
                                                   Editable=No }
    { 51402;  ;Anzahl Akt. Belege  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Line" WHERE (Kampagnennr.=FIELD(No.),
                                                                                         Type=FILTER(Item),
                                                                                         Outstanding Quantity=FILTER(>0)));
                                                   Description=TOPAS 10.01.17 ST;
                                                   Editable=No }
    { 51403;  ;Anzahl Arch. Belege ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Line Archive" WHERE (Kampagnennr.=FIELD(No.),
                                                                                                 Type=FILTER(Item)));
                                                   Description=TOPAS 10.01.17 ST;
                                                   Editable=No }
    { 51404;  ;Anzahl Rechnungen   ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count(Belege WHERE (Kampagne=FIELD(No.),
                                                                                   Belegart=FILTER(Invoice),
                                                                                   Menge=FILTER(<>0),
                                                                                   Lagerortcode=FILTER(ZENT|KONSI)));
                                                   Description=TOPAS 10.01.17 ST;
                                                   Editable=No }
    { 51405;  ;Anzahl Gutschriften ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Cr.Memo Line" WHERE (Kampagnennr.=FIELD(No.)));
                                                   Description=TOPAS 10.01.17 ST;
                                                   Editable=No }
    { 51406;  ;Anzahl Akt. Muster  ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Line" WHERE (Kampagnennr.=FIELD(No.),
                                                                                         Type=FILTER(Item),
                                                                                         Location Code=FILTER(MUST),
                                                                                         Document Type=FILTER(Order)));
                                                   Description=TOPAS 10.01.17 ST;
                                                   Editable=No }
    { 51407;  ;Anzahl Arch. Muster ;Integer       ;FieldClass=FlowField;
                                                   CalcFormula=Count("Sales Line Archive" WHERE (Kampagnennr.=FIELD(No.),
                                                                                                 Type=FILTER(Item),
                                                                                                 Location Code=FILTER(MUST),
                                                                                                 Document Type=FILTER(Order)));
                                                   Description=TOPAS 10.01.17 ST;
                                                   Editable=No }
    { 51408;  ;Anzahl Leihstellungen;Integer      ;FieldClass=FlowField;
                                                   CalcFormula=Count("Serviceleist. & Leihstellungen" WHERE (Kampagnennr.=FIELD(No.),
                                                                                                             Art=FILTER(Leihstellung)));
                                                   Description=TOPAS 10.01.17 ST;
                                                   Editable=No }
    { 51409;  ;Anzahl Historische Belege;Integer  ;FieldClass=FlowField;
                                                   CalcFormula=Count(Beleghistorie WHERE (Kampagne=FIELD(No.)));
                                                   Description=TOPAS 10.01.17 ST;
                                                   Editable=No }
    { 60000;  ;Territory Code      ;Code10        ;TableRelation=Territory;
                                                   CaptionML=DEU=Gebietscode;
                                                   Description=TOPAS,ST Region }
    { 60001;  ;Betreuer Innendienst;Code10        ;TableRelation=Salesperson/Purchaser;
                                                   CaptionML=DEU=Betreuer Innendienst;
                                                   Description=TOPAS,ST }
    { 60002;  ;Teams               ;Code10        ;TableRelation=Team;
                                                   CaptionML=DEU=Teams;
                                                   Description=TOPAS,ST Mitwirkende }
  }
  KEYS
  {
    {    ;No.                                     ;Clustered=Yes }
    {    ;Salesperson Code                         }
  }
  FIELDGROUPS
  {
    { 1   ;DropDown            ;No.,Description,Starting Date,Ending Date,Status Code }
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'DEU=%1 muss vor dem %2 sein.;ENU=%1 must be before %2.';
      Text001@1001 : TextConst 'DEU=%1 muss nach dem %2 sein.;ENU=%1 must be after %2.';
      RMSetup@1002 : Record 5079;
      Campaign@1003 : Record 5071;
      RMCommentLine@1004 : Record 5061;
      CampaignEntry@1005 : Record 5072;
      NoSeriesMgt@1006 : Codeunit 396;
      DimMgt@1007 : Codeunit 408;
      CampaignMgmt@1008 : Codeunit 7030;
      "***TOPAS_VAR***"@1000000001 : Integer;
      Ansprechpartner@1000000000 : Record 50005;
      Text002@1000000002 : TextConst 'DEU=Wollen Sie den Projektnamen wirklich „ndern?';

    PROCEDURE AssistEdit@2(OldCampaign@1000 : Record 5071) : Boolean;
    BEGIN
      WITH Campaign DO BEGIN
        Campaign := Rec;
        RMSetup.GET;
        RMSetup.TESTFIELD("Campaign Nos.");
        IF NoSeriesMgt.SelectSeries(RMSetup."Campaign Nos.",OldCampaign."No. Series","No. Series") THEN BEGIN
          RMSetup.GET;
          RMSetup.TESTFIELD("Campaign Nos.");
          NoSeriesMgt.SetSeries("No.");
          Rec := Campaign;
          EXIT(TRUE);
        END;
      END;
    END;

    LOCAL PROCEDURE ValidateShortcutDimCode@29(FieldNumber@1000 : Integer;VAR ShortcutDimCode@1001 : Code[20]);
    BEGIN
      DimMgt.ValidateDimValueCode(FieldNumber,ShortcutDimCode);
      DimMgt.SaveDefaultDim(DATABASE::Campaign,"No.",FieldNumber,ShortcutDimCode);
      MODIFY;
    END;

    LOCAL PROCEDURE UpdateDates@1();
    VAR
      SalesPrice@1002 : Record 7002;
      SalesLineDisc@1001 : Record 7004;
      SalesPrice2@1003 : Record 7002;
      SalesLineDisc2@1004 : Record 7004;
    BEGIN
      MODIFY;
      SalesPrice.SETRANGE("Sales Type",SalesPrice."Sales Type"::Campaign);
      SalesPrice.SETRANGE("Sales Code","No.");
      SalesPrice.LOCKTABLE;
      IF SalesPrice.FIND('-') THEN
        REPEAT
          SalesPrice2 := SalesPrice;
          SalesPrice.DELETE;
          SalesPrice2.VALIDATE("Starting Date","Starting Date");
          SalesPrice2.INSERT(TRUE);
          SalesPrice2.VALIDATE("Ending Date","Ending Date");
          SalesPrice2.MODIFY;
        UNTIL SalesPrice.NEXT = 0;

      SalesLineDisc.SETRANGE("Sales Type",SalesLineDisc."Sales Type"::Campaign);
      SalesLineDisc.SETRANGE("Sales Code","No.");
      SalesLineDisc.LOCKTABLE;
      IF SalesLineDisc.FIND('-') THEN
        REPEAT
          SalesLineDisc2 := SalesLineDisc;
          SalesLineDisc.DELETE;
          SalesLineDisc2.VALIDATE("Starting Date","Starting Date");
          SalesLineDisc2.INSERT(TRUE);
          SalesLineDisc2.VALIDATE("Ending Date","Ending Date");
          SalesLineDisc2.MODIFY;
        UNTIL SalesLineDisc.NEXT = 0;
    END;

    BEGIN
    {
      Lfd.Nr. Version   Datum       User    Beschreibung
      ===========================================================================
      1       TOP1.00   19.10.16    UB      TOPAS Felder 50214,51301-51321,51324-51326,60000-60002 angelegt
      2       TOP1.00   14.11.16    ST      TOPAS Programmierung bernommen und angepasst
      3       TOP1.01   11.09.17    ST      Neues Feld 51330 Hauptbeteiligter angelegt
    }
    END.
  }
}

