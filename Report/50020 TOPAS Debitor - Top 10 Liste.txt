OBJECT Report 50020 TOPAS Debitor - Top 10 Liste
{
  OBJECT-PROPERTIES
  {
    Date=17.01.18;
    Time=14:36:24;
    Modified=Yes;
    Version List=Topas Bericht,FORNAV2.0.0.1189/1189;
  }
  PROPERTIES
  {
    CaptionML=[DEU=TOPAS Debitor - Top 10 Liste;
               ENU=TOPAS Customer - Top 10 List];
    OnInitReport=BEGIN
                   ReportForNav:= ReportForNav.Report(CurrReport.OBJECTID,CurrReport.LANGUAGE,SERIALNUMBER,USERID,COMPANYNAME);ReportForNav.Init;
                 END;

    OnPreReport=BEGIN
                  //Excel Definition
                  filter := 'Datum: ' + FORMAT(StartBuchdatum) + ' bis ' + FORMAT(Endbuchdatum) +
                                    ', ' + 'Anzeigen: ' + FORMAT(NoOfRecordsToPrint) + ', Herstellercode: ' + vHerstellercode
                                    +  ', ' + l„ndercode;
                  ges_aubestand := 0;
                  ges_CustSalesLCY := 0;
                  CREATE(Excel,FALSE,TRUE);                                    //erzeugt excel
                  Book := Excel.Workbooks.Add(-4167);                          //legt neue datei in excel an
                  Sheet := Excel.ActiveSheet;                                  //definiert aktives worksheet
                  Sheet.Range('A1').Value := 'Kunden-Nr';                      // definiert die beschriftung der berschriftszeile
                  Sheet.Range('B1').Value := 'Debitor';
                  Sheet.Range('C1').Value := 'Umsatz in °';
                  Sheet.Range('D1').Value := 'AU-Bestand Gesamt';
                  Sheet.Range('E1').Value := 'Durchschn. Marge';
                  Sheet.Range('F1').Value := 'Linien';
                  Sheet.Range('B:B').ColumnWidth := 30;
                  Sheet.Range('C:C').ColumnWidth := 20;
                  Sheet.Range('D:D').ColumnWidth := 20;
                  j := '2';                                                    // <- Import in excel ab Zeile 2

                  //*******************************************************************************************************
                  //                                 Akt. Angebote werden durchsucht
                  //*******************************************************************************************************

                  Belege.RESET;
                  //belege.SETFILTER("Debitornr.",Customer."No.");
                  Belege.SETFILTER(Verk„ufercode,vkcode);
                  Belege.SETFILTER("Betreuer Innendienst",betrinnen);
                  Belege.SETFILTER(Teams,vteams);
                  Belege.SETFILTER(Herstellercode,vHerstellercode);
                  Belege.SETFILTER(Gebiet,vGebietscode);
                  Belege.SETFILTER(Lagerortcode,'%1|%2|%3|%4','ZENT','KONSI','ERSATZ','IDT');
                  Belege.SETFILTER(Menge,'<>%1',0);
                  Belege.SETFILTER(Belegart,'Rechnung');
                  IF (StartBuchdatum <> 0D ) AND (Endbuchdatum = 0D) THEN
                    Belege.SETFILTER(Belegdatum,'>=%1',StartBuchdatum);
                  IF (StartBuchdatum = 0D) AND (Endbuchdatum <> 0D) THEN
                    Belege.SETFILTER(Belegdatum,'<=%1',Endbuchdatum);
                  IF (StartBuchdatum <> 0D) AND (Endbuchdatum <> 0D) THEN
                    Belege.SETFILTER(Belegdatum,'>=%1&<=%2',StartBuchdatum,Endbuchdatum);
                  IF Belege.FINDFIRST THEN BEGIN
                    REPEAT
                      Berichtstabelle.RESET;
                      Berichtstabelle.SETFILTER(Tabelle,'%1','DEBITOR');
                      Berichtstabelle.SETFILTER(Index,'%1',Belege."Debitornr.");
                      IF NOT Berichtstabelle.FINDFIRST THEN BEGIN
                        //*******************************************************************************************************
                        //                                     Debitor Daten schreiben
                        //*******************************************************************************************************
                        Berichtstabelle.INIT;
                        Berichtstabelle.Tabelle := 'DEBITOR';
                        Berichtstabelle.Index := Belege."Debitornr.";
                        Customer.GET(Belege."Debitornr.");
                        Customer.CALCFIELDS("Sales (LCY)");
                        Berichtstabelle."Feld 4" := Customer."Sales (LCY)";
                        Berichtstabelle."Feld 6" := Customer."Post Code";
                        Berichtstabelle."Feld 10" := Customer.Name;
                        Berichtstabelle."Feld 12" := Customer.City;
                        Berichtstabelle.Uhrzeit := CURRENTDATETIME;
                        Berichtstabelle.User := USERID;
                        Berichtstabelle.INSERT;
                      END;
                      Berichtstabelle.INIT;
                      Berichtstabelle.Tabelle := 'BELEGE';
                      Berichtstabelle.Index := Belege."Debitornr.";
                      Berichtstabelle."Belegnr." := Belege."Belegnr.";
                      Berichtstabelle."Zeilennr." := Belege."Zeilennr.";
                      Berichtstabelle."Feld 4" := Belege."Betrag MW ohne Mwst.";
                      Berichtstabelle."Feld 5" := Belege."DB %";
                      Berichtstabelle.Uhrzeit := CURRENTDATETIME;
                      Berichtstabelle.User := USERID;
                      Berichtstabelle.INSERT;
                    UNTIL Belege.NEXT = 0;
                    //Gutschriften werden abgezogen
                    Belege.RESET;
                    //belege.SETFILTER("Debitornr.",Customer."No.");
                    Belege.SETFILTER(Verk„ufercode,vkcode);
                    Belege.SETFILTER("Betreuer Innendienst",betrinnen);
                    Belege.SETFILTER(Teams,vteams);
                    Belege.SETFILTER(Herstellercode,vHerstellercode);
                    Belege.SETFILTER(Gebiet,vGebietscode);
                    Belege.SETFILTER(Lagerortcode,'%1|%2|%3|%4','ZENT','KONSI','ERSATZ','IDT');
                    Belege.SETFILTER(Menge,'<>%1',0);
                    Belege.SETFILTER(Belegart,'Gutschrift');
                    IF (StartBuchdatum <> 0D ) AND (Endbuchdatum = 0D) THEN
                      Belege.SETFILTER(Belegdatum,'>=%1',StartBuchdatum);
                    IF (StartBuchdatum = 0D) AND (Endbuchdatum <> 0D) THEN
                      Belege.SETFILTER(Belegdatum,'<=%1',Endbuchdatum);
                    IF (StartBuchdatum <> 0D) AND (Endbuchdatum <> 0D) THEN
                      Belege.SETFILTER(Belegdatum,'>=%1&<=%2',StartBuchdatum,Endbuchdatum);
                    IF Belege.FINDFIRST THEN
                      REPEAT
                        Berichtstabelle.INIT;
                        Berichtstabelle.Tabelle := 'BELEGE';
                        Berichtstabelle.Index := Belege."Debitornr.";
                        Berichtstabelle."Belegnr." := Belege."Belegnr.";
                        Berichtstabelle."Zeilennr." := Belege."Zeilennr.";
                        Berichtstabelle."Feld 4" := - Belege."Betrag MW ohne Mwst.";
                        Berichtstabelle.Uhrzeit := CURRENTDATETIME;
                        Berichtstabelle.User := USERID;
                        Berichtstabelle.INSERT;
                      UNTIL Belege.NEXT = 0;
                    END;
                  ;ReportForNav.OpenDesigner:=ReportForNavOpenDesigner;IF NOT ReportForNav.Pre THEN CurrReport.QUIT;
                END;

    OnPostReport=BEGIN
                   j := INCSTR (j);
                   Sheet.Range('C'+j).Value := ges_CustSalesLCY;
                   Sheet.Range('D'+j).Value := ges_aubestand;
                   Excel.Visible(TRUE);
                   ;ReportForNav.Post;
                 END;

  }
  DATASET
  {
    { 1   ;    ;DataItem;Debitor             ;
               DataItemTable=Table18;
               OnPreDataItem=BEGIN
                               Window.OPEN(Text000);
                               i := 0;
                               CustAmount.DELETEALL;
                               Customer.SETFILTER(Customer."Country/Region Code",l„ndercode);
                             END;

               OnAfterGetRecord=BEGIN
                                  Window.UPDATE(1,Debitor."No.");
                                  ges_CustSalesLCY := 0;
                                  aubestand := 0;
                                  //Auftr„ge
                                  Berichtstabelle.RESET;
                                  Berichtstabelle.SETFILTER(Tabelle,'%1','BELEGE');
                                  Berichtstabelle.SETFILTER(Index,'%1',Debitor."No.");
                                  IF Berichtstabelle.FINDFIRST THEN
                                    REPEAT
                                      CustSalesLCY := CustSalesLCY - Berichtstabelle."Feld 4";
                                   UNTIL Berichtstabelle.NEXT = 0;
                                  //AU-Bestand
                                    SalesHeader.RESET;
                                    SalesHeader.SETFILTER("Sell-to Customer No.",Debitor."No.");
                                    SalesHeader.SETFILTER("Document Type",'Auftrag');
                                    SalesHeader.SETFILTER("Location Code",'%1|%2|%3|%4','ZENT','KONSI','ERSATZ','IDT');
                                    SalesHeader.SETFILTER("Salesperson Code",vkcode);
                                    SalesHeader.SETFILTER("Betreuer Innendienst",betrinnen);
                                    SalesHeader.SETFILTER(Teams,vteams);
                                    IF SalesHeader.FINDFIRST THEN BEGIN
                                      REPEAT
                                        SalesLine.RESET;
                                        SalesLine.SETFILTER("Document No.",SalesHeader."No.");
                                        SalesLine.SETFILTER(Type,'%1',SalesLine.Type::Item);
                                        SalesLine.SETFILTER("Manufacturer Code",vHerstellercode);
                                        SalesLine.SETFILTER("Outstanding Quantity",'>%1',0);
                                        IF SalesLine.FINDFIRST THEN
                                          REPEAT
                                            aubestand := aubestand + (SalesLine."VK-Preis (MW)" * SalesLine."Outstanding Quantity");
                                         UNTIL SalesLine.NEXT = 0;
                                       UNTIL SalesHeader.NEXT = 0;
                                     END;
                                    //Datensatz wird in Tabelle Debitorenbetrag (temp.) eingetragen, wenn Umsatz > 0  oder AE >0
                                  IF ((CustSalesLCY < 0) OR (aubestand > 0)) THEN BEGIN
                                      CustAmount.INIT;
                                      CustAmount."Customer No." := Debitor."No.";
                                      CustAmount."Amount (LCY)" := CustSalesLCY;
                                      CustAmount."Amount 2 (LCY)" := aubestand;
                                      CustAmount.INSERT;
                                      IF (NoOfRecordsToPrint = 0) OR (i < NoOfRecordsToPrint) THEN
                                        i := i + 1
                                      ELSE BEGIN
                                        CustAmount.FIND('+');
                                        CustAmount.DELETE;
                                      END;
                                    END;
                                END;
                                 }

    { 2   ;    ;DataItem;                    ;
               DataItemTable=Table2000000026;
               DataItemTableView=SORTING(Number)
                                 WHERE(Number=FILTER(1..));
               OnPreDataItem=BEGIN
                               Window.CLOSE;
                               Berichtstabelle.RESET;
                               Berichtstabelle.SETRANGE(Tabelle,'DEBITOR');
                               SETRANGE(Number,1,Berichtstabelle.COUNT);
                             END;

               OnAfterGetRecord=BEGIN
                                  IF Number = 1 THEN BEGIN
                                    Berichtstabelle.FIND('-');
                                    IF NOT CustAmount.FINDFIRST THEN
                                      CurrReport.BREAK;
                                  END ELSE BEGIN
                                    Berichtstabelle.NEXT;
                                    IF CustAmount.NEXT = 0 THEN
                                      CurrReport.BREAK;
                                  END;

                                  CustAmount."Amount (LCY)" := -CustAmount."Amount (LCY)";
                                  Customer.GET(CustAmount."Customer No.");
                                  IF MaxAmount = 0 THEN
                                    MaxAmount := CustAmount."Amount (LCY)";
                                  IF (MaxAmount > 0) AND (CustAmount."Amount (LCY)" > 0) THEN
                                    BarText := PADSTR('',ROUND(CustAmount."Amount (LCY)" / MaxAmount * 45,1),'*')
                                  ELSE
                                    BarText := '';
                                  CustAmount."Amount (LCY)" := -CustAmount."Amount (LCY)";
                                  ges_CustSalesLCY := ges_CustSalesLCY - CustAmount."Amount (LCY)";
                                  ges_aubestand := ges_aubestand + CustAmount."Amount 2 (LCY)";
                                  CustName := '';
                                  Cust.SETFILTER(Cust."No.",CustAmount."Customer No.");
                                  IF Cust.FINDFIRST THEN
                                    CustName := Cust.Name;
                                  vk_wert := 0;
                                  ma_wert := 0;
                                  ma_proz := 0;
                                  marge := 0;
                                  linien := '';
                                  Sheet.Range('A'+j).Value := TOPAS_API.CreateExcelHyperlinkToNav(Customer.TABLENAME,1,21,CustAmount."Customer No.");
                                  Sheet.Range('B'+j).Value := Cust.Name;
                                  Sheet.Range('C'+j).Value := CustAmount."Amount (LCY)" * (-1);
                                  Sheet.Range('D'+j).Value := CustAmount."Amount 2 (LCY)";
                                  Belege.RESET;
                                  Belege.SETFILTER(Belegart,'%1',Belege.Belegart::Invoice);
                                  Belege.SETFILTER("Debitornr.",'%1',CustAmount."Customer No.");
                                  Belege.SETFILTER(Verk„ufercode,vkcode);
                                  Belege.SETFILTER("Betreuer Innendienst",betrinnen);
                                  Belege.SETFILTER(Teams,vteams);
                                  Belege.SETFILTER(Gebiet,vGebietscode);
                                  Belege.SETFILTER(Herstellercode,vHerstellercode);
                                  Belege.SETFILTER(Lagerortcode,'%1|%2|%3|%4','ZENT','KONSI','ERSATZ','IDT');
                                  Belege.SETFILTER(Menge,'<>%1',0);
                                  IF (StartBuchdatum <> 0D ) AND (Endbuchdatum = 0D) THEN
                                    Belege.SETFILTER(Belegdatum,'>=%1',StartBuchdatum);
                                  IF (StartBuchdatum = 0D) AND (Endbuchdatum <> 0D) THEN
                                    Belege.SETFILTER(Belegdatum,'<=%1',Endbuchdatum);
                                  IF (StartBuchdatum <> 0D) AND (Endbuchdatum <> 0D) THEN
                                    Belege.SETFILTER(Belegdatum,'>=%1&<=%2',StartBuchdatum,Endbuchdatum);
                                  IF Belege.FINDFIRST THEN BEGIN
                                    REPEAT
                                      IF marge = 0 THEN
                                        marge := Belege."DB %"
                                      ELSE
                                        marge:= marge + Belege."DB %";
                                        //marge := (marge + belege."DB %") / 2;
                                      Hersteller.GET(Belege.Herstellercode);
                                      IF STRPOS(linien,Hersteller.Herstellerkurzname) = 0 THEN
                                        linien := linien + ' ' + Hersteller.Herstellerkurzname;
                                      vk_wert := vk_wert + Belege."Betrag MW ohne Mwst.";
                                      ma_wert := ma_wert + (Belege."Betrag MW ohne Mwst."/100 * Belege."DB %");
                                    UNTIL Belege.NEXT = 0;
                                    IF vk_wert <> 0 THEN
                                      ma_proz := (ma_wert / vk_wert) * 100;
                                    marge := marge / Belege.COUNT;
                                    //Sheet.Range('E'+j).Value := FORMAT(ROUND(marge,0.01));
                                    Sheet.Range('E'+j).Value := FORMAT(ROUND(ma_proz,0.01));
                                    Sheet.Range('F'+j).Value := linien;
                                    Sheet.Range('G'+j).Value := vGebietscode;
                                  END;
                                  j := INCSTR (j);
                                END;
                                 }

    { 7   ;1   ;Column  ;USERID              ;
               SourceExpr=USERID }

    { 8   ;1   ;Column  ;COMPANYNAME         ;
               SourceExpr=COMPANYNAME }

    { 9   ;1   ;Column  ;ReportForNavPageNo  ;
               SourceExpr=ReportForNav.PageNo }

    { 10  ;1   ;Column  ;TODAY_0_4           ;
               SourceExpr=FORMAT(TODAY,0,4) }

    { 3   ;1   ;Column  ;vteams              ;
               SourceExpr=vteams }

    { 4   ;1   ;Column  ;vkcode              ;
               SourceExpr=vkcode }

    { 5   ;1   ;Column  ;betrinnen           ;
               SourceExpr=betrinnen }

    { 6   ;1   ;Column  ;filter              ;
               SourceExpr=filter }

    { 11  ;1   ;Column  ;CustomerTABLECAPTION___CustFilter;
               SourceExpr=Customer.TABLECAPTION + ': ' + CustFilter }

    { 12  ;1   ;Column  ;Amount2_LCY_CustAmount;
               SourceExpr=CustAmount."Amount 2 (LCY)" }

    { 13  ;1   ;Column  ;BarText             ;
               SourceExpr=BarText }

    { 14  ;1   ;Column  ;CustAmountAmount_LCY__1;
               SourceExpr=CustAmount."Amount (LCY)"*(-1) }

    { 15  ;1   ;Column  ;CustName            ;
               SourceExpr=CustName }

    { 16  ;1   ;Column  ;CustomerNo_CustAmount;
               SourceExpr=CustAmount."Customer No." }

    { 17  ;1   ;Column  ;Number_Integer      ;
               SourceExpr=Number }

    { 18  ;1   ;Column  ;SalesPct            ;
               DecimalPlaces=1:1;
               SourceExpr=SalesPct }

    { 19  ;1   ;Column  ;ges_aubestand       ;
               SourceExpr=ges_aubestand }

    { 20  ;1   ;Column  ;ges_CustSalesLCY    ;
               SourceExpr=ges_CustSalesLCY }

    { 21  ;1   ;Column  ;aubestand           ;
               SourceExpr=aubestand }

    { 22  ;1   ;Column  ;CustSalesLCY_1      ;
               SourceExpr=CustSalesLCY*(-1) }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      SaveValues=Yes;
      OnOpenPage=BEGIN
                   IF NoOfRecordsToPrint = 0 THEN
                     NoOfRecordsToPrint := 10;
                   letzteRE := 0D;
                   Belege.RESET;
                   Belege.SETFILTER(Belege.Belegart,'Rechnung');
                   IF Belege.FINDLAST THEN
                     BEGIN
                       letzteRE:=Belege.Belegdatum;
                       "RE-Nr" := Belege."Belegnr.";
                     END;
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[CSY=Moznosti;
                             DAN=Indstillinger;
                             DEU=Optionen;
                             ENU=Options;
                             FIN=Vaihtoehdot;
                             ISL=Valkostir;
                             NLD=Opties;
                             NOR=Alternativer;
                             SVE=Alternativ;
                             ITS=Opzioni;
                             NLB=Opties] }

      { 1140007;2;Field     ;
                  CaptionML=DEU=Stand letzte RE:;
                  SourceExpr=letzteRE;
                  Editable=FALSE }

      { 1140011;2;Field     ;
                  SourceExpr="RE-Nr";
                  Editable=FALSE }

      { 1140010;2;Field     ;
                  CaptionML=DEU=Betreuer Innendienst;
                  SourceExpr=betrinnen;
                  TableRelation=Salesperson/Purchaser }

      { 1140001;2;Field     ;
                  CaptionML=DEU=Verk„ufercode;
                  SourceExpr=vkcode;
                  TableRelation=Salesperson/Purchaser }

      { 1140017;2;Field     ;
                  CaptionML=DEU=Teams;
                  SourceExpr=vteams;
                  TableRelation=Team }

      { 1140019;2;Field     ;
                  CaptionML=DEU=Gebietscode;
                  SourceExpr=vGebietscode;
                  TableRelation=Territory }

      { 1140004;2;Field     ;
                  CaptionML=DEU=Buchungsdatum von;
                  SourceExpr=StartBuchdatum }

      { 1140006;2;Field     ;
                  CaptionML=DEU=bis;
                  SourceExpr=Endbuchdatum }

      { 1000000004;2;Field  ;
                  CaptionML=DEU=Herstellercode;
                  SourceExpr=vHerstellercode }

      { 1000000001;2;Field  ;
                  SourceExpr='Hersteller šbersicht';
                  TableRelation=Manufacturer }

      { 1140013;2;Field     ;
                  CaptionML=DEU=L„ndercode;
                  SourceExpr=l„ndercode;
                  TableRelation=Country/Region;
                  OnValidate=BEGIN
                               MESSAGE('Das Feld L„ndercode wird derzeit noch nicht ausgewertet.');
                             END;
                              }

      { 3   ;2   ;Field     ;
                  CaptionML=[DEU=Menge;
                             ENU=Quantity];
                  SourceExpr=NoOfRecordsToPrint }

      { 5000;2   ;Field     ;
                  Name=ForNavOpenDesigner;
                  CaptionML=ENU=Open Designer;
                  SourceExpr=ReportForNavOpenDesigner;
                  Visible=ReportForNavAllowDesign }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Text000@1000 : TextConst 'DEU=Debitoren sortieren  #1##########;ENU=Sorting customers    #1##########';
      Text001@1001 : TextConst 'DEU=Periode: %1;ENU=Period: %1';
      Text002@1002 : TextConst 'DEU=Reihenfolge gem„á %1;ENU=Ranked according to %1';
      Text003@1003 : TextConst 'DEU=Anteil von %1;ENU=Portion of %1';
      Window@1004 : Dialog;
      CustAmount@1005 : TEMPORARY Record 266;
      Cust@1140005 : Record 18;
      SalesHeader@1140000 : Record 36;
      SalesLine@1140001 : Record 37;
      Belege@1140003 : Record 50010;
      Customer@1140027 : Record 18;
      Berichtstabelle@1140024 : TEMPORARY Record 50037;
      Hersteller@1140028 : Record 5720;
      CustName@1140004 : Text[50];
      CustFilter@1006 : Text[250];
      CustDateFilter@1007 : Text[30];
      ShowType@1008 : 'Sales (LCY),Balance (LCY)';
      NoOfRecordsToPrint@1009 : Integer;
      CustSalesLCY@1010 : Decimal;
      ges_CustSalesLCY@1140015 : Decimal;
      SalesPct@1012 : Decimal;
      MaxAmount@1014 : Decimal;
      BarText@1015 : Text[50];
      i@1016 : Integer;
      Text004@1017 : TextConst 'DEU=Verkauf (MW),Saldo (MW);ENU=Sales (LCY),Balance (LCY)';
      vkcode@1140002 : Code[80];
      betrinnen@1140019 : Code[80];
      vteams@1140023 : Code[80];
      aubestand@1140012 : Decimal;
      ges_aubestand@1140014 : Decimal;
      marge@1140013 : Decimal;
      letzteRE@1140006 : Date;
      "RE-Nr"@1140020 : Code[20];
      StartBuchdatum@1140017 : Date;
      Endbuchdatum@1140016 : Date;
      Excel@1140011 : Automation "{00020813-0000-0000-C000-000000000046} 1.2:{00024500-0000-0000-C000-000000000046}:Unknown Automation Server.Application";
      Book@1140010 : Automation "{00020813-0000-0000-C000-000000000046} 1.2:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";
      Range@1140009 : Automation "{00020813-0000-0000-C000-000000000046} 1.2:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";
      Sheet@1140008 : Automation "{00020813-0000-0000-C000-000000000046} 1.2:{00020820-0000-0000-C000-000000000046}:Unknown Automation Server.Worksheet";
      j@1140007 : Text[30];
      filter@1140018 : Text[250];
      l„ndercode@1140021 : Code[40];
      vHerstellercode@1140022 : Code[40];
      vGebietscode@1140033 : Code[20];
      counter@1140025 : Integer;
      linien@1140029 : Text[250];
      vk_wert@1140030 : Decimal;
      ma_wert@1140031 : Decimal;
      ma_proz@1140032 : Decimal;
      TOPAS_API@1000000000 : Codeunit 50001;
      ReportForNav@5000 : DotNet "'ForNav.Reports.2.0.0.1189, Version=2.0.0.1189, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" WITHEVENTS;
      ReportForNavClient@5003 : DotNet "'ForNav.Reports.2.0.0.1189, Version=2.0.0.1189, Culture=neutral, PublicKeyToken=5284c1af2984feb0'.ForNav.Report" RUNONCLIENT;
      ReportForNavDialog@5001 : Dialog;
      ReportForNavOpenDesigner@5002 : Boolean;
      ReportForNavAllowDesign@5004 : Boolean INDATASET;

    LOCAL PROCEDURE OnPreSectionInteger_Header2@5010(VAR Integer@1000000000 : Record 2000000026);
    BEGIN
      WITH Integer DO BEGIN
        ReportForNav.ShowOutput((ReportForNav.PageNo = 1) AND (CustFilter <> ''));
      END;
    END;

    LOCAL PROCEDURE OnPreSectionInteger_Footer5@5011(VAR Integer@1000000000 : Record 2000000026);
    BEGIN
      WITH Integer DO BEGIN
        SalesPct := Pct(ges_CustSalesLCY,CustSalesLCY*(-1));
      END;
    END;

    LOCAL PROCEDURE Pct@1(Numeral1@1000 : Decimal;Numeral2@1001 : Decimal) : Decimal;
    BEGIN
      IF Numeral2 = 0 THEN
        EXIT(0);
      EXIT(ROUND(Numeral1 / Numeral2 * 100,0.1));
    END;

    EVENT ReportForNav@5000::OnInit@5002();
    VAR
      ReportLayoutSelection@1000 : Record 9651;
      CustomReportLayout@1001 : Record 9650;
      CustomLayoutID@1002 : Variant;
      InStream@1004 : InStream;
      EmptyLayout@1003 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout ID");
      CustomLayoutID := ReportLayoutSelection."Custom Report Layout ID";
      ReportForNav.OData := GETURL(CLIENTTYPE::OData, COMPANYNAME, OBJECTTYPE::Page, 7702);
      IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN
        CustomLayoutID := ReportLayoutSelection.GetTempLayoutSelected
      ELSE
        IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN
          CustomLayoutID := ReportLayoutSelection."Custom Report Layout ID";

      IF (FORMAT(CustomLayoutID) <> EmptyLayout) AND CustomReportLayout.GET(CustomLayoutID) THEN BEGIN
        CustomReportLayout.TESTFIELD(Type,CustomReportLayout.Type::RDLC);
        CustomReportLayout.CALCFIELDS(Layout);
        CustomReportLayout.Layout.CREATEINSTREAM(InStream,TEXTENCODING::UTF8);
        ReportForNav.IsCustomLayout := TRUE;
      END ELSE
        REPORT.RDLCLAYOUT(ReportForNav.ReportID,InStream);

      ReportForNav.LoadRdlc(InStream);
      IF COPYSTR(LOWERCASE(GETURL(CLIENTTYPE::Current, COMPANYNAME, OBJECTTYPE::Codeunit, 1)), 1, 14) = 'dynamicsnav://' THEN BEGIN
        ReportForNav.CheckClientAddIn();
        ReportForNavClient := ReportForNavClient.Report(ReportForNav.Definition);
        ReportForNavAllowDesign := ReportForNavClient.HasDesigner AND NOT ReportForNav.ParameterMode;
      END;
    END;

    EVENT ReportForNav@5000::OnSave@5010(Base64Layout@1000 : Text);
    VAR
      CustomReportLayout@1002 : Record 9650;
      ReportLayoutSelection@1003 : Record 9651;
      LayoutId@1004 : Variant;
      TempBlob@1007 : Record 99008535;
      OutStream@1006 : OutStream;
      Bstr@1005 : BigText;
      EmptyLayout@1001 : Text;
    BEGIN
      EmptyLayout := FORMAT(ReportLayoutSelection."Custom Report Layout ID");
      LayoutId := ReportLayoutSelection."Custom Report Layout ID";
      IF ReportLayoutSelection.HasCustomLayout(ReportForNav.ReportID) = 1 THEN BEGIN
        IF FORMAT(ReportLayoutSelection.GetTempLayoutSelected) <> EmptyLayout THEN BEGIN
          LayoutId := ReportLayoutSelection.GetTempLayoutSelected;
        END ELSE BEGIN
          IF ReportLayoutSelection.GET(ReportForNav.ReportID, COMPANYNAME) THEN BEGIN
          LayoutId := ReportLayoutSelection."Custom Report Layout ID";
          END;
        END;
      END ELSE BEGIN
        IF CONFIRM('Default custom layout not found. Create one?') THEN;
      END;
      IF FORMAT(LayoutId) <> EmptyLayout THEN BEGIN
        TempBlob.Blob.CREATEOUTSTREAM(OutStream);
        Bstr.ADDTEXT(Base64Layout);
        Bstr.WRITE(OutStream);
        CustomReportLayout.GET(LayoutId);
        CustomReportLayout.ImportLayoutBlob(TempBlob, 'RDL');
      END;
    END;

    EVENT ReportForNav@5000::OnParameters@5008(Parameters@1000 : Text);
    BEGIN
      ReportForNav.Parameters := REPORT.RUNREQUESTPAGE(ReportForNav.ReportID, Parameters);
    END;

    EVENT ReportForNav@5000::OnPreview@5009(Parameters@1000 : Text;FileName@1005 : Text);
    VAR
      PdfFile@1002 : File;
      InStream@1003 : InStream;
      OutStream@1004 : OutStream;
    BEGIN
      COMMIT;
      PdfFile.CREATETEMPFILE;
      PdfFile.CREATEOUTSTREAM(OutStream);
      REPORT.SAVEAS(ReportForNav.ReportID, Parameters, REPORTFORMAT::Pdf, OutStream);
      PdfFile.CREATEINSTREAM(InStream);
      ReportForNavClient.ShowDesigner;
      IF ReportForNav.IsValidPdf(PdfFile.NAME) THEN DOWNLOADFROMSTREAM(InStream, '', '', '', FileName);
      PdfFile.CLOSE;
    END;

    EVENT ReportForNav@5000::OnPreSection@5012(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
      CASE DataItemId OF
        'Integer': CASE SectionId OF
          'Header2': OnPreSectionInteger_Header2(Integer);
          'Footer5': OnPreSectionInteger_Footer5(Integer);
        END;
      END;
    END;

    EVENT ReportForNav@5000::OnPostSection@50013(DataItemId@1000000000 : Text;SectionId@1000000001 : Text);
    BEGIN
    END;

    EVENT ReportForNav@5000::OnClientOperation@5008(Args@1000 : DotNet "'mscorlib, Version=2.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Array");
    VAR
      op@1001 : Text;
      FileMgmt@1002 : Codeunit 419;
      Process@1006 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.Process" RUNONCLIENT;
      PathObj@1005 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Path" RUNONCLIENT;
      FileVersionInfo@1003 : DotNet "'System, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.Diagnostics.FileVersionInfo" RUNONCLIENT;
      DirectoryHelper@1004 : DotNet "'mscorlib'.System.IO.Directory" RUNONCLIENT;
    BEGIN
      op := Args.GetValue(0);
      CASE op OF
        'TempPath': ReportForNav.Result := PathObj.GetTempPath();
        'FileExists': ReportForNav.Result := FileMgmt.ClientFileExists(Args.GetValue(1));
        'DirectoryExists': ReportForNav.Result := FileMgmt.ClientDirectoryExists(Args.GetValue(1));
        'ProcessLocation': ReportForNav.Result := Process.GetCurrentProcess().MainModule.FileName;
        'FileVersion': ReportForNav.Result := FileVersionInfo.GetVersionInfo(Args.GetValue(1)).FileVersion;
        'DeleteFile': FileMgmt.DeleteClientFile(Args.GetValue(1));
        'DeleteDirectory': IF STRLEN(Args.GetValue(1)) > 20 THEN
          IF FileMgmt.ClientDirectoryExists(Args.GetValue(1)) THEN
            DirectoryHelper.Delete(FORMAT(Args.GetValue(1)), TRUE);
      END;
    END;

    EVENT ReportForNav@5000::OnCheckForNavClientVersion@5007();
    BEGIN
      ReportForNavClient := ReportForNavClient.Report();
      IF ReportForNav.MyFileVersion <> ReportForNavClient.MyFileVersion THEN
        ERROR('You have version %1 of the Reports ForNAV assembly here:\\%2\\Please close your NAV client and update it to version %3.',
              ReportForNavClient.MyFileVersion, ReportForNavClient.MyFileName, ReportForNav.MyFileVersion);
    END;

    EVENT ReportForNav@5000::OnSelectPrinter@5006();
    BEGIN
      ReportForNav.PrinterSettings.PageSettings := ReportForNavClient.SelectPrinter(ReportForNav.PrinterSettings.PrinterName,ReportForNav.PrinterSettings.ShowPrinterDialog,ReportForNav.PrinterSettings.PageSettings);
    END;

    EVENT ReportForNav@5000::OnPrint@5005(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream");
    VAR
      ClientFileName@1000000001 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      ReportForNavClient.Print(ClientFileName);
    END;

    EVENT ReportForNav@5000::OnDesign@5007(Data@1001 : Text);
    BEGIN
      ReportForNavClient.Data := Data;
      WHILE ReportForNavClient.DesignReport DO BEGIN
        ReportForNav.HandleRequest(ReportForNavClient.GetRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnView@5008(ClientFileName@1000000000 : Text;Parameters@1000000001 : Text;ServerFileName@1000000002 : Text);
    VAR
      ServerFile@1000000003 : File;
      ServerInStream@1000000004 : InStream;
    BEGIN
      ServerFile.OPEN(ServerFileName);
      ServerFile.CREATEINSTREAM(ServerInStream);
      DOWNLOADFROMSTREAM(ServerInStream,'','','',ClientFileName);
    END;

    EVENT ReportForNav@5000::OnMessage@5009(Operation@1000000000 : Text;Parameter@1000000001 : Text;ParameterNo@1000000002 : Integer);
    BEGIN
      CASE Operation OF
        'Open'    : ReportForNavDialog.OPEN(Parameter);
        'Update'  : ReportForNavDialog.UPDATE(ParameterNo,Parameter);
        'Close'   : ReportForNavDialog.CLOSE();
        'Message' : MESSAGE(Parameter);
        'Error'   : ERROR(Parameter);
      END;
    END;

    EVENT ReportForNav@5000::OnPrintPreview@5011(InStream@1000000000 : DotNet "'mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.System.IO.Stream";Preview@1000000001 : Boolean);
    VAR
      ClientFileName@1000000002 : Text[255];
    BEGIN
      DOWNLOADFROMSTREAM(InStream, '', '<TEMP>', '', ClientFileName);
      WHILE ReportForNavClient.PrintPreviewDialog(ClientFileName,ReportForNav.PrinterSettings.PrinterName,Preview) DO BEGIN
        ReportForNav.HandlePrintPreviewRequest(ReportForNavClient.GetPrintPreviewRequest());
        SLEEP(100);
      END;
    END;

    EVENT ReportForNav@5000::OnTotals@5004(DataItemId@1000000000 : Text;Operation@1000000001 : Text;GroupTotalFieldNo@1000000002 : Integer);
    VAR
      CurrRecRef@1000000003 : RecordRef;
      NextRecRef@1000000004 : RecordRef;
      CurrKeyRef@1000000005 : KeyRef;
      NextKeyRef@1000000006 : KeyRef;
      FieldIndex@1000000007 : Integer;
      GroupFieldIndex@1000000008 : Integer;
    BEGIN
      // Do not change (Autogenerated by Reports ForNAV) - Instead change the Create Totals, Total Fields or Group Total Fields properties on the Data item in the ForNAV designer
      CASE DataItemId OF
        'Debitor': WITH Debitor DO CASE Operation OF
           'Add': BEGIN
                ReportForNav.AddTotal(DataItemId,0,aubestand);
                ReportForNav.AddTotal(DataItemId,1,CustSalesLCY);
              END;
           'Restore': BEGIN
                 aubestand := ReportForNav.RestoreTotal(DataItemId,0,GroupTotalFieldNo);
                 CustSalesLCY := ReportForNav.RestoreTotal(DataItemId,1,GroupTotalFieldNo);
              END;
        END;
      END;
    END;

    EVENT Sheet@1140008::SelectionChange@1543(Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT Sheet@1140008::BeforeDoubleClick@1537(Target@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Sheet@1140008::BeforeRightClick@1534(Target@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Sheet@1140008::Activate@304();
    BEGIN
    END;

    EVENT Sheet@1140008::Deactivate@1530();
    BEGIN
    END;

    EVENT Sheet@1140008::Calculate@279();
    BEGIN
    END;

    EVENT Sheet@1140008::Change@1545(Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT Sheet@1140008::FollowHyperlink@1470(Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00024431-0000-0000-C000-000000000046}:Unknown Automation Server.Hyperlink");
    BEGIN
    END;

    EVENT Sheet@1140008::PivotTableUpdate@2156(Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT Book@1140010::Open@1923();
    BEGIN
    END;

    EVENT Book@1140010::Activate@304();
    BEGIN
    END;

    EVENT Book@1140010::Deactivate@1530();
    BEGIN
    END;

    EVENT Book@1140010::BeforeClose@1546(VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book@1140010::BeforeSave@1547(SaveAsUI@1140001 : Boolean;VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book@1140010::BeforePrint@1549(VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book@1140010::NewSheet@1550(Sh@1140000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Book@1140010::AddinInstall@1552();
    BEGIN
    END;

    EVENT Book@1140010::AddinUninstall@1553();
    BEGIN
    END;

    EVENT Book@1140010::WindowResize@1554(Wn@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020893-0000-0000-C000-000000000046}:Unknown Automation Server.Window");
    BEGIN
    END;

    EVENT Book@1140010::WindowActivate@1556(Wn@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020893-0000-0000-C000-000000000046}:Unknown Automation Server.Window");
    BEGIN
    END;

    EVENT Book@1140010::WindowDeactivate@1557(Wn@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020893-0000-0000-C000-000000000046}:Unknown Automation Server.Window");
    BEGIN
    END;

    EVENT Book@1140010::SheetSelectionChange@1558(Sh@1140001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT Book@1140010::SheetBeforeDoubleClick@1559(Sh@1140002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book@1140010::SheetBeforeRightClick@1560(Sh@1140002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book@1140010::SheetActivate@1561(Sh@1140000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Book@1140010::SheetDeactivate@1562(Sh@1140000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Book@1140010::SheetCalculate@1563(Sh@1140000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Book@1140010::SheetChange@1564(Sh@1140001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT Book@1140010::SheetFollowHyperlink@1854(Sh@1140001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00024431-0000-0000-C000-000000000046}:Unknown Automation Server.Hyperlink");
    BEGIN
    END;

    EVENT Book@1140010::SheetPivotTableUpdate@2157(Sh@1140001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT Book@1140010::PivotTableCloseConnection@2158(Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT Book@1140010::PivotTableOpenConnection@2159(Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT Book@1140010::Sync@2266(SyncEventType@1140000 : Integer);
    BEGIN
    END;

    EVENT Book@1140010::BeforeXmlImport@2283(Map@1140003 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";Url@1140002 : Text[1024];IsRefresh@1140001 : Boolean;VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book@1140010::AfterXmlImport@2285(Map@1140002 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";IsRefresh@1140001 : Boolean;Result@1140000 : Integer);
    BEGIN
    END;

    EVENT Book@1140010::BeforeXmlExport@2287(Map@1140002 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";Url@1140001 : Text[1024];VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Book@1140010::AfterXmlExport@2288(Map@1140002 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";Url@1140001 : Text[1024];Result@1140000 : Integer);
    BEGIN
    END;

    EVENT Book@1140010::RowsetComplete@2610(Description@1140002 : Text[1024];Sheet@1140001 : Text[1024];Success@1140000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1140011::NewWorkbook@1565(Wb@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook");
    BEGIN
    END;

    EVENT Excel@1140011::SheetSelectionChange@1558(Sh@1140001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT Excel@1140011::SheetBeforeDoubleClick@1559(Sh@1140002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1140011::SheetBeforeRightClick@1560(Sh@1140002 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range";VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1140011::SheetActivate@1561(Sh@1140000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Excel@1140011::SheetDeactivate@1562(Sh@1140000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Excel@1140011::SheetCalculate@1563(Sh@1140000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Excel@1140011::SheetChange@1564(Sh@1140001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020846-0000-0000-C000-000000000046}:Unknown Automation Server.Range");
    BEGIN
    END;

    EVENT Excel@1140011::WorkbookOpen@1567(Wb@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook");
    BEGIN
    END;

    EVENT Excel@1140011::WorkbookActivate@1568(Wb@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook");
    BEGIN
    END;

    EVENT Excel@1140011::WorkbookDeactivate@1569(Wb@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook");
    BEGIN
    END;

    EVENT Excel@1140011::WorkbookBeforeClose@1570(Wb@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1140011::WorkbookBeforeSave@1571(Wb@1140002 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";SaveAsUI@1140001 : Boolean;VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1140011::WorkbookBeforePrint@1572(Wb@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1140011::WorkbookNewSheet@1573(Wb@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Sh@1140000 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH");
    BEGIN
    END;

    EVENT Excel@1140011::WorkbookAddinInstall@1574(Wb@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook");
    BEGIN
    END;

    EVENT Excel@1140011::WorkbookAddinUninstall@1575(Wb@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook");
    BEGIN
    END;

    EVENT Excel@1140011::WindowResize@1554(Wb@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Wn@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020893-0000-0000-C000-000000000046}:Unknown Automation Server.Window");
    BEGIN
    END;

    EVENT Excel@1140011::WindowActivate@1556(Wb@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Wn@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020893-0000-0000-C000-000000000046}:Unknown Automation Server.Window");
    BEGIN
    END;

    EVENT Excel@1140011::WindowDeactivate@1557(Wb@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Wn@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020893-0000-0000-C000-000000000046}:Unknown Automation Server.Window");
    BEGIN
    END;

    EVENT Excel@1140011::SheetFollowHyperlink@1854(Sh@1140001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00024431-0000-0000-C000-000000000046}:Unknown Automation Server.Hyperlink");
    BEGIN
    END;

    EVENT Excel@1140011::SheetPivotTableUpdate@2157(Sh@1140001 : Automation ":{00020400-0000-0000-C000-000000000046}:''.IDISPATCH";Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT Excel@1140011::WorkbookPivotTableCloseConnection@2160(Wb@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT Excel@1140011::WorkbookPivotTableOpenConnection@2161(Wb@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Target@1140000 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020872-0000-0000-C000-000000000046}:Unknown Automation Server.PivotTable");
    BEGIN
    END;

    EVENT Excel@1140011::WorkbookSync@2289(Wb@1140001 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";SyncEventType@1140000 : Integer);
    BEGIN
    END;

    EVENT Excel@1140011::WorkbookBeforeXmlImport@2290(Wb@1140004 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Map@1140003 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";Url@1140002 : Text[1024];IsRefresh@1140001 : Boolean;VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1140011::WorkbookAfterXmlImport@2291(Wb@1140003 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Map@1140002 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";IsRefresh@1140001 : Boolean;Result@1140000 : Integer);
    BEGIN
    END;

    EVENT Excel@1140011::WorkbookBeforeXmlExport@2292(Wb@1140003 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Map@1140002 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";Url@1140001 : Text[1024];VAR Cancel@1140000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1140011::WorkbookAfterXmlExport@2293(Wb@1140003 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Map@1140002 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{0002447B-0000-0000-C000-000000000046}:Unknown Automation Server.XmlMap";Url@1140001 : Text[1024];Result@1140000 : Integer);
    BEGIN
    END;

    EVENT Excel@1140011::WorkbookRowsetComplete@2611(Wb@1140003 : Automation "{00020813-0000-0000-C000-000000000046} 1.6:{00020819-0000-0000-C000-000000000046}:Unknown Automation Server.Workbook";Description@1140002 : Text[1024];Sheet@1140001 : Text[1024];Success@1140000 : Boolean);
    BEGIN
    END;

    EVENT Excel@1140011::AfterCalculate@2612();
    BEGIN
    END;

    BEGIN
    {
      Nr.     Version   Datum       User  Beschreibung
      ===========================================================================
      1       TOP1.00   10.10.17    ST    Umstellung Berichtstabelle auf TEMPORARY = YES, um L”schungprobleme in der Berichtstabelle zu verhindern
    }
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <Description>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</Description>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>addeab18-f39e-47a2-ac49-21b189d8bb92</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <ReportSections>
    <ReportSection>
      <Body>
        <Height>2in</Height>
        <Style />
      </Body>
      <Width>6.5in</Width>
      <Page>
        <Style />
      </Page>
    </ReportSection>
  </ReportSections>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>d7ab8421-bd9b-444b-971f-1b74f603e042</rd:ReportID>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Fields>
        <Field Name="USERID">
          <DataField>USERID</DataField>
        </Field>
        <Field Name="COMPANYNAME">
          <DataField>COMPANYNAME</DataField>
        </Field>
        <Field Name="ReportForNavPageNo">
          <DataField>ReportForNavPageNo</DataField>
        </Field>
        <Field Name="TODAY_0_4">
          <DataField>TODAY_0_4</DataField>
        </Field>
        <Field Name="vteams">
          <DataField>vteams</DataField>
        </Field>
        <Field Name="vkcode">
          <DataField>vkcode</DataField>
        </Field>
        <Field Name="betrinnen">
          <DataField>betrinnen</DataField>
        </Field>
        <Field Name="filter">
          <DataField>filter</DataField>
        </Field>
        <Field Name="CustomerTABLECAPTION___CustFilter">
          <DataField>CustomerTABLECAPTION___CustFilter</DataField>
        </Field>
        <Field Name="Amount2_LCY_CustAmount">
          <DataField>Amount2_LCY_CustAmount</DataField>
        </Field>
        <Field Name="Amount2_LCY_CustAmountFormat">
          <DataField>Amount2_LCY_CustAmountFormat</DataField>
        </Field>
        <Field Name="BarText">
          <DataField>BarText</DataField>
        </Field>
        <Field Name="CustAmountAmount_LCY__1">
          <DataField>CustAmountAmount_LCY__1</DataField>
        </Field>
        <Field Name="CustAmountAmount_LCY__1Format">
          <DataField>CustAmountAmount_LCY__1Format</DataField>
        </Field>
        <Field Name="CustName">
          <DataField>CustName</DataField>
        </Field>
        <Field Name="CustomerNo_CustAmount">
          <DataField>CustomerNo_CustAmount</DataField>
        </Field>
        <Field Name="Number_Integer">
          <DataField>Number_Integer</DataField>
        </Field>
        <Field Name="SalesPct">
          <DataField>SalesPct</DataField>
        </Field>
        <Field Name="SalesPctFormat">
          <DataField>SalesPctFormat</DataField>
        </Field>
        <Field Name="ges_aubestand">
          <DataField>ges_aubestand</DataField>
        </Field>
        <Field Name="ges_aubestandFormat">
          <DataField>ges_aubestandFormat</DataField>
        </Field>
        <Field Name="ges_CustSalesLCY">
          <DataField>ges_CustSalesLCY</DataField>
        </Field>
        <Field Name="ges_CustSalesLCYFormat">
          <DataField>ges_CustSalesLCYFormat</DataField>
        </Field>
        <Field Name="aubestand">
          <DataField>aubestand</DataField>
        </Field>
        <Field Name="aubestandFormat">
          <DataField>aubestandFormat</DataField>
        </Field>
        <Field Name="CustSalesLCY_1">
          <DataField>CustSalesLCY_1</DataField>
        </Field>
        <Field Name="CustSalesLCY_1Format">
          <DataField>CustSalesLCY_1Format</DataField>
        </Field>
      </Fields>
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
</Report>
    END_OF_RDLDATA
  }
}

